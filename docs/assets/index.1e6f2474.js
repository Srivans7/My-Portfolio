var PL=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports);var S8=PL((E8,e_)=>{const RL=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}};RL();var Ch=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function xp(i){throw new Error('Could not dynamically require "'+i+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var St={exports:{}},$t={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sf=Symbol.for("react.element"),LL=Symbol.for("react.portal"),kL=Symbol.for("react.fragment"),IL=Symbol.for("react.strict_mode"),FL=Symbol.for("react.profiler"),DL=Symbol.for("react.provider"),BL=Symbol.for("react.context"),zL=Symbol.for("react.forward_ref"),OL=Symbol.for("react.suspense"),NL=Symbol.for("react.memo"),UL=Symbol.for("react.lazy"),Fb=Symbol.iterator;function HL(i){return i===null||typeof i!="object"?null:(i=Fb&&i[Fb]||i["@@iterator"],typeof i=="function"?i:null)}var dA={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},fA=Object.assign,pA={};function Hu(i,e,t){this.props=i,this.context=e,this.refs=pA,this.updater=t||dA}Hu.prototype.isReactComponent={};Hu.prototype.setState=function(i,e){if(typeof i!="object"&&typeof i!="function"&&i!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,i,e,"setState")};Hu.prototype.forceUpdate=function(i){this.updater.enqueueForceUpdate(this,i,"forceUpdate")};function mA(){}mA.prototype=Hu.prototype;function t_(i,e,t){this.props=i,this.context=e,this.refs=pA,this.updater=t||dA}var n_=t_.prototype=new mA;n_.constructor=t_;fA(n_,Hu.prototype);n_.isPureReactComponent=!0;var Db=Array.isArray,gA=Object.prototype.hasOwnProperty,i_={current:null},vA={key:!0,ref:!0,__self:!0,__source:!0};function yA(i,e,t){var n,r={},s=null,o=null;if(e!=null)for(n in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)gA.call(e,n)&&!vA.hasOwnProperty(n)&&(r[n]=e[n]);var a=arguments.length-2;if(a===1)r.children=t;else if(1<a){for(var c=Array(a),h=0;h<a;h++)c[h]=arguments[h+2];r.children=c}if(i&&i.defaultProps)for(n in a=i.defaultProps,a)r[n]===void 0&&(r[n]=a[n]);return{$$typeof:sf,type:i,key:s,ref:o,props:r,_owner:i_.current}}function VL(i,e){return{$$typeof:sf,type:i.type,key:e,ref:i.ref,props:i.props,_owner:i._owner}}function r_(i){return typeof i=="object"&&i!==null&&i.$$typeof===sf}function GL(i){var e={"=":"=0",":":"=2"};return"$"+i.replace(/[=:]/g,function(t){return e[t]})}var Bb=/\/+/g;function B0(i,e){return typeof i=="object"&&i!==null&&i.key!=null?GL(""+i.key):e.toString(36)}function Bm(i,e,t,n,r){var s=typeof i;(s==="undefined"||s==="boolean")&&(i=null);var o=!1;if(i===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(i.$$typeof){case sf:case LL:o=!0}}if(o)return o=i,r=r(o),i=n===""?"."+B0(o,0):n,Db(r)?(t="",i!=null&&(t=i.replace(Bb,"$&/")+"/"),Bm(r,e,t,"",function(h){return h})):r!=null&&(r_(r)&&(r=VL(r,t+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(Bb,"$&/")+"/")+i)),e.push(r)),1;if(o=0,n=n===""?".":n+":",Db(i))for(var a=0;a<i.length;a++){s=i[a];var c=n+B0(s,a);o+=Bm(s,e,t,c,r)}else if(c=HL(i),typeof c=="function")for(i=c.call(i),a=0;!(s=i.next()).done;)s=s.value,c=n+B0(s,a++),o+=Bm(s,e,t,c,r);else if(s==="object")throw e=String(i),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function wp(i,e,t){if(i==null)return i;var n=[],r=0;return Bm(i,n,"","",function(s){return e.call(t,s,r++)}),n}function WL(i){if(i._status===-1){var e=i._result;e=e(),e.then(function(t){(i._status===0||i._status===-1)&&(i._status=1,i._result=t)},function(t){(i._status===0||i._status===-1)&&(i._status=2,i._result=t)}),i._status===-1&&(i._status=0,i._result=e)}if(i._status===1)return i._result.default;throw i._result}var tr={current:null},zm={transition:null},jL={ReactCurrentDispatcher:tr,ReactCurrentBatchConfig:zm,ReactCurrentOwner:i_};$t.Children={map:wp,forEach:function(i,e,t){wp(i,function(){e.apply(this,arguments)},t)},count:function(i){var e=0;return wp(i,function(){e++}),e},toArray:function(i){return wp(i,function(e){return e})||[]},only:function(i){if(!r_(i))throw Error("React.Children.only expected to receive a single React element child.");return i}};$t.Component=Hu;$t.Fragment=kL;$t.Profiler=FL;$t.PureComponent=t_;$t.StrictMode=IL;$t.Suspense=OL;$t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=jL;$t.cloneElement=function(i,e,t){if(i==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+i+".");var n=fA({},i.props),r=i.key,s=i.ref,o=i._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=i_.current),e.key!==void 0&&(r=""+e.key),i.type&&i.type.defaultProps)var a=i.type.defaultProps;for(c in e)gA.call(e,c)&&!vA.hasOwnProperty(c)&&(n[c]=e[c]===void 0&&a!==void 0?a[c]:e[c])}var c=arguments.length-2;if(c===1)n.children=t;else if(1<c){a=Array(c);for(var h=0;h<c;h++)a[h]=arguments[h+2];n.children=a}return{$$typeof:sf,type:i.type,key:r,ref:s,props:n,_owner:o}};$t.createContext=function(i){return i={$$typeof:BL,_currentValue:i,_currentValue2:i,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},i.Provider={$$typeof:DL,_context:i},i.Consumer=i};$t.createElement=yA;$t.createFactory=function(i){var e=yA.bind(null,i);return e.type=i,e};$t.createRef=function(){return{current:null}};$t.forwardRef=function(i){return{$$typeof:zL,render:i}};$t.isValidElement=r_;$t.lazy=function(i){return{$$typeof:UL,_payload:{_status:-1,_result:i},_init:WL}};$t.memo=function(i,e){return{$$typeof:NL,type:i,compare:e===void 0?null:e}};$t.startTransition=function(i){var e=zm.transition;zm.transition={};try{i()}finally{zm.transition=e}};$t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};$t.useCallback=function(i,e){return tr.current.useCallback(i,e)};$t.useContext=function(i){return tr.current.useContext(i)};$t.useDebugValue=function(){};$t.useDeferredValue=function(i){return tr.current.useDeferredValue(i)};$t.useEffect=function(i,e){return tr.current.useEffect(i,e)};$t.useId=function(){return tr.current.useId()};$t.useImperativeHandle=function(i,e,t){return tr.current.useImperativeHandle(i,e,t)};$t.useInsertionEffect=function(i,e){return tr.current.useInsertionEffect(i,e)};$t.useLayoutEffect=function(i,e){return tr.current.useLayoutEffect(i,e)};$t.useMemo=function(i,e){return tr.current.useMemo(i,e)};$t.useReducer=function(i,e,t){return tr.current.useReducer(i,e,t)};$t.useRef=function(i){return tr.current.useRef(i)};$t.useState=function(i){return tr.current.useState(i)};$t.useSyncExternalStore=function(i,e,t){return tr.current.useSyncExternalStore(i,e,t)};$t.useTransition=function(){return tr.current.useTransition()};$t.version="18.2.0";St.exports=$t;var XL=St.exports,xA={exports:{}},Br={},wA={exports:{}},_A={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(i){function e(k,W){var Y=k.length;k.push(W);e:for(;0<Y;){var H=Y-1>>>1,J=k[H];if(0<r(J,W))k[H]=W,k[Y]=J,Y=H;else break e}}function t(k){return k.length===0?null:k[0]}function n(k){if(k.length===0)return null;var W=k[0],Y=k.pop();if(Y!==W){k[0]=Y;e:for(var H=0,J=k.length,K=J>>>1;H<K;){var ee=2*(H+1)-1,$=k[ee],Z=ee+1,Ee=k[Z];if(0>r($,Y))Z<J&&0>r(Ee,$)?(k[H]=Ee,k[Z]=Y,H=Z):(k[H]=$,k[ee]=Y,H=ee);else if(Z<J&&0>r(Ee,Y))k[H]=Ee,k[Z]=Y,H=Z;else break e}}return W}function r(k,W){var Y=k.sortIndex-W.sortIndex;return Y!==0?Y:k.id-W.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;i.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();i.unstable_now=function(){return o.now()-a}}var c=[],h=[],d=1,l=null,u=3,p=!1,g=!1,y=!1,x=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate!="undefined"?setImmediate:null;typeof navigator!="undefined"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(k){for(var W=t(h);W!==null;){if(W.callback===null)n(h);else if(W.startTime<=k)n(h),W.sortIndex=W.expirationTime,e(c,W);else break;W=t(h)}}function b(k){if(y=!1,S(k),!g)if(t(c)!==null)g=!0,ne(E);else{var W=t(h);W!==null&&j(b,W.startTime-k)}}function E(k,W){g=!1,y&&(y=!1,v(I),I=-1),p=!0;var Y=u;try{for(S(W),l=t(c);l!==null&&(!(l.expirationTime>W)||k&&!C());){var H=l.callback;if(typeof H=="function"){l.callback=null,u=l.priorityLevel;var J=H(l.expirationTime<=W);W=i.unstable_now(),typeof J=="function"?l.callback=J:l===t(c)&&n(c),S(W)}else n(c);l=t(c)}if(l!==null)var K=!0;else{var ee=t(h);ee!==null&&j(b,ee.startTime-W),K=!1}return K}finally{l=null,u=Y,p=!1}}var R=!1,z=null,I=-1,N=5,F=-1;function C(){return!(i.unstable_now()-F<N)}function O(){if(z!==null){var k=i.unstable_now();F=k;var W=!0;try{W=z(!0,k)}finally{W?X():(R=!1,z=null)}}else R=!1}var X;if(typeof w=="function")X=function(){w(O)};else if(typeof MessageChannel!="undefined"){var U=new MessageChannel,te=U.port2;U.port1.onmessage=O,X=function(){te.postMessage(null)}}else X=function(){x(O,0)};function ne(k){z=k,R||(R=!0,X())}function j(k,W){I=x(function(){k(i.unstable_now())},W)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(k){k.callback=null},i.unstable_continueExecution=function(){g||p||(g=!0,ne(E))},i.unstable_forceFrameRate=function(k){0>k||125<k?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<k?Math.floor(1e3/k):5},i.unstable_getCurrentPriorityLevel=function(){return u},i.unstable_getFirstCallbackNode=function(){return t(c)},i.unstable_next=function(k){switch(u){case 1:case 2:case 3:var W=3;break;default:W=u}var Y=u;u=W;try{return k()}finally{u=Y}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(k,W){switch(k){case 1:case 2:case 3:case 4:case 5:break;default:k=3}var Y=u;u=k;try{return W()}finally{u=Y}},i.unstable_scheduleCallback=function(k,W,Y){var H=i.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?H+Y:H):Y=H,k){case 1:var J=-1;break;case 2:J=250;break;case 5:J=1073741823;break;case 4:J=1e4;break;default:J=5e3}return J=Y+J,k={id:d++,callback:W,priorityLevel:k,startTime:Y,expirationTime:J,sortIndex:-1},Y>H?(k.sortIndex=Y,e(h,k),t(c)===null&&k===t(h)&&(y?(v(I),I=-1):y=!0,j(b,Y-H))):(k.sortIndex=J,e(c,k),g||p||(g=!0,ne(E))),k},i.unstable_shouldYield=C,i.unstable_wrapCallback=function(k){var W=u;return function(){var Y=u;u=W;try{return k.apply(this,arguments)}finally{u=Y}}}})(_A);wA.exports=_A;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var SA=St.exports,Dr=wA.exports;function tt(i){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+i,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+i+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var bA=new Set,Md={};function ql(i,e){du(i,e),du(i+"Capture",e)}function du(i,e){for(Md[i]=e,i=0;i<e.length;i++)bA.add(e[i])}var Eo=!(typeof window=="undefined"||typeof window.document=="undefined"||typeof window.document.createElement=="undefined"),ax=Object.prototype.hasOwnProperty,qL=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,zb={},Ob={};function YL(i){return ax.call(Ob,i)?!0:ax.call(zb,i)?!1:qL.test(i)?Ob[i]=!0:(zb[i]=!0,!1)}function $L(i,e,t,n){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:t!==null?!t.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function QL(i,e,t,n){if(e===null||typeof e=="undefined"||$L(i,e,t,n))return!0;if(n)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function nr(i,e,t,n,r,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=r,this.mustUseProperty=t,this.propertyName=i,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Ii={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){Ii[i]=new nr(i,0,!1,i,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var e=i[0];Ii[e]=new nr(e,1,!1,i[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(i){Ii[i]=new nr(i,2,!1,i.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){Ii[i]=new nr(i,2,!1,i,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){Ii[i]=new nr(i,3,!1,i.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(i){Ii[i]=new nr(i,3,!0,i,null,!1,!1)});["capture","download"].forEach(function(i){Ii[i]=new nr(i,4,!1,i,null,!1,!1)});["cols","rows","size","span"].forEach(function(i){Ii[i]=new nr(i,6,!1,i,null,!1,!1)});["rowSpan","start"].forEach(function(i){Ii[i]=new nr(i,5,!1,i.toLowerCase(),null,!1,!1)});var s_=/[\-:]([a-z])/g;function o_(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var e=i.replace(s_,o_);Ii[e]=new nr(e,1,!1,i,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var e=i.replace(s_,o_);Ii[e]=new nr(e,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(i){var e=i.replace(s_,o_);Ii[e]=new nr(e,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(i){Ii[i]=new nr(i,1,!1,i.toLowerCase(),null,!1,!1)});Ii.xlinkHref=new nr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(i){Ii[i]=new nr(i,1,!1,i.toLowerCase(),null,!0,!0)});function a_(i,e,t,n){var r=Ii.hasOwnProperty(e)?Ii[e]:null;(r!==null?r.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(QL(e,t,r,n)&&(t=null),n||r===null?YL(e)&&(t===null?i.removeAttribute(e):i.setAttribute(e,""+t)):r.mustUseProperty?i[r.propertyName]=t===null?r.type===3?!1:"":t:(e=r.attributeName,n=r.attributeNamespace,t===null?i.removeAttribute(e):(r=r.type,t=r===3||r===4&&t===!0?"":""+t,n?i.setAttributeNS(n,e,t):i.setAttribute(e,t))))}var Fo=SA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_p=Symbol.for("react.element"),Hc=Symbol.for("react.portal"),Vc=Symbol.for("react.fragment"),l_=Symbol.for("react.strict_mode"),lx=Symbol.for("react.profiler"),MA=Symbol.for("react.provider"),EA=Symbol.for("react.context"),c_=Symbol.for("react.forward_ref"),cx=Symbol.for("react.suspense"),ux=Symbol.for("react.suspense_list"),u_=Symbol.for("react.memo"),aa=Symbol.for("react.lazy"),TA=Symbol.for("react.offscreen"),Nb=Symbol.iterator;function Ph(i){return i===null||typeof i!="object"?null:(i=Nb&&i[Nb]||i["@@iterator"],typeof i=="function"?i:null)}var Nn=Object.assign,z0;function Kh(i){if(z0===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);z0=e&&e[1]||""}return`
`+z0+i}var O0=!1;function N0(i,e){if(!i||O0)return"";O0=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(h){var n=h}Reflect.construct(i,[],e)}else{try{e.call()}catch(h){n=h}i.call(e.prototype)}else{try{throw Error()}catch(h){n=h}i()}}catch(h){if(h&&n&&typeof h.stack=="string"){for(var r=h.stack.split(`
`),s=n.stack.split(`
`),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==s[a]){var c=`
`+r[o].replace(" at new "," at ");return i.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",i.displayName)),c}while(1<=o&&0<=a);break}}}finally{O0=!1,Error.prepareStackTrace=t}return(i=i?i.displayName||i.name:"")?Kh(i):""}function ZL(i){switch(i.tag){case 5:return Kh(i.type);case 16:return Kh("Lazy");case 13:return Kh("Suspense");case 19:return Kh("SuspenseList");case 0:case 2:case 15:return i=N0(i.type,!1),i;case 11:return i=N0(i.type.render,!1),i;case 1:return i=N0(i.type,!0),i;default:return""}}function hx(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case Vc:return"Fragment";case Hc:return"Portal";case lx:return"Profiler";case l_:return"StrictMode";case cx:return"Suspense";case ux:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case EA:return(i.displayName||"Context")+".Consumer";case MA:return(i._context.displayName||"Context")+".Provider";case c_:var e=i.render;return i=i.displayName,i||(i=e.displayName||e.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case u_:return e=i.displayName||null,e!==null?e:hx(i.type)||"Memo";case aa:e=i._payload,i=i._init;try{return hx(i(e))}catch{}}return null}function KL(i){var e=i.type;switch(i.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=e.render,i=i.displayName||i.name||"",e.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return hx(e);case 8:return e===l_?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Aa(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function AA(i){var e=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function JL(i){var e=AA(i)?"checked":"value",t=Object.getOwnPropertyDescriptor(i.constructor.prototype,e),n=""+i[e];if(!i.hasOwnProperty(e)&&typeof t!="undefined"&&typeof t.get=="function"&&typeof t.set=="function"){var r=t.get,s=t.set;return Object.defineProperty(i,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(i,e,{enumerable:t.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){i._valueTracker=null,delete i[e]}}}}function Sp(i){i._valueTracker||(i._valueTracker=JL(i))}function CA(i){if(!i)return!1;var e=i._valueTracker;if(!e)return!0;var t=e.getValue(),n="";return i&&(n=AA(i)?i.checked?"true":"false":i.value),i=n,i!==t?(e.setValue(i),!0):!1}function sg(i){if(i=i||(typeof document!="undefined"?document:void 0),typeof i=="undefined")return null;try{return i.activeElement||i.body}catch{return i.body}}function dx(i,e){var t=e.checked;return Nn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t!=null?t:i._wrapperState.initialChecked})}function Ub(i,e){var t=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;t=Aa(e.value!=null?e.value:t),i._wrapperState={initialChecked:n,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function PA(i,e){e=e.checked,e!=null&&a_(i,"checked",e,!1)}function fx(i,e){PA(i,e);var t=Aa(e.value),n=e.type;if(t!=null)n==="number"?(t===0&&i.value===""||i.value!=t)&&(i.value=""+t):i.value!==""+t&&(i.value=""+t);else if(n==="submit"||n==="reset"){i.removeAttribute("value");return}e.hasOwnProperty("value")?px(i,e.type,t):e.hasOwnProperty("defaultValue")&&px(i,e.type,Aa(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(i.defaultChecked=!!e.defaultChecked)}function Hb(i,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+i._wrapperState.initialValue,t||e===i.value||(i.value=e),i.defaultValue=e}t=i.name,t!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,t!==""&&(i.name=t)}function px(i,e,t){(e!=="number"||sg(i.ownerDocument)!==i)&&(t==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+t&&(i.defaultValue=""+t))}var Jh=Array.isArray;function ru(i,e,t,n){if(i=i.options,e){e={};for(var r=0;r<t.length;r++)e["$"+t[r]]=!0;for(t=0;t<i.length;t++)r=e.hasOwnProperty("$"+i[t].value),i[t].selected!==r&&(i[t].selected=r),r&&n&&(i[t].defaultSelected=!0)}else{for(t=""+Aa(t),e=null,r=0;r<i.length;r++){if(i[r].value===t){i[r].selected=!0,n&&(i[r].defaultSelected=!0);return}e!==null||i[r].disabled||(e=i[r])}e!==null&&(e.selected=!0)}}function mx(i,e){if(e.dangerouslySetInnerHTML!=null)throw Error(tt(91));return Nn({},e,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function Vb(i,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(tt(92));if(Jh(t)){if(1<t.length)throw Error(tt(93));t=t[0]}e=t}e==null&&(e=""),t=e}i._wrapperState={initialValue:Aa(t)}}function RA(i,e){var t=Aa(e.value),n=Aa(e.defaultValue);t!=null&&(t=""+t,t!==i.value&&(i.value=t),e.defaultValue==null&&i.defaultValue!==t&&(i.defaultValue=t)),n!=null&&(i.defaultValue=""+n)}function Gb(i){var e=i.textContent;e===i._wrapperState.initialValue&&e!==""&&e!==null&&(i.value=e)}function LA(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function gx(i,e){return i==null||i==="http://www.w3.org/1999/xhtml"?LA(e):i==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var bp,kA=function(i){return typeof MSApp!="undefined"&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction(function(){return i(e,t,n,r)})}:i}(function(i,e){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=e;else{for(bp=bp||document.createElement("div"),bp.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=bp.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;e.firstChild;)i.appendChild(e.firstChild)}});function Ed(i,e){if(e){var t=i.firstChild;if(t&&t===i.lastChild&&t.nodeType===3){t.nodeValue=e;return}}i.textContent=e}var od={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ek=["Webkit","ms","Moz","O"];Object.keys(od).forEach(function(i){ek.forEach(function(e){e=e+i.charAt(0).toUpperCase()+i.substring(1),od[e]=od[i]})});function IA(i,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||od.hasOwnProperty(i)&&od[i]?(""+e).trim():e+"px"}function FA(i,e){i=i.style;for(var t in e)if(e.hasOwnProperty(t)){var n=t.indexOf("--")===0,r=IA(t,e[t],n);t==="float"&&(t="cssFloat"),n?i.setProperty(t,r):i[t]=r}}var tk=Nn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function vx(i,e){if(e){if(tk[i]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(tt(137,i));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(tt(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(tt(61))}if(e.style!=null&&typeof e.style!="object")throw Error(tt(62))}}function yx(i,e){if(i.indexOf("-")===-1)return typeof e.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xx=null;function h_(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var wx=null,su=null,ou=null;function Wb(i){if(i=lf(i)){if(typeof wx!="function")throw Error(tt(280));var e=i.stateNode;e&&(e=$g(e),wx(i.stateNode,i.type,e))}}function DA(i){su?ou?ou.push(i):ou=[i]:su=i}function BA(){if(su){var i=su,e=ou;if(ou=su=null,Wb(i),e)for(i=0;i<e.length;i++)Wb(e[i])}}function zA(i,e){return i(e)}function OA(){}var U0=!1;function NA(i,e,t){if(U0)return i(e,t);U0=!0;try{return zA(i,e,t)}finally{U0=!1,(su!==null||ou!==null)&&(OA(),BA())}}function Td(i,e){var t=i.stateNode;if(t===null)return null;var n=$g(t);if(n===null)return null;t=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(i=i.type,n=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!n;break e;default:i=!1}if(i)return null;if(t&&typeof t!="function")throw Error(tt(231,e,typeof t));return t}var _x=!1;if(Eo)try{var Rh={};Object.defineProperty(Rh,"passive",{get:function(){_x=!0}}),window.addEventListener("test",Rh,Rh),window.removeEventListener("test",Rh,Rh)}catch{_x=!1}function nk(i,e,t,n,r,s,o,a,c){var h=Array.prototype.slice.call(arguments,3);try{e.apply(t,h)}catch(d){this.onError(d)}}var ad=!1,og=null,ag=!1,Sx=null,ik={onError:function(i){ad=!0,og=i}};function rk(i,e,t,n,r,s,o,a,c){ad=!1,og=null,nk.apply(ik,arguments)}function sk(i,e,t,n,r,s,o,a,c){if(rk.apply(this,arguments),ad){if(ad){var h=og;ad=!1,og=null}else throw Error(tt(198));ag||(ag=!0,Sx=h)}}function Yl(i){var e=i,t=i;if(i.alternate)for(;e.return;)e=e.return;else{i=e;do e=i,(e.flags&4098)!==0&&(t=e.return),i=e.return;while(i)}return e.tag===3?t:null}function UA(i){if(i.tag===13){var e=i.memoizedState;if(e===null&&(i=i.alternate,i!==null&&(e=i.memoizedState)),e!==null)return e.dehydrated}return null}function jb(i){if(Yl(i)!==i)throw Error(tt(188))}function ok(i){var e=i.alternate;if(!e){if(e=Yl(i),e===null)throw Error(tt(188));return e!==i?null:i}for(var t=i,n=e;;){var r=t.return;if(r===null)break;var s=r.alternate;if(s===null){if(n=r.return,n!==null){t=n;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===t)return jb(r),i;if(s===n)return jb(r),e;s=s.sibling}throw Error(tt(188))}if(t.return!==n.return)t=r,n=s;else{for(var o=!1,a=r.child;a;){if(a===t){o=!0,t=r,n=s;break}if(a===n){o=!0,n=r,t=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===t){o=!0,t=s,n=r;break}if(a===n){o=!0,n=s,t=r;break}a=a.sibling}if(!o)throw Error(tt(189))}}if(t.alternate!==n)throw Error(tt(190))}if(t.tag!==3)throw Error(tt(188));return t.stateNode.current===t?i:e}function HA(i){return i=ok(i),i!==null?VA(i):null}function VA(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var e=VA(i);if(e!==null)return e;i=i.sibling}return null}var GA=Dr.unstable_scheduleCallback,Xb=Dr.unstable_cancelCallback,ak=Dr.unstable_shouldYield,lk=Dr.unstable_requestPaint,Kn=Dr.unstable_now,ck=Dr.unstable_getCurrentPriorityLevel,d_=Dr.unstable_ImmediatePriority,WA=Dr.unstable_UserBlockingPriority,lg=Dr.unstable_NormalPriority,uk=Dr.unstable_LowPriority,jA=Dr.unstable_IdlePriority,jg=null,qs=null;function hk(i){if(qs&&typeof qs.onCommitFiberRoot=="function")try{qs.onCommitFiberRoot(jg,i,void 0,(i.current.flags&128)===128)}catch{}}var _s=Math.clz32?Math.clz32:pk,dk=Math.log,fk=Math.LN2;function pk(i){return i>>>=0,i===0?32:31-(dk(i)/fk|0)|0}var Mp=64,Ep=4194304;function ed(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function cg(i,e){var t=i.pendingLanes;if(t===0)return 0;var n=0,r=i.suspendedLanes,s=i.pingedLanes,o=t&268435455;if(o!==0){var a=o&~r;a!==0?n=ed(a):(s&=o,s!==0&&(n=ed(s)))}else o=t&~r,o!==0?n=ed(o):s!==0&&(n=ed(s));if(n===0)return 0;if(e!==0&&e!==n&&(e&r)===0&&(r=n&-n,s=e&-e,r>=s||r===16&&(s&4194240)!==0))return e;if((n&4)!==0&&(n|=t&16),e=i.entangledLanes,e!==0)for(i=i.entanglements,e&=n;0<e;)t=31-_s(e),r=1<<t,n|=i[t],e&=~r;return n}function mk(i,e){switch(i){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function gk(i,e){for(var t=i.suspendedLanes,n=i.pingedLanes,r=i.expirationTimes,s=i.pendingLanes;0<s;){var o=31-_s(s),a=1<<o,c=r[o];c===-1?((a&t)===0||(a&n)!==0)&&(r[o]=mk(a,e)):c<=e&&(i.expiredLanes|=a),s&=~a}}function bx(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function XA(){var i=Mp;return Mp<<=1,(Mp&4194240)===0&&(Mp=64),i}function H0(i){for(var e=[],t=0;31>t;t++)e.push(i);return e}function of(i,e,t){i.pendingLanes|=e,e!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,e=31-_s(e),i[e]=t}function vk(i,e){var t=i.pendingLanes&~e;i.pendingLanes=e,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=e,i.mutableReadLanes&=e,i.entangledLanes&=e,e=i.entanglements;var n=i.eventTimes;for(i=i.expirationTimes;0<t;){var r=31-_s(t),s=1<<r;e[r]=0,n[r]=-1,i[r]=-1,t&=~s}}function f_(i,e){var t=i.entangledLanes|=e;for(i=i.entanglements;t;){var n=31-_s(t),r=1<<n;r&e|i[n]&e&&(i[n]|=e),t&=~r}}var un=0;function qA(i){return i&=-i,1<i?4<i?(i&268435455)!==0?16:536870912:4:1}var YA,p_,$A,QA,ZA,Mx=!1,Tp=[],ma=null,ga=null,va=null,Ad=new Map,Cd=new Map,ca=[],yk="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function qb(i,e){switch(i){case"focusin":case"focusout":ma=null;break;case"dragenter":case"dragleave":ga=null;break;case"mouseover":case"mouseout":va=null;break;case"pointerover":case"pointerout":Ad.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Cd.delete(e.pointerId)}}function Lh(i,e,t,n,r,s){return i===null||i.nativeEvent!==s?(i={blockedOn:e,domEventName:t,eventSystemFlags:n,nativeEvent:s,targetContainers:[r]},e!==null&&(e=lf(e),e!==null&&p_(e)),i):(i.eventSystemFlags|=n,e=i.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),i)}function xk(i,e,t,n,r){switch(e){case"focusin":return ma=Lh(ma,i,e,t,n,r),!0;case"dragenter":return ga=Lh(ga,i,e,t,n,r),!0;case"mouseover":return va=Lh(va,i,e,t,n,r),!0;case"pointerover":var s=r.pointerId;return Ad.set(s,Lh(Ad.get(s)||null,i,e,t,n,r)),!0;case"gotpointercapture":return s=r.pointerId,Cd.set(s,Lh(Cd.get(s)||null,i,e,t,n,r)),!0}return!1}function KA(i){var e=vl(i.target);if(e!==null){var t=Yl(e);if(t!==null){if(e=t.tag,e===13){if(e=UA(t),e!==null){i.blockedOn=e,ZA(i.priority,function(){$A(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){i.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Om(i){if(i.blockedOn!==null)return!1;for(var e=i.targetContainers;0<e.length;){var t=Ex(i.domEventName,i.eventSystemFlags,e[0],i.nativeEvent);if(t===null){t=i.nativeEvent;var n=new t.constructor(t.type,t);xx=n,t.target.dispatchEvent(n),xx=null}else return e=lf(t),e!==null&&p_(e),i.blockedOn=t,!1;e.shift()}return!0}function Yb(i,e,t){Om(i)&&t.delete(e)}function wk(){Mx=!1,ma!==null&&Om(ma)&&(ma=null),ga!==null&&Om(ga)&&(ga=null),va!==null&&Om(va)&&(va=null),Ad.forEach(Yb),Cd.forEach(Yb)}function kh(i,e){i.blockedOn===e&&(i.blockedOn=null,Mx||(Mx=!0,Dr.unstable_scheduleCallback(Dr.unstable_NormalPriority,wk)))}function Pd(i){function e(r){return kh(r,i)}if(0<Tp.length){kh(Tp[0],i);for(var t=1;t<Tp.length;t++){var n=Tp[t];n.blockedOn===i&&(n.blockedOn=null)}}for(ma!==null&&kh(ma,i),ga!==null&&kh(ga,i),va!==null&&kh(va,i),Ad.forEach(e),Cd.forEach(e),t=0;t<ca.length;t++)n=ca[t],n.blockedOn===i&&(n.blockedOn=null);for(;0<ca.length&&(t=ca[0],t.blockedOn===null);)KA(t),t.blockedOn===null&&ca.shift()}var au=Fo.ReactCurrentBatchConfig,ug=!0;function _k(i,e,t,n){var r=un,s=au.transition;au.transition=null;try{un=1,m_(i,e,t,n)}finally{un=r,au.transition=s}}function Sk(i,e,t,n){var r=un,s=au.transition;au.transition=null;try{un=4,m_(i,e,t,n)}finally{un=r,au.transition=s}}function m_(i,e,t,n){if(ug){var r=Ex(i,e,t,n);if(r===null)Z0(i,e,n,hg,t),qb(i,n);else if(xk(r,i,e,t,n))n.stopPropagation();else if(qb(i,n),e&4&&-1<yk.indexOf(i)){for(;r!==null;){var s=lf(r);if(s!==null&&YA(s),s=Ex(i,e,t,n),s===null&&Z0(i,e,n,hg,t),s===r)break;r=s}r!==null&&n.stopPropagation()}else Z0(i,e,n,null,t)}}var hg=null;function Ex(i,e,t,n){if(hg=null,i=h_(n),i=vl(i),i!==null)if(e=Yl(i),e===null)i=null;else if(t=e.tag,t===13){if(i=UA(e),i!==null)return i;i=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;i=null}else e!==i&&(i=null);return hg=i,null}function JA(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ck()){case d_:return 1;case WA:return 4;case lg:case uk:return 16;case jA:return 536870912;default:return 16}default:return 16}}var ha=null,g_=null,Nm=null;function e2(){if(Nm)return Nm;var i,e=g_,t=e.length,n,r="value"in ha?ha.value:ha.textContent,s=r.length;for(i=0;i<t&&e[i]===r[i];i++);var o=t-i;for(n=1;n<=o&&e[t-n]===r[s-n];n++);return Nm=r.slice(i,1<n?1-n:void 0)}function Um(i){var e=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&e===13&&(i=13)):i=e,i===10&&(i=13),32<=i||i===13?i:0}function Ap(){return!0}function $b(){return!1}function zr(i){function e(t,n,r,s,o){this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in i)i.hasOwnProperty(a)&&(t=i[a],this[a]=t?t(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Ap:$b,this.isPropagationStopped=$b,this}return Nn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Ap)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Ap)},persist:function(){},isPersistent:Ap}),e}var Vu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},v_=zr(Vu),af=Nn({},Vu,{view:0,detail:0}),bk=zr(af),V0,G0,Ih,Xg=Nn({},af,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:y_,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Ih&&(Ih&&i.type==="mousemove"?(V0=i.screenX-Ih.screenX,G0=i.screenY-Ih.screenY):G0=V0=0,Ih=i),V0)},movementY:function(i){return"movementY"in i?i.movementY:G0}}),Qb=zr(Xg),Mk=Nn({},Xg,{dataTransfer:0}),Ek=zr(Mk),Tk=Nn({},af,{relatedTarget:0}),W0=zr(Tk),Ak=Nn({},Vu,{animationName:0,elapsedTime:0,pseudoElement:0}),Ck=zr(Ak),Pk=Nn({},Vu,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),Rk=zr(Pk),Lk=Nn({},Vu,{data:0}),Zb=zr(Lk),kk={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ik={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Fk={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Dk(i){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(i):(i=Fk[i])?!!e[i]:!1}function y_(){return Dk}var Bk=Nn({},af,{key:function(i){if(i.key){var e=kk[i.key]||i.key;if(e!=="Unidentified")return e}return i.type==="keypress"?(i=Um(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?Ik[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:y_,charCode:function(i){return i.type==="keypress"?Um(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Um(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),zk=zr(Bk),Ok=Nn({},Xg,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Kb=zr(Ok),Nk=Nn({},af,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:y_}),Uk=zr(Nk),Hk=Nn({},Vu,{propertyName:0,elapsedTime:0,pseudoElement:0}),Vk=zr(Hk),Gk=Nn({},Xg,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Wk=zr(Gk),jk=[9,13,27,32],x_=Eo&&"CompositionEvent"in window,ld=null;Eo&&"documentMode"in document&&(ld=document.documentMode);var Xk=Eo&&"TextEvent"in window&&!ld,t2=Eo&&(!x_||ld&&8<ld&&11>=ld),Jb=String.fromCharCode(32),eM=!1;function n2(i,e){switch(i){case"keyup":return jk.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function i2(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Gc=!1;function qk(i,e){switch(i){case"compositionend":return i2(e);case"keypress":return e.which!==32?null:(eM=!0,Jb);case"textInput":return i=e.data,i===Jb&&eM?null:i;default:return null}}function Yk(i,e){if(Gc)return i==="compositionend"||!x_&&n2(i,e)?(i=e2(),Nm=g_=ha=null,Gc=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return t2&&e.locale!=="ko"?null:e.data;default:return null}}var $k={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function tM(i){var e=i&&i.nodeName&&i.nodeName.toLowerCase();return e==="input"?!!$k[i.type]:e==="textarea"}function r2(i,e,t,n){DA(n),e=dg(e,"onChange"),0<e.length&&(t=new v_("onChange","change",null,t,n),i.push({event:t,listeners:e}))}var cd=null,Rd=null;function Qk(i){m2(i,0)}function qg(i){var e=Xc(i);if(CA(e))return i}function Zk(i,e){if(i==="change")return e}var s2=!1;if(Eo){var j0;if(Eo){var X0="oninput"in document;if(!X0){var nM=document.createElement("div");nM.setAttribute("oninput","return;"),X0=typeof nM.oninput=="function"}j0=X0}else j0=!1;s2=j0&&(!document.documentMode||9<document.documentMode)}function iM(){cd&&(cd.detachEvent("onpropertychange",o2),Rd=cd=null)}function o2(i){if(i.propertyName==="value"&&qg(Rd)){var e=[];r2(e,Rd,i,h_(i)),NA(Qk,e)}}function Kk(i,e,t){i==="focusin"?(iM(),cd=e,Rd=t,cd.attachEvent("onpropertychange",o2)):i==="focusout"&&iM()}function Jk(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return qg(Rd)}function eI(i,e){if(i==="click")return qg(e)}function tI(i,e){if(i==="input"||i==="change")return qg(e)}function nI(i,e){return i===e&&(i!==0||1/i===1/e)||i!==i&&e!==e}var Ms=typeof Object.is=="function"?Object.is:nI;function Ld(i,e){if(Ms(i,e))return!0;if(typeof i!="object"||i===null||typeof e!="object"||e===null)return!1;var t=Object.keys(i),n=Object.keys(e);if(t.length!==n.length)return!1;for(n=0;n<t.length;n++){var r=t[n];if(!ax.call(e,r)||!Ms(i[r],e[r]))return!1}return!0}function rM(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function sM(i,e){var t=rM(i);i=0;for(var n;t;){if(t.nodeType===3){if(n=i+t.textContent.length,i<=e&&n>=e)return{node:t,offset:e-i};i=n}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=rM(t)}}function a2(i,e){return i&&e?i===e?!0:i&&i.nodeType===3?!1:e&&e.nodeType===3?a2(i,e.parentNode):"contains"in i?i.contains(e):i.compareDocumentPosition?!!(i.compareDocumentPosition(e)&16):!1:!1}function l2(){for(var i=window,e=sg();e instanceof i.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)i=e.contentWindow;else break;e=sg(i.document)}return e}function w_(i){var e=i&&i.nodeName&&i.nodeName.toLowerCase();return e&&(e==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||e==="textarea"||i.contentEditable==="true")}function iI(i){var e=l2(),t=i.focusedElem,n=i.selectionRange;if(e!==t&&t&&t.ownerDocument&&a2(t.ownerDocument.documentElement,t)){if(n!==null&&w_(t)){if(e=n.start,i=n.end,i===void 0&&(i=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(i,t.value.length);else if(i=(e=t.ownerDocument||document)&&e.defaultView||window,i.getSelection){i=i.getSelection();var r=t.textContent.length,s=Math.min(n.start,r);n=n.end===void 0?s:Math.min(n.end,r),!i.extend&&s>n&&(r=n,n=s,s=r),r=sM(t,s);var o=sM(t,n);r&&o&&(i.rangeCount!==1||i.anchorNode!==r.node||i.anchorOffset!==r.offset||i.focusNode!==o.node||i.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),i.removeAllRanges(),s>n?(i.addRange(e),i.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),i.addRange(e)))}}for(e=[],i=t;i=i.parentNode;)i.nodeType===1&&e.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)i=e[t],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var rI=Eo&&"documentMode"in document&&11>=document.documentMode,Wc=null,Tx=null,ud=null,Ax=!1;function oM(i,e,t){var n=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;Ax||Wc==null||Wc!==sg(n)||(n=Wc,"selectionStart"in n&&w_(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),ud&&Ld(ud,n)||(ud=n,n=dg(Tx,"onSelect"),0<n.length&&(e=new v_("onSelect","select",null,e,t),i.push({event:e,listeners:n}),e.target=Wc)))}function Cp(i,e){var t={};return t[i.toLowerCase()]=e.toLowerCase(),t["Webkit"+i]="webkit"+e,t["Moz"+i]="moz"+e,t}var jc={animationend:Cp("Animation","AnimationEnd"),animationiteration:Cp("Animation","AnimationIteration"),animationstart:Cp("Animation","AnimationStart"),transitionend:Cp("Transition","TransitionEnd")},q0={},c2={};Eo&&(c2=document.createElement("div").style,"AnimationEvent"in window||(delete jc.animationend.animation,delete jc.animationiteration.animation,delete jc.animationstart.animation),"TransitionEvent"in window||delete jc.transitionend.transition);function Yg(i){if(q0[i])return q0[i];if(!jc[i])return i;var e=jc[i],t;for(t in e)if(e.hasOwnProperty(t)&&t in c2)return q0[i]=e[t];return i}var u2=Yg("animationend"),h2=Yg("animationiteration"),d2=Yg("animationstart"),f2=Yg("transitionend"),p2=new Map,aM="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ba(i,e){p2.set(i,e),ql(e,[i])}for(var Y0=0;Y0<aM.length;Y0++){var $0=aM[Y0],sI=$0.toLowerCase(),oI=$0[0].toUpperCase()+$0.slice(1);Ba(sI,"on"+oI)}Ba(u2,"onAnimationEnd");Ba(h2,"onAnimationIteration");Ba(d2,"onAnimationStart");Ba("dblclick","onDoubleClick");Ba("focusin","onFocus");Ba("focusout","onBlur");Ba(f2,"onTransitionEnd");du("onMouseEnter",["mouseout","mouseover"]);du("onMouseLeave",["mouseout","mouseover"]);du("onPointerEnter",["pointerout","pointerover"]);du("onPointerLeave",["pointerout","pointerover"]);ql("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ql("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ql("onBeforeInput",["compositionend","keypress","textInput","paste"]);ql("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ql("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ql("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var td="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),aI=new Set("cancel close invalid load scroll toggle".split(" ").concat(td));function lM(i,e,t){var n=i.type||"unknown-event";i.currentTarget=t,sk(n,e,void 0,i),i.currentTarget=null}function m2(i,e){e=(e&4)!==0;for(var t=0;t<i.length;t++){var n=i[t],r=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var o=n.length-1;0<=o;o--){var a=n[o],c=a.instance,h=a.currentTarget;if(a=a.listener,c!==s&&r.isPropagationStopped())break e;lM(r,a,h),s=c}else for(o=0;o<n.length;o++){if(a=n[o],c=a.instance,h=a.currentTarget,a=a.listener,c!==s&&r.isPropagationStopped())break e;lM(r,a,h),s=c}}}if(ag)throw i=Sx,ag=!1,Sx=null,i}function Sn(i,e){var t=e[kx];t===void 0&&(t=e[kx]=new Set);var n=i+"__bubble";t.has(n)||(g2(e,i,2,!1),t.add(n))}function Q0(i,e,t){var n=0;e&&(n|=4),g2(t,i,n,e)}var Pp="_reactListening"+Math.random().toString(36).slice(2);function kd(i){if(!i[Pp]){i[Pp]=!0,bA.forEach(function(t){t!=="selectionchange"&&(aI.has(t)||Q0(t,!1,i),Q0(t,!0,i))});var e=i.nodeType===9?i:i.ownerDocument;e===null||e[Pp]||(e[Pp]=!0,Q0("selectionchange",!1,e))}}function g2(i,e,t,n){switch(JA(e)){case 1:var r=_k;break;case 4:r=Sk;break;default:r=m_}t=r.bind(null,e,t,i),r=void 0,!_x||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),n?r!==void 0?i.addEventListener(e,t,{capture:!0,passive:r}):i.addEventListener(e,t,!0):r!==void 0?i.addEventListener(e,t,{passive:r}):i.addEventListener(e,t,!1)}function Z0(i,e,t,n,r){var s=n;if((e&1)===0&&(e&2)===0&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var a=n.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===r||c.nodeType===8&&c.parentNode===r))return;o=o.return}for(;a!==null;){if(o=vl(a),o===null)return;if(c=o.tag,c===5||c===6){n=s=o;continue e}a=a.parentNode}}n=n.return}NA(function(){var h=s,d=h_(t),l=[];e:{var u=p2.get(i);if(u!==void 0){var p=v_,g=i;switch(i){case"keypress":if(Um(t)===0)break e;case"keydown":case"keyup":p=zk;break;case"focusin":g="focus",p=W0;break;case"focusout":g="blur",p=W0;break;case"beforeblur":case"afterblur":p=W0;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=Qb;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=Ek;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=Uk;break;case u2:case h2:case d2:p=Ck;break;case f2:p=Vk;break;case"scroll":p=bk;break;case"wheel":p=Wk;break;case"copy":case"cut":case"paste":p=Rk;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Kb}var y=(e&4)!==0,x=!y&&i==="scroll",v=y?u!==null?u+"Capture":null:u;y=[];for(var w=h,S;w!==null;){S=w;var b=S.stateNode;if(S.tag===5&&b!==null&&(S=b,v!==null&&(b=Td(w,v),b!=null&&y.push(Id(w,b,S)))),x)break;w=w.return}0<y.length&&(u=new p(u,g,null,t,d),l.push({event:u,listeners:y}))}}if((e&7)===0){e:{if(u=i==="mouseover"||i==="pointerover",p=i==="mouseout"||i==="pointerout",u&&t!==xx&&(g=t.relatedTarget||t.fromElement)&&(vl(g)||g[To]))break e;if((p||u)&&(u=d.window===d?d:(u=d.ownerDocument)?u.defaultView||u.parentWindow:window,p?(g=t.relatedTarget||t.toElement,p=h,g=g?vl(g):null,g!==null&&(x=Yl(g),g!==x||g.tag!==5&&g.tag!==6)&&(g=null)):(p=null,g=h),p!==g)){if(y=Qb,b="onMouseLeave",v="onMouseEnter",w="mouse",(i==="pointerout"||i==="pointerover")&&(y=Kb,b="onPointerLeave",v="onPointerEnter",w="pointer"),x=p==null?u:Xc(p),S=g==null?u:Xc(g),u=new y(b,w+"leave",p,t,d),u.target=x,u.relatedTarget=S,b=null,vl(d)===h&&(y=new y(v,w+"enter",g,t,d),y.target=S,y.relatedTarget=x,b=y),x=b,p&&g)t:{for(y=p,v=g,w=0,S=y;S;S=pc(S))w++;for(S=0,b=v;b;b=pc(b))S++;for(;0<w-S;)y=pc(y),w--;for(;0<S-w;)v=pc(v),S--;for(;w--;){if(y===v||v!==null&&y===v.alternate)break t;y=pc(y),v=pc(v)}y=null}else y=null;p!==null&&cM(l,u,p,y,!1),g!==null&&x!==null&&cM(l,x,g,y,!0)}}e:{if(u=h?Xc(h):window,p=u.nodeName&&u.nodeName.toLowerCase(),p==="select"||p==="input"&&u.type==="file")var E=Zk;else if(tM(u))if(s2)E=tI;else{E=Jk;var R=Kk}else(p=u.nodeName)&&p.toLowerCase()==="input"&&(u.type==="checkbox"||u.type==="radio")&&(E=eI);if(E&&(E=E(i,h))){r2(l,E,t,d);break e}R&&R(i,u,h),i==="focusout"&&(R=u._wrapperState)&&R.controlled&&u.type==="number"&&px(u,"number",u.value)}switch(R=h?Xc(h):window,i){case"focusin":(tM(R)||R.contentEditable==="true")&&(Wc=R,Tx=h,ud=null);break;case"focusout":ud=Tx=Wc=null;break;case"mousedown":Ax=!0;break;case"contextmenu":case"mouseup":case"dragend":Ax=!1,oM(l,t,d);break;case"selectionchange":if(rI)break;case"keydown":case"keyup":oM(l,t,d)}var z;if(x_)e:{switch(i){case"compositionstart":var I="onCompositionStart";break e;case"compositionend":I="onCompositionEnd";break e;case"compositionupdate":I="onCompositionUpdate";break e}I=void 0}else Gc?n2(i,t)&&(I="onCompositionEnd"):i==="keydown"&&t.keyCode===229&&(I="onCompositionStart");I&&(t2&&t.locale!=="ko"&&(Gc||I!=="onCompositionStart"?I==="onCompositionEnd"&&Gc&&(z=e2()):(ha=d,g_="value"in ha?ha.value:ha.textContent,Gc=!0)),R=dg(h,I),0<R.length&&(I=new Zb(I,i,null,t,d),l.push({event:I,listeners:R}),z?I.data=z:(z=i2(t),z!==null&&(I.data=z)))),(z=Xk?qk(i,t):Yk(i,t))&&(h=dg(h,"onBeforeInput"),0<h.length&&(d=new Zb("onBeforeInput","beforeinput",null,t,d),l.push({event:d,listeners:h}),d.data=z))}m2(l,e)})}function Id(i,e,t){return{instance:i,listener:e,currentTarget:t}}function dg(i,e){for(var t=e+"Capture",n=[];i!==null;){var r=i,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=Td(i,t),s!=null&&n.unshift(Id(i,s,r)),s=Td(i,e),s!=null&&n.push(Id(i,s,r))),i=i.return}return n}function pc(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function cM(i,e,t,n,r){for(var s=e._reactName,o=[];t!==null&&t!==n;){var a=t,c=a.alternate,h=a.stateNode;if(c!==null&&c===n)break;a.tag===5&&h!==null&&(a=h,r?(c=Td(t,s),c!=null&&o.unshift(Id(t,c,a))):r||(c=Td(t,s),c!=null&&o.push(Id(t,c,a)))),t=t.return}o.length!==0&&i.push({event:e,listeners:o})}var lI=/\r\n?/g,cI=/\u0000|\uFFFD/g;function uM(i){return(typeof i=="string"?i:""+i).replace(lI,`
`).replace(cI,"")}function Rp(i,e,t){if(e=uM(e),uM(i)!==e&&t)throw Error(tt(425))}function fg(){}var Cx=null,Px=null;function Rx(i,e){return i==="textarea"||i==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Lx=typeof setTimeout=="function"?setTimeout:void 0,uI=typeof clearTimeout=="function"?clearTimeout:void 0,hM=typeof Promise=="function"?Promise:void 0,hI=typeof queueMicrotask=="function"?queueMicrotask:typeof hM!="undefined"?function(i){return hM.resolve(null).then(i).catch(dI)}:Lx;function dI(i){setTimeout(function(){throw i})}function K0(i,e){var t=e,n=0;do{var r=t.nextSibling;if(i.removeChild(t),r&&r.nodeType===8)if(t=r.data,t==="/$"){if(n===0){i.removeChild(r),Pd(e);return}n--}else t!=="$"&&t!=="$?"&&t!=="$!"||n++;t=r}while(t);Pd(e)}function ya(i){for(;i!=null;i=i.nextSibling){var e=i.nodeType;if(e===1||e===3)break;if(e===8){if(e=i.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return i}function dM(i){i=i.previousSibling;for(var e=0;i;){if(i.nodeType===8){var t=i.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return i;e--}else t==="/$"&&e++}i=i.previousSibling}return null}var Gu=Math.random().toString(36).slice(2),Xs="__reactFiber$"+Gu,Fd="__reactProps$"+Gu,To="__reactContainer$"+Gu,kx="__reactEvents$"+Gu,fI="__reactListeners$"+Gu,pI="__reactHandles$"+Gu;function vl(i){var e=i[Xs];if(e)return e;for(var t=i.parentNode;t;){if(e=t[To]||t[Xs]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(i=dM(i);i!==null;){if(t=i[Xs])return t;i=dM(i)}return e}i=t,t=i.parentNode}return null}function lf(i){return i=i[Xs]||i[To],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function Xc(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(tt(33))}function $g(i){return i[Fd]||null}var Ix=[],qc=-1;function za(i){return{current:i}}function Tn(i){0>qc||(i.current=Ix[qc],Ix[qc]=null,qc--)}function vn(i,e){qc++,Ix[qc]=i.current,i.current=e}var Ca={},Wi=za(Ca),hr=za(!1),Ll=Ca;function fu(i,e){var t=i.type.contextTypes;if(!t)return Ca;var n=i.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in t)r[s]=e[s];return n&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=e,i.__reactInternalMemoizedMaskedChildContext=r),r}function dr(i){return i=i.childContextTypes,i!=null}function pg(){Tn(hr),Tn(Wi)}function fM(i,e,t){if(Wi.current!==Ca)throw Error(tt(168));vn(Wi,e),vn(hr,t)}function v2(i,e,t){var n=i.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return t;n=n.getChildContext();for(var r in n)if(!(r in e))throw Error(tt(108,KL(i)||"Unknown",r));return Nn({},t,n)}function mg(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||Ca,Ll=Wi.current,vn(Wi,i),vn(hr,hr.current),!0}function pM(i,e,t){var n=i.stateNode;if(!n)throw Error(tt(169));t?(i=v2(i,e,Ll),n.__reactInternalMemoizedMergedChildContext=i,Tn(hr),Tn(Wi),vn(Wi,i)):Tn(hr),vn(hr,t)}var yo=null,Qg=!1,J0=!1;function y2(i){yo===null?yo=[i]:yo.push(i)}function mI(i){Qg=!0,y2(i)}function Oa(){if(!J0&&yo!==null){J0=!0;var i=0,e=un;try{var t=yo;for(un=1;i<t.length;i++){var n=t[i];do n=n(!0);while(n!==null)}yo=null,Qg=!1}catch(r){throw yo!==null&&(yo=yo.slice(i+1)),GA(d_,Oa),r}finally{un=e,J0=!1}}return null}var Yc=[],$c=0,gg=null,vg=0,Qr=[],Zr=0,kl=null,xo=1,wo="";function ul(i,e){Yc[$c++]=vg,Yc[$c++]=gg,gg=i,vg=e}function x2(i,e,t){Qr[Zr++]=xo,Qr[Zr++]=wo,Qr[Zr++]=kl,kl=i;var n=xo;i=wo;var r=32-_s(n)-1;n&=~(1<<r),t+=1;var s=32-_s(e)+r;if(30<s){var o=r-r%5;s=(n&(1<<o)-1).toString(32),n>>=o,r-=o,xo=1<<32-_s(e)+r|t<<r|n,wo=s+i}else xo=1<<s|t<<r|n,wo=i}function __(i){i.return!==null&&(ul(i,1),x2(i,1,0))}function S_(i){for(;i===gg;)gg=Yc[--$c],Yc[$c]=null,vg=Yc[--$c],Yc[$c]=null;for(;i===kl;)kl=Qr[--Zr],Qr[Zr]=null,wo=Qr[--Zr],Qr[Zr]=null,xo=Qr[--Zr],Qr[Zr]=null}var Lr=null,Rr=null,In=!1,gs=null;function w2(i,e){var t=Kr(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=i,e=i.deletions,e===null?(i.deletions=[t],i.flags|=16):e.push(t)}function mM(i,e){switch(i.tag){case 5:var t=i.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(i.stateNode=e,Lr=i,Rr=ya(e.firstChild),!0):!1;case 6:return e=i.pendingProps===""||e.nodeType!==3?null:e,e!==null?(i.stateNode=e,Lr=i,Rr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=kl!==null?{id:xo,overflow:wo}:null,i.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=Kr(18,null,null,0),t.stateNode=e,t.return=i,i.child=t,Lr=i,Rr=null,!0):!1;default:return!1}}function Fx(i){return(i.mode&1)!==0&&(i.flags&128)===0}function Dx(i){if(In){var e=Rr;if(e){var t=e;if(!mM(i,e)){if(Fx(i))throw Error(tt(418));e=ya(t.nextSibling);var n=Lr;e&&mM(i,e)?w2(n,t):(i.flags=i.flags&-4097|2,In=!1,Lr=i)}}else{if(Fx(i))throw Error(tt(418));i.flags=i.flags&-4097|2,In=!1,Lr=i}}}function gM(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;Lr=i}function Lp(i){if(i!==Lr)return!1;if(!In)return gM(i),In=!0,!1;var e;if((e=i.tag!==3)&&!(e=i.tag!==5)&&(e=i.type,e=e!=="head"&&e!=="body"&&!Rx(i.type,i.memoizedProps)),e&&(e=Rr)){if(Fx(i))throw _2(),Error(tt(418));for(;e;)w2(i,e),e=ya(e.nextSibling)}if(gM(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(tt(317));e:{for(i=i.nextSibling,e=0;i;){if(i.nodeType===8){var t=i.data;if(t==="/$"){if(e===0){Rr=ya(i.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}i=i.nextSibling}Rr=null}}else Rr=Lr?ya(i.stateNode.nextSibling):null;return!0}function _2(){for(var i=Rr;i;)i=ya(i.nextSibling)}function pu(){Rr=Lr=null,In=!1}function b_(i){gs===null?gs=[i]:gs.push(i)}var gI=Fo.ReactCurrentBatchConfig;function ps(i,e){if(i&&i.defaultProps){e=Nn({},e),i=i.defaultProps;for(var t in i)e[t]===void 0&&(e[t]=i[t]);return e}return e}var yg=za(null),xg=null,Qc=null,M_=null;function E_(){M_=Qc=xg=null}function T_(i){var e=yg.current;Tn(yg),i._currentValue=e}function Bx(i,e,t){for(;i!==null;){var n=i.alternate;if((i.childLanes&e)!==e?(i.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),i===t)break;i=i.return}}function lu(i,e){xg=i,M_=Qc=null,i=i.dependencies,i!==null&&i.firstContext!==null&&((i.lanes&e)!==0&&(cr=!0),i.firstContext=null)}function is(i){var e=i._currentValue;if(M_!==i)if(i={context:i,memoizedValue:e,next:null},Qc===null){if(xg===null)throw Error(tt(308));Qc=i,xg.dependencies={lanes:0,firstContext:i}}else Qc=Qc.next=i;return e}var yl=null;function A_(i){yl===null?yl=[i]:yl.push(i)}function S2(i,e,t,n){var r=e.interleaved;return r===null?(t.next=t,A_(e)):(t.next=r.next,r.next=t),e.interleaved=t,Ao(i,n)}function Ao(i,e){i.lanes|=e;var t=i.alternate;for(t!==null&&(t.lanes|=e),t=i,i=i.return;i!==null;)i.childLanes|=e,t=i.alternate,t!==null&&(t.childLanes|=e),t=i,i=i.return;return t.tag===3?t.stateNode:null}var la=!1;function C_(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function b2(i,e){i=i.updateQueue,e.updateQueue===i&&(e.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function bo(i,e){return{eventTime:i,lane:e,tag:0,payload:null,callback:null,next:null}}function xa(i,e,t){var n=i.updateQueue;if(n===null)return null;if(n=n.shared,(en&2)!==0){var r=n.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),n.pending=e,Ao(i,t)}return r=n.interleaved,r===null?(e.next=e,A_(n)):(e.next=r.next,r.next=e),n.interleaved=e,Ao(i,t)}function Hm(i,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var n=e.lanes;n&=i.pendingLanes,t|=n,e.lanes=t,f_(i,t)}}function vM(i,e){var t=i.updateQueue,n=i.alternate;if(n!==null&&(n=n.updateQueue,t===n)){var r=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?r=s=o:s=s.next=o,t=t.next}while(t!==null);s===null?r=s=e:s=s.next=e}else r=s=e;t={baseState:n.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:n.shared,effects:n.effects},i.updateQueue=t;return}i=t.lastBaseUpdate,i===null?t.firstBaseUpdate=e:i.next=e,t.lastBaseUpdate=e}function wg(i,e,t,n){var r=i.updateQueue;la=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var c=a,h=c.next;c.next=null,o===null?s=h:o.next=h,o=c;var d=i.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=h:a.next=h,d.lastBaseUpdate=c))}if(s!==null){var l=r.baseState;o=0,d=h=c=null,a=s;do{var u=a.lane,p=a.eventTime;if((n&u)===u){d!==null&&(d=d.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var g=i,y=a;switch(u=e,p=t,y.tag){case 1:if(g=y.payload,typeof g=="function"){l=g.call(p,l,u);break e}l=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=y.payload,u=typeof g=="function"?g.call(p,l,u):g,u==null)break e;l=Nn({},l,u);break e;case 2:la=!0}}a.callback!==null&&a.lane!==0&&(i.flags|=64,u=r.effects,u===null?r.effects=[a]:u.push(a))}else p={eventTime:p,lane:u,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(h=d=p,c=l):d=d.next=p,o|=u;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;u=a,a=u.next,u.next=null,r.lastBaseUpdate=u,r.shared.pending=null}}while(1);if(d===null&&(c=l),r.baseState=c,r.firstBaseUpdate=h,r.lastBaseUpdate=d,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else s===null&&(r.shared.lanes=0);Fl|=o,i.lanes=o,i.memoizedState=l}}function yM(i,e,t){if(i=e.effects,e.effects=null,i!==null)for(e=0;e<i.length;e++){var n=i[e],r=n.callback;if(r!==null){if(n.callback=null,n=t,typeof r!="function")throw Error(tt(191,r));r.call(n)}}}var M2=new SA.Component().refs;function zx(i,e,t,n){e=i.memoizedState,t=t(n,e),t=t==null?e:Nn({},e,t),i.memoizedState=t,i.lanes===0&&(i.updateQueue.baseState=t)}var Zg={isMounted:function(i){return(i=i._reactInternals)?Yl(i)===i:!1},enqueueSetState:function(i,e,t){i=i._reactInternals;var n=Zi(),r=_a(i),s=bo(n,r);s.payload=e,t!=null&&(s.callback=t),e=xa(i,s,r),e!==null&&(Ss(e,i,r,n),Hm(e,i,r))},enqueueReplaceState:function(i,e,t){i=i._reactInternals;var n=Zi(),r=_a(i),s=bo(n,r);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=xa(i,s,r),e!==null&&(Ss(e,i,r,n),Hm(e,i,r))},enqueueForceUpdate:function(i,e){i=i._reactInternals;var t=Zi(),n=_a(i),r=bo(t,n);r.tag=2,e!=null&&(r.callback=e),e=xa(i,r,n),e!==null&&(Ss(e,i,n,t),Hm(e,i,n))}};function xM(i,e,t,n,r,s,o){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(n,s,o):e.prototype&&e.prototype.isPureReactComponent?!Ld(t,n)||!Ld(r,s):!0}function E2(i,e,t){var n=!1,r=Ca,s=e.contextType;return typeof s=="object"&&s!==null?s=is(s):(r=dr(e)?Ll:Wi.current,n=e.contextTypes,s=(n=n!=null)?fu(i,r):Ca),e=new e(t,s),i.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Zg,i.stateNode=e,e._reactInternals=i,n&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=r,i.__reactInternalMemoizedMaskedChildContext=s),e}function wM(i,e,t,n){i=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,n),e.state!==i&&Zg.enqueueReplaceState(e,e.state,null)}function Ox(i,e,t,n){var r=i.stateNode;r.props=t,r.state=i.memoizedState,r.refs=M2,C_(i);var s=e.contextType;typeof s=="object"&&s!==null?r.context=is(s):(s=dr(e)?Ll:Wi.current,r.context=fu(i,s)),r.state=i.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(zx(i,e,s,t),r.state=i.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&Zg.enqueueReplaceState(r,r.state,null),wg(i,t,r,n),r.state=i.memoizedState),typeof r.componentDidMount=="function"&&(i.flags|=4194308)}function Fh(i,e,t){if(i=t.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(tt(309));var n=t.stateNode}if(!n)throw Error(tt(147,i));var r=n,s=""+i;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=r.refs;a===M2&&(a=r.refs={}),o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof i!="string")throw Error(tt(284));if(!t._owner)throw Error(tt(290,i))}return i}function kp(i,e){throw i=Object.prototype.toString.call(e),Error(tt(31,i==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":i))}function _M(i){var e=i._init;return e(i._payload)}function T2(i){function e(v,w){if(i){var S=v.deletions;S===null?(v.deletions=[w],v.flags|=16):S.push(w)}}function t(v,w){if(!i)return null;for(;w!==null;)e(v,w),w=w.sibling;return null}function n(v,w){for(v=new Map;w!==null;)w.key!==null?v.set(w.key,w):v.set(w.index,w),w=w.sibling;return v}function r(v,w){return v=Sa(v,w),v.index=0,v.sibling=null,v}function s(v,w,S){return v.index=S,i?(S=v.alternate,S!==null?(S=S.index,S<w?(v.flags|=2,w):S):(v.flags|=2,w)):(v.flags|=1048576,w)}function o(v){return i&&v.alternate===null&&(v.flags|=2),v}function a(v,w,S,b){return w===null||w.tag!==6?(w=oy(S,v.mode,b),w.return=v,w):(w=r(w,S),w.return=v,w)}function c(v,w,S,b){var E=S.type;return E===Vc?d(v,w,S.props.children,b,S.key):w!==null&&(w.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===aa&&_M(E)===w.type)?(b=r(w,S.props),b.ref=Fh(v,w,S),b.return=v,b):(b=qm(S.type,S.key,S.props,null,v.mode,b),b.ref=Fh(v,w,S),b.return=v,b)}function h(v,w,S,b){return w===null||w.tag!==4||w.stateNode.containerInfo!==S.containerInfo||w.stateNode.implementation!==S.implementation?(w=ay(S,v.mode,b),w.return=v,w):(w=r(w,S.children||[]),w.return=v,w)}function d(v,w,S,b,E){return w===null||w.tag!==7?(w=Ml(S,v.mode,b,E),w.return=v,w):(w=r(w,S),w.return=v,w)}function l(v,w,S){if(typeof w=="string"&&w!==""||typeof w=="number")return w=oy(""+w,v.mode,S),w.return=v,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case _p:return S=qm(w.type,w.key,w.props,null,v.mode,S),S.ref=Fh(v,null,w),S.return=v,S;case Hc:return w=ay(w,v.mode,S),w.return=v,w;case aa:var b=w._init;return l(v,b(w._payload),S)}if(Jh(w)||Ph(w))return w=Ml(w,v.mode,S,null),w.return=v,w;kp(v,w)}return null}function u(v,w,S,b){var E=w!==null?w.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return E!==null?null:a(v,w,""+S,b);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case _p:return S.key===E?c(v,w,S,b):null;case Hc:return S.key===E?h(v,w,S,b):null;case aa:return E=S._init,u(v,w,E(S._payload),b)}if(Jh(S)||Ph(S))return E!==null?null:d(v,w,S,b,null);kp(v,S)}return null}function p(v,w,S,b,E){if(typeof b=="string"&&b!==""||typeof b=="number")return v=v.get(S)||null,a(w,v,""+b,E);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case _p:return v=v.get(b.key===null?S:b.key)||null,c(w,v,b,E);case Hc:return v=v.get(b.key===null?S:b.key)||null,h(w,v,b,E);case aa:var R=b._init;return p(v,w,S,R(b._payload),E)}if(Jh(b)||Ph(b))return v=v.get(S)||null,d(w,v,b,E,null);kp(w,b)}return null}function g(v,w,S,b){for(var E=null,R=null,z=w,I=w=0,N=null;z!==null&&I<S.length;I++){z.index>I?(N=z,z=null):N=z.sibling;var F=u(v,z,S[I],b);if(F===null){z===null&&(z=N);break}i&&z&&F.alternate===null&&e(v,z),w=s(F,w,I),R===null?E=F:R.sibling=F,R=F,z=N}if(I===S.length)return t(v,z),In&&ul(v,I),E;if(z===null){for(;I<S.length;I++)z=l(v,S[I],b),z!==null&&(w=s(z,w,I),R===null?E=z:R.sibling=z,R=z);return In&&ul(v,I),E}for(z=n(v,z);I<S.length;I++)N=p(z,v,I,S[I],b),N!==null&&(i&&N.alternate!==null&&z.delete(N.key===null?I:N.key),w=s(N,w,I),R===null?E=N:R.sibling=N,R=N);return i&&z.forEach(function(C){return e(v,C)}),In&&ul(v,I),E}function y(v,w,S,b){var E=Ph(S);if(typeof E!="function")throw Error(tt(150));if(S=E.call(S),S==null)throw Error(tt(151));for(var R=E=null,z=w,I=w=0,N=null,F=S.next();z!==null&&!F.done;I++,F=S.next()){z.index>I?(N=z,z=null):N=z.sibling;var C=u(v,z,F.value,b);if(C===null){z===null&&(z=N);break}i&&z&&C.alternate===null&&e(v,z),w=s(C,w,I),R===null?E=C:R.sibling=C,R=C,z=N}if(F.done)return t(v,z),In&&ul(v,I),E;if(z===null){for(;!F.done;I++,F=S.next())F=l(v,F.value,b),F!==null&&(w=s(F,w,I),R===null?E=F:R.sibling=F,R=F);return In&&ul(v,I),E}for(z=n(v,z);!F.done;I++,F=S.next())F=p(z,v,I,F.value,b),F!==null&&(i&&F.alternate!==null&&z.delete(F.key===null?I:F.key),w=s(F,w,I),R===null?E=F:R.sibling=F,R=F);return i&&z.forEach(function(O){return e(v,O)}),In&&ul(v,I),E}function x(v,w,S,b){if(typeof S=="object"&&S!==null&&S.type===Vc&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case _p:e:{for(var E=S.key,R=w;R!==null;){if(R.key===E){if(E=S.type,E===Vc){if(R.tag===7){t(v,R.sibling),w=r(R,S.props.children),w.return=v,v=w;break e}}else if(R.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===aa&&_M(E)===R.type){t(v,R.sibling),w=r(R,S.props),w.ref=Fh(v,R,S),w.return=v,v=w;break e}t(v,R);break}else e(v,R);R=R.sibling}S.type===Vc?(w=Ml(S.props.children,v.mode,b,S.key),w.return=v,v=w):(b=qm(S.type,S.key,S.props,null,v.mode,b),b.ref=Fh(v,w,S),b.return=v,v=b)}return o(v);case Hc:e:{for(R=S.key;w!==null;){if(w.key===R)if(w.tag===4&&w.stateNode.containerInfo===S.containerInfo&&w.stateNode.implementation===S.implementation){t(v,w.sibling),w=r(w,S.children||[]),w.return=v,v=w;break e}else{t(v,w);break}else e(v,w);w=w.sibling}w=ay(S,v.mode,b),w.return=v,v=w}return o(v);case aa:return R=S._init,x(v,w,R(S._payload),b)}if(Jh(S))return g(v,w,S,b);if(Ph(S))return y(v,w,S,b);kp(v,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,w!==null&&w.tag===6?(t(v,w.sibling),w=r(w,S),w.return=v,v=w):(t(v,w),w=oy(S,v.mode,b),w.return=v,v=w),o(v)):t(v,w)}return x}var mu=T2(!0),A2=T2(!1),cf={},Ys=za(cf),Dd=za(cf),Bd=za(cf);function xl(i){if(i===cf)throw Error(tt(174));return i}function P_(i,e){switch(vn(Bd,e),vn(Dd,i),vn(Ys,cf),i=e.nodeType,i){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:gx(null,"");break;default:i=i===8?e.parentNode:e,e=i.namespaceURI||null,i=i.tagName,e=gx(e,i)}Tn(Ys),vn(Ys,e)}function gu(){Tn(Ys),Tn(Dd),Tn(Bd)}function C2(i){xl(Bd.current);var e=xl(Ys.current),t=gx(e,i.type);e!==t&&(vn(Dd,i),vn(Ys,t))}function R_(i){Dd.current===i&&(Tn(Ys),Tn(Dd))}var Bn=za(0);function _g(i){for(var e=i;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if((e.flags&128)!==0)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===i)break;for(;e.sibling===null;){if(e.return===null||e.return===i)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var ey=[];function L_(){for(var i=0;i<ey.length;i++)ey[i]._workInProgressVersionPrimary=null;ey.length=0}var Vm=Fo.ReactCurrentDispatcher,ty=Fo.ReactCurrentBatchConfig,Il=0,On=null,hi=null,wi=null,Sg=!1,hd=!1,zd=0,vI=0;function Ni(){throw Error(tt(321))}function k_(i,e){if(e===null)return!1;for(var t=0;t<e.length&&t<i.length;t++)if(!Ms(i[t],e[t]))return!1;return!0}function I_(i,e,t,n,r,s){if(Il=s,On=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Vm.current=i===null||i.memoizedState===null?_I:SI,i=t(n,r),hd){s=0;do{if(hd=!1,zd=0,25<=s)throw Error(tt(301));s+=1,wi=hi=null,e.updateQueue=null,Vm.current=bI,i=t(n,r)}while(hd)}if(Vm.current=bg,e=hi!==null&&hi.next!==null,Il=0,wi=hi=On=null,Sg=!1,e)throw Error(tt(300));return i}function F_(){var i=zd!==0;return zd=0,i}function Ws(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return wi===null?On.memoizedState=wi=i:wi=wi.next=i,wi}function rs(){if(hi===null){var i=On.alternate;i=i!==null?i.memoizedState:null}else i=hi.next;var e=wi===null?On.memoizedState:wi.next;if(e!==null)wi=e,hi=i;else{if(i===null)throw Error(tt(310));hi=i,i={memoizedState:hi.memoizedState,baseState:hi.baseState,baseQueue:hi.baseQueue,queue:hi.queue,next:null},wi===null?On.memoizedState=wi=i:wi=wi.next=i}return wi}function Od(i,e){return typeof e=="function"?e(i):e}function ny(i){var e=rs(),t=e.queue;if(t===null)throw Error(tt(311));t.lastRenderedReducer=i;var n=hi,r=n.baseQueue,s=t.pending;if(s!==null){if(r!==null){var o=r.next;r.next=s.next,s.next=o}n.baseQueue=r=s,t.pending=null}if(r!==null){s=r.next,n=n.baseState;var a=o=null,c=null,h=s;do{var d=h.lane;if((Il&d)===d)c!==null&&(c=c.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),n=h.hasEagerState?h.eagerState:i(n,h.action);else{var l={lane:d,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};c===null?(a=c=l,o=n):c=c.next=l,On.lanes|=d,Fl|=d}h=h.next}while(h!==null&&h!==s);c===null?o=n:c.next=a,Ms(n,e.memoizedState)||(cr=!0),e.memoizedState=n,e.baseState=o,e.baseQueue=c,t.lastRenderedState=n}if(i=t.interleaved,i!==null){r=i;do s=r.lane,On.lanes|=s,Fl|=s,r=r.next;while(r!==i)}else r===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function iy(i){var e=rs(),t=e.queue;if(t===null)throw Error(tt(311));t.lastRenderedReducer=i;var n=t.dispatch,r=t.pending,s=e.memoizedState;if(r!==null){t.pending=null;var o=r=r.next;do s=i(s,o.action),o=o.next;while(o!==r);Ms(s,e.memoizedState)||(cr=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),t.lastRenderedState=s}return[s,n]}function P2(){}function R2(i,e){var t=On,n=rs(),r=e(),s=!Ms(n.memoizedState,r);if(s&&(n.memoizedState=r,cr=!0),n=n.queue,D_(I2.bind(null,t,n,i),[i]),n.getSnapshot!==e||s||wi!==null&&wi.memoizedState.tag&1){if(t.flags|=2048,Nd(9,k2.bind(null,t,n,r,e),void 0,null),bi===null)throw Error(tt(349));(Il&30)!==0||L2(t,e,r)}return r}function L2(i,e,t){i.flags|=16384,i={getSnapshot:e,value:t},e=On.updateQueue,e===null?(e={lastEffect:null,stores:null},On.updateQueue=e,e.stores=[i]):(t=e.stores,t===null?e.stores=[i]:t.push(i))}function k2(i,e,t,n){e.value=t,e.getSnapshot=n,F2(e)&&D2(i)}function I2(i,e,t){return t(function(){F2(e)&&D2(i)})}function F2(i){var e=i.getSnapshot;i=i.value;try{var t=e();return!Ms(i,t)}catch{return!0}}function D2(i){var e=Ao(i,1);e!==null&&Ss(e,i,1,-1)}function SM(i){var e=Ws();return typeof i=="function"&&(i=i()),e.memoizedState=e.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Od,lastRenderedState:i},e.queue=i,i=i.dispatch=wI.bind(null,On,i),[e.memoizedState,i]}function Nd(i,e,t,n){return i={tag:i,create:e,destroy:t,deps:n,next:null},e=On.updateQueue,e===null?(e={lastEffect:null,stores:null},On.updateQueue=e,e.lastEffect=i.next=i):(t=e.lastEffect,t===null?e.lastEffect=i.next=i:(n=t.next,t.next=i,i.next=n,e.lastEffect=i)),i}function B2(){return rs().memoizedState}function Gm(i,e,t,n){var r=Ws();On.flags|=i,r.memoizedState=Nd(1|e,t,void 0,n===void 0?null:n)}function Kg(i,e,t,n){var r=rs();n=n===void 0?null:n;var s=void 0;if(hi!==null){var o=hi.memoizedState;if(s=o.destroy,n!==null&&k_(n,o.deps)){r.memoizedState=Nd(e,t,s,n);return}}On.flags|=i,r.memoizedState=Nd(1|e,t,s,n)}function bM(i,e){return Gm(8390656,8,i,e)}function D_(i,e){return Kg(2048,8,i,e)}function z2(i,e){return Kg(4,2,i,e)}function O2(i,e){return Kg(4,4,i,e)}function N2(i,e){if(typeof e=="function")return i=i(),e(i),function(){e(null)};if(e!=null)return i=i(),e.current=i,function(){e.current=null}}function U2(i,e,t){return t=t!=null?t.concat([i]):null,Kg(4,4,N2.bind(null,e,i),t)}function B_(){}function H2(i,e){var t=rs();e=e===void 0?null:e;var n=t.memoizedState;return n!==null&&e!==null&&k_(e,n[1])?n[0]:(t.memoizedState=[i,e],i)}function V2(i,e){var t=rs();e=e===void 0?null:e;var n=t.memoizedState;return n!==null&&e!==null&&k_(e,n[1])?n[0]:(i=i(),t.memoizedState=[i,e],i)}function G2(i,e,t){return(Il&21)===0?(i.baseState&&(i.baseState=!1,cr=!0),i.memoizedState=t):(Ms(t,e)||(t=XA(),On.lanes|=t,Fl|=t,i.baseState=!0),e)}function yI(i,e){var t=un;un=t!==0&&4>t?t:4,i(!0);var n=ty.transition;ty.transition={};try{i(!1),e()}finally{un=t,ty.transition=n}}function W2(){return rs().memoizedState}function xI(i,e,t){var n=_a(i);if(t={lane:n,action:t,hasEagerState:!1,eagerState:null,next:null},j2(i))X2(e,t);else if(t=S2(i,e,t,n),t!==null){var r=Zi();Ss(t,i,n,r),q2(t,e,n)}}function wI(i,e,t){var n=_a(i),r={lane:n,action:t,hasEagerState:!1,eagerState:null,next:null};if(j2(i))X2(e,r);else{var s=i.alternate;if(i.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,t);if(r.hasEagerState=!0,r.eagerState=a,Ms(a,o)){var c=e.interleaved;c===null?(r.next=r,A_(e)):(r.next=c.next,c.next=r),e.interleaved=r;return}}catch{}finally{}t=S2(i,e,r,n),t!==null&&(r=Zi(),Ss(t,i,n,r),q2(t,e,n))}}function j2(i){var e=i.alternate;return i===On||e!==null&&e===On}function X2(i,e){hd=Sg=!0;var t=i.pending;t===null?e.next=e:(e.next=t.next,t.next=e),i.pending=e}function q2(i,e,t){if((t&4194240)!==0){var n=e.lanes;n&=i.pendingLanes,t|=n,e.lanes=t,f_(i,t)}}var bg={readContext:is,useCallback:Ni,useContext:Ni,useEffect:Ni,useImperativeHandle:Ni,useInsertionEffect:Ni,useLayoutEffect:Ni,useMemo:Ni,useReducer:Ni,useRef:Ni,useState:Ni,useDebugValue:Ni,useDeferredValue:Ni,useTransition:Ni,useMutableSource:Ni,useSyncExternalStore:Ni,useId:Ni,unstable_isNewReconciler:!1},_I={readContext:is,useCallback:function(i,e){return Ws().memoizedState=[i,e===void 0?null:e],i},useContext:is,useEffect:bM,useImperativeHandle:function(i,e,t){return t=t!=null?t.concat([i]):null,Gm(4194308,4,N2.bind(null,e,i),t)},useLayoutEffect:function(i,e){return Gm(4194308,4,i,e)},useInsertionEffect:function(i,e){return Gm(4,2,i,e)},useMemo:function(i,e){var t=Ws();return e=e===void 0?null:e,i=i(),t.memoizedState=[i,e],i},useReducer:function(i,e,t){var n=Ws();return e=t!==void 0?t(e):e,n.memoizedState=n.baseState=e,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:e},n.queue=i,i=i.dispatch=xI.bind(null,On,i),[n.memoizedState,i]},useRef:function(i){var e=Ws();return i={current:i},e.memoizedState=i},useState:SM,useDebugValue:B_,useDeferredValue:function(i){return Ws().memoizedState=i},useTransition:function(){var i=SM(!1),e=i[0];return i=yI.bind(null,i[1]),Ws().memoizedState=i,[e,i]},useMutableSource:function(){},useSyncExternalStore:function(i,e,t){var n=On,r=Ws();if(In){if(t===void 0)throw Error(tt(407));t=t()}else{if(t=e(),bi===null)throw Error(tt(349));(Il&30)!==0||L2(n,e,t)}r.memoizedState=t;var s={value:t,getSnapshot:e};return r.queue=s,bM(I2.bind(null,n,s,i),[i]),n.flags|=2048,Nd(9,k2.bind(null,n,s,t,e),void 0,null),t},useId:function(){var i=Ws(),e=bi.identifierPrefix;if(In){var t=wo,n=xo;t=(n&~(1<<32-_s(n)-1)).toString(32)+t,e=":"+e+"R"+t,t=zd++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=vI++,e=":"+e+"r"+t.toString(32)+":";return i.memoizedState=e},unstable_isNewReconciler:!1},SI={readContext:is,useCallback:H2,useContext:is,useEffect:D_,useImperativeHandle:U2,useInsertionEffect:z2,useLayoutEffect:O2,useMemo:V2,useReducer:ny,useRef:B2,useState:function(){return ny(Od)},useDebugValue:B_,useDeferredValue:function(i){var e=rs();return G2(e,hi.memoizedState,i)},useTransition:function(){var i=ny(Od)[0],e=rs().memoizedState;return[i,e]},useMutableSource:P2,useSyncExternalStore:R2,useId:W2,unstable_isNewReconciler:!1},bI={readContext:is,useCallback:H2,useContext:is,useEffect:D_,useImperativeHandle:U2,useInsertionEffect:z2,useLayoutEffect:O2,useMemo:V2,useReducer:iy,useRef:B2,useState:function(){return iy(Od)},useDebugValue:B_,useDeferredValue:function(i){var e=rs();return hi===null?e.memoizedState=i:G2(e,hi.memoizedState,i)},useTransition:function(){var i=iy(Od)[0],e=rs().memoizedState;return[i,e]},useMutableSource:P2,useSyncExternalStore:R2,useId:W2,unstable_isNewReconciler:!1};function vu(i,e){try{var t="",n=e;do t+=ZL(n),n=n.return;while(n);var r=t}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:i,source:e,stack:r,digest:null}}function ry(i,e,t){return{value:i,source:null,stack:t!=null?t:null,digest:e!=null?e:null}}function Nx(i,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var MI=typeof WeakMap=="function"?WeakMap:Map;function Y2(i,e,t){t=bo(-1,t),t.tag=3,t.payload={element:null};var n=e.value;return t.callback=function(){Eg||(Eg=!0,$x=n),Nx(i,e)},t}function $2(i,e,t){t=bo(-1,t),t.tag=3;var n=i.type.getDerivedStateFromError;if(typeof n=="function"){var r=e.value;t.payload=function(){return n(r)},t.callback=function(){Nx(i,e)}}var s=i.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){Nx(i,e),typeof n!="function"&&(wa===null?wa=new Set([this]):wa.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function MM(i,e,t){var n=i.pingCache;if(n===null){n=i.pingCache=new MI;var r=new Set;n.set(e,r)}else r=n.get(e),r===void 0&&(r=new Set,n.set(e,r));r.has(t)||(r.add(t),i=OI.bind(null,i,e,t),e.then(i,i))}function EM(i){do{var e;if((e=i.tag===13)&&(e=i.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return i;i=i.return}while(i!==null);return null}function TM(i,e,t,n,r){return(i.mode&1)===0?(i===e?i.flags|=65536:(i.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=bo(-1,1),e.tag=2,xa(t,e,1))),t.lanes|=1),i):(i.flags|=65536,i.lanes=r,i)}var EI=Fo.ReactCurrentOwner,cr=!1;function $i(i,e,t,n){e.child=i===null?A2(e,null,t,n):mu(e,i.child,t,n)}function AM(i,e,t,n,r){t=t.render;var s=e.ref;return lu(e,r),n=I_(i,e,t,n,s,r),t=F_(),i!==null&&!cr?(e.updateQueue=i.updateQueue,e.flags&=-2053,i.lanes&=~r,Co(i,e,r)):(In&&t&&__(e),e.flags|=1,$i(i,e,n,r),e.child)}function CM(i,e,t,n,r){if(i===null){var s=t.type;return typeof s=="function"&&!W_(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=s,Q2(i,e,s,n,r)):(i=qm(t.type,null,n,e,e.mode,r),i.ref=e.ref,i.return=e,e.child=i)}if(s=i.child,(i.lanes&r)===0){var o=s.memoizedProps;if(t=t.compare,t=t!==null?t:Ld,t(o,n)&&i.ref===e.ref)return Co(i,e,r)}return e.flags|=1,i=Sa(s,n),i.ref=e.ref,i.return=e,e.child=i}function Q2(i,e,t,n,r){if(i!==null){var s=i.memoizedProps;if(Ld(s,n)&&i.ref===e.ref)if(cr=!1,e.pendingProps=n=s,(i.lanes&r)!==0)(i.flags&131072)!==0&&(cr=!0);else return e.lanes=i.lanes,Co(i,e,r)}return Ux(i,e,t,n,r)}function Z2(i,e,t){var n=e.pendingProps,r=n.children,s=i!==null?i.memoizedState:null;if(n.mode==="hidden")if((e.mode&1)===0)e.memoizedState={baseLanes:0,cachePool:null,transitions:null},vn(Kc,Tr),Tr|=t;else{if((t&1073741824)===0)return i=s!==null?s.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:i,cachePool:null,transitions:null},e.updateQueue=null,vn(Kc,Tr),Tr|=i,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:t,vn(Kc,Tr),Tr|=n}else s!==null?(n=s.baseLanes|t,e.memoizedState=null):n=t,vn(Kc,Tr),Tr|=n;return $i(i,e,r,t),e.child}function K2(i,e){var t=e.ref;(i===null&&t!==null||i!==null&&i.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function Ux(i,e,t,n,r){var s=dr(t)?Ll:Wi.current;return s=fu(e,s),lu(e,r),t=I_(i,e,t,n,s,r),n=F_(),i!==null&&!cr?(e.updateQueue=i.updateQueue,e.flags&=-2053,i.lanes&=~r,Co(i,e,r)):(In&&n&&__(e),e.flags|=1,$i(i,e,t,r),e.child)}function PM(i,e,t,n,r){if(dr(t)){var s=!0;mg(e)}else s=!1;if(lu(e,r),e.stateNode===null)Wm(i,e),E2(e,t,n),Ox(e,t,n,r),n=!0;else if(i===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var c=o.context,h=t.contextType;typeof h=="object"&&h!==null?h=is(h):(h=dr(t)?Ll:Wi.current,h=fu(e,h));var d=t.getDerivedStateFromProps,l=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";l||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==n||c!==h)&&wM(e,o,n,h),la=!1;var u=e.memoizedState;o.state=u,wg(e,n,o,r),c=e.memoizedState,a!==n||u!==c||hr.current||la?(typeof d=="function"&&(zx(e,t,d,n),c=e.memoizedState),(a=la||xM(e,t,a,n,u,c,h))?(l||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=c),o.props=n,o.state=c,o.context=h,n=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{o=e.stateNode,b2(i,e),a=e.memoizedProps,h=e.type===e.elementType?a:ps(e.type,a),o.props=h,l=e.pendingProps,u=o.context,c=t.contextType,typeof c=="object"&&c!==null?c=is(c):(c=dr(t)?Ll:Wi.current,c=fu(e,c));var p=t.getDerivedStateFromProps;(d=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==l||u!==c)&&wM(e,o,n,c),la=!1,u=e.memoizedState,o.state=u,wg(e,n,o,r);var g=e.memoizedState;a!==l||u!==g||hr.current||la?(typeof p=="function"&&(zx(e,t,p,n),g=e.memoizedState),(h=la||xM(e,t,h,n,u,g,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,g,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,g,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===i.memoizedProps&&u===i.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===i.memoizedProps&&u===i.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=g),o.props=n,o.state=g,o.context=c,n=h):(typeof o.componentDidUpdate!="function"||a===i.memoizedProps&&u===i.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===i.memoizedProps&&u===i.memoizedState||(e.flags|=1024),n=!1)}return Hx(i,e,t,n,s,r)}function Hx(i,e,t,n,r,s){K2(i,e);var o=(e.flags&128)!==0;if(!n&&!o)return r&&pM(e,t,!1),Co(i,e,s);n=e.stateNode,EI.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,i!==null&&o?(e.child=mu(e,i.child,null,s),e.child=mu(e,null,a,s)):$i(i,e,a,s),e.memoizedState=n.state,r&&pM(e,t,!0),e.child}function J2(i){var e=i.stateNode;e.pendingContext?fM(i,e.pendingContext,e.pendingContext!==e.context):e.context&&fM(i,e.context,!1),P_(i,e.containerInfo)}function RM(i,e,t,n,r){return pu(),b_(r),e.flags|=256,$i(i,e,t,n),e.child}var Vx={dehydrated:null,treeContext:null,retryLane:0};function Gx(i){return{baseLanes:i,cachePool:null,transitions:null}}function eC(i,e,t){var n=e.pendingProps,r=Bn.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=i!==null&&i.memoizedState===null?!1:(r&2)!==0),a?(s=!0,e.flags&=-129):(i===null||i.memoizedState!==null)&&(r|=1),vn(Bn,r&1),i===null)return Dx(e),i=e.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?((e.mode&1)===0?e.lanes=1:i.data==="$!"?e.lanes=8:e.lanes=1073741824,null):(o=n.children,i=n.fallback,s?(n=e.mode,s=e.child,o={mode:"hidden",children:o},(n&1)===0&&s!==null?(s.childLanes=0,s.pendingProps=o):s=tv(o,n,0,null),i=Ml(i,n,t,null),s.return=e,i.return=e,s.sibling=i,e.child=s,e.child.memoizedState=Gx(t),e.memoizedState=Vx,i):z_(e,o));if(r=i.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return TI(i,e,o,n,a,r,t);if(s){s=n.fallback,o=e.mode,r=i.child,a=r.sibling;var c={mode:"hidden",children:n.children};return(o&1)===0&&e.child!==r?(n=e.child,n.childLanes=0,n.pendingProps=c,e.deletions=null):(n=Sa(r,c),n.subtreeFlags=r.subtreeFlags&14680064),a!==null?s=Sa(a,s):(s=Ml(s,o,t,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,o=i.child.memoizedState,o=o===null?Gx(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=i.childLanes&~t,e.memoizedState=Vx,n}return s=i.child,i=s.sibling,n=Sa(s,{mode:"visible",children:n.children}),(e.mode&1)===0&&(n.lanes=t),n.return=e,n.sibling=null,i!==null&&(t=e.deletions,t===null?(e.deletions=[i],e.flags|=16):t.push(i)),e.child=n,e.memoizedState=null,n}function z_(i,e){return e=tv({mode:"visible",children:e},i.mode,0,null),e.return=i,i.child=e}function Ip(i,e,t,n){return n!==null&&b_(n),mu(e,i.child,null,t),i=z_(e,e.pendingProps.children),i.flags|=2,e.memoizedState=null,i}function TI(i,e,t,n,r,s,o){if(t)return e.flags&256?(e.flags&=-257,n=ry(Error(tt(422))),Ip(i,e,o,n)):e.memoizedState!==null?(e.child=i.child,e.flags|=128,null):(s=n.fallback,r=e.mode,n=tv({mode:"visible",children:n.children},r,0,null),s=Ml(s,r,o,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,(e.mode&1)!==0&&mu(e,i.child,null,o),e.child.memoizedState=Gx(o),e.memoizedState=Vx,s);if((e.mode&1)===0)return Ip(i,e,o,null);if(r.data==="$!"){if(n=r.nextSibling&&r.nextSibling.dataset,n)var a=n.dgst;return n=a,s=Error(tt(419)),n=ry(s,n,void 0),Ip(i,e,o,n)}if(a=(o&i.childLanes)!==0,cr||a){if(n=bi,n!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=(r&(n.suspendedLanes|o))!==0?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,Ao(i,r),Ss(n,i,r,-1))}return G_(),n=ry(Error(tt(421))),Ip(i,e,o,n)}return r.data==="$?"?(e.flags|=128,e.child=i.child,e=NI.bind(null,i),r._reactRetry=e,null):(i=s.treeContext,Rr=ya(r.nextSibling),Lr=e,In=!0,gs=null,i!==null&&(Qr[Zr++]=xo,Qr[Zr++]=wo,Qr[Zr++]=kl,xo=i.id,wo=i.overflow,kl=e),e=z_(e,n.children),e.flags|=4096,e)}function LM(i,e,t){i.lanes|=e;var n=i.alternate;n!==null&&(n.lanes|=e),Bx(i.return,e,t)}function sy(i,e,t,n,r){var s=i.memoizedState;s===null?i.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:t,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=t,s.tailMode=r)}function tC(i,e,t){var n=e.pendingProps,r=n.revealOrder,s=n.tail;if($i(i,e,n.children,t),n=Bn.current,(n&2)!==0)n=n&1|2,e.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=e.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&LM(i,t,e);else if(i.tag===19)LM(i,t,e);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break e;for(;i.sibling===null;){if(i.return===null||i.return===e)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}n&=1}if(vn(Bn,n),(e.mode&1)===0)e.memoizedState=null;else switch(r){case"forwards":for(t=e.child,r=null;t!==null;)i=t.alternate,i!==null&&_g(i)===null&&(r=t),t=t.sibling;t=r,t===null?(r=e.child,e.child=null):(r=t.sibling,t.sibling=null),sy(e,!1,r,t,s);break;case"backwards":for(t=null,r=e.child,e.child=null;r!==null;){if(i=r.alternate,i!==null&&_g(i)===null){e.child=r;break}i=r.sibling,r.sibling=t,t=r,r=i}sy(e,!0,t,null,s);break;case"together":sy(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Wm(i,e){(e.mode&1)===0&&i!==null&&(i.alternate=null,e.alternate=null,e.flags|=2)}function Co(i,e,t){if(i!==null&&(e.dependencies=i.dependencies),Fl|=e.lanes,(t&e.childLanes)===0)return null;if(i!==null&&e.child!==i.child)throw Error(tt(153));if(e.child!==null){for(i=e.child,t=Sa(i,i.pendingProps),e.child=t,t.return=e;i.sibling!==null;)i=i.sibling,t=t.sibling=Sa(i,i.pendingProps),t.return=e;t.sibling=null}return e.child}function AI(i,e,t){switch(e.tag){case 3:J2(e),pu();break;case 5:C2(e);break;case 1:dr(e.type)&&mg(e);break;case 4:P_(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,r=e.memoizedProps.value;vn(yg,n._currentValue),n._currentValue=r;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(vn(Bn,Bn.current&1),e.flags|=128,null):(t&e.child.childLanes)!==0?eC(i,e,t):(vn(Bn,Bn.current&1),i=Co(i,e,t),i!==null?i.sibling:null);vn(Bn,Bn.current&1);break;case 19:if(n=(t&e.childLanes)!==0,(i.flags&128)!==0){if(n)return tC(i,e,t);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),vn(Bn,Bn.current),n)break;return null;case 22:case 23:return e.lanes=0,Z2(i,e,t)}return Co(i,e,t)}var nC,Wx,iC,rC;nC=function(i,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)i.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};Wx=function(){};iC=function(i,e,t,n){var r=i.memoizedProps;if(r!==n){i=e.stateNode,xl(Ys.current);var s=null;switch(t){case"input":r=dx(i,r),n=dx(i,n),s=[];break;case"select":r=Nn({},r,{value:void 0}),n=Nn({},n,{value:void 0}),s=[];break;case"textarea":r=mx(i,r),n=mx(i,n),s=[];break;default:typeof r.onClick!="function"&&typeof n.onClick=="function"&&(i.onclick=fg)}vx(t,n);var o;t=null;for(h in r)if(!n.hasOwnProperty(h)&&r.hasOwnProperty(h)&&r[h]!=null)if(h==="style"){var a=r[h];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(Md.hasOwnProperty(h)?s||(s=[]):(s=s||[]).push(h,null));for(h in n){var c=n[h];if(a=r!=null?r[h]:void 0,n.hasOwnProperty(h)&&c!==a&&(c!=null||a!=null))if(h==="style")if(a){for(o in a)!a.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in c)c.hasOwnProperty(o)&&a[o]!==c[o]&&(t||(t={}),t[o]=c[o])}else t||(s||(s=[]),s.push(h,t)),t=c;else h==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(s=s||[]).push(h,c)):h==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(h,""+c):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(Md.hasOwnProperty(h)?(c!=null&&h==="onScroll"&&Sn("scroll",i),s||a===c||(s=[])):(s=s||[]).push(h,c))}t&&(s=s||[]).push("style",t);var h=s;(e.updateQueue=h)&&(e.flags|=4)}};rC=function(i,e,t,n){t!==n&&(e.flags|=4)};function Dh(i,e){if(!In)switch(i.tailMode){case"hidden":e=i.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?i.tail=null:t.sibling=null;break;case"collapsed":t=i.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e||i.tail===null?i.tail=null:i.tail.sibling=null:n.sibling=null}}function Ui(i){var e=i.alternate!==null&&i.alternate.child===i.child,t=0,n=0;if(e)for(var r=i.child;r!==null;)t|=r.lanes|r.childLanes,n|=r.subtreeFlags&14680064,n|=r.flags&14680064,r.return=i,r=r.sibling;else for(r=i.child;r!==null;)t|=r.lanes|r.childLanes,n|=r.subtreeFlags,n|=r.flags,r.return=i,r=r.sibling;return i.subtreeFlags|=n,i.childLanes=t,e}function CI(i,e,t){var n=e.pendingProps;switch(S_(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ui(e),null;case 1:return dr(e.type)&&pg(),Ui(e),null;case 3:return n=e.stateNode,gu(),Tn(hr),Tn(Wi),L_(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(i===null||i.child===null)&&(Lp(e)?e.flags|=4:i===null||i.memoizedState.isDehydrated&&(e.flags&256)===0||(e.flags|=1024,gs!==null&&(Kx(gs),gs=null))),Wx(i,e),Ui(e),null;case 5:R_(e);var r=xl(Bd.current);if(t=e.type,i!==null&&e.stateNode!=null)iC(i,e,t,n,r),i.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(tt(166));return Ui(e),null}if(i=xl(Ys.current),Lp(e)){n=e.stateNode,t=e.type;var s=e.memoizedProps;switch(n[Xs]=e,n[Fd]=s,i=(e.mode&1)!==0,t){case"dialog":Sn("cancel",n),Sn("close",n);break;case"iframe":case"object":case"embed":Sn("load",n);break;case"video":case"audio":for(r=0;r<td.length;r++)Sn(td[r],n);break;case"source":Sn("error",n);break;case"img":case"image":case"link":Sn("error",n),Sn("load",n);break;case"details":Sn("toggle",n);break;case"input":Ub(n,s),Sn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Sn("invalid",n);break;case"textarea":Vb(n,s),Sn("invalid",n)}vx(t,s),r=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?n.textContent!==a&&(s.suppressHydrationWarning!==!0&&Rp(n.textContent,a,i),r=["children",a]):typeof a=="number"&&n.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Rp(n.textContent,a,i),r=["children",""+a]):Md.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Sn("scroll",n)}switch(t){case"input":Sp(n),Hb(n,s,!0);break;case"textarea":Sp(n),Gb(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=fg)}n=r,e.updateQueue=n,n!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=LA(t)),i==="http://www.w3.org/1999/xhtml"?t==="script"?(i=o.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof n.is=="string"?i=o.createElement(t,{is:n.is}):(i=o.createElement(t),t==="select"&&(o=i,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):i=o.createElementNS(i,t),i[Xs]=e,i[Fd]=n,nC(i,e,!1,!1),e.stateNode=i;e:{switch(o=yx(t,n),t){case"dialog":Sn("cancel",i),Sn("close",i),r=n;break;case"iframe":case"object":case"embed":Sn("load",i),r=n;break;case"video":case"audio":for(r=0;r<td.length;r++)Sn(td[r],i);r=n;break;case"source":Sn("error",i),r=n;break;case"img":case"image":case"link":Sn("error",i),Sn("load",i),r=n;break;case"details":Sn("toggle",i),r=n;break;case"input":Ub(i,n),r=dx(i,n),Sn("invalid",i);break;case"option":r=n;break;case"select":i._wrapperState={wasMultiple:!!n.multiple},r=Nn({},n,{value:void 0}),Sn("invalid",i);break;case"textarea":Vb(i,n),r=mx(i,n),Sn("invalid",i);break;default:r=n}vx(t,r),a=r;for(s in a)if(a.hasOwnProperty(s)){var c=a[s];s==="style"?FA(i,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&kA(i,c)):s==="children"?typeof c=="string"?(t!=="textarea"||c!=="")&&Ed(i,c):typeof c=="number"&&Ed(i,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Md.hasOwnProperty(s)?c!=null&&s==="onScroll"&&Sn("scroll",i):c!=null&&a_(i,s,c,o))}switch(t){case"input":Sp(i),Hb(i,n,!1);break;case"textarea":Sp(i),Gb(i);break;case"option":n.value!=null&&i.setAttribute("value",""+Aa(n.value));break;case"select":i.multiple=!!n.multiple,s=n.value,s!=null?ru(i,!!n.multiple,s,!1):n.defaultValue!=null&&ru(i,!!n.multiple,n.defaultValue,!0);break;default:typeof r.onClick=="function"&&(i.onclick=fg)}switch(t){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ui(e),null;case 6:if(i&&e.stateNode!=null)rC(i,e,i.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(tt(166));if(t=xl(Bd.current),xl(Ys.current),Lp(e)){if(n=e.stateNode,t=e.memoizedProps,n[Xs]=e,(s=n.nodeValue!==t)&&(i=Lr,i!==null))switch(i.tag){case 3:Rp(n.nodeValue,t,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&Rp(n.nodeValue,t,(i.mode&1)!==0)}s&&(e.flags|=4)}else n=(t.nodeType===9?t:t.ownerDocument).createTextNode(n),n[Xs]=e,e.stateNode=n}return Ui(e),null;case 13:if(Tn(Bn),n=e.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(In&&Rr!==null&&(e.mode&1)!==0&&(e.flags&128)===0)_2(),pu(),e.flags|=98560,s=!1;else if(s=Lp(e),n!==null&&n.dehydrated!==null){if(i===null){if(!s)throw Error(tt(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(tt(317));s[Xs]=e}else pu(),(e.flags&128)===0&&(e.memoizedState=null),e.flags|=4;Ui(e),s=!1}else gs!==null&&(Kx(gs),gs=null),s=!0;if(!s)return e.flags&65536?e:null}return(e.flags&128)!==0?(e.lanes=t,e):(n=n!==null,n!==(i!==null&&i.memoizedState!==null)&&n&&(e.child.flags|=8192,(e.mode&1)!==0&&(i===null||(Bn.current&1)!==0?fi===0&&(fi=3):G_())),e.updateQueue!==null&&(e.flags|=4),Ui(e),null);case 4:return gu(),Wx(i,e),i===null&&kd(e.stateNode.containerInfo),Ui(e),null;case 10:return T_(e.type._context),Ui(e),null;case 17:return dr(e.type)&&pg(),Ui(e),null;case 19:if(Tn(Bn),s=e.memoizedState,s===null)return Ui(e),null;if(n=(e.flags&128)!==0,o=s.rendering,o===null)if(n)Dh(s,!1);else{if(fi!==0||i!==null&&(i.flags&128)!==0)for(i=e.child;i!==null;){if(o=_g(i),o!==null){for(e.flags|=128,Dh(s,!1),n=o.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=t,t=e.child;t!==null;)s=t,i=n,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=i,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,i=o.dependencies,s.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),t=t.sibling;return vn(Bn,Bn.current&1|2),e.child}i=i.sibling}s.tail!==null&&Kn()>yu&&(e.flags|=128,n=!0,Dh(s,!1),e.lanes=4194304)}else{if(!n)if(i=_g(o),i!==null){if(e.flags|=128,n=!0,t=i.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Dh(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!In)return Ui(e),null}else 2*Kn()-s.renderingStartTime>yu&&t!==1073741824&&(e.flags|=128,n=!0,Dh(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(t=s.last,t!==null?t.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Kn(),e.sibling=null,t=Bn.current,vn(Bn,n?t&1|2:t&1),e):(Ui(e),null);case 22:case 23:return V_(),n=e.memoizedState!==null,i!==null&&i.memoizedState!==null!==n&&(e.flags|=8192),n&&(e.mode&1)!==0?(Tr&1073741824)!==0&&(Ui(e),e.subtreeFlags&6&&(e.flags|=8192)):Ui(e),null;case 24:return null;case 25:return null}throw Error(tt(156,e.tag))}function PI(i,e){switch(S_(e),e.tag){case 1:return dr(e.type)&&pg(),i=e.flags,i&65536?(e.flags=i&-65537|128,e):null;case 3:return gu(),Tn(hr),Tn(Wi),L_(),i=e.flags,(i&65536)!==0&&(i&128)===0?(e.flags=i&-65537|128,e):null;case 5:return R_(e),null;case 13:if(Tn(Bn),i=e.memoizedState,i!==null&&i.dehydrated!==null){if(e.alternate===null)throw Error(tt(340));pu()}return i=e.flags,i&65536?(e.flags=i&-65537|128,e):null;case 19:return Tn(Bn),null;case 4:return gu(),null;case 10:return T_(e.type._context),null;case 22:case 23:return V_(),null;case 24:return null;default:return null}}var Fp=!1,Vi=!1,RI=typeof WeakSet=="function"?WeakSet:Set,mt=null;function Zc(i,e){var t=i.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(n){Wn(i,e,n)}else t.current=null}function jx(i,e,t){try{t()}catch(n){Wn(i,e,n)}}var kM=!1;function LI(i,e){if(Cx=ug,i=l2(),w_(i)){if("selectionStart"in i)var t={start:i.selectionStart,end:i.selectionEnd};else e:{t=(t=i.ownerDocument)&&t.defaultView||window;var n=t.getSelection&&t.getSelection();if(n&&n.rangeCount!==0){t=n.anchorNode;var r=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var o=0,a=-1,c=-1,h=0,d=0,l=i,u=null;t:for(;;){for(var p;l!==t||r!==0&&l.nodeType!==3||(a=o+r),l!==s||n!==0&&l.nodeType!==3||(c=o+n),l.nodeType===3&&(o+=l.nodeValue.length),(p=l.firstChild)!==null;)u=l,l=p;for(;;){if(l===i)break t;if(u===t&&++h===r&&(a=o),u===s&&++d===n&&(c=o),(p=l.nextSibling)!==null)break;l=u,u=l.parentNode}l=p}t=a===-1||c===-1?null:{start:a,end:c}}else t=null}t=t||{start:0,end:0}}else t=null;for(Px={focusedElem:i,selectionRange:t},ug=!1,mt=e;mt!==null;)if(e=mt,i=e.child,(e.subtreeFlags&1028)!==0&&i!==null)i.return=e,mt=i;else for(;mt!==null;){e=mt;try{var g=e.alternate;if((e.flags&1024)!==0)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var y=g.memoizedProps,x=g.memoizedState,v=e.stateNode,w=v.getSnapshotBeforeUpdate(e.elementType===e.type?y:ps(e.type,y),x);v.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(tt(163))}}catch(b){Wn(e,e.return,b)}if(i=e.sibling,i!==null){i.return=e.return,mt=i;break}mt=e.return}return g=kM,kM=!1,g}function dd(i,e,t){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var r=n=n.next;do{if((r.tag&i)===i){var s=r.destroy;r.destroy=void 0,s!==void 0&&jx(e,t,s)}r=r.next}while(r!==n)}}function Jg(i,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&i)===i){var n=t.create;t.destroy=n()}t=t.next}while(t!==e)}}function Xx(i){var e=i.ref;if(e!==null){var t=i.stateNode;switch(i.tag){case 5:i=t;break;default:i=t}typeof e=="function"?e(i):e.current=i}}function sC(i){var e=i.alternate;e!==null&&(i.alternate=null,sC(e)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(e=i.stateNode,e!==null&&(delete e[Xs],delete e[Fd],delete e[kx],delete e[fI],delete e[pI])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function oC(i){return i.tag===5||i.tag===3||i.tag===4}function IM(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||oC(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function qx(i,e,t){var n=i.tag;if(n===5||n===6)i=i.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(i,e):t.insertBefore(i,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(i,t)):(e=t,e.appendChild(i)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=fg));else if(n!==4&&(i=i.child,i!==null))for(qx(i,e,t),i=i.sibling;i!==null;)qx(i,e,t),i=i.sibling}function Yx(i,e,t){var n=i.tag;if(n===5||n===6)i=i.stateNode,e?t.insertBefore(i,e):t.appendChild(i);else if(n!==4&&(i=i.child,i!==null))for(Yx(i,e,t),i=i.sibling;i!==null;)Yx(i,e,t),i=i.sibling}var Li=null,ms=!1;function Yo(i,e,t){for(t=t.child;t!==null;)aC(i,e,t),t=t.sibling}function aC(i,e,t){if(qs&&typeof qs.onCommitFiberUnmount=="function")try{qs.onCommitFiberUnmount(jg,t)}catch{}switch(t.tag){case 5:Vi||Zc(t,e);case 6:var n=Li,r=ms;Li=null,Yo(i,e,t),Li=n,ms=r,Li!==null&&(ms?(i=Li,t=t.stateNode,i.nodeType===8?i.parentNode.removeChild(t):i.removeChild(t)):Li.removeChild(t.stateNode));break;case 18:Li!==null&&(ms?(i=Li,t=t.stateNode,i.nodeType===8?K0(i.parentNode,t):i.nodeType===1&&K0(i,t),Pd(i)):K0(Li,t.stateNode));break;case 4:n=Li,r=ms,Li=t.stateNode.containerInfo,ms=!0,Yo(i,e,t),Li=n,ms=r;break;case 0:case 11:case 14:case 15:if(!Vi&&(n=t.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){r=n=n.next;do{var s=r,o=s.destroy;s=s.tag,o!==void 0&&((s&2)!==0||(s&4)!==0)&&jx(t,e,o),r=r.next}while(r!==n)}Yo(i,e,t);break;case 1:if(!Vi&&(Zc(t,e),n=t.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=t.memoizedProps,n.state=t.memoizedState,n.componentWillUnmount()}catch(a){Wn(t,e,a)}Yo(i,e,t);break;case 21:Yo(i,e,t);break;case 22:t.mode&1?(Vi=(n=Vi)||t.memoizedState!==null,Yo(i,e,t),Vi=n):Yo(i,e,t);break;default:Yo(i,e,t)}}function FM(i){var e=i.updateQueue;if(e!==null){i.updateQueue=null;var t=i.stateNode;t===null&&(t=i.stateNode=new RI),e.forEach(function(n){var r=UI.bind(null,i,n);t.has(n)||(t.add(n),n.then(r,r))})}}function ls(i,e){var t=e.deletions;if(t!==null)for(var n=0;n<t.length;n++){var r=t[n];try{var s=i,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Li=a.stateNode,ms=!1;break e;case 3:Li=a.stateNode.containerInfo,ms=!0;break e;case 4:Li=a.stateNode.containerInfo,ms=!0;break e}a=a.return}if(Li===null)throw Error(tt(160));aC(s,o,r),Li=null,ms=!1;var c=r.alternate;c!==null&&(c.return=null),r.return=null}catch(h){Wn(r,e,h)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)lC(e,i),e=e.sibling}function lC(i,e){var t=i.alternate,n=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(ls(e,i),Ns(i),n&4){try{dd(3,i,i.return),Jg(3,i)}catch(y){Wn(i,i.return,y)}try{dd(5,i,i.return)}catch(y){Wn(i,i.return,y)}}break;case 1:ls(e,i),Ns(i),n&512&&t!==null&&Zc(t,t.return);break;case 5:if(ls(e,i),Ns(i),n&512&&t!==null&&Zc(t,t.return),i.flags&32){var r=i.stateNode;try{Ed(r,"")}catch(y){Wn(i,i.return,y)}}if(n&4&&(r=i.stateNode,r!=null)){var s=i.memoizedProps,o=t!==null?t.memoizedProps:s,a=i.type,c=i.updateQueue;if(i.updateQueue=null,c!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&PA(r,s),yx(a,o);var h=yx(a,s);for(o=0;o<c.length;o+=2){var d=c[o],l=c[o+1];d==="style"?FA(r,l):d==="dangerouslySetInnerHTML"?kA(r,l):d==="children"?Ed(r,l):a_(r,d,l,h)}switch(a){case"input":fx(r,s);break;case"textarea":RA(r,s);break;case"select":var u=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?ru(r,!!s.multiple,p,!1):u!==!!s.multiple&&(s.defaultValue!=null?ru(r,!!s.multiple,s.defaultValue,!0):ru(r,!!s.multiple,s.multiple?[]:"",!1))}r[Fd]=s}catch(y){Wn(i,i.return,y)}}break;case 6:if(ls(e,i),Ns(i),n&4){if(i.stateNode===null)throw Error(tt(162));r=i.stateNode,s=i.memoizedProps;try{r.nodeValue=s}catch(y){Wn(i,i.return,y)}}break;case 3:if(ls(e,i),Ns(i),n&4&&t!==null&&t.memoizedState.isDehydrated)try{Pd(e.containerInfo)}catch(y){Wn(i,i.return,y)}break;case 4:ls(e,i),Ns(i);break;case 13:ls(e,i),Ns(i),r=i.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(U_=Kn())),n&4&&FM(i);break;case 22:if(d=t!==null&&t.memoizedState!==null,i.mode&1?(Vi=(h=Vi)||d,ls(e,i),Vi=h):ls(e,i),Ns(i),n&8192){if(h=i.memoizedState!==null,(i.stateNode.isHidden=h)&&!d&&(i.mode&1)!==0)for(mt=i,d=i.child;d!==null;){for(l=mt=d;mt!==null;){switch(u=mt,p=u.child,u.tag){case 0:case 11:case 14:case 15:dd(4,u,u.return);break;case 1:Zc(u,u.return);var g=u.stateNode;if(typeof g.componentWillUnmount=="function"){n=u,t=u.return;try{e=n,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(y){Wn(n,t,y)}}break;case 5:Zc(u,u.return);break;case 22:if(u.memoizedState!==null){BM(l);continue}}p!==null?(p.return=u,mt=p):BM(l)}d=d.sibling}e:for(d=null,l=i;;){if(l.tag===5){if(d===null){d=l;try{r=l.stateNode,h?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=l.stateNode,c=l.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=IA("display",o))}catch(y){Wn(i,i.return,y)}}}else if(l.tag===6){if(d===null)try{l.stateNode.nodeValue=h?"":l.memoizedProps}catch(y){Wn(i,i.return,y)}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===i)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===i)break e;for(;l.sibling===null;){if(l.return===null||l.return===i)break e;d===l&&(d=null),l=l.return}d===l&&(d=null),l.sibling.return=l.return,l=l.sibling}}break;case 19:ls(e,i),Ns(i),n&4&&FM(i);break;case 21:break;default:ls(e,i),Ns(i)}}function Ns(i){var e=i.flags;if(e&2){try{e:{for(var t=i.return;t!==null;){if(oC(t)){var n=t;break e}t=t.return}throw Error(tt(160))}switch(n.tag){case 5:var r=n.stateNode;n.flags&32&&(Ed(r,""),n.flags&=-33);var s=IM(i);Yx(i,s,r);break;case 3:case 4:var o=n.stateNode.containerInfo,a=IM(i);qx(i,a,o);break;default:throw Error(tt(161))}}catch(c){Wn(i,i.return,c)}i.flags&=-3}e&4096&&(i.flags&=-4097)}function kI(i,e,t){mt=i,cC(i)}function cC(i,e,t){for(var n=(i.mode&1)!==0;mt!==null;){var r=mt,s=r.child;if(r.tag===22&&n){var o=r.memoizedState!==null||Fp;if(!o){var a=r.alternate,c=a!==null&&a.memoizedState!==null||Vi;a=Fp;var h=Vi;if(Fp=o,(Vi=c)&&!h)for(mt=r;mt!==null;)o=mt,c=o.child,o.tag===22&&o.memoizedState!==null?zM(r):c!==null?(c.return=o,mt=c):zM(r);for(;s!==null;)mt=s,cC(s),s=s.sibling;mt=r,Fp=a,Vi=h}DM(i)}else(r.subtreeFlags&8772)!==0&&s!==null?(s.return=r,mt=s):DM(i)}}function DM(i){for(;mt!==null;){var e=mt;if((e.flags&8772)!==0){var t=e.alternate;try{if((e.flags&8772)!==0)switch(e.tag){case 0:case 11:case 15:Vi||Jg(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Vi)if(t===null)n.componentDidMount();else{var r=e.elementType===e.type?t.memoizedProps:ps(e.type,t.memoizedProps);n.componentDidUpdate(r,t.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&yM(e,s,n);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}yM(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&t.focus();break;case"img":c.src&&(t.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var h=e.alternate;if(h!==null){var d=h.memoizedState;if(d!==null){var l=d.dehydrated;l!==null&&Pd(l)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(tt(163))}Vi||e.flags&512&&Xx(e)}catch(u){Wn(e,e.return,u)}}if(e===i){mt=null;break}if(t=e.sibling,t!==null){t.return=e.return,mt=t;break}mt=e.return}}function BM(i){for(;mt!==null;){var e=mt;if(e===i){mt=null;break}var t=e.sibling;if(t!==null){t.return=e.return,mt=t;break}mt=e.return}}function zM(i){for(;mt!==null;){var e=mt;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{Jg(4,e)}catch(c){Wn(e,t,c)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var r=e.return;try{n.componentDidMount()}catch(c){Wn(e,r,c)}}var s=e.return;try{Xx(e)}catch(c){Wn(e,s,c)}break;case 5:var o=e.return;try{Xx(e)}catch(c){Wn(e,o,c)}}}catch(c){Wn(e,e.return,c)}if(e===i){mt=null;break}var a=e.sibling;if(a!==null){a.return=e.return,mt=a;break}mt=e.return}}var II=Math.ceil,Mg=Fo.ReactCurrentDispatcher,O_=Fo.ReactCurrentOwner,es=Fo.ReactCurrentBatchConfig,en=0,bi=null,oi=null,ki=0,Tr=0,Kc=za(0),fi=0,Ud=null,Fl=0,ev=0,N_=0,fd=null,lr=null,U_=0,yu=1/0,vo=null,Eg=!1,$x=null,wa=null,Dp=!1,da=null,Tg=0,pd=0,Qx=null,jm=-1,Xm=0;function Zi(){return(en&6)!==0?Kn():jm!==-1?jm:jm=Kn()}function _a(i){return(i.mode&1)===0?1:(en&2)!==0&&ki!==0?ki&-ki:gI.transition!==null?(Xm===0&&(Xm=XA()),Xm):(i=un,i!==0||(i=window.event,i=i===void 0?16:JA(i.type)),i)}function Ss(i,e,t,n){if(50<pd)throw pd=0,Qx=null,Error(tt(185));of(i,t,n),((en&2)===0||i!==bi)&&(i===bi&&((en&2)===0&&(ev|=t),fi===4&&ua(i,ki)),fr(i,n),t===1&&en===0&&(e.mode&1)===0&&(yu=Kn()+500,Qg&&Oa()))}function fr(i,e){var t=i.callbackNode;gk(i,e);var n=cg(i,i===bi?ki:0);if(n===0)t!==null&&Xb(t),i.callbackNode=null,i.callbackPriority=0;else if(e=n&-n,i.callbackPriority!==e){if(t!=null&&Xb(t),e===1)i.tag===0?mI(OM.bind(null,i)):y2(OM.bind(null,i)),hI(function(){(en&6)===0&&Oa()}),t=null;else{switch(qA(n)){case 1:t=d_;break;case 4:t=WA;break;case 16:t=lg;break;case 536870912:t=jA;break;default:t=lg}t=vC(t,uC.bind(null,i))}i.callbackPriority=e,i.callbackNode=t}}function uC(i,e){if(jm=-1,Xm=0,(en&6)!==0)throw Error(tt(327));var t=i.callbackNode;if(cu()&&i.callbackNode!==t)return null;var n=cg(i,i===bi?ki:0);if(n===0)return null;if((n&30)!==0||(n&i.expiredLanes)!==0||e)e=Ag(i,n);else{e=n;var r=en;en|=2;var s=dC();(bi!==i||ki!==e)&&(vo=null,yu=Kn()+500,bl(i,e));do try{BI();break}catch(a){hC(i,a)}while(1);E_(),Mg.current=s,en=r,oi!==null?e=0:(bi=null,ki=0,e=fi)}if(e!==0){if(e===2&&(r=bx(i),r!==0&&(n=r,e=Zx(i,r))),e===1)throw t=Ud,bl(i,0),ua(i,n),fr(i,Kn()),t;if(e===6)ua(i,n);else{if(r=i.current.alternate,(n&30)===0&&!FI(r)&&(e=Ag(i,n),e===2&&(s=bx(i),s!==0&&(n=s,e=Zx(i,s))),e===1))throw t=Ud,bl(i,0),ua(i,n),fr(i,Kn()),t;switch(i.finishedWork=r,i.finishedLanes=n,e){case 0:case 1:throw Error(tt(345));case 2:hl(i,lr,vo);break;case 3:if(ua(i,n),(n&130023424)===n&&(e=U_+500-Kn(),10<e)){if(cg(i,0)!==0)break;if(r=i.suspendedLanes,(r&n)!==n){Zi(),i.pingedLanes|=i.suspendedLanes&r;break}i.timeoutHandle=Lx(hl.bind(null,i,lr,vo),e);break}hl(i,lr,vo);break;case 4:if(ua(i,n),(n&4194240)===n)break;for(e=i.eventTimes,r=-1;0<n;){var o=31-_s(n);s=1<<o,o=e[o],o>r&&(r=o),n&=~s}if(n=r,n=Kn()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*II(n/1960))-n,10<n){i.timeoutHandle=Lx(hl.bind(null,i,lr,vo),n);break}hl(i,lr,vo);break;case 5:hl(i,lr,vo);break;default:throw Error(tt(329))}}}return fr(i,Kn()),i.callbackNode===t?uC.bind(null,i):null}function Zx(i,e){var t=fd;return i.current.memoizedState.isDehydrated&&(bl(i,e).flags|=256),i=Ag(i,e),i!==2&&(e=lr,lr=t,e!==null&&Kx(e)),i}function Kx(i){lr===null?lr=i:lr.push.apply(lr,i)}function FI(i){for(var e=i;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var n=0;n<t.length;n++){var r=t[n],s=r.getSnapshot;r=r.value;try{if(!Ms(s(),r))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===i)break;for(;e.sibling===null;){if(e.return===null||e.return===i)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ua(i,e){for(e&=~N_,e&=~ev,i.suspendedLanes|=e,i.pingedLanes&=~e,i=i.expirationTimes;0<e;){var t=31-_s(e),n=1<<t;i[t]=-1,e&=~n}}function OM(i){if((en&6)!==0)throw Error(tt(327));cu();var e=cg(i,0);if((e&1)===0)return fr(i,Kn()),null;var t=Ag(i,e);if(i.tag!==0&&t===2){var n=bx(i);n!==0&&(e=n,t=Zx(i,n))}if(t===1)throw t=Ud,bl(i,0),ua(i,e),fr(i,Kn()),t;if(t===6)throw Error(tt(345));return i.finishedWork=i.current.alternate,i.finishedLanes=e,hl(i,lr,vo),fr(i,Kn()),null}function H_(i,e){var t=en;en|=1;try{return i(e)}finally{en=t,en===0&&(yu=Kn()+500,Qg&&Oa())}}function Dl(i){da!==null&&da.tag===0&&(en&6)===0&&cu();var e=en;en|=1;var t=es.transition,n=un;try{if(es.transition=null,un=1,i)return i()}finally{un=n,es.transition=t,en=e,(en&6)===0&&Oa()}}function V_(){Tr=Kc.current,Tn(Kc)}function bl(i,e){i.finishedWork=null,i.finishedLanes=0;var t=i.timeoutHandle;if(t!==-1&&(i.timeoutHandle=-1,uI(t)),oi!==null)for(t=oi.return;t!==null;){var n=t;switch(S_(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&pg();break;case 3:gu(),Tn(hr),Tn(Wi),L_();break;case 5:R_(n);break;case 4:gu();break;case 13:Tn(Bn);break;case 19:Tn(Bn);break;case 10:T_(n.type._context);break;case 22:case 23:V_()}t=t.return}if(bi=i,oi=i=Sa(i.current,null),ki=Tr=e,fi=0,Ud=null,N_=ev=Fl=0,lr=fd=null,yl!==null){for(e=0;e<yl.length;e++)if(t=yl[e],n=t.interleaved,n!==null){t.interleaved=null;var r=n.next,s=t.pending;if(s!==null){var o=s.next;s.next=r,n.next=o}t.pending=n}yl=null}return i}function hC(i,e){do{var t=oi;try{if(E_(),Vm.current=bg,Sg){for(var n=On.memoizedState;n!==null;){var r=n.queue;r!==null&&(r.pending=null),n=n.next}Sg=!1}if(Il=0,wi=hi=On=null,hd=!1,zd=0,O_.current=null,t===null||t.return===null){fi=1,Ud=e,oi=null;break}e:{var s=i,o=t.return,a=t,c=e;if(e=ki,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var h=c,d=a,l=d.tag;if((d.mode&1)===0&&(l===0||l===11||l===15)){var u=d.alternate;u?(d.updateQueue=u.updateQueue,d.memoizedState=u.memoizedState,d.lanes=u.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=EM(o);if(p!==null){p.flags&=-257,TM(p,o,a,s,e),p.mode&1&&MM(s,h,e),e=p,c=h;var g=e.updateQueue;if(g===null){var y=new Set;y.add(c),e.updateQueue=y}else g.add(c);break e}else{if((e&1)===0){MM(s,h,e),G_();break e}c=Error(tt(426))}}else if(In&&a.mode&1){var x=EM(o);if(x!==null){(x.flags&65536)===0&&(x.flags|=256),TM(x,o,a,s,e),b_(vu(c,a));break e}}s=c=vu(c,a),fi!==4&&(fi=2),fd===null?fd=[s]:fd.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var v=Y2(s,c,e);vM(s,v);break e;case 1:a=c;var w=s.type,S=s.stateNode;if((s.flags&128)===0&&(typeof w.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(wa===null||!wa.has(S)))){s.flags|=65536,e&=-e,s.lanes|=e;var b=$2(s,a,e);vM(s,b);break e}}s=s.return}while(s!==null)}pC(t)}catch(E){e=E,oi===t&&t!==null&&(oi=t=t.return);continue}break}while(1)}function dC(){var i=Mg.current;return Mg.current=bg,i===null?bg:i}function G_(){(fi===0||fi===3||fi===2)&&(fi=4),bi===null||(Fl&268435455)===0&&(ev&268435455)===0||ua(bi,ki)}function Ag(i,e){var t=en;en|=2;var n=dC();(bi!==i||ki!==e)&&(vo=null,bl(i,e));do try{DI();break}catch(r){hC(i,r)}while(1);if(E_(),en=t,Mg.current=n,oi!==null)throw Error(tt(261));return bi=null,ki=0,fi}function DI(){for(;oi!==null;)fC(oi)}function BI(){for(;oi!==null&&!ak();)fC(oi)}function fC(i){var e=gC(i.alternate,i,Tr);i.memoizedProps=i.pendingProps,e===null?pC(i):oi=e,O_.current=null}function pC(i){var e=i;do{var t=e.alternate;if(i=e.return,(e.flags&32768)===0){if(t=CI(t,e,Tr),t!==null){oi=t;return}}else{if(t=PI(t,e),t!==null){t.flags&=32767,oi=t;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{fi=6,oi=null;return}}if(e=e.sibling,e!==null){oi=e;return}oi=e=i}while(e!==null);fi===0&&(fi=5)}function hl(i,e,t){var n=un,r=es.transition;try{es.transition=null,un=1,zI(i,e,t,n)}finally{es.transition=r,un=n}return null}function zI(i,e,t,n){do cu();while(da!==null);if((en&6)!==0)throw Error(tt(327));t=i.finishedWork;var r=i.finishedLanes;if(t===null)return null;if(i.finishedWork=null,i.finishedLanes=0,t===i.current)throw Error(tt(177));i.callbackNode=null,i.callbackPriority=0;var s=t.lanes|t.childLanes;if(vk(i,s),i===bi&&(oi=bi=null,ki=0),(t.subtreeFlags&2064)===0&&(t.flags&2064)===0||Dp||(Dp=!0,vC(lg,function(){return cu(),null})),s=(t.flags&15990)!==0,(t.subtreeFlags&15990)!==0||s){s=es.transition,es.transition=null;var o=un;un=1;var a=en;en|=4,O_.current=null,LI(i,t),lC(t,i),iI(Px),ug=!!Cx,Px=Cx=null,i.current=t,kI(t),lk(),en=a,un=o,es.transition=s}else i.current=t;if(Dp&&(Dp=!1,da=i,Tg=r),s=i.pendingLanes,s===0&&(wa=null),hk(t.stateNode),fr(i,Kn()),e!==null)for(n=i.onRecoverableError,t=0;t<e.length;t++)r=e[t],n(r.value,{componentStack:r.stack,digest:r.digest});if(Eg)throw Eg=!1,i=$x,$x=null,i;return(Tg&1)!==0&&i.tag!==0&&cu(),s=i.pendingLanes,(s&1)!==0?i===Qx?pd++:(pd=0,Qx=i):pd=0,Oa(),null}function cu(){if(da!==null){var i=qA(Tg),e=es.transition,t=un;try{if(es.transition=null,un=16>i?16:i,da===null)var n=!1;else{if(i=da,da=null,Tg=0,(en&6)!==0)throw Error(tt(331));var r=en;for(en|=4,mt=i.current;mt!==null;){var s=mt,o=s.child;if((mt.flags&16)!==0){var a=s.deletions;if(a!==null){for(var c=0;c<a.length;c++){var h=a[c];for(mt=h;mt!==null;){var d=mt;switch(d.tag){case 0:case 11:case 15:dd(8,d,s)}var l=d.child;if(l!==null)l.return=d,mt=l;else for(;mt!==null;){d=mt;var u=d.sibling,p=d.return;if(sC(d),d===h){mt=null;break}if(u!==null){u.return=p,mt=u;break}mt=p}}}var g=s.alternate;if(g!==null){var y=g.child;if(y!==null){g.child=null;do{var x=y.sibling;y.sibling=null,y=x}while(y!==null)}}mt=s}}if((s.subtreeFlags&2064)!==0&&o!==null)o.return=s,mt=o;else e:for(;mt!==null;){if(s=mt,(s.flags&2048)!==0)switch(s.tag){case 0:case 11:case 15:dd(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,mt=v;break e}mt=s.return}}var w=i.current;for(mt=w;mt!==null;){o=mt;var S=o.child;if((o.subtreeFlags&2064)!==0&&S!==null)S.return=o,mt=S;else e:for(o=w;mt!==null;){if(a=mt,(a.flags&2048)!==0)try{switch(a.tag){case 0:case 11:case 15:Jg(9,a)}}catch(E){Wn(a,a.return,E)}if(a===o){mt=null;break e}var b=a.sibling;if(b!==null){b.return=a.return,mt=b;break e}mt=a.return}}if(en=r,Oa(),qs&&typeof qs.onPostCommitFiberRoot=="function")try{qs.onPostCommitFiberRoot(jg,i)}catch{}n=!0}return n}finally{un=t,es.transition=e}}return!1}function NM(i,e,t){e=vu(t,e),e=Y2(i,e,1),i=xa(i,e,1),e=Zi(),i!==null&&(of(i,1,e),fr(i,e))}function Wn(i,e,t){if(i.tag===3)NM(i,i,t);else for(;e!==null;){if(e.tag===3){NM(e,i,t);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(wa===null||!wa.has(n))){i=vu(t,i),i=$2(e,i,1),e=xa(e,i,1),i=Zi(),e!==null&&(of(e,1,i),fr(e,i));break}}e=e.return}}function OI(i,e,t){var n=i.pingCache;n!==null&&n.delete(e),e=Zi(),i.pingedLanes|=i.suspendedLanes&t,bi===i&&(ki&t)===t&&(fi===4||fi===3&&(ki&130023424)===ki&&500>Kn()-U_?bl(i,0):N_|=t),fr(i,e)}function mC(i,e){e===0&&((i.mode&1)===0?e=1:(e=Ep,Ep<<=1,(Ep&130023424)===0&&(Ep=4194304)));var t=Zi();i=Ao(i,e),i!==null&&(of(i,e,t),fr(i,t))}function NI(i){var e=i.memoizedState,t=0;e!==null&&(t=e.retryLane),mC(i,t)}function UI(i,e){var t=0;switch(i.tag){case 13:var n=i.stateNode,r=i.memoizedState;r!==null&&(t=r.retryLane);break;case 19:n=i.stateNode;break;default:throw Error(tt(314))}n!==null&&n.delete(e),mC(i,t)}var gC;gC=function(i,e,t){if(i!==null)if(i.memoizedProps!==e.pendingProps||hr.current)cr=!0;else{if((i.lanes&t)===0&&(e.flags&128)===0)return cr=!1,AI(i,e,t);cr=(i.flags&131072)!==0}else cr=!1,In&&(e.flags&1048576)!==0&&x2(e,vg,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;Wm(i,e),i=e.pendingProps;var r=fu(e,Wi.current);lu(e,t),r=I_(null,e,n,i,r,t);var s=F_();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,dr(n)?(s=!0,mg(e)):s=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,C_(e),r.updater=Zg,e.stateNode=r,r._reactInternals=e,Ox(e,n,i,t),e=Hx(null,e,n,!0,s,t)):(e.tag=0,In&&s&&__(e),$i(null,e,r,t),e=e.child),e;case 16:n=e.elementType;e:{switch(Wm(i,e),i=e.pendingProps,r=n._init,n=r(n._payload),e.type=n,r=e.tag=VI(n),i=ps(n,i),r){case 0:e=Ux(null,e,n,i,t);break e;case 1:e=PM(null,e,n,i,t);break e;case 11:e=AM(null,e,n,i,t);break e;case 14:e=CM(null,e,n,ps(n.type,i),t);break e}throw Error(tt(306,n,""))}return e;case 0:return n=e.type,r=e.pendingProps,r=e.elementType===n?r:ps(n,r),Ux(i,e,n,r,t);case 1:return n=e.type,r=e.pendingProps,r=e.elementType===n?r:ps(n,r),PM(i,e,n,r,t);case 3:e:{if(J2(e),i===null)throw Error(tt(387));n=e.pendingProps,s=e.memoizedState,r=s.element,b2(i,e),wg(e,n,null,t);var o=e.memoizedState;if(n=o.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){r=vu(Error(tt(423)),e),e=RM(i,e,n,t,r);break e}else if(n!==r){r=vu(Error(tt(424)),e),e=RM(i,e,n,t,r);break e}else for(Rr=ya(e.stateNode.containerInfo.firstChild),Lr=e,In=!0,gs=null,t=A2(e,null,n,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(pu(),n===r){e=Co(i,e,t);break e}$i(i,e,n,t)}e=e.child}return e;case 5:return C2(e),i===null&&Dx(e),n=e.type,r=e.pendingProps,s=i!==null?i.memoizedProps:null,o=r.children,Rx(n,r)?o=null:s!==null&&Rx(n,s)&&(e.flags|=32),K2(i,e),$i(i,e,o,t),e.child;case 6:return i===null&&Dx(e),null;case 13:return eC(i,e,t);case 4:return P_(e,e.stateNode.containerInfo),n=e.pendingProps,i===null?e.child=mu(e,null,n,t):$i(i,e,n,t),e.child;case 11:return n=e.type,r=e.pendingProps,r=e.elementType===n?r:ps(n,r),AM(i,e,n,r,t);case 7:return $i(i,e,e.pendingProps,t),e.child;case 8:return $i(i,e,e.pendingProps.children,t),e.child;case 12:return $i(i,e,e.pendingProps.children,t),e.child;case 10:e:{if(n=e.type._context,r=e.pendingProps,s=e.memoizedProps,o=r.value,vn(yg,n._currentValue),n._currentValue=o,s!==null)if(Ms(s.value,o)){if(s.children===r.children&&!hr.current){e=Co(i,e,t);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var c=a.firstContext;c!==null;){if(c.context===n){if(s.tag===1){c=bo(-1,t&-t),c.tag=2;var h=s.updateQueue;if(h!==null){h=h.shared;var d=h.pending;d===null?c.next=c:(c.next=d.next,d.next=c),h.pending=c}}s.lanes|=t,c=s.alternate,c!==null&&(c.lanes|=t),Bx(s.return,t,e),a.lanes|=t;break}c=c.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(tt(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),Bx(o,t,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}$i(i,e,r.children,t),e=e.child}return e;case 9:return r=e.type,n=e.pendingProps.children,lu(e,t),r=is(r),n=n(r),e.flags|=1,$i(i,e,n,t),e.child;case 14:return n=e.type,r=ps(n,e.pendingProps),r=ps(n.type,r),CM(i,e,n,r,t);case 15:return Q2(i,e,e.type,e.pendingProps,t);case 17:return n=e.type,r=e.pendingProps,r=e.elementType===n?r:ps(n,r),Wm(i,e),e.tag=1,dr(n)?(i=!0,mg(e)):i=!1,lu(e,t),E2(e,n,r),Ox(e,n,r,t),Hx(null,e,n,!0,i,t);case 19:return tC(i,e,t);case 22:return Z2(i,e,t)}throw Error(tt(156,e.tag))};function vC(i,e){return GA(i,e)}function HI(i,e,t,n){this.tag=i,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Kr(i,e,t,n){return new HI(i,e,t,n)}function W_(i){return i=i.prototype,!(!i||!i.isReactComponent)}function VI(i){if(typeof i=="function")return W_(i)?1:0;if(i!=null){if(i=i.$$typeof,i===c_)return 11;if(i===u_)return 14}return 2}function Sa(i,e){var t=i.alternate;return t===null?(t=Kr(i.tag,e,i.key,i.mode),t.elementType=i.elementType,t.type=i.type,t.stateNode=i.stateNode,t.alternate=i,i.alternate=t):(t.pendingProps=e,t.type=i.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=i.flags&14680064,t.childLanes=i.childLanes,t.lanes=i.lanes,t.child=i.child,t.memoizedProps=i.memoizedProps,t.memoizedState=i.memoizedState,t.updateQueue=i.updateQueue,e=i.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=i.sibling,t.index=i.index,t.ref=i.ref,t}function qm(i,e,t,n,r,s){var o=2;if(n=i,typeof i=="function")W_(i)&&(o=1);else if(typeof i=="string")o=5;else e:switch(i){case Vc:return Ml(t.children,r,s,e);case l_:o=8,r|=8;break;case lx:return i=Kr(12,t,e,r|2),i.elementType=lx,i.lanes=s,i;case cx:return i=Kr(13,t,e,r),i.elementType=cx,i.lanes=s,i;case ux:return i=Kr(19,t,e,r),i.elementType=ux,i.lanes=s,i;case TA:return tv(t,r,s,e);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case MA:o=10;break e;case EA:o=9;break e;case c_:o=11;break e;case u_:o=14;break e;case aa:o=16,n=null;break e}throw Error(tt(130,i==null?i:typeof i,""))}return e=Kr(o,t,e,r),e.elementType=i,e.type=n,e.lanes=s,e}function Ml(i,e,t,n){return i=Kr(7,i,n,e),i.lanes=t,i}function tv(i,e,t,n){return i=Kr(22,i,n,e),i.elementType=TA,i.lanes=t,i.stateNode={isHidden:!1},i}function oy(i,e,t){return i=Kr(6,i,null,e),i.lanes=t,i}function ay(i,e,t){return e=Kr(4,i.children!==null?i.children:[],i.key,e),e.lanes=t,e.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},e}function GI(i,e,t,n,r){this.tag=e,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=H0(0),this.expirationTimes=H0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=H0(0),this.identifierPrefix=n,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function j_(i,e,t,n,r,s,o,a,c){return i=new GI(i,e,t,a,c),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Kr(3,null,null,e),i.current=s,s.stateNode=i,s.memoizedState={element:n,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},C_(s),i}function WI(i,e,t){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Hc,key:n==null?null:""+n,children:i,containerInfo:e,implementation:t}}function yC(i){if(!i)return Ca;i=i._reactInternals;e:{if(Yl(i)!==i||i.tag!==1)throw Error(tt(170));var e=i;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(dr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(tt(171))}if(i.tag===1){var t=i.type;if(dr(t))return v2(i,t,e)}return e}function xC(i,e,t,n,r,s,o,a,c){return i=j_(t,n,!0,i,r,s,o,a,c),i.context=yC(null),t=i.current,n=Zi(),r=_a(t),s=bo(n,r),s.callback=e!=null?e:null,xa(t,s,r),i.current.lanes=r,of(i,r,n),fr(i,n),i}function nv(i,e,t,n){var r=e.current,s=Zi(),o=_a(r);return t=yC(t),e.context===null?e.context=t:e.pendingContext=t,e=bo(s,o),e.payload={element:i},n=n===void 0?null:n,n!==null&&(e.callback=n),i=xa(r,e,o),i!==null&&(Ss(i,r,o,s),Hm(i,r,o)),o}function Cg(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function UM(i,e){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var t=i.retryLane;i.retryLane=t!==0&&t<e?t:e}}function X_(i,e){UM(i,e),(i=i.alternate)&&UM(i,e)}function jI(){return null}var wC=typeof reportError=="function"?reportError:function(i){console.error(i)};function q_(i){this._internalRoot=i}iv.prototype.render=q_.prototype.render=function(i){var e=this._internalRoot;if(e===null)throw Error(tt(409));nv(i,e,null,null)};iv.prototype.unmount=q_.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var e=i.containerInfo;Dl(function(){nv(null,i,null,null)}),e[To]=null}};function iv(i){this._internalRoot=i}iv.prototype.unstable_scheduleHydration=function(i){if(i){var e=QA();i={blockedOn:null,target:i,priority:e};for(var t=0;t<ca.length&&e!==0&&e<ca[t].priority;t++);ca.splice(t,0,i),t===0&&KA(i)}};function Y_(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function rv(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function HM(){}function XI(i,e,t,n,r){if(r){if(typeof n=="function"){var s=n;n=function(){var h=Cg(o);s.call(h)}}var o=xC(e,n,i,0,null,!1,!1,"",HM);return i._reactRootContainer=o,i[To]=o.current,kd(i.nodeType===8?i.parentNode:i),Dl(),o}for(;r=i.lastChild;)i.removeChild(r);if(typeof n=="function"){var a=n;n=function(){var h=Cg(c);a.call(h)}}var c=j_(i,0,!1,null,null,!1,!1,"",HM);return i._reactRootContainer=c,i[To]=c.current,kd(i.nodeType===8?i.parentNode:i),Dl(function(){nv(e,c,t,n)}),c}function sv(i,e,t,n,r){var s=t._reactRootContainer;if(s){var o=s;if(typeof r=="function"){var a=r;r=function(){var c=Cg(o);a.call(c)}}nv(e,o,i,r)}else o=XI(t,e,i,r,n);return Cg(o)}YA=function(i){switch(i.tag){case 3:var e=i.stateNode;if(e.current.memoizedState.isDehydrated){var t=ed(e.pendingLanes);t!==0&&(f_(e,t|1),fr(e,Kn()),(en&6)===0&&(yu=Kn()+500,Oa()))}break;case 13:Dl(function(){var n=Ao(i,1);if(n!==null){var r=Zi();Ss(n,i,1,r)}}),X_(i,1)}};p_=function(i){if(i.tag===13){var e=Ao(i,134217728);if(e!==null){var t=Zi();Ss(e,i,134217728,t)}X_(i,134217728)}};$A=function(i){if(i.tag===13){var e=_a(i),t=Ao(i,e);if(t!==null){var n=Zi();Ss(t,i,e,n)}X_(i,e)}};QA=function(){return un};ZA=function(i,e){var t=un;try{return un=i,e()}finally{un=t}};wx=function(i,e,t){switch(e){case"input":if(fx(i,t),e=t.name,t.type==="radio"&&e!=null){for(t=i;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var n=t[e];if(n!==i&&n.form===i.form){var r=$g(n);if(!r)throw Error(tt(90));CA(n),fx(n,r)}}}break;case"textarea":RA(i,t);break;case"select":e=t.value,e!=null&&ru(i,!!t.multiple,e,!1)}};zA=H_;OA=Dl;var qI={usingClientEntryPoint:!1,Events:[lf,Xc,$g,DA,BA,H_]},Bh={findFiberByHostInstance:vl,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},YI={bundleType:Bh.bundleType,version:Bh.version,rendererPackageName:Bh.rendererPackageName,rendererConfig:Bh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Fo.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=HA(i),i===null?null:i.stateNode},findFiberByHostInstance:Bh.findFiberByHostInstance||jI,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__!="undefined"){var Bp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Bp.isDisabled&&Bp.supportsFiber)try{jg=Bp.inject(YI),qs=Bp}catch{}}Br.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=qI;Br.createPortal=function(i,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Y_(e))throw Error(tt(200));return WI(i,e,null,t)};Br.createRoot=function(i,e){if(!Y_(i))throw Error(tt(299));var t=!1,n="",r=wC;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=j_(i,1,!1,null,null,t,!1,n,r),i[To]=e.current,kd(i.nodeType===8?i.parentNode:i),new q_(e)};Br.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var e=i._reactInternals;if(e===void 0)throw typeof i.render=="function"?Error(tt(188)):(i=Object.keys(i).join(","),Error(tt(268,i)));return i=HA(e),i=i===null?null:i.stateNode,i};Br.flushSync=function(i){return Dl(i)};Br.hydrate=function(i,e,t){if(!rv(e))throw Error(tt(200));return sv(null,i,e,!0,t)};Br.hydrateRoot=function(i,e,t){if(!Y_(i))throw Error(tt(405));var n=t!=null&&t.hydratedSources||null,r=!1,s="",o=wC;if(t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=xC(e,null,i,1,t!=null?t:null,r,!1,s,o),i[To]=e.current,kd(i),n)for(i=0;i<n.length;i++)t=n[i],r=t._getVersion,r=r(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,r]:e.mutableSourceEagerHydrationData.push(t,r);return new iv(e)};Br.render=function(i,e,t){if(!rv(e))throw Error(tt(200));return sv(null,i,e,!1,t)};Br.unmountComponentAtNode=function(i){if(!rv(i))throw Error(tt(40));return i._reactRootContainer?(Dl(function(){sv(null,null,i,!1,function(){i._reactRootContainer=null,i[To]=null})}),!0):!1};Br.unstable_batchedUpdates=H_;Br.unstable_renderSubtreeIntoContainer=function(i,e,t,n){if(!rv(t))throw Error(tt(200));if(i==null||i._reactInternals===void 0)throw Error(tt(38));return sv(i,e,t,!1,n)};Br.version="18.2.0-next-9e3b772b8-20220608";function _C(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__=="undefined"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(_C)}catch(i){console.error(i)}}_C(),xA.exports=Br;var SC,VM=xA.exports;SC=VM.createRoot,VM.hydrateRoot;function Pg(){return Pg=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(i[n]=t[n])}return i},Pg.apply(null,arguments)}/**
 * @license
 * Copyright 2010-2022 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const ov="139",Ar={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Cr={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},bC=0,Jx=1,MC=2,$I=3,QI=0,$_=1,Q_=2,Jc=3,Pa=0,kr=1,Es=2,Z_=1,ZI=2,Mo=0,El=1,ew=2,tw=3,nw=4,EC=5,ml=100,TC=101,AC=102,iw=103,rw=104,CC=200,PC=201,RC=202,LC=203,K_=204,J_=205,kC=206,IC=207,FC=208,DC=209,BC=210,zC=0,OC=1,NC=2,Rg=3,UC=4,HC=5,VC=6,GC=7,uf=0,WC=1,jC=2,bs=0,XC=1,qC=2,YC=3,e1=4,$C=5,av=300,Ra=301,La=302,xu=303,Hd=304,Wu=306,Zs=1e3,_i=1001,wu=1002,Kt=1003,Vd=1004,KI=1004,Gd=1005,JI=1005,jt=1006,lv=1007,eF=1007,Do=1008,tF=1008,ka=1009,QC=1010,ZC=1011,_u=1012,KC=1013,md=1014,_o=1015,Tl=1016,JC=1017,e3=1018,Al=1020,t3=1021,n3=1022,ur=1023,i3=1024,r3=1025,ba=1026,Bl=1027,s3=1028,o3=1029,a3=1030,l3=1031,c3=1033,Ym=33776,$m=33777,Qm=33778,Zm=33779,sw=35840,ow=35841,aw=35842,lw=35843,u3=36196,cw=37492,uw=37496,hw=37808,dw=37809,fw=37810,pw=37811,mw=37812,gw=37813,vw=37814,yw=37815,xw=37816,ww=37817,_w=37818,Sw=37819,bw=37820,Mw=37821,Ew=36492,h3=2200,d3=2201,f3=2202,Su=2300,zl=2301,Km=2302,wl=2400,_l=2401,Wd=2402,cv=2500,t1=2501,p3=0,m3=1,n1=2,Ts=3e3,Ht=3001,g3=3200,v3=3201,Na=0,y3=1,nF="",js="srgb",fa="srgb-linear",iF=0,Jm=7680,rF=7681,sF=7682,oF=7683,aF=34055,lF=34056,cF=5386,uF=512,hF=513,dF=514,fF=515,pF=516,mF=517,gF=518,x3=519,bu=35044,Mu=35048,vF=35040,yF=35045,xF=35049,wF=35041,_F=35046,SF=35050,bF=35042,MF="100",Tw="300 es",Lg=1035;class Bo{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const n=this._listeners[e.type];if(n!==void 0){e.target=this;const r=n.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const Ri=[];for(let i=0;i<256;i++)Ri[i]=(i<16?"0":"")+i.toString(16);let GM=1234567;const Cl=Math.PI/180,jd=180/Math.PI;function Ir(){const i=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(Ri[i&255]+Ri[i>>8&255]+Ri[i>>16&255]+Ri[i>>24&255]+"-"+Ri[e&255]+Ri[e>>8&255]+"-"+Ri[e>>16&15|64]+Ri[e>>24&255]+"-"+Ri[t&63|128]+Ri[t>>8&255]+"-"+Ri[t>>16&255]+Ri[t>>24&255]+Ri[n&255]+Ri[n>>8&255]+Ri[n>>16&255]+Ri[n>>24&255]).toLowerCase()}function Jn(i,e,t){return Math.max(e,Math.min(t,i))}function i1(i,e){return(i%e+e)%e}function EF(i,e,t,n,r){return n+(i-e)*(r-n)/(t-e)}function TF(i,e,t){return i!==e?(t-i)/(e-i):0}function gd(i,e,t){return(1-t)*i+t*e}function AF(i,e,t,n){return gd(i,e,1-Math.exp(-t*n))}function CF(i,e=1){return e-Math.abs(i1(i,e*2)-e)}function PF(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*(3-2*i))}function RF(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*i*(i*(i*6-15)+10))}function LF(i,e){return i+Math.floor(Math.random()*(e-i+1))}function kF(i,e){return i+Math.random()*(e-i)}function IF(i){return i*(.5-Math.random())}function FF(i){i!==void 0&&(GM=i);let e=GM+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function DF(i){return i*Cl}function BF(i){return i*jd}function Aw(i){return(i&i-1)===0&&i!==0}function w3(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function kg(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}function zF(i,e,t,n,r){const s=Math.cos,o=Math.sin,a=s(t/2),c=o(t/2),h=s((e+n)/2),d=o((e+n)/2),l=s((e-n)/2),u=o((e-n)/2),p=s((n-e)/2),g=o((n-e)/2);switch(r){case"XYX":i.set(a*d,c*l,c*u,a*h);break;case"YZY":i.set(c*u,a*d,c*l,a*h);break;case"ZXZ":i.set(c*l,c*u,a*d,a*h);break;case"XZX":i.set(a*d,c*g,c*p,a*h);break;case"YXY":i.set(c*p,a*d,c*g,a*h);break;case"ZYZ":i.set(c*g,c*p,a*d,a*h);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function OF(i,e){switch(e.constructor){case Float32Array:return i;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}function NF(i,e){switch(e.constructor){case Float32Array:return i;case Uint16Array:return Math.round(i*65535);case Uint8Array:return Math.round(i*255);case Int16Array:return Math.round(i*32767);case Int8Array:return Math.round(i*127);default:throw new Error("Invalid component type.")}}var Pr=Object.freeze({__proto__:null,DEG2RAD:Cl,RAD2DEG:jd,generateUUID:Ir,clamp:Jn,euclideanModulo:i1,mapLinear:EF,inverseLerp:TF,lerp:gd,damp:AF,pingpong:CF,smoothstep:PF,smootherstep:RF,randInt:LF,randFloat:kF,randFloatSpread:IF,seededRandom:FF,degToRad:DF,radToDeg:BF,isPowerOfTwo:Aw,ceilPowerOfTwo:w3,floorPowerOfTwo:kg,setQuaternionFromProperEuler:zF,normalize:NF,denormalize:OF});class Me{constructor(e=0,t=0){this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e,t){return t!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e,t){return t!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t,n){return n!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*n-o*r+e.x,this.y=s*r+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}Me.prototype.isVector2=!0;class ai{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(e,t,n,r,s,o,a,c,h){const d=this.elements;return d[0]=e,d[1]=r,d[2]=a,d[3]=t,d[4]=s,d[5]=c,d[6]=n,d[7]=o,d[8]=h,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,o=n[0],a=n[3],c=n[6],h=n[1],d=n[4],l=n[7],u=n[2],p=n[5],g=n[8],y=r[0],x=r[3],v=r[6],w=r[1],S=r[4],b=r[7],E=r[2],R=r[5],z=r[8];return s[0]=o*y+a*w+c*E,s[3]=o*x+a*S+c*R,s[6]=o*v+a*b+c*z,s[1]=h*y+d*w+l*E,s[4]=h*x+d*S+l*R,s[7]=h*v+d*b+l*z,s[2]=u*y+p*w+g*E,s[5]=u*x+p*S+g*R,s[8]=u*v+p*b+g*z,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],h=e[7],d=e[8];return t*o*d-t*a*h-n*s*d+n*a*c+r*s*h-r*o*c}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],h=e[7],d=e[8],l=d*o-a*h,u=a*c-d*s,p=h*s-o*c,g=t*l+n*u+r*p;if(g===0)return this.set(0,0,0,0,0,0,0,0,0);const y=1/g;return e[0]=l*y,e[1]=(r*h-d*n)*y,e[2]=(a*n-r*o)*y,e[3]=u*y,e[4]=(d*t-r*c)*y,e[5]=(r*s-a*t)*y,e[6]=p*y,e[7]=(n*c-h*t)*y,e[8]=(o*t-n*s)*y,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,s,o,a){const c=Math.cos(s),h=Math.sin(s);return this.set(n*c,n*h,-n*(c*o+h*a)+o+e,-r*h,r*c,-r*(-h*o+c*a)+a+t,0,0,1),this}scale(e,t){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this}rotate(e){const t=Math.cos(e),n=Math.sin(e),r=this.elements,s=r[0],o=r[3],a=r[6],c=r[1],h=r[4],d=r[7];return r[0]=t*s+n*c,r[3]=t*o+n*h,r[6]=t*a+n*d,r[1]=-n*s+t*c,r[4]=-n*o+t*h,r[7]=-n*a+t*d,this}translate(e,t){const n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}ai.prototype.isMatrix3=!0;function _3(i){for(let e=i.length-1;e>=0;--e)if(i[e]>65535)return!0;return!1}const UF={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function eu(i,e){return new UF[i](e)}function Xd(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}function Pl(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}function eg(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}const ly={[js]:{[fa]:Pl},[fa]:{[js]:eg}},Yr={legacyMode:!0,get workingColorSpace(){return fa},set workingColorSpace(i){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(i,e,t){if(this.legacyMode||e===t||!e||!t)return i;if(ly[e]&&ly[e][t]!==void 0){const n=ly[e][t];return i.r=n(i.r),i.g=n(i.g),i.b=n(i.b),i}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(i,e){return this.convert(i,this.workingColorSpace,e)},toWorkingColorSpace:function(i,e){return this.convert(i,e,this.workingColorSpace)}},S3={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ui={r:0,g:0,b:0},cs={h:0,s:0,l:0},zp={h:0,s:0,l:0};function cy(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+(e-i)*6*t:t<1/2?e:t<2/3?i+(e-i)*6*(2/3-t):i}function Op(i,e){return e.r=i.r,e.g=i.g,e.b=i.b,e}class qe{constructor(e,t,n){return t===void 0&&n===void 0?this.set(e):this.setRGB(e,t,n)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=js){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Yr.toWorkingColorSpace(this,t),this}setRGB(e,t,n,r=fa){return this.r=e,this.g=t,this.b=n,Yr.toWorkingColorSpace(this,r),this}setHSL(e,t,n,r=fa){if(e=i1(e,1),t=Jn(t,0,1),n=Jn(n,0,1),t===0)this.r=this.g=this.b=n;else{const s=n<=.5?n*(1+t):n+t-n*t,o=2*n-s;this.r=cy(o,s,e+1/3),this.g=cy(o,s,e),this.b=cy(o,s,e-1/3)}return Yr.toWorkingColorSpace(this,r),this}setStyle(e,t=js){function n(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let s;const o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(s[1],10))/255,this.g=Math.min(255,parseInt(s[2],10))/255,this.b=Math.min(255,parseInt(s[3],10))/255,Yr.toWorkingColorSpace(this,t),n(s[4]),this;if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(s[1],10))/100,this.g=Math.min(100,parseInt(s[2],10))/100,this.b=Math.min(100,parseInt(s[3],10))/100,Yr.toWorkingColorSpace(this,t),n(s[4]),this;break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a)){const c=parseFloat(s[1])/360,h=parseInt(s[2],10)/100,d=parseInt(s[3],10)/100;return n(s[4]),this.setHSL(c,h,d,t)}break}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(o===3)return this.r=parseInt(s.charAt(0)+s.charAt(0),16)/255,this.g=parseInt(s.charAt(1)+s.charAt(1),16)/255,this.b=parseInt(s.charAt(2)+s.charAt(2),16)/255,Yr.toWorkingColorSpace(this,t),this;if(o===6)return this.r=parseInt(s.charAt(0)+s.charAt(1),16)/255,this.g=parseInt(s.charAt(2)+s.charAt(3),16)/255,this.b=parseInt(s.charAt(4)+s.charAt(5),16)/255,Yr.toWorkingColorSpace(this,t),this}return e&&e.length>0?this.setColorName(e,t):this}setColorName(e,t=js){const n=S3[e.toLowerCase()];return n!==void 0?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Pl(e.r),this.g=Pl(e.g),this.b=Pl(e.b),this}copyLinearToSRGB(e){return this.r=eg(e.r),this.g=eg(e.g),this.b=eg(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=js){return Yr.fromWorkingColorSpace(Op(this,ui),e),Jn(ui.r*255,0,255)<<16^Jn(ui.g*255,0,255)<<8^Jn(ui.b*255,0,255)<<0}getHexString(e=js){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=fa){Yr.fromWorkingColorSpace(Op(this,ui),t);const n=ui.r,r=ui.g,s=ui.b,o=Math.max(n,r,s),a=Math.min(n,r,s);let c,h;const d=(a+o)/2;if(a===o)c=0,h=0;else{const l=o-a;switch(h=d<=.5?l/(o+a):l/(2-o-a),o){case n:c=(r-s)/l+(r<s?6:0);break;case r:c=(s-n)/l+2;break;case s:c=(n-r)/l+4;break}c/=6}return e.h=c,e.s=h,e.l=d,e}getRGB(e,t=fa){return Yr.fromWorkingColorSpace(Op(this,ui),t),e.r=ui.r,e.g=ui.g,e.b=ui.b,e}getStyle(e=js){return Yr.fromWorkingColorSpace(Op(this,ui),e),e!==js?`color(${e} ${ui.r} ${ui.g} ${ui.b})`:`rgb(${ui.r*255|0},${ui.g*255|0},${ui.b*255|0})`}offsetHSL(e,t,n){return this.getHSL(cs),cs.h+=e,cs.s+=t,cs.l+=n,this.setHSL(cs.h,cs.s,cs.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(cs),e.getHSL(zp);const n=gd(cs.h,zp.h,t),r=gd(cs.s,zp.s,t),s=gd(cs.l,zp.l,t);return this.setHSL(n,r,s),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),e.normalized===!0&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}qe.NAMES=S3;qe.prototype.isColor=!0;qe.prototype.r=1;qe.prototype.g=1;qe.prototype.b=1;let mc;class Ua{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement=="undefined")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{mc===void 0&&(mc=Xd("canvas")),mc.width=e.width,mc.height=e.height;const n=mc.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=mc}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement!="undefined"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&e instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&e instanceof ImageBitmap){const t=Xd("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=Pl(s[o]/255)*255;return n.putImageData(r,0,0),t}else if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(Pl(t[n]/255)*255):t[n]=Pl(t[n]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class Sl{constructor(e=null){this.uuid=Ir(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)r[o].isDataTexture?s.push(uy(r[o].image)):s.push(uy(r[o]))}else s=uy(r);n.url=s}return t||(e.images[this.uuid]=n),n}}function uy(i){return typeof HTMLImageElement!="undefined"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&i instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&i instanceof ImageBitmap?Ua.getDataURL(i):i.data?{data:Array.prototype.slice.call(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}Sl.prototype.isSource=!0;let HF=0;class hn extends Bo{constructor(e=hn.DEFAULT_IMAGE,t=hn.DEFAULT_MAPPING,n=_i,r=_i,s=jt,o=Do,a=ur,c=ka,h=1,d=Ts){super(),Object.defineProperty(this,"id",{value:HF++}),this.uuid=Ir(),this.name="",this.source=new Sl(e),this.mipmaps=[],this.mapping=t,this.wrapS=n,this.wrapT=r,this.magFilter=s,this.minFilter=o,this.anisotropy=h,this.format=a,this.internalFormat=null,this.type=c,this.offset=new Me(0,0),this.repeat=new Me(1,1),this.center=new Me(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ai,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=d,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return JSON.stringify(this.userData)!=="{}"&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==av)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Zs:e.x=e.x-Math.floor(e.x);break;case _i:e.x=e.x<0?0:1;break;case wu:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Zs:e.y=e.y-Math.floor(e.y);break;case _i:e.y=e.y<0?0:1;break;case wu:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}}hn.DEFAULT_IMAGE=null;hn.DEFAULT_MAPPING=av;hn.prototype.isTexture=!0;class Jt{constructor(e=0,t=0,n=0,r=1){this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e,t){return t!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e,t){return t!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*n+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*n+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*n+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,s;const c=e.elements,h=c[0],d=c[4],l=c[8],u=c[1],p=c[5],g=c[9],y=c[2],x=c[6],v=c[10];if(Math.abs(d-u)<.01&&Math.abs(l-y)<.01&&Math.abs(g-x)<.01){if(Math.abs(d+u)<.1&&Math.abs(l+y)<.1&&Math.abs(g+x)<.1&&Math.abs(h+p+v-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const S=(h+1)/2,b=(p+1)/2,E=(v+1)/2,R=(d+u)/4,z=(l+y)/4,I=(g+x)/4;return S>b&&S>E?S<.01?(n=0,r=.707106781,s=.707106781):(n=Math.sqrt(S),r=R/n,s=z/n):b>E?b<.01?(n=.707106781,r=0,s=.707106781):(r=Math.sqrt(b),n=R/r,s=I/r):E<.01?(n=.707106781,r=.707106781,s=0):(s=Math.sqrt(E),n=z/s,r=I/s),this.set(n,r,s,t),this}let w=Math.sqrt((x-g)*(x-g)+(l-y)*(l-y)+(u-d)*(u-d));return Math.abs(w)<.001&&(w=1),this.x=(x-g)/w,this.y=(l-y)/w,this.z=(u-d)/w,this.w=Math.acos((h+p+v-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t,n){return n!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}Jt.prototype.isVector4=!0;class Gi extends Bo{constructor(e,t,n={}){super(),this.width=e,this.height=t,this.depth=1,this.scissor=new Jt(0,0,e,t),this.scissorTest=!1,this.viewport=new Jt(0,0,e,t);const r={width:e,height:t,depth:1};this.texture=new hn(r,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.internalFormat=n.internalFormat!==void 0?n.internalFormat:null,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:jt,this.depthBuffer=n.depthBuffer!==void 0?n.depthBuffer:!0,this.stencilBuffer=n.stencilBuffer!==void 0?n.stencilBuffer:!1,this.depthTexture=n.depthTexture!==void 0?n.depthTexture:null,this.samples=n.samples!==void 0?n.samples:0}setSize(e,t,n=1){(this.width!==e||this.height!==t||this.depth!==n)&&(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0,this.texture.image=Object.assign({},e.texture.image),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}Gi.prototype.isWebGLRenderTarget=!0;class ju extends hn{constructor(e=null,t=1,n=1,r=1){super(null),this.image={data:e,width:t,height:n,depth:r},this.magFilter=Kt,this.minFilter=Kt,this.wrapR=_i,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}ju.prototype.isDataArrayTexture=!0;class b3 extends Gi{constructor(e,t,n){super(e,t),this.depth=n,this.texture=new ju(null,e,t,n),this.texture.isRenderTargetTexture=!0}}b3.prototype.isWebGLArrayRenderTarget=!0;class hf extends hn{constructor(e=null,t=1,n=1,r=1){super(null),this.image={data:e,width:t,height:n,depth:r},this.magFilter=Kt,this.minFilter=Kt,this.wrapR=_i,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}hf.prototype.isData3DTexture=!0;class M3 extends Gi{constructor(e,t,n){super(e,t),this.depth=n,this.texture=new hf(null,e,t,n),this.texture.isRenderTargetTexture=!0}}M3.prototype.isWebGL3DRenderTarget=!0;class E3 extends Gi{constructor(e,t,n,r={}){super(e,t,r);const s=this.texture;this.texture=[];for(let o=0;o<n;o++)this.texture[o]=s.clone(),this.texture[o].isRenderTargetTexture=!0}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let r=0,s=this.texture.length;r<s;r++)this.texture[r].image.width=e,this.texture[r].image.height=t,this.texture[r].image.depth=n;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this.texture.length=0;for(let t=0,n=e.texture.length;t<n;t++)this.texture[t]=e.texture[t].clone();return this}}E3.prototype.isWebGLMultipleRenderTargets=!0;class qt{constructor(e=0,t=0,n=0,r=1){this._x=e,this._y=t,this._z=n,this._w=r}static slerp(e,t,n,r){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),n.slerpQuaternions(e,t,r)}static slerpFlat(e,t,n,r,s,o,a){let c=n[r+0],h=n[r+1],d=n[r+2],l=n[r+3];const u=s[o+0],p=s[o+1],g=s[o+2],y=s[o+3];if(a===0){e[t+0]=c,e[t+1]=h,e[t+2]=d,e[t+3]=l;return}if(a===1){e[t+0]=u,e[t+1]=p,e[t+2]=g,e[t+3]=y;return}if(l!==y||c!==u||h!==p||d!==g){let x=1-a;const v=c*u+h*p+d*g+l*y,w=v>=0?1:-1,S=1-v*v;if(S>Number.EPSILON){const E=Math.sqrt(S),R=Math.atan2(E,v*w);x=Math.sin(x*R)/E,a=Math.sin(a*R)/E}const b=a*w;if(c=c*x+u*b,h=h*x+p*b,d=d*x+g*b,l=l*x+y*b,x===1-a){const E=1/Math.sqrt(c*c+h*h+d*d+l*l);c*=E,h*=E,d*=E,l*=E}}e[t]=c,e[t+1]=h,e[t+2]=d,e[t+3]=l}static multiplyQuaternionsFlat(e,t,n,r,s,o){const a=n[r],c=n[r+1],h=n[r+2],d=n[r+3],l=s[o],u=s[o+1],p=s[o+2],g=s[o+3];return e[t]=a*g+d*l+c*p-h*u,e[t+1]=c*g+d*u+h*l-a*p,e[t+2]=h*g+d*p+a*u-c*l,e[t+3]=d*g-a*l-c*u-h*p,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){if(!(e&&e.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const n=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,c=Math.sin,h=a(n/2),d=a(r/2),l=a(s/2),u=c(n/2),p=c(r/2),g=c(s/2);switch(o){case"XYZ":this._x=u*d*l+h*p*g,this._y=h*p*l-u*d*g,this._z=h*d*g+u*p*l,this._w=h*d*l-u*p*g;break;case"YXZ":this._x=u*d*l+h*p*g,this._y=h*p*l-u*d*g,this._z=h*d*g-u*p*l,this._w=h*d*l+u*p*g;break;case"ZXY":this._x=u*d*l-h*p*g,this._y=h*p*l+u*d*g,this._z=h*d*g+u*p*l,this._w=h*d*l-u*p*g;break;case"ZYX":this._x=u*d*l-h*p*g,this._y=h*p*l+u*d*g,this._z=h*d*g-u*p*l,this._w=h*d*l+u*p*g;break;case"YZX":this._x=u*d*l+h*p*g,this._y=h*p*l+u*d*g,this._z=h*d*g-u*p*l,this._w=h*d*l-u*p*g;break;case"XZY":this._x=u*d*l-h*p*g,this._y=h*p*l-u*d*g,this._z=h*d*g+u*p*l,this._w=h*d*l+u*p*g;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],s=t[8],o=t[1],a=t[5],c=t[9],h=t[2],d=t[6],l=t[10],u=n+a+l;if(u>0){const p=.5/Math.sqrt(u+1);this._w=.25/p,this._x=(d-c)*p,this._y=(s-h)*p,this._z=(o-r)*p}else if(n>a&&n>l){const p=2*Math.sqrt(1+n-a-l);this._w=(d-c)/p,this._x=.25*p,this._y=(r+o)/p,this._z=(s+h)/p}else if(a>l){const p=2*Math.sqrt(1+a-n-l);this._w=(s-h)/p,this._x=(r+o)/p,this._y=.25*p,this._z=(c+d)/p}else{const p=2*Math.sqrt(1+l-n-a);this._w=(o-r)/p,this._x=(s+h)/p,this._y=(c+d)/p,this._z=.25*p}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Jn(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e,t){return t!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,s=e._z,o=e._w,a=t._x,c=t._y,h=t._z,d=t._w;return this._x=n*d+o*a+r*h-s*c,this._y=r*d+o*c+s*a-n*h,this._z=s*d+o*h+n*c-r*a,this._w=o*d-n*a-r*c-s*h,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const n=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+n*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=n,this._y=r,this._z=s,this;const c=1-a*a;if(c<=Number.EPSILON){const p=1-t;return this._w=p*o+t*this._w,this._x=p*n+t*this._x,this._y=p*r+t*this._y,this._z=p*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const h=Math.sqrt(c),d=Math.atan2(h,a),l=Math.sin((1-t)*d)/h,u=Math.sin(t*d)/h;return this._w=o*l+this._w*u,this._x=n*l+this._x*u,this._y=r*l+this._y*u,this._z=s*l+this._z*u,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=Math.random(),t=Math.sqrt(1-e),n=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(r),n*Math.sin(s),n*Math.cos(s),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}qt.prototype.isQuaternion=!0;class B{constructor(e=0,t=0,n=0){this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e,t){return t!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e,t){return t!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e,t){return t!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(WM.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(WM.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6]*r,this.y=s[1]*t+s[4]*n+s[7]*r,this.z=s[2]*t+s[5]*n+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*n+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*n+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*n+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*n+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,s=e.x,o=e.y,a=e.z,c=e.w,h=c*t+o*r-a*n,d=c*n+a*t-s*r,l=c*r+s*n-o*t,u=-s*t-o*n-a*r;return this.x=h*c+u*-s+d*-a-l*-o,this.y=d*c+u*-o+l*-s-h*-a,this.z=l*c+u*-a+h*-o-d*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*r,this.y=s[1]*t+s[5]*n+s[9]*r,this.z=s[2]*t+s[6]*n+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e,t){return t!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,s=e.z,o=t.x,a=t.y,c=t.z;return this.x=r*c-s*a,this.y=s*o-n*c,this.z=n*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return hy.copy(this).projectOnVector(e),this.sub(hy)}reflect(e){return this.sub(hy.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Jn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t,n){return n!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,n=Math.sqrt(1-e**2);return this.x=n*Math.cos(t),this.y=n*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}B.prototype.isVector3=!0;const hy=new B,WM=new qt;class vr{constructor(e=new B(1/0,1/0,1/0),t=new B(-1/0,-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,n=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let c=0,h=e.length;c<h;c+=3){const d=e[c],l=e[c+1],u=e[c+2];d<t&&(t=d),l<n&&(n=l),u<r&&(r=u),d>s&&(s=d),l>o&&(o=l),u>a&&(a=u)}return this.min.set(t,n,r),this.max.set(s,o,a),this}setFromBufferAttribute(e){let t=1/0,n=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let c=0,h=e.count;c<h;c++){const d=e.getX(c),l=e.getY(c),u=e.getZ(c);d<t&&(t=d),l<n&&(n=l),u<r&&(r=u),d>s&&(s=d),l>o&&(o=l),u>a&&(a=u)}return this.min.set(t,n,r),this.max.set(s,o,a),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=tl.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(n!==void 0)if(t&&n.attributes!=null&&n.attributes.position!==void 0){const s=n.attributes.position;for(let o=0,a=s.count;o<a;o++)tl.fromBufferAttribute(s,o).applyMatrix4(e.matrixWorld),this.expandByPoint(tl)}else n.boundingBox===null&&n.computeBoundingBox(),dy.copy(n.boundingBox),dy.applyMatrix4(e.matrixWorld),this.union(dy);const r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,tl),tl.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(zh),Np.subVectors(this.max,zh),gc.subVectors(e.a,zh),vc.subVectors(e.b,zh),yc.subVectors(e.c,zh),$o.subVectors(vc,gc),Qo.subVectors(yc,vc),nl.subVectors(gc,yc);let t=[0,-$o.z,$o.y,0,-Qo.z,Qo.y,0,-nl.z,nl.y,$o.z,0,-$o.x,Qo.z,0,-Qo.x,nl.z,0,-nl.x,-$o.y,$o.x,0,-Qo.y,Qo.x,0,-nl.y,nl.x,0];return!fy(t,gc,vc,yc,Np)||(t=[1,0,0,0,1,0,0,0,1],!fy(t,gc,vc,yc,Np))?!1:(Up.crossVectors($o,Qo),t=[Up.x,Up.y,Up.z],fy(t,gc,vc,yc,Np))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return tl.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=this.getSize(tl).length()*.5,e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(lo[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),lo[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),lo[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),lo[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),lo[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),lo[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),lo[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),lo[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(lo),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}vr.prototype.isBox3=!0;const lo=[new B,new B,new B,new B,new B,new B,new B,new B],tl=new B,dy=new vr,gc=new B,vc=new B,yc=new B,$o=new B,Qo=new B,nl=new B,zh=new B,Np=new B,Up=new B,il=new B;function fy(i,e,t,n,r){for(let s=0,o=i.length-3;s<=o;s+=3){il.fromArray(i,s);const a=r.x*Math.abs(il.x)+r.y*Math.abs(il.y)+r.z*Math.abs(il.z),c=e.dot(il),h=t.dot(il),d=n.dot(il);if(Math.max(-Math.max(c,h,d),Math.min(c,h,d))>a)return!1}return!0}const VF=new vr,jM=new B,Hp=new B,py=new B;class zo{constructor(e=new B,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;t!==void 0?n.copy(t):VF.setFromPoints(e).getCenter(n);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,n.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){py.subVectors(e,this.center);const t=py.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),r=(n-this.radius)*.5;this.center.add(py.multiplyScalar(r/n)),this.radius+=r}return this}union(e){return this.center.equals(e.center)===!0?Hp.set(0,0,1).multiplyScalar(e.radius):Hp.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(jM.copy(e.center).add(Hp)),this.expandByPoint(jM.copy(e.center).sub(Hp)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const co=new B,my=new B,Vp=new B,Zo=new B,gy=new B,Gp=new B,vy=new B;class Oo{constructor(e=new B,t=new B(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,co)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=co.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(co.copy(this.direction).multiplyScalar(t).add(this.origin),co.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){my.copy(e).add(t).multiplyScalar(.5),Vp.copy(t).sub(e).normalize(),Zo.copy(this.origin).sub(my);const s=e.distanceTo(t)*.5,o=-this.direction.dot(Vp),a=Zo.dot(this.direction),c=-Zo.dot(Vp),h=Zo.lengthSq(),d=Math.abs(1-o*o);let l,u,p,g;if(d>0)if(l=o*c-a,u=o*a-c,g=s*d,l>=0)if(u>=-g)if(u<=g){const y=1/d;l*=y,u*=y,p=l*(l+o*u+2*a)+u*(o*l+u+2*c)+h}else u=s,l=Math.max(0,-(o*u+a)),p=-l*l+u*(u+2*c)+h;else u=-s,l=Math.max(0,-(o*u+a)),p=-l*l+u*(u+2*c)+h;else u<=-g?(l=Math.max(0,-(-o*s+a)),u=l>0?-s:Math.min(Math.max(-s,-c),s),p=-l*l+u*(u+2*c)+h):u<=g?(l=0,u=Math.min(Math.max(-s,-c),s),p=u*(u+2*c)+h):(l=Math.max(0,-(o*s+a)),u=l>0?s:Math.min(Math.max(-s,-c),s),p=-l*l+u*(u+2*c)+h);else u=o>0?-s:s,l=Math.max(0,-(o*u+a)),p=-l*l+u*(u+2*c)+h;return n&&n.copy(this.direction).multiplyScalar(l).add(this.origin),r&&r.copy(Vp).multiplyScalar(u).add(my),p}intersectSphere(e,t){co.subVectors(e.center,this.origin);const n=co.dot(this.direction),r=co.dot(co)-n*n,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=n-o,c=n+o;return a<0&&c<0?null:a<0?this.at(c,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,s,o,a,c;const h=1/this.direction.x,d=1/this.direction.y,l=1/this.direction.z,u=this.origin;return h>=0?(n=(e.min.x-u.x)*h,r=(e.max.x-u.x)*h):(n=(e.max.x-u.x)*h,r=(e.min.x-u.x)*h),d>=0?(s=(e.min.y-u.y)*d,o=(e.max.y-u.y)*d):(s=(e.max.y-u.y)*d,o=(e.min.y-u.y)*d),n>o||s>r||((s>n||n!==n)&&(n=s),(o<r||r!==r)&&(r=o),l>=0?(a=(e.min.z-u.z)*l,c=(e.max.z-u.z)*l):(a=(e.max.z-u.z)*l,c=(e.min.z-u.z)*l),n>c||a>r)||((a>n||n!==n)&&(n=a),(c<r||r!==r)&&(r=c),r<0)?null:this.at(n>=0?n:r,t)}intersectsBox(e){return this.intersectBox(e,co)!==null}intersectTriangle(e,t,n,r,s){gy.subVectors(t,e),Gp.subVectors(n,e),vy.crossVectors(gy,Gp);let o=this.direction.dot(vy),a;if(o>0){if(r)return null;a=1}else if(o<0)a=-1,o=-o;else return null;Zo.subVectors(this.origin,e);const c=a*this.direction.dot(Gp.crossVectors(Zo,Gp));if(c<0)return null;const h=a*this.direction.dot(gy.cross(Zo));if(h<0||c+h>o)return null;const d=-a*Zo.dot(vy);return d<0?null:this.at(d/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class st{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(e,t,n,r,s,o,a,c,h,d,l,u,p,g,y,x){const v=this.elements;return v[0]=e,v[4]=t,v[8]=n,v[12]=r,v[1]=s,v[5]=o,v[9]=a,v[13]=c,v[2]=h,v[6]=d,v[10]=l,v[14]=u,v[3]=p,v[7]=g,v[11]=y,v[15]=x,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new st().fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,r=1/xc.setFromMatrixColumn(e,0).length(),s=1/xc.setFromMatrixColumn(e,1).length(),o=1/xc.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*s,t[5]=n[5]*s,t[6]=n[6]*s,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const t=this.elements,n=e.x,r=e.y,s=e.z,o=Math.cos(n),a=Math.sin(n),c=Math.cos(r),h=Math.sin(r),d=Math.cos(s),l=Math.sin(s);if(e.order==="XYZ"){const u=o*d,p=o*l,g=a*d,y=a*l;t[0]=c*d,t[4]=-c*l,t[8]=h,t[1]=p+g*h,t[5]=u-y*h,t[9]=-a*c,t[2]=y-u*h,t[6]=g+p*h,t[10]=o*c}else if(e.order==="YXZ"){const u=c*d,p=c*l,g=h*d,y=h*l;t[0]=u+y*a,t[4]=g*a-p,t[8]=o*h,t[1]=o*l,t[5]=o*d,t[9]=-a,t[2]=p*a-g,t[6]=y+u*a,t[10]=o*c}else if(e.order==="ZXY"){const u=c*d,p=c*l,g=h*d,y=h*l;t[0]=u-y*a,t[4]=-o*l,t[8]=g+p*a,t[1]=p+g*a,t[5]=o*d,t[9]=y-u*a,t[2]=-o*h,t[6]=a,t[10]=o*c}else if(e.order==="ZYX"){const u=o*d,p=o*l,g=a*d,y=a*l;t[0]=c*d,t[4]=g*h-p,t[8]=u*h+y,t[1]=c*l,t[5]=y*h+u,t[9]=p*h-g,t[2]=-h,t[6]=a*c,t[10]=o*c}else if(e.order==="YZX"){const u=o*c,p=o*h,g=a*c,y=a*h;t[0]=c*d,t[4]=y-u*l,t[8]=g*l+p,t[1]=l,t[5]=o*d,t[9]=-a*d,t[2]=-h*d,t[6]=p*l+g,t[10]=u-y*l}else if(e.order==="XZY"){const u=o*c,p=o*h,g=a*c,y=a*h;t[0]=c*d,t[4]=-l,t[8]=h*d,t[1]=u*l+y,t[5]=o*d,t[9]=p*l-g,t[2]=g*l-p,t[6]=a*d,t[10]=y*l+u}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(GF,e,WF)}lookAt(e,t,n){const r=this.elements;return br.subVectors(e,t),br.lengthSq()===0&&(br.z=1),br.normalize(),Ko.crossVectors(n,br),Ko.lengthSq()===0&&(Math.abs(n.z)===1?br.x+=1e-4:br.z+=1e-4,br.normalize(),Ko.crossVectors(n,br)),Ko.normalize(),Wp.crossVectors(br,Ko),r[0]=Ko.x,r[4]=Wp.x,r[8]=br.x,r[1]=Ko.y,r[5]=Wp.y,r[9]=br.y,r[2]=Ko.z,r[6]=Wp.z,r[10]=br.z,this}multiply(e,t){return t!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,o=n[0],a=n[4],c=n[8],h=n[12],d=n[1],l=n[5],u=n[9],p=n[13],g=n[2],y=n[6],x=n[10],v=n[14],w=n[3],S=n[7],b=n[11],E=n[15],R=r[0],z=r[4],I=r[8],N=r[12],F=r[1],C=r[5],O=r[9],X=r[13],U=r[2],te=r[6],ne=r[10],j=r[14],k=r[3],W=r[7],Y=r[11],H=r[15];return s[0]=o*R+a*F+c*U+h*k,s[4]=o*z+a*C+c*te+h*W,s[8]=o*I+a*O+c*ne+h*Y,s[12]=o*N+a*X+c*j+h*H,s[1]=d*R+l*F+u*U+p*k,s[5]=d*z+l*C+u*te+p*W,s[9]=d*I+l*O+u*ne+p*Y,s[13]=d*N+l*X+u*j+p*H,s[2]=g*R+y*F+x*U+v*k,s[6]=g*z+y*C+x*te+v*W,s[10]=g*I+y*O+x*ne+v*Y,s[14]=g*N+y*X+x*j+v*H,s[3]=w*R+S*F+b*U+E*k,s[7]=w*z+S*C+b*te+E*W,s[11]=w*I+S*O+b*ne+E*Y,s[15]=w*N+S*X+b*j+E*H,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],s=e[12],o=e[1],a=e[5],c=e[9],h=e[13],d=e[2],l=e[6],u=e[10],p=e[14],g=e[3],y=e[7],x=e[11],v=e[15];return g*(+s*c*l-r*h*l-s*a*u+n*h*u+r*a*p-n*c*p)+y*(+t*c*p-t*h*u+s*o*u-r*o*p+r*h*d-s*c*d)+x*(+t*h*l-t*a*p-s*o*l+n*o*p+s*a*d-n*h*d)+v*(-r*a*d-t*c*l+t*a*u+r*o*l-n*o*u+n*c*d)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],h=e[7],d=e[8],l=e[9],u=e[10],p=e[11],g=e[12],y=e[13],x=e[14],v=e[15],w=l*x*h-y*u*h+y*c*p-a*x*p-l*c*v+a*u*v,S=g*u*h-d*x*h-g*c*p+o*x*p+d*c*v-o*u*v,b=d*y*h-g*l*h+g*a*p-o*y*p-d*a*v+o*l*v,E=g*l*c-d*y*c-g*a*u+o*y*u+d*a*x-o*l*x,R=t*w+n*S+r*b+s*E;if(R===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const z=1/R;return e[0]=w*z,e[1]=(y*u*s-l*x*s-y*r*p+n*x*p+l*r*v-n*u*v)*z,e[2]=(a*x*s-y*c*s+y*r*h-n*x*h-a*r*v+n*c*v)*z,e[3]=(l*c*s-a*u*s-l*r*h+n*u*h+a*r*p-n*c*p)*z,e[4]=S*z,e[5]=(d*x*s-g*u*s+g*r*p-t*x*p-d*r*v+t*u*v)*z,e[6]=(g*c*s-o*x*s-g*r*h+t*x*h+o*r*v-t*c*v)*z,e[7]=(o*u*s-d*c*s+d*r*h-t*u*h-o*r*p+t*c*p)*z,e[8]=b*z,e[9]=(g*l*s-d*y*s-g*n*p+t*y*p+d*n*v-t*l*v)*z,e[10]=(o*y*s-g*a*s+g*n*h-t*y*h-o*n*v+t*a*v)*z,e[11]=(d*a*s-o*l*s-d*n*h+t*l*h+o*n*p-t*a*p)*z,e[12]=E*z,e[13]=(d*y*r-g*l*r+g*n*u-t*y*u-d*n*x+t*l*x)*z,e[14]=(g*a*r-o*y*r-g*n*c+t*y*c+o*n*x-t*a*x)*z,e[15]=(o*l*r-d*a*r+d*n*c-t*l*c-o*n*u+t*a*u)*z,this}scale(e){const t=this.elements,n=e.x,r=e.y,s=e.z;return t[0]*=n,t[4]*=r,t[8]*=s,t[1]*=n,t[5]*=r,t[9]*=s,t[2]*=n,t[6]*=r,t[10]*=s,t[3]*=n,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}makeTranslation(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),s=1-n,o=e.x,a=e.y,c=e.z,h=s*o,d=s*a;return this.set(h*o+n,h*a-r*c,h*c+r*a,0,h*a+r*c,d*a+n,d*c-r*o,0,h*c-r*a,d*c+r*o,s*c*c+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,s,o){return this.set(1,n,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,s=t._x,o=t._y,a=t._z,c=t._w,h=s+s,d=o+o,l=a+a,u=s*h,p=s*d,g=s*l,y=o*d,x=o*l,v=a*l,w=c*h,S=c*d,b=c*l,E=n.x,R=n.y,z=n.z;return r[0]=(1-(y+v))*E,r[1]=(p+b)*E,r[2]=(g-S)*E,r[3]=0,r[4]=(p-b)*R,r[5]=(1-(u+v))*R,r[6]=(x+w)*R,r[7]=0,r[8]=(g+S)*z,r[9]=(x-w)*z,r[10]=(1-(u+y))*z,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;let s=xc.set(r[0],r[1],r[2]).length();const o=xc.set(r[4],r[5],r[6]).length(),a=xc.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],us.copy(this);const h=1/s,d=1/o,l=1/a;return us.elements[0]*=h,us.elements[1]*=h,us.elements[2]*=h,us.elements[4]*=d,us.elements[5]*=d,us.elements[6]*=d,us.elements[8]*=l,us.elements[9]*=l,us.elements[10]*=l,t.setFromRotationMatrix(us),n.x=s,n.y=o,n.z=a,this}makePerspective(e,t,n,r,s,o){o===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const a=this.elements,c=2*s/(t-e),h=2*s/(n-r),d=(t+e)/(t-e),l=(n+r)/(n-r),u=-(o+s)/(o-s),p=-2*o*s/(o-s);return a[0]=c,a[4]=0,a[8]=d,a[12]=0,a[1]=0,a[5]=h,a[9]=l,a[13]=0,a[2]=0,a[6]=0,a[10]=u,a[14]=p,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,n,r,s,o){const a=this.elements,c=1/(t-e),h=1/(n-r),d=1/(o-s),l=(t+e)*c,u=(n+r)*h,p=(o+s)*d;return a[0]=2*c,a[4]=0,a[8]=0,a[12]=-l,a[1]=0,a[5]=2*h,a[9]=0,a[13]=-u,a[2]=0,a[6]=0,a[10]=-2*d,a[14]=-p,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}st.prototype.isMatrix4=!0;const xc=new B,us=new st,GF=new B(0,0,0),WF=new B(1,1,1),Ko=new B,Wp=new B,br=new B,XM=new st,qM=new qt;class Et{constructor(e=0,t=0,n=0,r=Et.DefaultOrder){this._x=e,this._y=t,this._z=n,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,r=this._order){return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const r=e.elements,s=r[0],o=r[4],a=r[8],c=r[1],h=r[5],d=r[9],l=r[2],u=r[6],p=r[10];switch(t){case"XYZ":this._y=Math.asin(Jn(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-d,p),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(u,h),this._z=0);break;case"YXZ":this._x=Math.asin(-Jn(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(a,p),this._z=Math.atan2(c,h)):(this._y=Math.atan2(-l,s),this._z=0);break;case"ZXY":this._x=Math.asin(Jn(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(-l,p),this._z=Math.atan2(-o,h)):(this._y=0,this._z=Math.atan2(c,s));break;case"ZYX":this._y=Math.asin(-Jn(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(u,p),this._z=Math.atan2(c,s)):(this._x=0,this._z=Math.atan2(-o,h));break;case"YZX":this._z=Math.asin(Jn(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-d,h),this._y=Math.atan2(-l,s)):(this._x=0,this._y=Math.atan2(a,p));break;case"XZY":this._z=Math.asin(-Jn(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(u,h),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-d,p),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return XM.makeRotationFromQuaternion(e),this.setFromRotationMatrix(XM,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return qM.setFromEuler(this),this.setFromQuaternion(qM,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}Et.prototype.isEuler=!0;Et.DefaultOrder="XYZ";Et.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class Rl{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let jF=0;const YM=new B,wc=new qt,uo=new st,jp=new B,Oh=new B,XF=new B,qF=new qt,$M=new B(1,0,0),QM=new B(0,1,0),ZM=new B(0,0,1),YF={type:"added"},KM={type:"removed"};class ft extends Bo{constructor(){super(),Object.defineProperty(this,"id",{value:jF++}),this.uuid=Ir(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=ft.DefaultUp.clone();const e=new B,t=new Et,n=new qt,r=new B(1,1,1);function s(){n.setFromEuler(t,!1)}function o(){t.setFromQuaternion(n,void 0,!1)}t._onChange(s),n._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new st},normalMatrix:{value:new ai}}),this.matrix=new st,this.matrixWorld=new st,this.matrixAutoUpdate=ft.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Rl,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return wc.setFromAxisAngle(e,t),this.quaternion.multiply(wc),this}rotateOnWorldAxis(e,t){return wc.setFromAxisAngle(e,t),this.quaternion.premultiply(wc),this}rotateX(e){return this.rotateOnAxis($M,e)}rotateY(e){return this.rotateOnAxis(QM,e)}rotateZ(e){return this.rotateOnAxis(ZM,e)}translateOnAxis(e,t){return YM.copy(e).applyQuaternion(this.quaternion),this.position.add(YM.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis($M,e)}translateY(e){return this.translateOnAxis(QM,e)}translateZ(e){return this.translateOnAxis(ZM,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(uo.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?jp.copy(e):jp.set(e,t,n);const r=this.parent;this.updateWorldMatrix(!0,!1),Oh.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?uo.lookAt(Oh,jp,this.up):uo.lookAt(jp,Oh,this.up),this.quaternion.setFromRotationMatrix(uo),r&&(uo.extractRotation(r.matrixWorld),wc.setFromRotationMatrix(uo),this.quaternion.premultiply(wc.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(YF)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(KM)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(KM)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),uo.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),uo.multiply(e.parent.matrixWorld)),e.applyMatrix4(uo),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,r=this.children.length;n<r;n++){const o=this.children[n].getObjectByProperty(e,t);if(o!==void 0)return o}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Oh,e,XF),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Oh,qF,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(e===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const r=this.children;for(let s=0,o=r.length;s<o;s++)r[s].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON()));function s(a,c){return a[c.uuid]===void 0&&(a[c.uuid]=c.toJSON(e)),c.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const c=a.shapes;if(Array.isArray(c))for(let h=0,d=c.length;h<d;h++){const l=c[h];s(e.shapes,l)}else s(e.shapes,c)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let c=0,h=this.material.length;c<h;c++)a.push(s(e.materials,this.material[c]));r.material=a}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++){const c=this.animations[a];r.animations.push(s(e.animations,c))}}if(t){const a=o(e.geometries),c=o(e.materials),h=o(e.textures),d=o(e.images),l=o(e.shapes),u=o(e.skeletons),p=o(e.animations),g=o(e.nodes);a.length>0&&(n.geometries=a),c.length>0&&(n.materials=c),h.length>0&&(n.textures=h),d.length>0&&(n.images=d),l.length>0&&(n.shapes=l),u.length>0&&(n.skeletons=u),p.length>0&&(n.animations=p),g.length>0&&(n.nodes=g)}return n.object=r,n;function o(a){const c=[];for(const h in a){const d=a[h];delete d.metadata,c.push(d)}return c}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){const r=e.children[n];this.add(r.clone())}return this}}ft.DefaultUp=new B(0,1,0);ft.DefaultMatrixAutoUpdate=!0;ft.prototype.isObject3D=!0;const hs=new B,ho=new B,yy=new B,fo=new B,_c=new B,Sc=new B,JM=new B,xy=new B,wy=new B,_y=new B;class ti{constructor(e=new B,t=new B,n=new B){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),hs.subVectors(e,t),r.cross(hs);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,n,r,s){hs.subVectors(r,t),ho.subVectors(n,t),yy.subVectors(e,t);const o=hs.dot(hs),a=hs.dot(ho),c=hs.dot(yy),h=ho.dot(ho),d=ho.dot(yy),l=o*h-a*a;if(l===0)return s.set(-2,-1,-1);const u=1/l,p=(h*c-a*d)*u,g=(o*d-a*c)*u;return s.set(1-p-g,g,p)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,fo),fo.x>=0&&fo.y>=0&&fo.x+fo.y<=1}static getUV(e,t,n,r,s,o,a,c){return this.getBarycoord(e,t,n,r,fo),c.set(0,0),c.addScaledVector(s,fo.x),c.addScaledVector(o,fo.y),c.addScaledVector(a,fo.z),c}static isFrontFacing(e,t,n,r){return hs.subVectors(n,t),ho.subVectors(e,t),hs.cross(ho).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return hs.subVectors(this.c,this.b),ho.subVectors(this.a,this.b),hs.cross(ho).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return ti.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return ti.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,n,r,s){return ti.getUV(e,this.a,this.b,this.c,t,n,r,s)}containsPoint(e){return ti.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return ti.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,s=this.c;let o,a;_c.subVectors(r,n),Sc.subVectors(s,n),xy.subVectors(e,n);const c=_c.dot(xy),h=Sc.dot(xy);if(c<=0&&h<=0)return t.copy(n);wy.subVectors(e,r);const d=_c.dot(wy),l=Sc.dot(wy);if(d>=0&&l<=d)return t.copy(r);const u=c*l-d*h;if(u<=0&&c>=0&&d<=0)return o=c/(c-d),t.copy(n).addScaledVector(_c,o);_y.subVectors(e,s);const p=_c.dot(_y),g=Sc.dot(_y);if(g>=0&&p<=g)return t.copy(s);const y=p*h-c*g;if(y<=0&&h>=0&&g<=0)return a=h/(h-g),t.copy(n).addScaledVector(Sc,a);const x=d*g-p*l;if(x<=0&&l-d>=0&&p-g>=0)return JM.subVectors(s,r),a=(l-d)/(l-d+(p-g)),t.copy(r).addScaledVector(JM,a);const v=1/(x+y+u);return o=y*v,a=u*v,t.copy(n).addScaledVector(_c,o).addScaledVector(Sc,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let $F=0;class An extends Bo{constructor(){super(),Object.defineProperty(this,"id",{value:$F++}),this.uuid=Ir(),this.name="",this.type="Material",this.fog=!0,this.blending=El,this.side=Pa,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=K_,this.blendDst=J_,this.blendEquation=ml,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Rg,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=x3,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Jm,this.stencilZFail=Jm,this.stencilZPass=Jm,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const n=e[t];if(n===void 0){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}if(t==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===Z_;continue}const r=this[t];if(r===void 0){console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.");continue}r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==El&&(n.blending=this.blending),this.side!==Pa&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(n.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=this.flatShading),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),JSON.stringify(this.userData)!=="{}"&&(n.userData=this.userData);function r(s){const o=[];for(const a in s){const c=s[a];delete c.metadata,o.push(c)}return o}if(t){const s=r(e.textures),o=r(e.images);s.length>0&&(n.textures=s),o.length>0&&(n.images=o)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(t!==null){const r=t.length;n=new Array(r);for(let s=0;s!==r;++s)n[s]=t[s].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}An.prototype.isMaterial=!0;An.fromType=function(){return null};class Bt extends An{constructor(e){super(),this.type="MeshBasicMaterial",this.color=new qe(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=uf,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}Bt.prototype.isMeshBasicMaterial=!0;const si=new B,Xp=new Me;class zt{constructor(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n===!0,this.usage=bu,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}copyColorsArray(e){const t=this.array;let n=0;for(let r=0,s=e.length;r<s;r++){let o=e[r];o===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),o=new qe),t[n++]=o.r,t[n++]=o.g,t[n++]=o.b}return this}copyVector2sArray(e){const t=this.array;let n=0;for(let r=0,s=e.length;r<s;r++){let o=e[r];o===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),o=new Me),t[n++]=o.x,t[n++]=o.y}return this}copyVector3sArray(e){const t=this.array;let n=0;for(let r=0,s=e.length;r<s;r++){let o=e[r];o===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),o=new B),t[n++]=o.x,t[n++]=o.y,t[n++]=o.z}return this}copyVector4sArray(e){const t=this.array;let n=0;for(let r=0,s=e.length;r<s;r++){let o=e[r];o===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),o=new Jt),t[n++]=o.x,t[n++]=o.y,t[n++]=o.z,t[n++]=o.w}return this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)Xp.fromBufferAttribute(this,t),Xp.applyMatrix3(e),this.setXY(t,Xp.x,Xp.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)si.fromBufferAttribute(this,t),si.applyMatrix3(e),this.setXYZ(t,si.x,si.y,si.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)si.fromBufferAttribute(this,t),si.applyMatrix4(e),this.setXYZ(t,si.x,si.y,si.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)si.fromBufferAttribute(this,t),si.applyNormalMatrix(e),this.setXYZ(t,si.x,si.y,si.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)si.fromBufferAttribute(this,t),si.transformDirection(e),this.setXYZ(t,si.x,si.y,si.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){return this.array[e*this.itemSize]}setX(e,t){return this.array[e*this.itemSize]=t,this}getY(e){return this.array[e*this.itemSize+1]}setY(e,t){return this.array[e*this.itemSize+1]=t,this}getZ(e){return this.array[e*this.itemSize+2]}setZ(e,t){return this.array[e*this.itemSize+2]=t,this}getW(e){return this.array[e*this.itemSize+3]}setW(e,t){return this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,s){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==bu&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}}zt.prototype.isBufferAttribute=!0;class T3 extends zt{constructor(e,t,n){super(new Int8Array(e),t,n)}}class A3 extends zt{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class C3 extends zt{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class P3 extends zt{constructor(e,t,n){super(new Int16Array(e),t,n)}}class df extends zt{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class R3 extends zt{constructor(e,t,n){super(new Int32Array(e),t,n)}}class uv extends zt{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class L3 extends zt{constructor(e,t,n){super(new Uint16Array(e),t,n)}}L3.prototype.isFloat16BufferAttribute=!0;class lt extends zt{constructor(e,t,n){super(new Float32Array(e),t,n)}}class k3 extends zt{constructor(e,t,n){super(new Float64Array(e),t,n)}}let QF=0;const qr=new st,Sy=new ft,bc=new B,Mr=new vr,Nh=new vr,yi=new B;class vt extends Bo{constructor(){super(),Object.defineProperty(this,"id",{value:QF++}),this.uuid=Ir(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(_3(e)?uv:df)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const s=new ai().getNormalMatrix(e);n.applyNormalMatrix(s),n.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return qr.makeRotationFromQuaternion(e),this.applyMatrix4(qr),this}rotateX(e){return qr.makeRotationX(e),this.applyMatrix4(qr),this}rotateY(e){return qr.makeRotationY(e),this.applyMatrix4(qr),this}rotateZ(e){return qr.makeRotationZ(e),this.applyMatrix4(qr),this}translate(e,t,n){return qr.makeTranslation(e,t,n),this.applyMatrix4(qr),this}scale(e,t,n){return qr.makeScale(e,t,n),this.applyMatrix4(qr),this}lookAt(e){return Sy.lookAt(e),Sy.updateMatrix(),this.applyMatrix4(Sy.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(bc).negate(),this.translate(bc.x,bc.y,bc.z),this}setFromPoints(e){const t=[];for(let n=0,r=e.length;n<r;n++){const s=e[n];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new lt(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new vr);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new B(-1/0,-1/0,-1/0),new B(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++){const s=t[n];Mr.setFromBufferAttribute(s),this.morphTargetsRelative?(yi.addVectors(this.boundingBox.min,Mr.min),this.boundingBox.expandByPoint(yi),yi.addVectors(this.boundingBox.max,Mr.max),this.boundingBox.expandByPoint(yi)):(this.boundingBox.expandByPoint(Mr.min),this.boundingBox.expandByPoint(Mr.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new zo);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new B,1/0);return}if(e){const n=this.boundingSphere.center;if(Mr.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++){const a=t[s];Nh.setFromBufferAttribute(a),this.morphTargetsRelative?(yi.addVectors(Mr.min,Nh.min),Mr.expandByPoint(yi),yi.addVectors(Mr.max,Nh.max),Mr.expandByPoint(yi)):(Mr.expandByPoint(Nh.min),Mr.expandByPoint(Nh.max))}Mr.getCenter(n);let r=0;for(let s=0,o=e.count;s<o;s++)yi.fromBufferAttribute(e,s),r=Math.max(r,n.distanceToSquared(yi));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],c=this.morphTargetsRelative;for(let h=0,d=a.count;h<d;h++)yi.fromBufferAttribute(a,h),c&&(bc.fromBufferAttribute(e,h),yi.add(bc)),r=Math.max(r,n.distanceToSquared(yi))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=e.array,r=t.position.array,s=t.normal.array,o=t.uv.array,a=r.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new zt(new Float32Array(4*a),4));const c=this.getAttribute("tangent").array,h=[],d=[];for(let F=0;F<a;F++)h[F]=new B,d[F]=new B;const l=new B,u=new B,p=new B,g=new Me,y=new Me,x=new Me,v=new B,w=new B;function S(F,C,O){l.fromArray(r,F*3),u.fromArray(r,C*3),p.fromArray(r,O*3),g.fromArray(o,F*2),y.fromArray(o,C*2),x.fromArray(o,O*2),u.sub(l),p.sub(l),y.sub(g),x.sub(g);const X=1/(y.x*x.y-x.x*y.y);!isFinite(X)||(v.copy(u).multiplyScalar(x.y).addScaledVector(p,-y.y).multiplyScalar(X),w.copy(p).multiplyScalar(y.x).addScaledVector(u,-x.x).multiplyScalar(X),h[F].add(v),h[C].add(v),h[O].add(v),d[F].add(w),d[C].add(w),d[O].add(w))}let b=this.groups;b.length===0&&(b=[{start:0,count:n.length}]);for(let F=0,C=b.length;F<C;++F){const O=b[F],X=O.start,U=O.count;for(let te=X,ne=X+U;te<ne;te+=3)S(n[te+0],n[te+1],n[te+2])}const E=new B,R=new B,z=new B,I=new B;function N(F){z.fromArray(s,F*3),I.copy(z);const C=h[F];E.copy(C),E.sub(z.multiplyScalar(z.dot(C))).normalize(),R.crossVectors(I,C);const X=R.dot(d[F])<0?-1:1;c[F*4]=E.x,c[F*4+1]=E.y,c[F*4+2]=E.z,c[F*4+3]=X}for(let F=0,C=b.length;F<C;++F){const O=b[F],X=O.start,U=O.count;for(let te=X,ne=X+U;te<ne;te+=3)N(n[te+0]),N(n[te+1]),N(n[te+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new zt(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let u=0,p=n.count;u<p;u++)n.setXYZ(u,0,0,0);const r=new B,s=new B,o=new B,a=new B,c=new B,h=new B,d=new B,l=new B;if(e)for(let u=0,p=e.count;u<p;u+=3){const g=e.getX(u+0),y=e.getX(u+1),x=e.getX(u+2);r.fromBufferAttribute(t,g),s.fromBufferAttribute(t,y),o.fromBufferAttribute(t,x),d.subVectors(o,s),l.subVectors(r,s),d.cross(l),a.fromBufferAttribute(n,g),c.fromBufferAttribute(n,y),h.fromBufferAttribute(n,x),a.add(d),c.add(d),h.add(d),n.setXYZ(g,a.x,a.y,a.z),n.setXYZ(y,c.x,c.y,c.z),n.setXYZ(x,h.x,h.y,h.z)}else for(let u=0,p=t.count;u<p;u+=3)r.fromBufferAttribute(t,u+0),s.fromBufferAttribute(t,u+1),o.fromBufferAttribute(t,u+2),d.subVectors(o,s),l.subVectors(r,s),d.cross(l),n.setXYZ(u+0,d.x,d.y,d.z),n.setXYZ(u+1,d.x,d.y,d.z),n.setXYZ(u+2,d.x,d.y,d.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(e,t){if(!(e&&e.isBufferGeometry)){console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);return}t===void 0&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const n=this.attributes;for(const r in n){if(e.attributes[r]===void 0)continue;const o=n[r].array,a=e.attributes[r],c=a.array,h=a.itemSize*t,d=Math.min(c.length,o.length-h);for(let l=0,u=h;l<d;l++,u++)o[u]=c[l]}return this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)yi.fromBufferAttribute(e,t),yi.normalize(),e.setXYZ(t,yi.x,yi.y,yi.z)}toNonIndexed(){function e(a,c){const h=a.array,d=a.itemSize,l=a.normalized,u=new h.constructor(c.length*d);let p=0,g=0;for(let y=0,x=c.length;y<x;y++){a.isInterleavedBufferAttribute?p=c[y]*a.data.stride+a.offset:p=c[y]*d;for(let v=0;v<d;v++)u[g++]=h[p++]}return new zt(u,d,l)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new vt,n=this.index.array,r=this.attributes;for(const a in r){const c=r[a],h=e(c,n);t.setAttribute(a,h)}const s=this.morphAttributes;for(const a in s){const c=[],h=s[a];for(let d=0,l=h.length;d<l;d++){const u=h[d],p=e(u,n);c.push(p)}t.morphAttributes[a]=c}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,c=o.length;a<c;a++){const h=o[a];t.addGroup(h.start,h.count,h.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const c=this.parameters;for(const h in c)c[h]!==void 0&&(e[h]=c[h]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const c in n){const h=n[c];e.data.attributes[c]=h.toJSON(e.data)}const r={};let s=!1;for(const c in this.morphAttributes){const h=this.morphAttributes[c],d=[];for(let l=0,u=h.length;l<u;l++){const p=h[l];d.push(p.toJSON(e.data))}d.length>0&&(r[c]=d,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone(t));const r=e.attributes;for(const h in r){const d=r[h];this.setAttribute(h,d.clone(t))}const s=e.morphAttributes;for(const h in s){const d=[],l=s[h];for(let u=0,p=l.length;u<p;u++)d.push(l[u].clone(t));this.morphAttributes[h]=d}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let h=0,d=o.length;h<d;h++){const l=o[h];this.addGroup(l.start,l.count,l.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const c=e.boundingSphere;return c!==null&&(this.boundingSphere=c.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,e.parameters!==void 0&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}vt.prototype.isBufferGeometry=!0;const eE=new st,Mc=new Oo,by=new zo,Jo=new B,ea=new B,ta=new B,My=new B,Ey=new B,Ty=new B,qp=new B,Yp=new B,$p=new B,Qp=new Me,Zp=new Me,Kp=new Me,Ay=new B,Jp=new B;class je extends ft{constructor(e=new vt,t=new Bt){super(),this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}else{const t=e.morphTargets;t!==void 0&&t.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(e,t){const n=this.geometry,r=this.material,s=this.matrixWorld;if(r===void 0||(n.boundingSphere===null&&n.computeBoundingSphere(),by.copy(n.boundingSphere),by.applyMatrix4(s),e.ray.intersectsSphere(by)===!1)||(eE.copy(s).invert(),Mc.copy(e.ray).applyMatrix4(eE),n.boundingBox!==null&&Mc.intersectsBox(n.boundingBox)===!1))return;let o;if(n.isBufferGeometry){const a=n.index,c=n.attributes.position,h=n.morphAttributes.position,d=n.morphTargetsRelative,l=n.attributes.uv,u=n.attributes.uv2,p=n.groups,g=n.drawRange;if(a!==null)if(Array.isArray(r))for(let y=0,x=p.length;y<x;y++){const v=p[y],w=r[v.materialIndex],S=Math.max(v.start,g.start),b=Math.min(a.count,Math.min(v.start+v.count,g.start+g.count));for(let E=S,R=b;E<R;E+=3){const z=a.getX(E),I=a.getX(E+1),N=a.getX(E+2);o=em(this,w,e,Mc,c,h,d,l,u,z,I,N),o&&(o.faceIndex=Math.floor(E/3),o.face.materialIndex=v.materialIndex,t.push(o))}}else{const y=Math.max(0,g.start),x=Math.min(a.count,g.start+g.count);for(let v=y,w=x;v<w;v+=3){const S=a.getX(v),b=a.getX(v+1),E=a.getX(v+2);o=em(this,r,e,Mc,c,h,d,l,u,S,b,E),o&&(o.faceIndex=Math.floor(v/3),t.push(o))}}else if(c!==void 0)if(Array.isArray(r))for(let y=0,x=p.length;y<x;y++){const v=p[y],w=r[v.materialIndex],S=Math.max(v.start,g.start),b=Math.min(c.count,Math.min(v.start+v.count,g.start+g.count));for(let E=S,R=b;E<R;E+=3){const z=E,I=E+1,N=E+2;o=em(this,w,e,Mc,c,h,d,l,u,z,I,N),o&&(o.faceIndex=Math.floor(E/3),o.face.materialIndex=v.materialIndex,t.push(o))}}else{const y=Math.max(0,g.start),x=Math.min(c.count,g.start+g.count);for(let v=y,w=x;v<w;v+=3){const S=v,b=v+1,E=v+2;o=em(this,r,e,Mc,c,h,d,l,u,S,b,E),o&&(o.faceIndex=Math.floor(v/3),t.push(o))}}}else n.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}je.prototype.isMesh=!0;function ZF(i,e,t,n,r,s,o,a){let c;if(e.side===kr?c=n.intersectTriangle(o,s,r,!0,a):c=n.intersectTriangle(r,s,o,e.side!==Es,a),c===null)return null;Jp.copy(a),Jp.applyMatrix4(i.matrixWorld);const h=t.ray.origin.distanceTo(Jp);return h<t.near||h>t.far?null:{distance:h,point:Jp.clone(),object:i}}function em(i,e,t,n,r,s,o,a,c,h,d,l){Jo.fromBufferAttribute(r,h),ea.fromBufferAttribute(r,d),ta.fromBufferAttribute(r,l);const u=i.morphTargetInfluences;if(s&&u){qp.set(0,0,0),Yp.set(0,0,0),$p.set(0,0,0);for(let g=0,y=s.length;g<y;g++){const x=u[g],v=s[g];x!==0&&(My.fromBufferAttribute(v,h),Ey.fromBufferAttribute(v,d),Ty.fromBufferAttribute(v,l),o?(qp.addScaledVector(My,x),Yp.addScaledVector(Ey,x),$p.addScaledVector(Ty,x)):(qp.addScaledVector(My.sub(Jo),x),Yp.addScaledVector(Ey.sub(ea),x),$p.addScaledVector(Ty.sub(ta),x)))}Jo.add(qp),ea.add(Yp),ta.add($p)}i.isSkinnedMesh&&(i.boneTransform(h,Jo),i.boneTransform(d,ea),i.boneTransform(l,ta));const p=ZF(i,e,t,n,Jo,ea,ta,Ay);if(p){a&&(Qp.fromBufferAttribute(a,h),Zp.fromBufferAttribute(a,d),Kp.fromBufferAttribute(a,l),p.uv=ti.getUV(Ay,Jo,ea,ta,Qp,Zp,Kp,new Me)),c&&(Qp.fromBufferAttribute(c,h),Zp.fromBufferAttribute(c,d),Kp.fromBufferAttribute(c,l),p.uv2=ti.getUV(Ay,Jo,ea,ta,Qp,Zp,Kp,new Me));const g={a:h,b:d,c:l,normal:new B,materialIndex:0};ti.getNormal(Jo,ea,ta,g.normal),p.face=g}return p}class dn extends vt{constructor(e=1,t=1,n=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const c=[],h=[],d=[],l=[];let u=0,p=0;g("z","y","x",-1,-1,n,t,e,o,s,0),g("z","y","x",1,-1,n,t,-e,o,s,1),g("x","z","y",1,1,e,n,t,r,o,2),g("x","z","y",1,-1,e,n,-t,r,o,3),g("x","y","z",1,-1,e,t,n,r,s,4),g("x","y","z",-1,-1,e,t,-n,r,s,5),this.setIndex(c),this.setAttribute("position",new lt(h,3)),this.setAttribute("normal",new lt(d,3)),this.setAttribute("uv",new lt(l,2));function g(y,x,v,w,S,b,E,R,z,I,N){const F=b/z,C=E/I,O=b/2,X=E/2,U=R/2,te=z+1,ne=I+1;let j=0,k=0;const W=new B;for(let Y=0;Y<ne;Y++){const H=Y*C-X;for(let J=0;J<te;J++){const K=J*F-O;W[y]=K*w,W[x]=H*S,W[v]=U,h.push(W.x,W.y,W.z),W[y]=0,W[x]=0,W[v]=R>0?1:-1,d.push(W.x,W.y,W.z),l.push(J/z),l.push(1-Y/I),j+=1}}for(let Y=0;Y<I;Y++)for(let H=0;H<z;H++){const J=u+H+te*Y,K=u+H+te*(Y+1),ee=u+(H+1)+te*(Y+1),$=u+(H+1)+te*Y;c.push(J,K,$),c.push(K,ee,$),k+=6}a.addGroup(p,k,N),p+=k,u+=j}}static fromJSON(e){return new dn(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Eu(i){const e={};for(const t in i){e[t]={};for(const n in i[t]){const r=i[t][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?e[t][n]=r.clone():Array.isArray(r)?e[t][n]=r.slice():e[t][n]=r}}return e}function Hi(i){const e={};for(let t=0;t<i.length;t++){const n=Eu(i[t]);for(const r in n)e[r]=n[r]}return e}const r1={clone:Eu,merge:Hi};var KF=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,JF=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class jn extends An{constructor(e){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=KF,this.fragmentShader=JF,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&(e.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Eu(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;o&&o.isTexture?t.uniforms[r]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[r]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[r]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[r]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[r]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[r]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[r]={type:"m4",value:o.toArray()}:t.uniforms[r]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const n={};for(const r in this.extensions)this.extensions[r]===!0&&(n[r]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}jn.prototype.isShaderMaterial=!0;class Xu extends ft{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new st,this.projectionMatrix=new st,this.projectionMatrixInverse=new st}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}Xu.prototype.isCamera=!0;class Mn extends Xu{constructor(e=50,t=1,n=.1,r=2e3){super(),this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=jd*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Cl*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return jd*2*Math.atan(Math.tan(Cl*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,n,r,s,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(Cl*.5*this.fov)/this.zoom,n=2*t,r=this.aspect*n,s=-.5*r;const o=this.view;if(this.view!==null&&this.view.enabled){const c=o.fullWidth,h=o.fullHeight;s+=o.offsetX*r/c,t-=o.offsetY*n/h,r*=o.width/c,n*=o.height/h}const a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-n,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}Mn.prototype.isPerspectiveCamera=!0;const Ec=90,Tc=1;class hv extends ft{constructor(e,t,n){if(super(),this.type="CubeCamera",n.isWebGLCubeRenderTarget!==!0){console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");return}this.renderTarget=n;const r=new Mn(Ec,Tc,e,t);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new B(1,0,0)),this.add(r);const s=new Mn(Ec,Tc,e,t);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new B(-1,0,0)),this.add(s);const o=new Mn(Ec,Tc,e,t);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(new B(0,1,0)),this.add(o);const a=new Mn(Ec,Tc,e,t);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(new B(0,-1,0)),this.add(a);const c=new Mn(Ec,Tc,e,t);c.layers=this.layers,c.up.set(0,-1,0),c.lookAt(new B(0,0,1)),this.add(c);const h=new Mn(Ec,Tc,e,t);h.layers=this.layers,h.up.set(0,-1,0),h.lookAt(new B(0,0,-1)),this.add(h)}update(e,t){this.parent===null&&this.updateMatrixWorld();const n=this.renderTarget,[r,s,o,a,c,h]=this.children,d=e.getRenderTarget(),l=e.outputEncoding,u=e.toneMapping,p=e.xr.enabled;e.outputEncoding=Ts,e.toneMapping=bs,e.xr.enabled=!1;const g=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,r),e.setRenderTarget(n,1),e.render(t,s),e.setRenderTarget(n,2),e.render(t,o),e.setRenderTarget(n,3),e.render(t,a),e.setRenderTarget(n,4),e.render(t,c),n.texture.generateMipmaps=g,e.setRenderTarget(n,5),e.render(t,h),e.setRenderTarget(d),e.outputEncoding=l,e.toneMapping=u,e.xr.enabled=p,n.texture.needsPMREMUpdate=!0}}class qu extends hn{constructor(e,t,n,r,s,o,a,c,h,d){e=e!==void 0?e:[],t=t!==void 0?t:Ra,super(e,t,n,r,s,o,a,c,h,d),this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}qu.prototype.isCubeTexture=!0;class dv extends Gi{constructor(e,t={}){super(e,e,t);const n={width:e,height:e,depth:1},r=[n,n,n,n,n,n];this.texture=new qu(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:jt}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new dn(5,5,5),s=new jn({name:"CubemapFromEquirect",uniforms:Eu(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:kr,blending:Mo});s.uniforms.tEquirect.value=t;const o=new je(r,s),a=t.minFilter;return t.minFilter===Do&&(t.minFilter=jt),new hv(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,n,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,n,r);e.setRenderTarget(s)}}dv.prototype.isWebGLCubeRenderTarget=!0;const Cy=new B,eD=new B,tD=new ai;class vs{constructor(e=new B(1,0,0),t=0){this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const r=Cy.subVectors(n,t).cross(eD.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){const n=e.delta(Cy),r=this.normal.dot(n);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(n).multiplyScalar(s).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||tD.getNormalMatrix(e),r=this.coplanarPoint(Cy).applyMatrix4(e),s=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}vs.prototype.isPlane=!0;const Ac=new zo,tm=new B;class ff{constructor(e=new vs,t=new vs,n=new vs,r=new vs,s=new vs,o=new vs){this.planes=[e,t,n,r,s,o]}set(e,t,n,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(n),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e){const t=this.planes,n=e.elements,r=n[0],s=n[1],o=n[2],a=n[3],c=n[4],h=n[5],d=n[6],l=n[7],u=n[8],p=n[9],g=n[10],y=n[11],x=n[12],v=n[13],w=n[14],S=n[15];return t[0].setComponents(a-r,l-c,y-u,S-x).normalize(),t[1].setComponents(a+r,l+c,y+u,S+x).normalize(),t[2].setComponents(a+s,l+h,y+p,S+v).normalize(),t[3].setComponents(a-s,l-h,y-p,S-v).normalize(),t[4].setComponents(a-o,l-d,y-g,S-w).normalize(),t[5].setComponents(a+o,l+d,y+g,S+w).normalize(),this}intersectsObject(e){const t=e.geometry;return t.boundingSphere===null&&t.computeBoundingSphere(),Ac.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Ac)}intersectsSprite(e){return Ac.center.set(0,0,0),Ac.radius=.7071067811865476,Ac.applyMatrix4(e.matrixWorld),this.intersectsSphere(Ac)}intersectsSphere(e){const t=this.planes,n=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const r=t[n];if(tm.x=r.normal.x>0?e.max.x:e.min.x,tm.y=r.normal.y>0?e.max.y:e.min.y,tm.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(tm)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function I3(){let i=null,e=!1,t=null,n=null;function r(s,o){t(s,o),n=i.requestAnimationFrame(r)}return{start:function(){e!==!0&&t!==null&&(n=i.requestAnimationFrame(r),e=!0)},stop:function(){i.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){i=s}}}function nD(i,e){const t=e.isWebGL2,n=new WeakMap;function r(h,d){const l=h.array,u=h.usage,p=i.createBuffer();i.bindBuffer(d,p),i.bufferData(d,l,u),h.onUploadCallback();let g;if(l instanceof Float32Array)g=5126;else if(l instanceof Uint16Array)if(h.isFloat16BufferAttribute)if(t)g=5131;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else g=5123;else if(l instanceof Int16Array)g=5122;else if(l instanceof Uint32Array)g=5125;else if(l instanceof Int32Array)g=5124;else if(l instanceof Int8Array)g=5120;else if(l instanceof Uint8Array)g=5121;else if(l instanceof Uint8ClampedArray)g=5121;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+l);return{buffer:p,type:g,bytesPerElement:l.BYTES_PER_ELEMENT,version:h.version}}function s(h,d,l){const u=d.array,p=d.updateRange;i.bindBuffer(l,h),p.count===-1?i.bufferSubData(l,0,u):(t?i.bufferSubData(l,p.offset*u.BYTES_PER_ELEMENT,u,p.offset,p.count):i.bufferSubData(l,p.offset*u.BYTES_PER_ELEMENT,u.subarray(p.offset,p.offset+p.count)),p.count=-1)}function o(h){return h.isInterleavedBufferAttribute&&(h=h.data),n.get(h)}function a(h){h.isInterleavedBufferAttribute&&(h=h.data);const d=n.get(h);d&&(i.deleteBuffer(d.buffer),n.delete(h))}function c(h,d){if(h.isGLBufferAttribute){const u=n.get(h);(!u||u.version<h.version)&&n.set(h,{buffer:h.buffer,type:h.type,bytesPerElement:h.elementSize,version:h.version});return}h.isInterleavedBufferAttribute&&(h=h.data);const l=n.get(h);l===void 0?n.set(h,r(h,d)):l.version<h.version&&(s(l.buffer,h,d),l.version=h.version)}return{get:o,remove:a,update:c}}class xn extends vt{constructor(e=1,t=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(n),c=Math.floor(r),h=a+1,d=c+1,l=e/a,u=t/c,p=[],g=[],y=[],x=[];for(let v=0;v<d;v++){const w=v*u-o;for(let S=0;S<h;S++){const b=S*l-s;g.push(b,-w,0),y.push(0,0,1),x.push(S/a),x.push(1-v/c)}}for(let v=0;v<c;v++)for(let w=0;w<a;w++){const S=w+h*v,b=w+h*(v+1),E=w+1+h*(v+1),R=w+1+h*v;p.push(S,b,R),p.push(b,E,R)}this.setIndex(p),this.setAttribute("position",new lt(g,3)),this.setAttribute("normal",new lt(y,3)),this.setAttribute("uv",new lt(x,2))}static fromJSON(e){return new xn(e.width,e.height,e.widthSegments,e.heightSegments)}}var iD=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,rD=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,sD=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,oD=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,aD=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,lD=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,cD="vec3 transformed = vec3( position );",uD=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,hD=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,dD=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,fD=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,pD=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,mD=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,gD=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,vD=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,yD=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,xD=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,wD=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,_D=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,SD=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		vec2 uv = getUV( direction, face ) * ( faceSize - 1.0 ) + 0.5;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define r0 1.0
	#define v0 0.339
	#define m0 - 2.0
	#define r1 0.8
	#define v1 0.276
	#define m1 - 1.0
	#define r4 0.4
	#define v4 0.046
	#define m4 2.0
	#define r5 0.305
	#define v5 0.016
	#define m5 3.0
	#define r6 0.21
	#define v6 0.0038
	#define m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= r1 ) {
			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;
		} else if ( roughness >= r4 ) {
			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;
		} else if ( roughness >= r5 ) {
			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;
		} else if ( roughness >= r6 ) {
			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,bD=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,MD=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,ED=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,TD=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,AD=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,CD="gl_FragColor = linearToOutputTexel( gl_FragColor );",PD=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,RD=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,LD=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,kD=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,ID=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,FD=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,DD=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,BD=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,zD=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,OD=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,ND=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,UD=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,HD=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,VD=`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointLightInfo( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotLightInfo( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );
		#endif
	}
	#pragma unroll_loop_end
#endif`,GD=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,WD=`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,jD=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,XD=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,qD=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,YD=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,$D=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,QD=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	vec3 FssEss = specularColor * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,ZD=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,KD=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,JD=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,eB=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,tB=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,nB=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,iB=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,rB=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,sB=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,oB=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,aB=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,lB=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,cB=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,uB=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,hB=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,dB=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,fB=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,pB=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,mB=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,gB=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,vB=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,yB=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,xB=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,wB=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,_B=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,SB=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,bB=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,MB=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,EB=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,TB=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,AB=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,CB=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,PB=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,RB=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,LB=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,kB=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,IB=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,FB=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,DB=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,BB=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,zB=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,OB=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,NB=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,UB=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,HB=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,VB=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,GB=`#ifdef USE_TRANSMISSION
	float transmissionAlpha = 1.0;
	float transmissionFactor = transmission;
	float thicknessFactor = thickness;
	#ifdef USE_TRANSMISSIONMAP
		transmissionFactor *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		thicknessFactor *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,
		attenuationColor, attenuationDistance );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );
	transmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );
#endif`,WB=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef texture2DLodEXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( attenuationDistance == 0.0 ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,jB=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,XB=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,qB=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,YB=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,$B=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,QB=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,ZB=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const KB=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,JB=`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	gl_FragColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		gl_FragColor = vec4( mix( pow( gl_FragColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), gl_FragColor.rgb * 0.0773993808, vec3( lessThanEqual( gl_FragColor.rgb, vec3( 0.04045 ) ) ) ), gl_FragColor.w );
	#endif
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,ez=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,tz=`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,nz=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,iz=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,rz=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,sz=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,oz=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,az=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,lz=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,cz=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,uz=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,hz=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,dz=`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fz=`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,pz=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,mz=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,gz=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,vz=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,yz=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,xz=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,wz=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,_z=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Sz=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,bz=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Mz=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,Ez=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Tz=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Az=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,Cz=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Pz=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,Gt={alphamap_fragment:iD,alphamap_pars_fragment:rD,alphatest_fragment:sD,alphatest_pars_fragment:oD,aomap_fragment:aD,aomap_pars_fragment:lD,begin_vertex:cD,beginnormal_vertex:uD,bsdfs:hD,bumpmap_pars_fragment:dD,clipping_planes_fragment:fD,clipping_planes_pars_fragment:pD,clipping_planes_pars_vertex:mD,clipping_planes_vertex:gD,color_fragment:vD,color_pars_fragment:yD,color_pars_vertex:xD,color_vertex:wD,common:_D,cube_uv_reflection_fragment:SD,defaultnormal_vertex:bD,displacementmap_pars_vertex:MD,displacementmap_vertex:ED,emissivemap_fragment:TD,emissivemap_pars_fragment:AD,encodings_fragment:CD,encodings_pars_fragment:PD,envmap_fragment:RD,envmap_common_pars_fragment:LD,envmap_pars_fragment:kD,envmap_pars_vertex:ID,envmap_physical_pars_fragment:WD,envmap_vertex:FD,fog_vertex:DD,fog_pars_vertex:BD,fog_fragment:zD,fog_pars_fragment:OD,gradientmap_pars_fragment:ND,lightmap_fragment:UD,lightmap_pars_fragment:HD,lights_lambert_vertex:VD,lights_pars_begin:GD,lights_toon_fragment:jD,lights_toon_pars_fragment:XD,lights_phong_fragment:qD,lights_phong_pars_fragment:YD,lights_physical_fragment:$D,lights_physical_pars_fragment:QD,lights_fragment_begin:ZD,lights_fragment_maps:KD,lights_fragment_end:JD,logdepthbuf_fragment:eB,logdepthbuf_pars_fragment:tB,logdepthbuf_pars_vertex:nB,logdepthbuf_vertex:iB,map_fragment:rB,map_pars_fragment:sB,map_particle_fragment:oB,map_particle_pars_fragment:aB,metalnessmap_fragment:lB,metalnessmap_pars_fragment:cB,morphcolor_vertex:uB,morphnormal_vertex:hB,morphtarget_pars_vertex:dB,morphtarget_vertex:fB,normal_fragment_begin:pB,normal_fragment_maps:mB,normal_pars_fragment:gB,normal_pars_vertex:vB,normal_vertex:yB,normalmap_pars_fragment:xB,clearcoat_normal_fragment_begin:wB,clearcoat_normal_fragment_maps:_B,clearcoat_pars_fragment:SB,output_fragment:bB,packing:MB,premultiplied_alpha_fragment:EB,project_vertex:TB,dithering_fragment:AB,dithering_pars_fragment:CB,roughnessmap_fragment:PB,roughnessmap_pars_fragment:RB,shadowmap_pars_fragment:LB,shadowmap_pars_vertex:kB,shadowmap_vertex:IB,shadowmask_pars_fragment:FB,skinbase_vertex:DB,skinning_pars_vertex:BB,skinning_vertex:zB,skinnormal_vertex:OB,specularmap_fragment:NB,specularmap_pars_fragment:UB,tonemapping_fragment:HB,tonemapping_pars_fragment:VB,transmission_fragment:GB,transmission_pars_fragment:WB,uv_pars_fragment:jB,uv_pars_vertex:XB,uv_vertex:qB,uv2_pars_fragment:YB,uv2_pars_vertex:$B,uv2_vertex:QB,worldpos_vertex:ZB,background_vert:KB,background_frag:JB,cube_vert:ez,cube_frag:tz,depth_vert:nz,depth_frag:iz,distanceRGBA_vert:rz,distanceRGBA_frag:sz,equirect_vert:oz,equirect_frag:az,linedashed_vert:lz,linedashed_frag:cz,meshbasic_vert:uz,meshbasic_frag:hz,meshlambert_vert:dz,meshlambert_frag:fz,meshmatcap_vert:pz,meshmatcap_frag:mz,meshnormal_vert:gz,meshnormal_frag:vz,meshphong_vert:yz,meshphong_frag:xz,meshphysical_vert:wz,meshphysical_frag:_z,meshtoon_vert:Sz,meshtoon_frag:bz,points_vert:Mz,points_frag:Ez,shadow_vert:Tz,shadow_frag:Az,sprite_vert:Cz,sprite_frag:Pz},ot={common:{diffuse:{value:new qe(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new ai},uv2Transform:{value:new ai},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Me(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new qe(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new qe(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new ai}},sprite:{diffuse:{value:new qe(16777215)},opacity:{value:1},center:{value:new Me(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new ai}}},ys={basic:{uniforms:Hi([ot.common,ot.specularmap,ot.envmap,ot.aomap,ot.lightmap,ot.fog]),vertexShader:Gt.meshbasic_vert,fragmentShader:Gt.meshbasic_frag},lambert:{uniforms:Hi([ot.common,ot.specularmap,ot.envmap,ot.aomap,ot.lightmap,ot.emissivemap,ot.fog,ot.lights,{emissive:{value:new qe(0)}}]),vertexShader:Gt.meshlambert_vert,fragmentShader:Gt.meshlambert_frag},phong:{uniforms:Hi([ot.common,ot.specularmap,ot.envmap,ot.aomap,ot.lightmap,ot.emissivemap,ot.bumpmap,ot.normalmap,ot.displacementmap,ot.fog,ot.lights,{emissive:{value:new qe(0)},specular:{value:new qe(1118481)},shininess:{value:30}}]),vertexShader:Gt.meshphong_vert,fragmentShader:Gt.meshphong_frag},standard:{uniforms:Hi([ot.common,ot.envmap,ot.aomap,ot.lightmap,ot.emissivemap,ot.bumpmap,ot.normalmap,ot.displacementmap,ot.roughnessmap,ot.metalnessmap,ot.fog,ot.lights,{emissive:{value:new qe(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Gt.meshphysical_vert,fragmentShader:Gt.meshphysical_frag},toon:{uniforms:Hi([ot.common,ot.aomap,ot.lightmap,ot.emissivemap,ot.bumpmap,ot.normalmap,ot.displacementmap,ot.gradientmap,ot.fog,ot.lights,{emissive:{value:new qe(0)}}]),vertexShader:Gt.meshtoon_vert,fragmentShader:Gt.meshtoon_frag},matcap:{uniforms:Hi([ot.common,ot.bumpmap,ot.normalmap,ot.displacementmap,ot.fog,{matcap:{value:null}}]),vertexShader:Gt.meshmatcap_vert,fragmentShader:Gt.meshmatcap_frag},points:{uniforms:Hi([ot.points,ot.fog]),vertexShader:Gt.points_vert,fragmentShader:Gt.points_frag},dashed:{uniforms:Hi([ot.common,ot.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Gt.linedashed_vert,fragmentShader:Gt.linedashed_frag},depth:{uniforms:Hi([ot.common,ot.displacementmap]),vertexShader:Gt.depth_vert,fragmentShader:Gt.depth_frag},normal:{uniforms:Hi([ot.common,ot.bumpmap,ot.normalmap,ot.displacementmap,{opacity:{value:1}}]),vertexShader:Gt.meshnormal_vert,fragmentShader:Gt.meshnormal_frag},sprite:{uniforms:Hi([ot.sprite,ot.fog]),vertexShader:Gt.sprite_vert,fragmentShader:Gt.sprite_frag},background:{uniforms:{uvTransform:{value:new ai},t2D:{value:null}},vertexShader:Gt.background_vert,fragmentShader:Gt.background_frag},cube:{uniforms:Hi([ot.envmap,{opacity:{value:1}}]),vertexShader:Gt.cube_vert,fragmentShader:Gt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Gt.equirect_vert,fragmentShader:Gt.equirect_frag},distanceRGBA:{uniforms:Hi([ot.common,ot.displacementmap,{referencePosition:{value:new B},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Gt.distanceRGBA_vert,fragmentShader:Gt.distanceRGBA_frag},shadow:{uniforms:Hi([ot.lights,ot.fog,{color:{value:new qe(0)},opacity:{value:1}}]),vertexShader:Gt.shadow_vert,fragmentShader:Gt.shadow_frag}};ys.physical={uniforms:Hi([ys.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Me(1,1)},clearcoatNormalMap:{value:null},sheen:{value:0},sheenColor:{value:new qe(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Me},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new qe(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new qe(1,1,1)},specularColorMap:{value:null}}]),vertexShader:Gt.meshphysical_vert,fragmentShader:Gt.meshphysical_frag};function Rz(i,e,t,n,r,s){const o=new qe(0);let a=r===!0?0:1,c,h,d=null,l=0,u=null;function p(y,x){let v=!1,w=x.isScene===!0?x.background:null;w&&w.isTexture&&(w=e.get(w));const S=i.xr,b=S.getSession&&S.getSession();b&&b.environmentBlendMode==="additive"&&(w=null),w===null?g(o,a):w&&w.isColor&&(g(w,1),v=!0),(i.autoClear||v)&&i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil),w&&(w.isCubeTexture||w.mapping===Wu)?(h===void 0&&(h=new je(new dn(1,1,1),new jn({name:"BackgroundCubeMaterial",uniforms:Eu(ys.cube.uniforms),vertexShader:ys.cube.vertexShader,fragmentShader:ys.cube.fragmentShader,side:kr,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),h.geometry.deleteAttribute("uv"),h.onBeforeRender=function(E,R,z){this.matrixWorld.copyPosition(z.matrixWorld)},Object.defineProperty(h.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(h)),h.material.uniforms.envMap.value=w,h.material.uniforms.flipEnvMap.value=w.isCubeTexture&&w.isRenderTargetTexture===!1?-1:1,(d!==w||l!==w.version||u!==i.toneMapping)&&(h.material.needsUpdate=!0,d=w,l=w.version,u=i.toneMapping),y.unshift(h,h.geometry,h.material,0,0,null)):w&&w.isTexture&&(c===void 0&&(c=new je(new xn(2,2),new jn({name:"BackgroundMaterial",uniforms:Eu(ys.background.uniforms),vertexShader:ys.background.vertexShader,fragmentShader:ys.background.fragmentShader,side:Pa,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(c)),c.material.uniforms.t2D.value=w,w.matrixAutoUpdate===!0&&w.updateMatrix(),c.material.uniforms.uvTransform.value.copy(w.matrix),(d!==w||l!==w.version||u!==i.toneMapping)&&(c.material.needsUpdate=!0,d=w,l=w.version,u=i.toneMapping),y.unshift(c,c.geometry,c.material,0,0,null))}function g(y,x){t.buffers.color.setClear(y.r,y.g,y.b,x,s)}return{getClearColor:function(){return o},setClearColor:function(y,x=1){o.set(y),a=x,g(o,a)},getClearAlpha:function(){return a},setClearAlpha:function(y){a=y,g(o,a)},render:p}}function Lz(i,e,t,n){const r=i.getParameter(34921),s=n.isWebGL2?null:e.get("OES_vertex_array_object"),o=n.isWebGL2||s!==null,a={},c=x(null);let h=c,d=!1;function l(U,te,ne,j,k){let W=!1;if(o){const Y=y(j,ne,te);h!==Y&&(h=Y,p(h.object)),W=v(j,k),W&&w(j,k)}else{const Y=te.wireframe===!0;(h.geometry!==j.id||h.program!==ne.id||h.wireframe!==Y)&&(h.geometry=j.id,h.program=ne.id,h.wireframe=Y,W=!0)}U.isInstancedMesh===!0&&(W=!0),k!==null&&t.update(k,34963),(W||d)&&(d=!1,I(U,te,ne,j),k!==null&&i.bindBuffer(34963,t.get(k).buffer))}function u(){return n.isWebGL2?i.createVertexArray():s.createVertexArrayOES()}function p(U){return n.isWebGL2?i.bindVertexArray(U):s.bindVertexArrayOES(U)}function g(U){return n.isWebGL2?i.deleteVertexArray(U):s.deleteVertexArrayOES(U)}function y(U,te,ne){const j=ne.wireframe===!0;let k=a[U.id];k===void 0&&(k={},a[U.id]=k);let W=k[te.id];W===void 0&&(W={},k[te.id]=W);let Y=W[j];return Y===void 0&&(Y=x(u()),W[j]=Y),Y}function x(U){const te=[],ne=[],j=[];for(let k=0;k<r;k++)te[k]=0,ne[k]=0,j[k]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:te,enabledAttributes:ne,attributeDivisors:j,object:U,attributes:{},index:null}}function v(U,te){const ne=h.attributes,j=U.attributes;let k=0;for(const W in j){const Y=ne[W],H=j[W];if(Y===void 0||Y.attribute!==H||Y.data!==H.data)return!0;k++}return h.attributesNum!==k||h.index!==te}function w(U,te){const ne={},j=U.attributes;let k=0;for(const W in j){const Y=j[W],H={};H.attribute=Y,Y.data&&(H.data=Y.data),ne[W]=H,k++}h.attributes=ne,h.attributesNum=k,h.index=te}function S(){const U=h.newAttributes;for(let te=0,ne=U.length;te<ne;te++)U[te]=0}function b(U){E(U,0)}function E(U,te){const ne=h.newAttributes,j=h.enabledAttributes,k=h.attributeDivisors;ne[U]=1,j[U]===0&&(i.enableVertexAttribArray(U),j[U]=1),k[U]!==te&&((n.isWebGL2?i:e.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](U,te),k[U]=te)}function R(){const U=h.newAttributes,te=h.enabledAttributes;for(let ne=0,j=te.length;ne<j;ne++)te[ne]!==U[ne]&&(i.disableVertexAttribArray(ne),te[ne]=0)}function z(U,te,ne,j,k,W){n.isWebGL2===!0&&(ne===5124||ne===5125)?i.vertexAttribIPointer(U,te,ne,k,W):i.vertexAttribPointer(U,te,ne,j,k,W)}function I(U,te,ne,j){if(n.isWebGL2===!1&&(U.isInstancedMesh||j.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;S();const k=j.attributes,W=ne.getAttributes(),Y=te.defaultAttributeValues;for(const H in W){const J=W[H];if(J.location>=0){let K=k[H];if(K===void 0&&(H==="instanceMatrix"&&U.instanceMatrix&&(K=U.instanceMatrix),H==="instanceColor"&&U.instanceColor&&(K=U.instanceColor)),K!==void 0){const ee=K.normalized,$=K.itemSize,Z=t.get(K);if(Z===void 0)continue;const Ee=Z.buffer,Se=Z.type,de=Z.bytesPerElement;if(K.isInterleavedBufferAttribute){const he=K.data,Ce=he.stride,me=K.offset;if(he.isInstancedInterleavedBuffer){for(let fe=0;fe<J.locationSize;fe++)E(J.location+fe,he.meshPerAttribute);U.isInstancedMesh!==!0&&j._maxInstanceCount===void 0&&(j._maxInstanceCount=he.meshPerAttribute*he.count)}else for(let fe=0;fe<J.locationSize;fe++)b(J.location+fe);i.bindBuffer(34962,Ee);for(let fe=0;fe<J.locationSize;fe++)z(J.location+fe,$/J.locationSize,Se,ee,Ce*de,(me+$/J.locationSize*fe)*de)}else{if(K.isInstancedBufferAttribute){for(let he=0;he<J.locationSize;he++)E(J.location+he,K.meshPerAttribute);U.isInstancedMesh!==!0&&j._maxInstanceCount===void 0&&(j._maxInstanceCount=K.meshPerAttribute*K.count)}else for(let he=0;he<J.locationSize;he++)b(J.location+he);i.bindBuffer(34962,Ee);for(let he=0;he<J.locationSize;he++)z(J.location+he,$/J.locationSize,Se,ee,$*de,$/J.locationSize*he*de)}}else if(Y!==void 0){const ee=Y[H];if(ee!==void 0)switch(ee.length){case 2:i.vertexAttrib2fv(J.location,ee);break;case 3:i.vertexAttrib3fv(J.location,ee);break;case 4:i.vertexAttrib4fv(J.location,ee);break;default:i.vertexAttrib1fv(J.location,ee)}}}}R()}function N(){O();for(const U in a){const te=a[U];for(const ne in te){const j=te[ne];for(const k in j)g(j[k].object),delete j[k];delete te[ne]}delete a[U]}}function F(U){if(a[U.id]===void 0)return;const te=a[U.id];for(const ne in te){const j=te[ne];for(const k in j)g(j[k].object),delete j[k];delete te[ne]}delete a[U.id]}function C(U){for(const te in a){const ne=a[te];if(ne[U.id]===void 0)continue;const j=ne[U.id];for(const k in j)g(j[k].object),delete j[k];delete ne[U.id]}}function O(){X(),d=!0,h!==c&&(h=c,p(h.object))}function X(){c.geometry=null,c.program=null,c.wireframe=!1}return{setup:l,reset:O,resetDefaultState:X,dispose:N,releaseStatesOfGeometry:F,releaseStatesOfProgram:C,initAttributes:S,enableAttribute:b,disableUnusedAttributes:R}}function kz(i,e,t,n){const r=n.isWebGL2;let s;function o(h){s=h}function a(h,d){i.drawArrays(s,h,d),t.update(d,s,1)}function c(h,d,l){if(l===0)return;let u,p;if(r)u=i,p="drawArraysInstanced";else if(u=e.get("ANGLE_instanced_arrays"),p="drawArraysInstancedANGLE",u===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}u[p](s,h,d,l),t.update(d,s,l)}this.setMode=o,this.render=a,this.renderInstances=c}function Iz(i,e,t){let n;function r(){if(n!==void 0)return n;if(e.has("EXT_texture_filter_anisotropic")===!0){const z=e.get("EXT_texture_filter_anisotropic");n=i.getParameter(z.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n}function s(z){if(z==="highp"){if(i.getShaderPrecisionFormat(35633,36338).precision>0&&i.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";z="mediump"}return z==="mediump"&&i.getShaderPrecisionFormat(35633,36337).precision>0&&i.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext!="undefined"&&i instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext!="undefined"&&i instanceof WebGL2ComputeRenderingContext;let a=t.precision!==void 0?t.precision:"highp";const c=s(a);c!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",c,"instead."),a=c);const h=o||e.has("WEBGL_draw_buffers"),d=t.logarithmicDepthBuffer===!0,l=i.getParameter(34930),u=i.getParameter(35660),p=i.getParameter(3379),g=i.getParameter(34076),y=i.getParameter(34921),x=i.getParameter(36347),v=i.getParameter(36348),w=i.getParameter(36349),S=u>0,b=o||e.has("OES_texture_float"),E=S&&b,R=o?i.getParameter(36183):0;return{isWebGL2:o,drawBuffers:h,getMaxAnisotropy:r,getMaxPrecision:s,precision:a,logarithmicDepthBuffer:d,maxTextures:l,maxVertexTextures:u,maxTextureSize:p,maxCubemapSize:g,maxAttributes:y,maxVertexUniforms:x,maxVaryings:v,maxFragmentUniforms:w,vertexTextures:S,floatFragmentTextures:b,floatVertexTextures:E,maxSamples:R}}function Fz(i){const e=this;let t=null,n=0,r=!1,s=!1;const o=new vs,a=new ai,c={value:null,needsUpdate:!1};this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(l,u,p){const g=l.length!==0||u||n!==0||r;return r=u,t=d(l,p,0),n=l.length,g},this.beginShadows=function(){s=!0,d(null)},this.endShadows=function(){s=!1,h()},this.setState=function(l,u,p){const g=l.clippingPlanes,y=l.clipIntersection,x=l.clipShadows,v=i.get(l);if(!r||g===null||g.length===0||s&&!x)s?d(null):h();else{const w=s?0:n,S=w*4;let b=v.clippingState||null;c.value=b,b=d(g,u,S,p);for(let E=0;E!==S;++E)b[E]=t[E];v.clippingState=b,this.numIntersection=y?this.numPlanes:0,this.numPlanes+=w}};function h(){c.value!==t&&(c.value=t,c.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function d(l,u,p,g){const y=l!==null?l.length:0;let x=null;if(y!==0){if(x=c.value,g!==!0||x===null){const v=p+y*4,w=u.matrixWorldInverse;a.getNormalMatrix(w),(x===null||x.length<v)&&(x=new Float32Array(v));for(let S=0,b=p;S!==y;++S,b+=4)o.copy(l[S]).applyMatrix4(w,a),o.normal.toArray(x,b),x[b+3]=o.constant}c.value=x,c.needsUpdate=!0}return e.numPlanes=y,e.numIntersection=0,x}}function Dz(i){let e=new WeakMap;function t(o,a){return a===xu?o.mapping=Ra:a===Hd&&(o.mapping=La),o}function n(o){if(o&&o.isTexture&&o.isRenderTargetTexture===!1){const a=o.mapping;if(a===xu||a===Hd)if(e.has(o)){const c=e.get(o).texture;return t(c,o.mapping)}else{const c=o.image;if(c&&c.height>0){const h=new dv(c.height/2);return h.fromEquirectangularTexture(i,o),e.set(o,h),o.addEventListener("dispose",r),t(h.texture,o.mapping)}else return null}}return o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const c=e.get(a);c!==void 0&&(e.delete(a),c.dispose())}function s(){e=new WeakMap}return{get:n,dispose:s}}class Fr extends Xu{constructor(e=-1,t=1,n=1,r=-1,s=.1,o=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=n-e,o=n+e,a=r+t,c=r-t;if(this.view!==null&&this.view.enabled){const h=(this.right-this.left)/this.view.fullWidth/this.zoom,d=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=h*this.view.offsetX,o=s+h*this.view.width,a-=d*this.view.offsetY,c=a-d*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,c,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}Fr.prototype.isOrthographicCamera=!0;const tu=4,tE=[.125,.215,.35,.446,.526,.582],gl=20,Py=new Fr,nE=new qe;let Ry=null;const dl=(1+Math.sqrt(5))/2,Cc=1/dl,iE=[new B(1,1,1),new B(-1,1,1),new B(1,1,-1),new B(-1,1,-1),new B(0,dl,Cc),new B(0,dl,-Cc),new B(Cc,0,dl),new B(-Cc,0,dl),new B(dl,Cc,0),new B(-dl,Cc,0)];class Cw{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,r=100){Ry=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,n,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=oE(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=sE(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Ry),e.scissorTest=!1,nm(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Ra||e.mapping===La?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),Ry=this._renderer.getRenderTarget();const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize-32,n={magFilter:jt,minFilter:jt,generateMipmaps:!1,type:Tl,format:ur,encoding:Ts,depthBuffer:!1},r=rE(e,t,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=rE(e,t,n);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=Bz(s)),this._blurMaterial=zz(s,e,t)}return r}_compileMaterial(e){const t=new je(this._lodPlanes[0],e);this._renderer.compile(t,Py)}_sceneToCubeUV(e,t,n,r){const a=new Mn(90,1,t,n),c=[1,-1,1,1,1,1],h=[1,1,1,-1,-1,-1],d=this._renderer,l=d.autoClear,u=d.toneMapping;d.getClearColor(nE),d.toneMapping=bs,d.autoClear=!1;const p=new Bt({name:"PMREM.Background",side:kr,depthWrite:!1,depthTest:!1}),g=new je(new dn,p);let y=!1;const x=e.background;x?x.isColor&&(p.color.copy(x),e.background=null,y=!0):(p.color.copy(nE),y=!0);for(let v=0;v<6;v++){const w=v%3;w===0?(a.up.set(0,c[v],0),a.lookAt(h[v],0,0)):w===1?(a.up.set(0,0,c[v]),a.lookAt(0,h[v],0)):(a.up.set(0,c[v],0),a.lookAt(0,0,h[v]));const S=this._cubeSize;nm(r,w*S,v>2?S:0,S,S),d.setRenderTarget(r),y&&d.render(g,a),d.render(e,a)}g.geometry.dispose(),g.material.dispose(),d.toneMapping=u,d.autoClear=l,e.background=x}_textureToCubeUV(e,t){const n=this._renderer,r=e.mapping===Ra||e.mapping===La;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=oE()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=sE());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new je(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=e;const c=this._cubeSize;nm(t,0,0,3*c,2*c),n.setRenderTarget(t),n.render(o,Py)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),o=iE[(r-1)%iE.length];this._blur(e,r-1,r,s,o)}t.autoClear=n}_blur(e,t,n,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,n,r,"latitudinal",s),this._halfBlur(o,e,n,n,r,"longitudinal",s)}_halfBlur(e,t,n,r,s,o,a){const c=this._renderer,h=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const d=3,l=new je(this._lodPlanes[r],h),u=h.uniforms,p=this._sizeLods[n]-1,g=isFinite(s)?Math.PI/(2*p):2*Math.PI/(2*gl-1),y=s/g,x=isFinite(s)?1+Math.floor(d*y):gl;x>gl&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${x} samples when the maximum is set to ${gl}`);const v=[];let w=0;for(let z=0;z<gl;++z){const I=z/y,N=Math.exp(-I*I/2);v.push(N),z===0?w+=N:z<x&&(w+=2*N)}for(let z=0;z<v.length;z++)v[z]=v[z]/w;u.envMap.value=e.texture,u.samples.value=x,u.weights.value=v,u.latitudinal.value=o==="latitudinal",a&&(u.poleAxis.value=a);const{_lodMax:S}=this;u.dTheta.value=g,u.mipInt.value=S-n;const b=this._sizeLods[r],E=3*b*(r>S-tu?r-S+tu:0),R=4*(this._cubeSize-b);nm(t,E,R,3*b,2*b),c.setRenderTarget(t),c.render(l,Py)}}function Bz(i){const e=[],t=[],n=[];let r=i;const s=i-tu+1+tE.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let c=1/a;o>i-tu?c=tE[o-i+tu-1]:o===0&&(c=0),n.push(c);const h=1/(a-1),d=-h/2,l=1+h/2,u=[d,d,l,d,l,l,d,d,l,l,d,l],p=6,g=6,y=3,x=2,v=1,w=new Float32Array(y*g*p),S=new Float32Array(x*g*p),b=new Float32Array(v*g*p);for(let R=0;R<p;R++){const z=R%3*2/3-1,I=R>2?0:-1,N=[z,I,0,z+2/3,I,0,z+2/3,I+1,0,z,I,0,z+2/3,I+1,0,z,I+1,0];w.set(N,y*g*R),S.set(u,x*g*R);const F=[R,R,R,R,R,R];b.set(F,v*g*R)}const E=new vt;E.setAttribute("position",new zt(w,y)),E.setAttribute("uv",new zt(S,x)),E.setAttribute("faceIndex",new zt(b,v)),e.push(E),r>tu&&r--}return{lodPlanes:e,sizeLods:t,sigmas:n}}function rE(i,e,t){const n=new Gi(i,e,t);return n.texture.mapping=Wu,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function nm(i,e,t,n,r){i.viewport.set(e,t,n,r),i.scissor.set(e,t,n,r)}function zz(i,e,t){const n=new Float32Array(gl),r=new B(0,1,0);return new jn({name:"SphericalGaussianBlur",defines:{n:gl,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:s1(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Mo,depthTest:!1,depthWrite:!1})}function sE(){return new jn({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:s1(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Mo,depthTest:!1,depthWrite:!1})}function oE(){return new jn({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:s1(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Mo,depthTest:!1,depthWrite:!1})}function s1(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function Oz(i){let e=new WeakMap,t=null;function n(a){if(a&&a.isTexture){const c=a.mapping,h=c===xu||c===Hd,d=c===Ra||c===La;if(h||d)if(a.isRenderTargetTexture&&a.needsPMREMUpdate===!0){a.needsPMREMUpdate=!1;let l=e.get(a);return t===null&&(t=new Cw(i)),l=h?t.fromEquirectangular(a,l):t.fromCubemap(a,l),e.set(a,l),l.texture}else{if(e.has(a))return e.get(a).texture;{const l=a.image;if(h&&l&&l.height>0||d&&l&&r(l)){t===null&&(t=new Cw(i));const u=h?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,u),a.addEventListener("dispose",s),u.texture}else return null}}}return a}function r(a){let c=0;const h=6;for(let d=0;d<h;d++)a[d]!==void 0&&c++;return c===h}function s(a){const c=a.target;c.removeEventListener("dispose",s);const h=e.get(c);h!==void 0&&(e.delete(c),h.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:n,dispose:o}}function Nz(i){const e={};function t(n){if(e[n]!==void 0)return e[n];let r;switch(n){case"WEBGL_depth_texture":r=i.getExtension("WEBGL_depth_texture")||i.getExtension("MOZ_WEBGL_depth_texture")||i.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=i.getExtension("WEBGL_compressed_texture_s3tc")||i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=i.getExtension(n)}return e[n]=r,r}return{has:function(n){return t(n)!==null},init:function(n){n.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(n){const r=t(n);return r===null&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),r}}}function Uz(i,e,t,n){const r={},s=new WeakMap;function o(l){const u=l.target;u.index!==null&&e.remove(u.index);for(const g in u.attributes)e.remove(u.attributes[g]);u.removeEventListener("dispose",o),delete r[u.id];const p=s.get(u);p&&(e.remove(p),s.delete(u)),n.releaseStatesOfGeometry(u),u.isInstancedBufferGeometry===!0&&delete u._maxInstanceCount,t.memory.geometries--}function a(l,u){return r[u.id]===!0||(u.addEventListener("dispose",o),r[u.id]=!0,t.memory.geometries++),u}function c(l){const u=l.attributes;for(const g in u)e.update(u[g],34962);const p=l.morphAttributes;for(const g in p){const y=p[g];for(let x=0,v=y.length;x<v;x++)e.update(y[x],34962)}}function h(l){const u=[],p=l.index,g=l.attributes.position;let y=0;if(p!==null){const w=p.array;y=p.version;for(let S=0,b=w.length;S<b;S+=3){const E=w[S+0],R=w[S+1],z=w[S+2];u.push(E,R,R,z,z,E)}}else{const w=g.array;y=g.version;for(let S=0,b=w.length/3-1;S<b;S+=3){const E=S+0,R=S+1,z=S+2;u.push(E,R,R,z,z,E)}}const x=new(_3(u)?uv:df)(u,1);x.version=y;const v=s.get(l);v&&e.remove(v),s.set(l,x)}function d(l){const u=s.get(l);if(u){const p=l.index;p!==null&&u.version<p.version&&h(l)}else h(l);return s.get(l)}return{get:a,update:c,getWireframeAttribute:d}}function Hz(i,e,t,n){const r=n.isWebGL2;let s;function o(u){s=u}let a,c;function h(u){a=u.type,c=u.bytesPerElement}function d(u,p){i.drawElements(s,p,a,u*c),t.update(p,s,1)}function l(u,p,g){if(g===0)return;let y,x;if(r)y=i,x="drawElementsInstanced";else if(y=e.get("ANGLE_instanced_arrays"),x="drawElementsInstancedANGLE",y===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}y[x](s,p,a,u*c,g),t.update(p,s,g)}this.setMode=o,this.setIndex=h,this.render=d,this.renderInstances=l}function Vz(i){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function n(s,o,a){switch(t.calls++,o){case 4:t.triangles+=a*(s/3);break;case 1:t.lines+=a*(s/2);break;case 3:t.lines+=a*(s-1);break;case 2:t.lines+=a*s;break;case 0:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function r(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:r,update:n}}function Gz(i,e){return i[0]-e[0]}function Wz(i,e){return Math.abs(e[1])-Math.abs(i[1])}function Ly(i,e){let t=1;const n=e.isInterleavedBufferAttribute?e.data.array:e.array;n instanceof Int8Array?t=127:n instanceof Int16Array?t=32767:n instanceof Int32Array?t=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",n),i.divideScalar(t)}function jz(i,e,t){const n={},r=new Float32Array(8),s=new WeakMap,o=new Jt,a=[];for(let h=0;h<8;h++)a[h]=[h,0];function c(h,d,l,u){const p=h.morphTargetInfluences;if(e.isWebGL2===!0){const y=d.morphAttributes.position||d.morphAttributes.normal||d.morphAttributes.color,x=y!==void 0?y.length:0;let v=s.get(d);if(v===void 0||v.count!==x){let ne=function(){U.dispose(),s.delete(d),d.removeEventListener("dispose",ne)};var g=ne;v!==void 0&&v.texture.dispose();const b=d.morphAttributes.position!==void 0,E=d.morphAttributes.normal!==void 0,R=d.morphAttributes.color!==void 0,z=d.morphAttributes.position||[],I=d.morphAttributes.normal||[],N=d.morphAttributes.color||[];let F=0;b===!0&&(F=1),E===!0&&(F=2),R===!0&&(F=3);let C=d.attributes.position.count*F,O=1;C>e.maxTextureSize&&(O=Math.ceil(C/e.maxTextureSize),C=e.maxTextureSize);const X=new Float32Array(C*O*4*x),U=new ju(X,C,O,x);U.type=_o,U.needsUpdate=!0;const te=F*4;for(let j=0;j<x;j++){const k=z[j],W=I[j],Y=N[j],H=C*O*4*j;for(let J=0;J<k.count;J++){const K=J*te;b===!0&&(o.fromBufferAttribute(k,J),k.normalized===!0&&Ly(o,k),X[H+K+0]=o.x,X[H+K+1]=o.y,X[H+K+2]=o.z,X[H+K+3]=0),E===!0&&(o.fromBufferAttribute(W,J),W.normalized===!0&&Ly(o,W),X[H+K+4]=o.x,X[H+K+5]=o.y,X[H+K+6]=o.z,X[H+K+7]=0),R===!0&&(o.fromBufferAttribute(Y,J),Y.normalized===!0&&Ly(o,Y),X[H+K+8]=o.x,X[H+K+9]=o.y,X[H+K+10]=o.z,X[H+K+11]=Y.itemSize===4?o.w:1)}}v={count:x,texture:U,size:new Me(C,O)},s.set(d,v),d.addEventListener("dispose",ne)}let w=0;for(let b=0;b<p.length;b++)w+=p[b];const S=d.morphTargetsRelative?1:1-w;u.getUniforms().setValue(i,"morphTargetBaseInfluence",S),u.getUniforms().setValue(i,"morphTargetInfluences",p),u.getUniforms().setValue(i,"morphTargetsTexture",v.texture,t),u.getUniforms().setValue(i,"morphTargetsTextureSize",v.size)}else{const y=p===void 0?0:p.length;let x=n[d.id];if(x===void 0||x.length!==y){x=[];for(let E=0;E<y;E++)x[E]=[E,0];n[d.id]=x}for(let E=0;E<y;E++){const R=x[E];R[0]=E,R[1]=p[E]}x.sort(Wz);for(let E=0;E<8;E++)E<y&&x[E][1]?(a[E][0]=x[E][0],a[E][1]=x[E][1]):(a[E][0]=Number.MAX_SAFE_INTEGER,a[E][1]=0);a.sort(Gz);const v=d.morphAttributes.position,w=d.morphAttributes.normal;let S=0;for(let E=0;E<8;E++){const R=a[E],z=R[0],I=R[1];z!==Number.MAX_SAFE_INTEGER&&I?(v&&d.getAttribute("morphTarget"+E)!==v[z]&&d.setAttribute("morphTarget"+E,v[z]),w&&d.getAttribute("morphNormal"+E)!==w[z]&&d.setAttribute("morphNormal"+E,w[z]),r[E]=I,S+=I):(v&&d.hasAttribute("morphTarget"+E)===!0&&d.deleteAttribute("morphTarget"+E),w&&d.hasAttribute("morphNormal"+E)===!0&&d.deleteAttribute("morphNormal"+E),r[E]=0)}const b=d.morphTargetsRelative?1:1-S;u.getUniforms().setValue(i,"morphTargetBaseInfluence",b),u.getUniforms().setValue(i,"morphTargetInfluences",r)}}return{update:c}}function Xz(i,e,t,n){let r=new WeakMap;function s(c){const h=n.render.frame,d=c.geometry,l=e.get(c,d);return r.get(l)!==h&&(e.update(l),r.set(l,h)),c.isInstancedMesh&&(c.hasEventListener("dispose",a)===!1&&c.addEventListener("dispose",a),t.update(c.instanceMatrix,34962),c.instanceColor!==null&&t.update(c.instanceColor,34962)),l}function o(){r=new WeakMap}function a(c){const h=c.target;h.removeEventListener("dispose",a),t.remove(h.instanceMatrix),h.instanceColor!==null&&t.remove(h.instanceColor)}return{update:s,dispose:o}}const F3=new hn,D3=new ju,B3=new hf,z3=new qu,aE=[],lE=[],cE=new Float32Array(16),uE=new Float32Array(9),hE=new Float32Array(4);function Yu(i,e,t){const n=i[0];if(n<=0||n>0)return i;const r=e*t;let s=aE[r];if(s===void 0&&(s=new Float32Array(r),aE[r]=s),e!==0){n.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,i[o].toArray(s,a)}return s}function Ki(i,e){if(i.length!==e.length)return!1;for(let t=0,n=i.length;t<n;t++)if(i[t]!==e[t])return!1;return!0}function ji(i,e){for(let t=0,n=e.length;t<n;t++)i[t]=e[t]}function fv(i,e){let t=lE[e];t===void 0&&(t=new Int32Array(e),lE[e]=t);for(let n=0;n!==e;++n)t[n]=i.allocateTextureUnit();return t}function qz(i,e){const t=this.cache;t[0]!==e&&(i.uniform1f(this.addr,e),t[0]=e)}function Yz(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ki(t,e))return;i.uniform2fv(this.addr,e),ji(t,e)}}function $z(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(i.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Ki(t,e))return;i.uniform3fv(this.addr,e),ji(t,e)}}function Qz(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ki(t,e))return;i.uniform4fv(this.addr,e),ji(t,e)}}function Zz(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(Ki(t,e))return;i.uniformMatrix2fv(this.addr,!1,e),ji(t,e)}else{if(Ki(t,n))return;hE.set(n),i.uniformMatrix2fv(this.addr,!1,hE),ji(t,n)}}function Kz(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(Ki(t,e))return;i.uniformMatrix3fv(this.addr,!1,e),ji(t,e)}else{if(Ki(t,n))return;uE.set(n),i.uniformMatrix3fv(this.addr,!1,uE),ji(t,n)}}function Jz(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(Ki(t,e))return;i.uniformMatrix4fv(this.addr,!1,e),ji(t,e)}else{if(Ki(t,n))return;cE.set(n),i.uniformMatrix4fv(this.addr,!1,cE),ji(t,n)}}function e5(i,e){const t=this.cache;t[0]!==e&&(i.uniform1i(this.addr,e),t[0]=e)}function t5(i,e){const t=this.cache;Ki(t,e)||(i.uniform2iv(this.addr,e),ji(t,e))}function n5(i,e){const t=this.cache;Ki(t,e)||(i.uniform3iv(this.addr,e),ji(t,e))}function i5(i,e){const t=this.cache;Ki(t,e)||(i.uniform4iv(this.addr,e),ji(t,e))}function r5(i,e){const t=this.cache;t[0]!==e&&(i.uniform1ui(this.addr,e),t[0]=e)}function s5(i,e){const t=this.cache;Ki(t,e)||(i.uniform2uiv(this.addr,e),ji(t,e))}function o5(i,e){const t=this.cache;Ki(t,e)||(i.uniform3uiv(this.addr,e),ji(t,e))}function a5(i,e){const t=this.cache;Ki(t,e)||(i.uniform4uiv(this.addr,e),ji(t,e))}function l5(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture2D(e||F3,r)}function c5(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture3D(e||B3,r)}function u5(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTextureCube(e||z3,r)}function h5(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture2DArray(e||D3,r)}function d5(i){switch(i){case 5126:return qz;case 35664:return Yz;case 35665:return $z;case 35666:return Qz;case 35674:return Zz;case 35675:return Kz;case 35676:return Jz;case 5124:case 35670:return e5;case 35667:case 35671:return t5;case 35668:case 35672:return n5;case 35669:case 35673:return i5;case 5125:return r5;case 36294:return s5;case 36295:return o5;case 36296:return a5;case 35678:case 36198:case 36298:case 36306:case 35682:return l5;case 35679:case 36299:case 36307:return c5;case 35680:case 36300:case 36308:case 36293:return u5;case 36289:case 36303:case 36311:case 36292:return h5}}function f5(i,e){i.uniform1fv(this.addr,e)}function p5(i,e){const t=Yu(e,this.size,2);i.uniform2fv(this.addr,t)}function m5(i,e){const t=Yu(e,this.size,3);i.uniform3fv(this.addr,t)}function g5(i,e){const t=Yu(e,this.size,4);i.uniform4fv(this.addr,t)}function v5(i,e){const t=Yu(e,this.size,4);i.uniformMatrix2fv(this.addr,!1,t)}function y5(i,e){const t=Yu(e,this.size,9);i.uniformMatrix3fv(this.addr,!1,t)}function x5(i,e){const t=Yu(e,this.size,16);i.uniformMatrix4fv(this.addr,!1,t)}function w5(i,e){i.uniform1iv(this.addr,e)}function _5(i,e){i.uniform2iv(this.addr,e)}function S5(i,e){i.uniform3iv(this.addr,e)}function b5(i,e){i.uniform4iv(this.addr,e)}function M5(i,e){i.uniform1uiv(this.addr,e)}function E5(i,e){i.uniform2uiv(this.addr,e)}function T5(i,e){i.uniform3uiv(this.addr,e)}function A5(i,e){i.uniform4uiv(this.addr,e)}function C5(i,e,t){const n=e.length,r=fv(t,n);i.uniform1iv(this.addr,r);for(let s=0;s!==n;++s)t.setTexture2D(e[s]||F3,r[s])}function P5(i,e,t){const n=e.length,r=fv(t,n);i.uniform1iv(this.addr,r);for(let s=0;s!==n;++s)t.setTexture3D(e[s]||B3,r[s])}function R5(i,e,t){const n=e.length,r=fv(t,n);i.uniform1iv(this.addr,r);for(let s=0;s!==n;++s)t.setTextureCube(e[s]||z3,r[s])}function L5(i,e,t){const n=e.length,r=fv(t,n);i.uniform1iv(this.addr,r);for(let s=0;s!==n;++s)t.setTexture2DArray(e[s]||D3,r[s])}function k5(i){switch(i){case 5126:return f5;case 35664:return p5;case 35665:return m5;case 35666:return g5;case 35674:return v5;case 35675:return y5;case 35676:return x5;case 5124:case 35670:return w5;case 35667:case 35671:return _5;case 35668:case 35672:return S5;case 35669:case 35673:return b5;case 5125:return M5;case 36294:return E5;case 36295:return T5;case 36296:return A5;case 35678:case 36198:case 36298:case 36306:case 35682:return C5;case 35679:case 36299:case 36307:return P5;case 35680:case 36300:case 36308:case 36293:return R5;case 36289:case 36303:case 36311:case 36292:return L5}}function I5(i,e,t){this.id=i,this.addr=t,this.cache=[],this.setValue=d5(e.type)}function O3(i,e,t){this.id=i,this.addr=t,this.cache=[],this.size=e.size,this.setValue=k5(e.type)}O3.prototype.updateCache=function(i){const e=this.cache;i instanceof Float32Array&&e.length!==i.length&&(this.cache=new Float32Array(i.length)),ji(e,i)};function N3(i){this.id=i,this.seq=[],this.map={}}N3.prototype.setValue=function(i,e,t){const n=this.seq;for(let r=0,s=n.length;r!==s;++r){const o=n[r];o.setValue(i,e[o.id],t)}};const ky=/(\w+)(\])?(\[|\.)?/g;function dE(i,e){i.seq.push(e),i.map[e.id]=e}function F5(i,e,t){const n=i.name,r=n.length;for(ky.lastIndex=0;;){const s=ky.exec(n),o=ky.lastIndex;let a=s[1];const c=s[2]==="]",h=s[3];if(c&&(a=a|0),h===void 0||h==="["&&o+2===r){dE(t,h===void 0?new I5(a,i,e):new O3(a,i,e));break}else{let l=t.map[a];l===void 0&&(l=new N3(a),dE(t,l)),t=l}}}function Ma(i,e){this.seq=[],this.map={};const t=i.getProgramParameter(e,35718);for(let n=0;n<t;++n){const r=i.getActiveUniform(e,n),s=i.getUniformLocation(e,r.name);F5(r,s,this)}}Ma.prototype.setValue=function(i,e,t,n){const r=this.map[e];r!==void 0&&r.setValue(i,t,n)};Ma.prototype.setOptional=function(i,e,t){const n=e[t];n!==void 0&&this.setValue(i,t,n)};Ma.upload=function(i,e,t,n){for(let r=0,s=e.length;r!==s;++r){const o=e[r],a=t[o.id];a.needsUpdate!==!1&&o.setValue(i,a.value,n)}};Ma.seqWithValue=function(i,e){const t=[];for(let n=0,r=i.length;n!==r;++n){const s=i[n];s.id in e&&t.push(s)}return t};function fE(i,e,t){const n=i.createShader(e);return i.shaderSource(n,t),i.compileShader(n),n}let D5=0;function B5(i,e){const t=i.split(`
`),n=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++)n.push(o+1+": "+t[o]);return n.join(`
`)}function z5(i){switch(i){case Ts:return["Linear","( value )"];case Ht:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",i),["Linear","( value )"]}}function pE(i,e,t){const n=i.getShaderParameter(e,35713),r=i.getShaderInfoLog(e).trim();if(n&&r==="")return"";const s=parseInt(/ERROR: 0:(\d+)/.exec(r)[1]);return t.toUpperCase()+`

`+r+`

`+B5(i.getShaderSource(e),s)}function O5(i,e){const t=z5(e);return"vec4 "+i+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function N5(i,e){let t;switch(e){case XC:t="Linear";break;case qC:t="Reinhard";break;case YC:t="OptimizedCineon";break;case e1:t="ACESFilmic";break;case $C:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+i+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function U5(i){return[i.extensionDerivatives||!!i.envMapCubeUVHeight||i.bumpMap||i.tangentSpaceNormalMap||i.clearcoatNormalMap||i.flatShading||i.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(i.extensionFragDepth||i.logarithmicDepthBuffer)&&i.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",i.extensionDrawBuffers&&i.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(i.extensionShaderTextureLOD||i.envMap||i.transmission)&&i.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(nd).join(`
`)}function H5(i){const e=[];for(const t in i){const n=i[t];n!==!1&&e.push("#define "+t+" "+n)}return e.join(`
`)}function V5(i,e){const t={},n=i.getProgramParameter(e,35721);for(let r=0;r<n;r++){const s=i.getActiveAttrib(e,r),o=s.name;let a=1;s.type===35674&&(a=2),s.type===35675&&(a=3),s.type===35676&&(a=4),t[o]={type:s.type,location:i.getAttribLocation(e,o),locationSize:a}}return t}function nd(i){return i!==""}function mE(i,e){return i.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function gE(i,e){return i.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const G5=/^[ \t]*#include +<([\w\d./]+)>/gm;function Pw(i){return i.replace(G5,W5)}function W5(i,e){const t=Gt[e];if(t===void 0)throw new Error("Can not resolve #include <"+e+">");return Pw(t)}const j5=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,X5=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function vE(i){return i.replace(X5,U3).replace(j5,q5)}function q5(i,e,t,n){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),U3(i,e,t,n)}function U3(i,e,t,n){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function yE(i){let e="precision "+i.precision+` float;
precision `+i.precision+" int;";return i.precision==="highp"?e+=`
#define HIGH_PRECISION`:i.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:i.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function Y5(i){let e="SHADOWMAP_TYPE_BASIC";return i.shadowMapType===$_?e="SHADOWMAP_TYPE_PCF":i.shadowMapType===Q_?e="SHADOWMAP_TYPE_PCF_SOFT":i.shadowMapType===Jc&&(e="SHADOWMAP_TYPE_VSM"),e}function $5(i){let e="ENVMAP_TYPE_CUBE";if(i.envMap)switch(i.envMapMode){case Ra:case La:e="ENVMAP_TYPE_CUBE";break;case Wu:e="ENVMAP_TYPE_CUBE_UV";break}return e}function Q5(i){let e="ENVMAP_MODE_REFLECTION";if(i.envMap)switch(i.envMapMode){case La:e="ENVMAP_MODE_REFRACTION";break}return e}function Z5(i){let e="ENVMAP_BLENDING_NONE";if(i.envMap)switch(i.combine){case uf:e="ENVMAP_BLENDING_MULTIPLY";break;case WC:e="ENVMAP_BLENDING_MIX";break;case jC:e="ENVMAP_BLENDING_ADD";break}return e}function K5(i){const e=i.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e/32+1)+3,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:n,maxMip:t}}function J5(i,e,t,n){const r=i.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const c=Y5(t),h=$5(t),d=Q5(t),l=Z5(t),u=K5(t),p=t.isWebGL2?"":U5(t),g=H5(s),y=r.createProgram();let x,v,w=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(x=[g].filter(nd).join(`
`),x.length>0&&(x+=`
`),v=[p,g].filter(nd).join(`
`),v.length>0&&(v+=`
`)):(x=[yE(t),"#define SHADER_NAME "+t.shaderName,g,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define MAX_BONES "+t.maxBones,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+d:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.useVertexTexture?"#define BONE_TEXTURE":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(nd).join(`
`),v=[p,yE(t),"#define SHADER_NAME "+t.shaderName,g,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+h:"",t.envMap?"#define "+d:"",t.envMap?"#define "+l:"",u?"#define CUBEUV_TEXEL_WIDTH "+u.texelWidth:"",u?"#define CUBEUV_TEXEL_HEIGHT "+u.texelHeight:"",u?"#define CUBEUV_MAX_MIP "+u.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==bs?"#define TONE_MAPPING":"",t.toneMapping!==bs?Gt.tonemapping_pars_fragment:"",t.toneMapping!==bs?N5("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Gt.encodings_pars_fragment,O5("linearToOutputTexel",t.outputEncoding),t.depthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(nd).join(`
`)),o=Pw(o),o=mE(o,t),o=gE(o,t),a=Pw(a),a=mE(a,t),a=gE(a,t),o=vE(o),a=vE(a),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(w=`#version 300 es
`,x=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+x,v=["#define varying in",t.glslVersion===Tw?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===Tw?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+v);const S=w+x+o,b=w+v+a,E=fE(r,35633,S),R=fE(r,35632,b);if(r.attachShader(y,E),r.attachShader(y,R),t.index0AttributeName!==void 0?r.bindAttribLocation(y,0,t.index0AttributeName):t.morphTargets===!0&&r.bindAttribLocation(y,0,"position"),r.linkProgram(y),i.debug.checkShaderErrors){const N=r.getProgramInfoLog(y).trim(),F=r.getShaderInfoLog(E).trim(),C=r.getShaderInfoLog(R).trim();let O=!0,X=!0;if(r.getProgramParameter(y,35714)===!1){O=!1;const U=pE(r,E,"vertex"),te=pE(r,R,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(y,35715)+`

Program Info Log: `+N+`
`+U+`
`+te)}else N!==""?console.warn("THREE.WebGLProgram: Program Info Log:",N):(F===""||C==="")&&(X=!1);X&&(this.diagnostics={runnable:O,programLog:N,vertexShader:{log:F,prefix:x},fragmentShader:{log:C,prefix:v}})}r.deleteShader(E),r.deleteShader(R);let z;this.getUniforms=function(){return z===void 0&&(z=new Ma(r,y)),z};let I;return this.getAttributes=function(){return I===void 0&&(I=V5(r,y)),I},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(y),this.program=void 0},this.name=t.shaderName,this.id=D5++,this.cacheKey=e,this.usedTimes=1,this.program=y,this.vertexShader=E,this.fragmentShader=R,this}let eO=0;class tO{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(t),s=this._getShaderStage(n),o=this._getShaderCacheForMaterial(e);return o.has(r)===!1&&(o.add(r),r.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;return t.has(e)===!1&&t.set(e,new Set),t.get(e)}_getShaderStage(e){const t=this.shaderCache;if(t.has(e)===!1){const n=new nO(e);t.set(e,n)}return t.get(e)}}class nO{constructor(e){this.id=eO++,this.code=e,this.usedTimes=0}}function iO(i,e,t,n,r,s,o){const a=new Rl,c=new tO,h=[],d=r.isWebGL2,l=r.logarithmicDepthBuffer,u=r.floatVertexTextures,p=r.maxVertexUniforms,g=r.vertexTextures;let y=r.precision;const x={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function v(C){const X=C.skeleton.bones;if(u)return 1024;{const te=Math.floor((p-20)/4),ne=Math.min(te,X.length);return ne<X.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+X.length+" bones. This GPU supports "+ne+"."),0):ne}}function w(C,O,X,U,te){const ne=U.fog,j=te.geometry,k=C.isMeshStandardMaterial?U.environment:null,W=(C.isMeshStandardMaterial?t:e).get(C.envMap||k),Y=!!W&&W.mapping===Wu?W.image.height:null,H=x[C.type],J=te.isSkinnedMesh?v(te):0;C.precision!==null&&(y=r.getMaxPrecision(C.precision),y!==C.precision&&console.warn("THREE.WebGLProgram.getParameters:",C.precision,"not supported, using",y,"instead."));const K=j.morphAttributes.position||j.morphAttributes.normal||j.morphAttributes.color,ee=K!==void 0?K.length:0;let $=0;j.morphAttributes.position!==void 0&&($=1),j.morphAttributes.normal!==void 0&&($=2),j.morphAttributes.color!==void 0&&($=3);let Z,Ee,Se,de;if(H){const we=ys[H];Z=we.vertexShader,Ee=we.fragmentShader}else Z=C.vertexShader,Ee=C.fragmentShader,c.update(C),Se=c.getVertexShaderID(C),de=c.getFragmentShaderID(C);const he=i.getRenderTarget(),Ce=C.alphaTest>0,me=C.clearcoat>0;return{isWebGL2:d,shaderID:H,shaderName:C.type,vertexShader:Z,fragmentShader:Ee,defines:C.defines,customVertexShaderID:Se,customFragmentShaderID:de,isRawShaderMaterial:C.isRawShaderMaterial===!0,glslVersion:C.glslVersion,precision:y,instancing:te.isInstancedMesh===!0,instancingColor:te.isInstancedMesh===!0&&te.instanceColor!==null,supportsVertexTextures:g,outputEncoding:he===null?i.outputEncoding:he.isXRRenderTarget===!0?he.texture.encoding:Ts,map:!!C.map,matcap:!!C.matcap,envMap:!!W,envMapMode:W&&W.mapping,envMapCubeUVHeight:Y,lightMap:!!C.lightMap,aoMap:!!C.aoMap,emissiveMap:!!C.emissiveMap,bumpMap:!!C.bumpMap,normalMap:!!C.normalMap,objectSpaceNormalMap:C.normalMapType===y3,tangentSpaceNormalMap:C.normalMapType===Na,decodeVideoTexture:!!C.map&&C.map.isVideoTexture===!0&&C.map.encoding===Ht,clearcoat:me,clearcoatMap:me&&!!C.clearcoatMap,clearcoatRoughnessMap:me&&!!C.clearcoatRoughnessMap,clearcoatNormalMap:me&&!!C.clearcoatNormalMap,displacementMap:!!C.displacementMap,roughnessMap:!!C.roughnessMap,metalnessMap:!!C.metalnessMap,specularMap:!!C.specularMap,specularIntensityMap:!!C.specularIntensityMap,specularColorMap:!!C.specularColorMap,opaque:C.transparent===!1&&C.blending===El,alphaMap:!!C.alphaMap,alphaTest:Ce,gradientMap:!!C.gradientMap,sheen:C.sheen>0,sheenColorMap:!!C.sheenColorMap,sheenRoughnessMap:!!C.sheenRoughnessMap,transmission:C.transmission>0,transmissionMap:!!C.transmissionMap,thicknessMap:!!C.thicknessMap,combine:C.combine,vertexTangents:!!C.normalMap&&!!j.attributes.tangent,vertexColors:C.vertexColors,vertexAlphas:C.vertexColors===!0&&!!j.attributes.color&&j.attributes.color.itemSize===4,vertexUvs:!!C.map||!!C.bumpMap||!!C.normalMap||!!C.specularMap||!!C.alphaMap||!!C.emissiveMap||!!C.roughnessMap||!!C.metalnessMap||!!C.clearcoatMap||!!C.clearcoatRoughnessMap||!!C.clearcoatNormalMap||!!C.displacementMap||!!C.transmissionMap||!!C.thicknessMap||!!C.specularIntensityMap||!!C.specularColorMap||!!C.sheenColorMap||!!C.sheenRoughnessMap,uvsVertexOnly:!(!!C.map||!!C.bumpMap||!!C.normalMap||!!C.specularMap||!!C.alphaMap||!!C.emissiveMap||!!C.roughnessMap||!!C.metalnessMap||!!C.clearcoatNormalMap||C.transmission>0||!!C.transmissionMap||!!C.thicknessMap||!!C.specularIntensityMap||!!C.specularColorMap||C.sheen>0||!!C.sheenColorMap||!!C.sheenRoughnessMap)&&!!C.displacementMap,fog:!!ne,useFog:C.fog,fogExp2:ne&&ne.isFogExp2,flatShading:!!C.flatShading,sizeAttenuation:C.sizeAttenuation,logarithmicDepthBuffer:l,skinning:te.isSkinnedMesh===!0&&J>0,maxBones:J,useVertexTexture:u,morphTargets:j.morphAttributes.position!==void 0,morphNormals:j.morphAttributes.normal!==void 0,morphColors:j.morphAttributes.color!==void 0,morphTargetsCount:ee,morphTextureStride:$,numDirLights:O.directional.length,numPointLights:O.point.length,numSpotLights:O.spot.length,numRectAreaLights:O.rectArea.length,numHemiLights:O.hemi.length,numDirLightShadows:O.directionalShadowMap.length,numPointLightShadows:O.pointShadowMap.length,numSpotLightShadows:O.spotShadowMap.length,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:C.dithering,shadowMapEnabled:i.shadowMap.enabled&&X.length>0,shadowMapType:i.shadowMap.type,toneMapping:C.toneMapped?i.toneMapping:bs,physicallyCorrectLights:i.physicallyCorrectLights,premultipliedAlpha:C.premultipliedAlpha,doubleSided:C.side===Es,flipSided:C.side===kr,depthPacking:C.depthPacking!==void 0?C.depthPacking:!1,index0AttributeName:C.index0AttributeName,extensionDerivatives:C.extensions&&C.extensions.derivatives,extensionFragDepth:C.extensions&&C.extensions.fragDepth,extensionDrawBuffers:C.extensions&&C.extensions.drawBuffers,extensionShaderTextureLOD:C.extensions&&C.extensions.shaderTextureLOD,rendererExtensionFragDepth:d||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:d||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:d||n.has("EXT_shader_texture_lod"),customProgramCacheKey:C.customProgramCacheKey()}}function S(C){const O=[];if(C.shaderID?O.push(C.shaderID):(O.push(C.customVertexShaderID),O.push(C.customFragmentShaderID)),C.defines!==void 0)for(const X in C.defines)O.push(X),O.push(C.defines[X]);return C.isRawShaderMaterial===!1&&(b(O,C),E(O,C),O.push(i.outputEncoding)),O.push(C.customProgramCacheKey),O.join()}function b(C,O){C.push(O.precision),C.push(O.outputEncoding),C.push(O.envMapMode),C.push(O.envMapCubeUVHeight),C.push(O.combine),C.push(O.vertexUvs),C.push(O.fogExp2),C.push(O.sizeAttenuation),C.push(O.maxBones),C.push(O.morphTargetsCount),C.push(O.morphAttributeCount),C.push(O.numDirLights),C.push(O.numPointLights),C.push(O.numSpotLights),C.push(O.numHemiLights),C.push(O.numRectAreaLights),C.push(O.numDirLightShadows),C.push(O.numPointLightShadows),C.push(O.numSpotLightShadows),C.push(O.shadowMapType),C.push(O.toneMapping),C.push(O.numClippingPlanes),C.push(O.numClipIntersection)}function E(C,O){a.disableAll(),O.isWebGL2&&a.enable(0),O.supportsVertexTextures&&a.enable(1),O.instancing&&a.enable(2),O.instancingColor&&a.enable(3),O.map&&a.enable(4),O.matcap&&a.enable(5),O.envMap&&a.enable(6),O.lightMap&&a.enable(7),O.aoMap&&a.enable(8),O.emissiveMap&&a.enable(9),O.bumpMap&&a.enable(10),O.normalMap&&a.enable(11),O.objectSpaceNormalMap&&a.enable(12),O.tangentSpaceNormalMap&&a.enable(13),O.clearcoat&&a.enable(14),O.clearcoatMap&&a.enable(15),O.clearcoatRoughnessMap&&a.enable(16),O.clearcoatNormalMap&&a.enable(17),O.displacementMap&&a.enable(18),O.specularMap&&a.enable(19),O.roughnessMap&&a.enable(20),O.metalnessMap&&a.enable(21),O.gradientMap&&a.enable(22),O.alphaMap&&a.enable(23),O.alphaTest&&a.enable(24),O.vertexColors&&a.enable(25),O.vertexAlphas&&a.enable(26),O.vertexUvs&&a.enable(27),O.vertexTangents&&a.enable(28),O.uvsVertexOnly&&a.enable(29),O.fog&&a.enable(30),C.push(a.mask),a.disableAll(),O.useFog&&a.enable(0),O.flatShading&&a.enable(1),O.logarithmicDepthBuffer&&a.enable(2),O.skinning&&a.enable(3),O.useVertexTexture&&a.enable(4),O.morphTargets&&a.enable(5),O.morphNormals&&a.enable(6),O.morphColors&&a.enable(7),O.premultipliedAlpha&&a.enable(8),O.shadowMapEnabled&&a.enable(9),O.physicallyCorrectLights&&a.enable(10),O.doubleSided&&a.enable(11),O.flipSided&&a.enable(12),O.depthPacking&&a.enable(13),O.dithering&&a.enable(14),O.specularIntensityMap&&a.enable(15),O.specularColorMap&&a.enable(16),O.transmission&&a.enable(17),O.transmissionMap&&a.enable(18),O.thicknessMap&&a.enable(19),O.sheen&&a.enable(20),O.sheenColorMap&&a.enable(21),O.sheenRoughnessMap&&a.enable(22),O.decodeVideoTexture&&a.enable(23),O.opaque&&a.enable(24),C.push(a.mask)}function R(C){const O=x[C.type];let X;if(O){const U=ys[O];X=r1.clone(U.uniforms)}else X=C.uniforms;return X}function z(C,O){let X;for(let U=0,te=h.length;U<te;U++){const ne=h[U];if(ne.cacheKey===O){X=ne,++X.usedTimes;break}}return X===void 0&&(X=new J5(i,O,C,s),h.push(X)),X}function I(C){if(--C.usedTimes===0){const O=h.indexOf(C);h[O]=h[h.length-1],h.pop(),C.destroy()}}function N(C){c.remove(C)}function F(){c.dispose()}return{getParameters:w,getProgramCacheKey:S,getUniforms:R,acquireProgram:z,releaseProgram:I,releaseShaderCache:N,programs:h,dispose:F}}function rO(){let i=new WeakMap;function e(s){let o=i.get(s);return o===void 0&&(o={},i.set(s,o)),o}function t(s){i.delete(s)}function n(s,o,a){i.get(s)[o]=a}function r(){i=new WeakMap}return{get:e,remove:t,update:n,dispose:r}}function sO(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.material.id!==e.material.id?i.material.id-e.material.id:i.z!==e.z?i.z-e.z:i.id-e.id}function xE(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}function wE(){const i=[];let e=0;const t=[],n=[],r=[];function s(){e=0,t.length=0,n.length=0,r.length=0}function o(l,u,p,g,y,x){let v=i[e];return v===void 0?(v={id:l.id,object:l,geometry:u,material:p,groupOrder:g,renderOrder:l.renderOrder,z:y,group:x},i[e]=v):(v.id=l.id,v.object=l,v.geometry=u,v.material=p,v.groupOrder=g,v.renderOrder=l.renderOrder,v.z=y,v.group=x),e++,v}function a(l,u,p,g,y,x){const v=o(l,u,p,g,y,x);p.transmission>0?n.push(v):p.transparent===!0?r.push(v):t.push(v)}function c(l,u,p,g,y,x){const v=o(l,u,p,g,y,x);p.transmission>0?n.unshift(v):p.transparent===!0?r.unshift(v):t.unshift(v)}function h(l,u){t.length>1&&t.sort(l||sO),n.length>1&&n.sort(u||xE),r.length>1&&r.sort(u||xE)}function d(){for(let l=e,u=i.length;l<u;l++){const p=i[l];if(p.id===null)break;p.id=null,p.object=null,p.geometry=null,p.material=null,p.group=null}}return{opaque:t,transmissive:n,transparent:r,init:s,push:a,unshift:c,finish:d,sort:h}}function oO(){let i=new WeakMap;function e(n,r){let s;return i.has(n)===!1?(s=new wE,i.set(n,[s])):r>=i.get(n).length?(s=new wE,i.get(n).push(s)):s=i.get(n)[r],s}function t(){i=new WeakMap}return{get:e,dispose:t}}function aO(){const i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new B,color:new qe};break;case"SpotLight":t={position:new B,direction:new B,color:new qe,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new B,color:new qe,distance:0,decay:0};break;case"HemisphereLight":t={direction:new B,skyColor:new qe,groundColor:new qe};break;case"RectAreaLight":t={color:new qe,position:new B,halfWidth:new B,halfHeight:new B};break}return i[e.id]=t,t}}}function lO(){const i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Me};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Me};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Me,shadowCameraNear:1,shadowCameraFar:1e3};break}return i[e.id]=t,t}}}let cO=0;function uO(i,e){return(e.castShadow?1:0)-(i.castShadow?1:0)}function hO(i,e){const t=new aO,n=lO(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let d=0;d<9;d++)r.probe.push(new B);const s=new B,o=new st,a=new st;function c(d,l){let u=0,p=0,g=0;for(let N=0;N<9;N++)r.probe[N].set(0,0,0);let y=0,x=0,v=0,w=0,S=0,b=0,E=0,R=0;d.sort(uO);const z=l!==!0?Math.PI:1;for(let N=0,F=d.length;N<F;N++){const C=d[N],O=C.color,X=C.intensity,U=C.distance,te=C.shadow&&C.shadow.map?C.shadow.map.texture:null;if(C.isAmbientLight)u+=O.r*X*z,p+=O.g*X*z,g+=O.b*X*z;else if(C.isLightProbe)for(let ne=0;ne<9;ne++)r.probe[ne].addScaledVector(C.sh.coefficients[ne],X);else if(C.isDirectionalLight){const ne=t.get(C);if(ne.color.copy(C.color).multiplyScalar(C.intensity*z),C.castShadow){const j=C.shadow,k=n.get(C);k.shadowBias=j.bias,k.shadowNormalBias=j.normalBias,k.shadowRadius=j.radius,k.shadowMapSize=j.mapSize,r.directionalShadow[y]=k,r.directionalShadowMap[y]=te,r.directionalShadowMatrix[y]=C.shadow.matrix,b++}r.directional[y]=ne,y++}else if(C.isSpotLight){const ne=t.get(C);if(ne.position.setFromMatrixPosition(C.matrixWorld),ne.color.copy(O).multiplyScalar(X*z),ne.distance=U,ne.coneCos=Math.cos(C.angle),ne.penumbraCos=Math.cos(C.angle*(1-C.penumbra)),ne.decay=C.decay,C.castShadow){const j=C.shadow,k=n.get(C);k.shadowBias=j.bias,k.shadowNormalBias=j.normalBias,k.shadowRadius=j.radius,k.shadowMapSize=j.mapSize,r.spotShadow[v]=k,r.spotShadowMap[v]=te,r.spotShadowMatrix[v]=C.shadow.matrix,R++}r.spot[v]=ne,v++}else if(C.isRectAreaLight){const ne=t.get(C);ne.color.copy(O).multiplyScalar(X),ne.halfWidth.set(C.width*.5,0,0),ne.halfHeight.set(0,C.height*.5,0),r.rectArea[w]=ne,w++}else if(C.isPointLight){const ne=t.get(C);if(ne.color.copy(C.color).multiplyScalar(C.intensity*z),ne.distance=C.distance,ne.decay=C.decay,C.castShadow){const j=C.shadow,k=n.get(C);k.shadowBias=j.bias,k.shadowNormalBias=j.normalBias,k.shadowRadius=j.radius,k.shadowMapSize=j.mapSize,k.shadowCameraNear=j.camera.near,k.shadowCameraFar=j.camera.far,r.pointShadow[x]=k,r.pointShadowMap[x]=te,r.pointShadowMatrix[x]=C.shadow.matrix,E++}r.point[x]=ne,x++}else if(C.isHemisphereLight){const ne=t.get(C);ne.skyColor.copy(C.color).multiplyScalar(X*z),ne.groundColor.copy(C.groundColor).multiplyScalar(X*z),r.hemi[S]=ne,S++}}w>0&&(e.isWebGL2||i.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=ot.LTC_FLOAT_1,r.rectAreaLTC2=ot.LTC_FLOAT_2):i.has("OES_texture_half_float_linear")===!0?(r.rectAreaLTC1=ot.LTC_HALF_1,r.rectAreaLTC2=ot.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=u,r.ambient[1]=p,r.ambient[2]=g;const I=r.hash;(I.directionalLength!==y||I.pointLength!==x||I.spotLength!==v||I.rectAreaLength!==w||I.hemiLength!==S||I.numDirectionalShadows!==b||I.numPointShadows!==E||I.numSpotShadows!==R)&&(r.directional.length=y,r.spot.length=v,r.rectArea.length=w,r.point.length=x,r.hemi.length=S,r.directionalShadow.length=b,r.directionalShadowMap.length=b,r.pointShadow.length=E,r.pointShadowMap.length=E,r.spotShadow.length=R,r.spotShadowMap.length=R,r.directionalShadowMatrix.length=b,r.pointShadowMatrix.length=E,r.spotShadowMatrix.length=R,I.directionalLength=y,I.pointLength=x,I.spotLength=v,I.rectAreaLength=w,I.hemiLength=S,I.numDirectionalShadows=b,I.numPointShadows=E,I.numSpotShadows=R,r.version=cO++)}function h(d,l){let u=0,p=0,g=0,y=0,x=0;const v=l.matrixWorldInverse;for(let w=0,S=d.length;w<S;w++){const b=d[w];if(b.isDirectionalLight){const E=r.directional[u];E.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),E.direction.sub(s),E.direction.transformDirection(v),u++}else if(b.isSpotLight){const E=r.spot[g];E.position.setFromMatrixPosition(b.matrixWorld),E.position.applyMatrix4(v),E.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),E.direction.sub(s),E.direction.transformDirection(v),g++}else if(b.isRectAreaLight){const E=r.rectArea[y];E.position.setFromMatrixPosition(b.matrixWorld),E.position.applyMatrix4(v),a.identity(),o.copy(b.matrixWorld),o.premultiply(v),a.extractRotation(o),E.halfWidth.set(b.width*.5,0,0),E.halfHeight.set(0,b.height*.5,0),E.halfWidth.applyMatrix4(a),E.halfHeight.applyMatrix4(a),y++}else if(b.isPointLight){const E=r.point[p];E.position.setFromMatrixPosition(b.matrixWorld),E.position.applyMatrix4(v),p++}else if(b.isHemisphereLight){const E=r.hemi[x];E.direction.setFromMatrixPosition(b.matrixWorld),E.direction.transformDirection(v),E.direction.normalize(),x++}}}return{setup:c,setupView:h,state:r}}function _E(i,e){const t=new hO(i,e),n=[],r=[];function s(){n.length=0,r.length=0}function o(l){n.push(l)}function a(l){r.push(l)}function c(l){t.setup(n,l)}function h(l){t.setupView(n,l)}return{init:s,state:{lightsArray:n,shadowsArray:r,lights:t},setupLights:c,setupLightsView:h,pushLight:o,pushShadow:a}}function dO(i,e){let t=new WeakMap;function n(s,o=0){let a;return t.has(s)===!1?(a=new _E(i,e),t.set(s,[a])):o>=t.get(s).length?(a=new _E(i,e),t.get(s).push(a)):a=t.get(s)[o],a}function r(){t=new WeakMap}return{get:n,dispose:r}}class pv extends An{constructor(e){super(),this.type="MeshDepthMaterial",this.depthPacking=g3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}pv.prototype.isMeshDepthMaterial=!0;class mv extends An{constructor(e){super(),this.type="MeshDistanceMaterial",this.referencePosition=new B,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}mv.prototype.isMeshDistanceMaterial=!0;const fO=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,pO=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function H3(i,e,t){let n=new ff;const r=new Me,s=new Me,o=new Jt,a=new pv({depthPacking:v3}),c=new mv,h={},d=t.maxTextureSize,l={0:kr,1:Pa,2:Es},u=new jn({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Me},radius:{value:4}},vertexShader:fO,fragmentShader:pO}),p=u.clone();p.defines.HORIZONTAL_PASS=1;const g=new vt;g.setAttribute("position",new zt(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const y=new je(g,u),x=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=$_,this.render=function(b,E,R){if(x.enabled===!1||x.autoUpdate===!1&&x.needsUpdate===!1||b.length===0)return;const z=i.getRenderTarget(),I=i.getActiveCubeFace(),N=i.getActiveMipmapLevel(),F=i.state;F.setBlending(Mo),F.buffers.color.setClear(1,1,1,1),F.buffers.depth.setTest(!0),F.setScissorTest(!1);for(let C=0,O=b.length;C<O;C++){const X=b[C],U=X.shadow;if(U===void 0){console.warn("THREE.WebGLShadowMap:",X,"has no shadow.");continue}if(U.autoUpdate===!1&&U.needsUpdate===!1)continue;r.copy(U.mapSize);const te=U.getFrameExtents();if(r.multiply(te),s.copy(U.mapSize),(r.x>d||r.y>d)&&(r.x>d&&(s.x=Math.floor(d/te.x),r.x=s.x*te.x,U.mapSize.x=s.x),r.y>d&&(s.y=Math.floor(d/te.y),r.y=s.y*te.y,U.mapSize.y=s.y)),U.map===null&&!U.isPointLightShadow&&this.type===Jc&&(U.map=new Gi(r.x,r.y),U.map.texture.name=X.name+".shadowMap",U.mapPass=new Gi(r.x,r.y),U.camera.updateProjectionMatrix()),U.map===null){const j={minFilter:Kt,magFilter:Kt,format:ur};U.map=new Gi(r.x,r.y,j),U.map.texture.name=X.name+".shadowMap",U.camera.updateProjectionMatrix()}i.setRenderTarget(U.map),i.clear();const ne=U.getViewportCount();for(let j=0;j<ne;j++){const k=U.getViewport(j);o.set(s.x*k.x,s.y*k.y,s.x*k.z,s.y*k.w),F.viewport(o),U.updateMatrices(X,j),n=U.getFrustum(),S(E,R,U.camera,X,this.type)}!U.isPointLightShadow&&this.type===Jc&&v(U,R),U.needsUpdate=!1}x.needsUpdate=!1,i.setRenderTarget(z,I,N)};function v(b,E){const R=e.update(y);u.defines.VSM_SAMPLES!==b.blurSamples&&(u.defines.VSM_SAMPLES=b.blurSamples,p.defines.VSM_SAMPLES=b.blurSamples,u.needsUpdate=!0,p.needsUpdate=!0),u.uniforms.shadow_pass.value=b.map.texture,u.uniforms.resolution.value=b.mapSize,u.uniforms.radius.value=b.radius,i.setRenderTarget(b.mapPass),i.clear(),i.renderBufferDirect(E,null,R,u,y,null),p.uniforms.shadow_pass.value=b.mapPass.texture,p.uniforms.resolution.value=b.mapSize,p.uniforms.radius.value=b.radius,i.setRenderTarget(b.map),i.clear(),i.renderBufferDirect(E,null,R,p,y,null)}function w(b,E,R,z,I,N){let F=null;const C=R.isPointLight===!0?b.customDistanceMaterial:b.customDepthMaterial;if(C!==void 0?F=C:F=R.isPointLight===!0?c:a,i.localClippingEnabled&&E.clipShadows===!0&&E.clippingPlanes.length!==0||E.displacementMap&&E.displacementScale!==0||E.alphaMap&&E.alphaTest>0){const O=F.uuid,X=E.uuid;let U=h[O];U===void 0&&(U={},h[O]=U);let te=U[X];te===void 0&&(te=F.clone(),U[X]=te),F=te}return F.visible=E.visible,F.wireframe=E.wireframe,N===Jc?F.side=E.shadowSide!==null?E.shadowSide:E.side:F.side=E.shadowSide!==null?E.shadowSide:l[E.side],F.alphaMap=E.alphaMap,F.alphaTest=E.alphaTest,F.clipShadows=E.clipShadows,F.clippingPlanes=E.clippingPlanes,F.clipIntersection=E.clipIntersection,F.displacementMap=E.displacementMap,F.displacementScale=E.displacementScale,F.displacementBias=E.displacementBias,F.wireframeLinewidth=E.wireframeLinewidth,F.linewidth=E.linewidth,R.isPointLight===!0&&F.isMeshDistanceMaterial===!0&&(F.referencePosition.setFromMatrixPosition(R.matrixWorld),F.nearDistance=z,F.farDistance=I),F}function S(b,E,R,z,I){if(b.visible===!1)return;if(b.layers.test(E.layers)&&(b.isMesh||b.isLine||b.isPoints)&&(b.castShadow||b.receiveShadow&&I===Jc)&&(!b.frustumCulled||n.intersectsObject(b))){b.modelViewMatrix.multiplyMatrices(R.matrixWorldInverse,b.matrixWorld);const C=e.update(b),O=b.material;if(Array.isArray(O)){const X=C.groups;for(let U=0,te=X.length;U<te;U++){const ne=X[U],j=O[ne.materialIndex];if(j&&j.visible){const k=w(b,j,z,R.near,R.far,I);i.renderBufferDirect(R,null,C,k,b,ne)}}}else if(O.visible){const X=w(b,O,z,R.near,R.far,I);i.renderBufferDirect(R,null,C,X,b,null)}}const F=b.children;for(let C=0,O=F.length;C<O;C++)S(F[C],E,R,z,I)}}function mO(i,e,t){const n=t.isWebGL2;function r(){let oe=!1;const Ne=new Jt;let Je=null;const ae=new Jt(0,0,0,0);return{setMask:function(Te){Je!==Te&&!oe&&(i.colorMask(Te,Te,Te,Te),Je=Te)},setLocked:function(Te){oe=Te},setClear:function(Te,Ge,ze,ct,Pt){Pt===!0&&(Te*=ct,Ge*=ct,ze*=ct),Ne.set(Te,Ge,ze,ct),ae.equals(Ne)===!1&&(i.clearColor(Te,Ge,ze,ct),ae.copy(Ne))},reset:function(){oe=!1,Je=null,ae.set(-1,0,0,0)}}}function s(){let oe=!1,Ne=null,Je=null,ae=null;return{setTest:function(Te){Te?$(2929):Z(2929)},setMask:function(Te){Ne!==Te&&!oe&&(i.depthMask(Te),Ne=Te)},setFunc:function(Te){if(Je!==Te){if(Te)switch(Te){case zC:i.depthFunc(512);break;case OC:i.depthFunc(519);break;case NC:i.depthFunc(513);break;case Rg:i.depthFunc(515);break;case UC:i.depthFunc(514);break;case HC:i.depthFunc(518);break;case VC:i.depthFunc(516);break;case GC:i.depthFunc(517);break;default:i.depthFunc(515)}else i.depthFunc(515);Je=Te}},setLocked:function(Te){oe=Te},setClear:function(Te){ae!==Te&&(i.clearDepth(Te),ae=Te)},reset:function(){oe=!1,Ne=null,Je=null,ae=null}}}function o(){let oe=!1,Ne=null,Je=null,ae=null,Te=null,Ge=null,ze=null,ct=null,Pt=null;return{setTest:function(xt){oe||(xt?$(2960):Z(2960))},setMask:function(xt){Ne!==xt&&!oe&&(i.stencilMask(xt),Ne=xt)},setFunc:function(xt,Xn,Cn){(Je!==xt||ae!==Xn||Te!==Cn)&&(i.stencilFunc(xt,Xn,Cn),Je=xt,ae=Xn,Te=Cn)},setOp:function(xt,Xn,Cn){(Ge!==xt||ze!==Xn||ct!==Cn)&&(i.stencilOp(xt,Xn,Cn),Ge=xt,ze=Xn,ct=Cn)},setLocked:function(xt){oe=xt},setClear:function(xt){Pt!==xt&&(i.clearStencil(xt),Pt=xt)},reset:function(){oe=!1,Ne=null,Je=null,ae=null,Te=null,Ge=null,ze=null,ct=null,Pt=null}}}const a=new r,c=new s,h=new o;let d={},l={},u=new WeakMap,p=[],g=null,y=!1,x=null,v=null,w=null,S=null,b=null,E=null,R=null,z=!1,I=null,N=null,F=null,C=null,O=null;const X=i.getParameter(35661);let U=!1,te=0;const ne=i.getParameter(7938);ne.indexOf("WebGL")!==-1?(te=parseFloat(/^WebGL (\d)/.exec(ne)[1]),U=te>=1):ne.indexOf("OpenGL ES")!==-1&&(te=parseFloat(/^OpenGL ES (\d)/.exec(ne)[1]),U=te>=2);let j=null,k={};const W=i.getParameter(3088),Y=i.getParameter(2978),H=new Jt().fromArray(W),J=new Jt().fromArray(Y);function K(oe,Ne,Je){const ae=new Uint8Array(4),Te=i.createTexture();i.bindTexture(oe,Te),i.texParameteri(oe,10241,9728),i.texParameteri(oe,10240,9728);for(let Ge=0;Ge<Je;Ge++)i.texImage2D(Ne+Ge,0,6408,1,1,0,6408,5121,ae);return Te}const ee={};ee[3553]=K(3553,3553,1),ee[34067]=K(34067,34069,6),a.setClear(0,0,0,1),c.setClear(1),h.setClear(0),$(2929),c.setFunc(Rg),we(!1),ye(Jx),$(2884),me(Mo);function $(oe){d[oe]!==!0&&(i.enable(oe),d[oe]=!0)}function Z(oe){d[oe]!==!1&&(i.disable(oe),d[oe]=!1)}function Ee(oe,Ne){return l[oe]!==Ne?(i.bindFramebuffer(oe,Ne),l[oe]=Ne,n&&(oe===36009&&(l[36160]=Ne),oe===36160&&(l[36009]=Ne)),!0):!1}function Se(oe,Ne){let Je=p,ae=!1;if(oe)if(Je=u.get(Ne),Je===void 0&&(Je=[],u.set(Ne,Je)),oe.isWebGLMultipleRenderTargets){const Te=oe.texture;if(Je.length!==Te.length||Je[0]!==36064){for(let Ge=0,ze=Te.length;Ge<ze;Ge++)Je[Ge]=36064+Ge;Je.length=Te.length,ae=!0}}else Je[0]!==36064&&(Je[0]=36064,ae=!0);else Je[0]!==1029&&(Je[0]=1029,ae=!0);ae&&(t.isWebGL2?i.drawBuffers(Je):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Je))}function de(oe){return g!==oe?(i.useProgram(oe),g=oe,!0):!1}const he={[ml]:32774,[TC]:32778,[AC]:32779};if(n)he[iw]=32775,he[rw]=32776;else{const oe=e.get("EXT_blend_minmax");oe!==null&&(he[iw]=oe.MIN_EXT,he[rw]=oe.MAX_EXT)}const Ce={[CC]:0,[PC]:1,[RC]:768,[K_]:770,[BC]:776,[FC]:774,[kC]:772,[LC]:769,[J_]:771,[DC]:775,[IC]:773};function me(oe,Ne,Je,ae,Te,Ge,ze,ct){if(oe===Mo){y===!0&&(Z(3042),y=!1);return}if(y===!1&&($(3042),y=!0),oe!==EC){if(oe!==x||ct!==z){if((v!==ml||b!==ml)&&(i.blendEquation(32774),v=ml,b=ml),ct)switch(oe){case El:i.blendFuncSeparate(1,771,1,771);break;case ew:i.blendFunc(1,1);break;case tw:i.blendFuncSeparate(0,769,0,1);break;case nw:i.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",oe);break}else switch(oe){case El:i.blendFuncSeparate(770,771,1,771);break;case ew:i.blendFunc(770,1);break;case tw:i.blendFuncSeparate(0,769,0,1);break;case nw:i.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",oe);break}w=null,S=null,E=null,R=null,x=oe,z=ct}return}Te=Te||Ne,Ge=Ge||Je,ze=ze||ae,(Ne!==v||Te!==b)&&(i.blendEquationSeparate(he[Ne],he[Te]),v=Ne,b=Te),(Je!==w||ae!==S||Ge!==E||ze!==R)&&(i.blendFuncSeparate(Ce[Je],Ce[ae],Ce[Ge],Ce[ze]),w=Je,S=ae,E=Ge,R=ze),x=oe,z=null}function fe(oe,Ne){oe.side===Es?Z(2884):$(2884);let Je=oe.side===kr;Ne&&(Je=!Je),we(Je),oe.blending===El&&oe.transparent===!1?me(Mo):me(oe.blending,oe.blendEquation,oe.blendSrc,oe.blendDst,oe.blendEquationAlpha,oe.blendSrcAlpha,oe.blendDstAlpha,oe.premultipliedAlpha),c.setFunc(oe.depthFunc),c.setTest(oe.depthTest),c.setMask(oe.depthWrite),a.setMask(oe.colorWrite);const ae=oe.stencilWrite;h.setTest(ae),ae&&(h.setMask(oe.stencilWriteMask),h.setFunc(oe.stencilFunc,oe.stencilRef,oe.stencilFuncMask),h.setOp(oe.stencilFail,oe.stencilZFail,oe.stencilZPass)),it(oe.polygonOffset,oe.polygonOffsetFactor,oe.polygonOffsetUnits),oe.alphaToCoverage===!0?$(32926):Z(32926)}function we(oe){I!==oe&&(oe?i.frontFace(2304):i.frontFace(2305),I=oe)}function ye(oe){oe!==bC?($(2884),oe!==N&&(oe===Jx?i.cullFace(1029):oe===MC?i.cullFace(1028):i.cullFace(1032))):Z(2884),N=oe}function _e(oe){oe!==F&&(U&&i.lineWidth(oe),F=oe)}function it(oe,Ne,Je){oe?($(32823),(C!==Ne||O!==Je)&&(i.polygonOffset(Ne,Je),C=Ne,O=Je)):Z(32823)}function $e(oe){oe?$(3089):Z(3089)}function et(oe){oe===void 0&&(oe=33984+X-1),j!==oe&&(i.activeTexture(oe),j=oe)}function L(oe,Ne){j===null&&et();let Je=k[j];Je===void 0&&(Je={type:void 0,texture:void 0},k[j]=Je),(Je.type!==oe||Je.texture!==Ne)&&(i.bindTexture(oe,Ne||ee[oe]),Je.type=oe,Je.texture=Ne)}function V(){const oe=k[j];oe!==void 0&&oe.type!==void 0&&(i.bindTexture(oe.type,null),oe.type=void 0,oe.texture=void 0)}function P(){try{i.compressedTexImage2D.apply(i,arguments)}catch(oe){console.error("THREE.WebGLState:",oe)}}function T(){try{i.texSubImage2D.apply(i,arguments)}catch(oe){console.error("THREE.WebGLState:",oe)}}function q(){try{i.texSubImage3D.apply(i,arguments)}catch(oe){console.error("THREE.WebGLState:",oe)}}function re(){try{i.compressedTexSubImage2D.apply(i,arguments)}catch(oe){console.error("THREE.WebGLState:",oe)}}function pe(){try{i.texStorage2D.apply(i,arguments)}catch(oe){console.error("THREE.WebGLState:",oe)}}function ge(){try{i.texStorage3D.apply(i,arguments)}catch(oe){console.error("THREE.WebGLState:",oe)}}function be(){try{i.texImage2D.apply(i,arguments)}catch(oe){console.error("THREE.WebGLState:",oe)}}function G(){try{i.texImage3D.apply(i,arguments)}catch(oe){console.error("THREE.WebGLState:",oe)}}function Ae(oe){H.equals(oe)===!1&&(i.scissor(oe.x,oe.y,oe.z,oe.w),H.copy(oe))}function Fe(oe){J.equals(oe)===!1&&(i.viewport(oe.x,oe.y,oe.z,oe.w),J.copy(oe))}function Ve(){i.disable(3042),i.disable(2884),i.disable(2929),i.disable(32823),i.disable(3089),i.disable(2960),i.disable(32926),i.blendEquation(32774),i.blendFunc(1,0),i.blendFuncSeparate(1,0,1,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(513),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(519,0,4294967295),i.stencilOp(7680,7680,7680),i.clearStencil(0),i.cullFace(1029),i.frontFace(2305),i.polygonOffset(0,0),i.activeTexture(33984),i.bindFramebuffer(36160,null),n===!0&&(i.bindFramebuffer(36009,null),i.bindFramebuffer(36008,null)),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),d={},j=null,k={},l={},u=new WeakMap,p=[],g=null,y=!1,x=null,v=null,w=null,S=null,b=null,E=null,R=null,z=!1,I=null,N=null,F=null,C=null,O=null,H.set(0,0,i.canvas.width,i.canvas.height),J.set(0,0,i.canvas.width,i.canvas.height),a.reset(),c.reset(),h.reset()}return{buffers:{color:a,depth:c,stencil:h},enable:$,disable:Z,bindFramebuffer:Ee,drawBuffers:Se,useProgram:de,setBlending:me,setMaterial:fe,setFlipSided:we,setCullFace:ye,setLineWidth:_e,setPolygonOffset:it,setScissorTest:$e,activeTexture:et,bindTexture:L,unbindTexture:V,compressedTexImage2D:P,texImage2D:be,texImage3D:G,texStorage2D:pe,texStorage3D:ge,texSubImage2D:T,texSubImage3D:q,compressedTexSubImage2D:re,scissor:Ae,viewport:Fe,reset:Ve}}function gO(i,e,t,n,r,s,o){const a=r.isWebGL2,c=r.maxTextures,h=r.maxCubemapSize,d=r.maxTextureSize,l=r.maxSamples,u=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,p=/OculusBrowser/g.test(navigator.userAgent),g=new WeakMap;let y;const x=new WeakMap;let v=!1;try{v=typeof OffscreenCanvas!="undefined"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function w(P,T){return v?new OffscreenCanvas(P,T):Xd("canvas")}function S(P,T,q,re){let pe=1;if((P.width>re||P.height>re)&&(pe=re/Math.max(P.width,P.height)),pe<1||T===!0)if(typeof HTMLImageElement!="undefined"&&P instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&P instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&P instanceof ImageBitmap){const ge=T?kg:Math.floor,be=ge(pe*P.width),G=ge(pe*P.height);y===void 0&&(y=w(be,G));const Ae=q?w(be,G):y;return Ae.width=be,Ae.height=G,Ae.getContext("2d").drawImage(P,0,0,be,G),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+P.width+"x"+P.height+") to ("+be+"x"+G+")."),Ae}else return"data"in P&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+P.width+"x"+P.height+")."),P;return P}function b(P){return Aw(P.width)&&Aw(P.height)}function E(P){return a?!1:P.wrapS!==_i||P.wrapT!==_i||P.minFilter!==Kt&&P.minFilter!==jt}function R(P,T){return P.generateMipmaps&&T&&P.minFilter!==Kt&&P.minFilter!==jt}function z(P){i.generateMipmap(P)}function I(P,T,q,re,pe=!1){if(a===!1)return T;if(P!==null){if(i[P]!==void 0)return i[P];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+P+"'")}let ge=T;return T===6403&&(q===5126&&(ge=33326),q===5131&&(ge=33325),q===5121&&(ge=33321)),T===33319&&(q===5126&&(ge=33328),q===5131&&(ge=33327),q===5121&&(ge=33323)),T===6408&&(q===5126&&(ge=34836),q===5131&&(ge=34842),q===5121&&(ge=re===Ht&&pe===!1?35907:32856),q===32819&&(ge=32854),q===32820&&(ge=32855)),(ge===33325||ge===33326||ge===33327||ge===33328||ge===34842||ge===34836)&&e.get("EXT_color_buffer_float"),ge}function N(P,T,q){return R(P,q)===!0||P.isFramebufferTexture&&P.minFilter!==Kt&&P.minFilter!==jt?Math.log2(Math.max(T.width,T.height))+1:P.mipmaps!==void 0&&P.mipmaps.length>0?P.mipmaps.length:P.isCompressedTexture&&Array.isArray(P.image)?T.mipmaps.length:1}function F(P){return P===Kt||P===Vd||P===Gd?9728:9729}function C(P){const T=P.target;T.removeEventListener("dispose",C),X(T),T.isVideoTexture&&g.delete(T)}function O(P){const T=P.target;T.removeEventListener("dispose",O),te(T)}function X(P){const T=n.get(P);if(T.__webglInit===void 0)return;const q=P.source,re=x.get(q);if(re){const pe=re[T.__cacheKey];pe.usedTimes--,pe.usedTimes===0&&U(P),Object.keys(re).length===0&&x.delete(q)}n.remove(P)}function U(P){const T=n.get(P);i.deleteTexture(T.__webglTexture);const q=P.source,re=x.get(q);delete re[T.__cacheKey],o.memory.textures--}function te(P){const T=P.texture,q=n.get(P),re=n.get(T);if(re.__webglTexture!==void 0&&(i.deleteTexture(re.__webglTexture),o.memory.textures--),P.depthTexture&&P.depthTexture.dispose(),P.isWebGLCubeRenderTarget)for(let pe=0;pe<6;pe++)i.deleteFramebuffer(q.__webglFramebuffer[pe]),q.__webglDepthbuffer&&i.deleteRenderbuffer(q.__webglDepthbuffer[pe]);else i.deleteFramebuffer(q.__webglFramebuffer),q.__webglDepthbuffer&&i.deleteRenderbuffer(q.__webglDepthbuffer),q.__webglMultisampledFramebuffer&&i.deleteFramebuffer(q.__webglMultisampledFramebuffer),q.__webglColorRenderbuffer&&i.deleteRenderbuffer(q.__webglColorRenderbuffer),q.__webglDepthRenderbuffer&&i.deleteRenderbuffer(q.__webglDepthRenderbuffer);if(P.isWebGLMultipleRenderTargets)for(let pe=0,ge=T.length;pe<ge;pe++){const be=n.get(T[pe]);be.__webglTexture&&(i.deleteTexture(be.__webglTexture),o.memory.textures--),n.remove(T[pe])}n.remove(T),n.remove(P)}let ne=0;function j(){ne=0}function k(){const P=ne;return P>=c&&console.warn("THREE.WebGLTextures: Trying to use "+P+" texture units while this GPU supports only "+c),ne+=1,P}function W(P){const T=[];return T.push(P.wrapS),T.push(P.wrapT),T.push(P.magFilter),T.push(P.minFilter),T.push(P.anisotropy),T.push(P.internalFormat),T.push(P.format),T.push(P.type),T.push(P.generateMipmaps),T.push(P.premultiplyAlpha),T.push(P.flipY),T.push(P.unpackAlignment),T.push(P.encoding),T.join()}function Y(P,T){const q=n.get(P);if(P.isVideoTexture&&L(P),P.isRenderTargetTexture===!1&&P.version>0&&q.__version!==P.version){const re=P.image;if(re===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(re.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Se(q,P,T);return}}t.activeTexture(33984+T),t.bindTexture(3553,q.__webglTexture)}function H(P,T){const q=n.get(P);if(P.version>0&&q.__version!==P.version){Se(q,P,T);return}t.activeTexture(33984+T),t.bindTexture(35866,q.__webglTexture)}function J(P,T){const q=n.get(P);if(P.version>0&&q.__version!==P.version){Se(q,P,T);return}t.activeTexture(33984+T),t.bindTexture(32879,q.__webglTexture)}function K(P,T){const q=n.get(P);if(P.version>0&&q.__version!==P.version){de(q,P,T);return}t.activeTexture(33984+T),t.bindTexture(34067,q.__webglTexture)}const ee={[Zs]:10497,[_i]:33071,[wu]:33648},$={[Kt]:9728,[Vd]:9984,[Gd]:9986,[jt]:9729,[lv]:9985,[Do]:9987};function Z(P,T,q){if(q?(i.texParameteri(P,10242,ee[T.wrapS]),i.texParameteri(P,10243,ee[T.wrapT]),(P===32879||P===35866)&&i.texParameteri(P,32882,ee[T.wrapR]),i.texParameteri(P,10240,$[T.magFilter]),i.texParameteri(P,10241,$[T.minFilter])):(i.texParameteri(P,10242,33071),i.texParameteri(P,10243,33071),(P===32879||P===35866)&&i.texParameteri(P,32882,33071),(T.wrapS!==_i||T.wrapT!==_i)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),i.texParameteri(P,10240,F(T.magFilter)),i.texParameteri(P,10241,F(T.minFilter)),T.minFilter!==Kt&&T.minFilter!==jt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),e.has("EXT_texture_filter_anisotropic")===!0){const re=e.get("EXT_texture_filter_anisotropic");if(T.type===_o&&e.has("OES_texture_float_linear")===!1||a===!1&&T.type===Tl&&e.has("OES_texture_half_float_linear")===!1)return;(T.anisotropy>1||n.get(T).__currentAnisotropy)&&(i.texParameterf(P,re.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(T.anisotropy,r.getMaxAnisotropy())),n.get(T).__currentAnisotropy=T.anisotropy)}}function Ee(P,T){let q=!1;P.__webglInit===void 0&&(P.__webglInit=!0,T.addEventListener("dispose",C));const re=T.source;let pe=x.get(re);pe===void 0&&(pe={},x.set(re,pe));const ge=W(T);if(ge!==P.__cacheKey){pe[ge]===void 0&&(pe[ge]={texture:i.createTexture(),usedTimes:0},o.memory.textures++,q=!0),pe[ge].usedTimes++;const be=pe[P.__cacheKey];be!==void 0&&(pe[P.__cacheKey].usedTimes--,be.usedTimes===0&&U(T)),P.__cacheKey=ge,P.__webglTexture=pe[ge].texture}return q}function Se(P,T,q){let re=3553;T.isDataArrayTexture&&(re=35866),T.isData3DTexture&&(re=32879);const pe=Ee(P,T),ge=T.source;if(t.activeTexture(33984+q),t.bindTexture(re,P.__webglTexture),ge.version!==ge.__currentVersion||pe===!0){i.pixelStorei(37440,T.flipY),i.pixelStorei(37441,T.premultiplyAlpha),i.pixelStorei(3317,T.unpackAlignment),i.pixelStorei(37443,0);const be=E(T)&&b(T.image)===!1;let G=S(T.image,be,!1,d);G=V(T,G);const Ae=b(G)||a,Fe=s.convert(T.format,T.encoding);let Ve=s.convert(T.type),oe=I(T.internalFormat,Fe,Ve,T.encoding,T.isVideoTexture);Z(re,T,Ae);let Ne;const Je=T.mipmaps,ae=a&&T.isVideoTexture!==!0,Te=P.__version===void 0,Ge=N(T,G,Ae);if(T.isDepthTexture)oe=6402,a?T.type===_o?oe=36012:T.type===md?oe=33190:T.type===Al?oe=35056:oe=33189:T.type===_o&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),T.format===ba&&oe===6402&&T.type!==_u&&T.type!==md&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),T.type=_u,Ve=s.convert(T.type)),T.format===Bl&&oe===6402&&(oe=34041,T.type!==Al&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),T.type=Al,Ve=s.convert(T.type))),ae&&Te?t.texStorage2D(3553,1,oe,G.width,G.height):t.texImage2D(3553,0,oe,G.width,G.height,0,Fe,Ve,null);else if(T.isDataTexture)if(Je.length>0&&Ae){ae&&Te&&t.texStorage2D(3553,Ge,oe,Je[0].width,Je[0].height);for(let ze=0,ct=Je.length;ze<ct;ze++)Ne=Je[ze],ae?t.texSubImage2D(3553,ze,0,0,Ne.width,Ne.height,Fe,Ve,Ne.data):t.texImage2D(3553,ze,oe,Ne.width,Ne.height,0,Fe,Ve,Ne.data);T.generateMipmaps=!1}else ae?(Te&&t.texStorage2D(3553,Ge,oe,G.width,G.height),t.texSubImage2D(3553,0,0,0,G.width,G.height,Fe,Ve,G.data)):t.texImage2D(3553,0,oe,G.width,G.height,0,Fe,Ve,G.data);else if(T.isCompressedTexture){ae&&Te&&t.texStorage2D(3553,Ge,oe,Je[0].width,Je[0].height);for(let ze=0,ct=Je.length;ze<ct;ze++)Ne=Je[ze],T.format!==ur?Fe!==null?ae?t.compressedTexSubImage2D(3553,ze,0,0,Ne.width,Ne.height,Fe,Ne.data):t.compressedTexImage2D(3553,ze,oe,Ne.width,Ne.height,0,Ne.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ae?t.texSubImage2D(3553,ze,0,0,Ne.width,Ne.height,Fe,Ve,Ne.data):t.texImage2D(3553,ze,oe,Ne.width,Ne.height,0,Fe,Ve,Ne.data)}else if(T.isDataArrayTexture)ae?(Te&&t.texStorage3D(35866,Ge,oe,G.width,G.height,G.depth),t.texSubImage3D(35866,0,0,0,0,G.width,G.height,G.depth,Fe,Ve,G.data)):t.texImage3D(35866,0,oe,G.width,G.height,G.depth,0,Fe,Ve,G.data);else if(T.isData3DTexture)ae?(Te&&t.texStorage3D(32879,Ge,oe,G.width,G.height,G.depth),t.texSubImage3D(32879,0,0,0,0,G.width,G.height,G.depth,Fe,Ve,G.data)):t.texImage3D(32879,0,oe,G.width,G.height,G.depth,0,Fe,Ve,G.data);else if(T.isFramebufferTexture)ae&&Te?t.texStorage2D(3553,Ge,oe,G.width,G.height):t.texImage2D(3553,0,oe,G.width,G.height,0,Fe,Ve,null);else if(Je.length>0&&Ae){ae&&Te&&t.texStorage2D(3553,Ge,oe,Je[0].width,Je[0].height);for(let ze=0,ct=Je.length;ze<ct;ze++)Ne=Je[ze],ae?t.texSubImage2D(3553,ze,0,0,Fe,Ve,Ne):t.texImage2D(3553,ze,oe,Fe,Ve,Ne);T.generateMipmaps=!1}else ae?(Te&&t.texStorage2D(3553,Ge,oe,G.width,G.height),t.texSubImage2D(3553,0,0,0,Fe,Ve,G)):t.texImage2D(3553,0,oe,Fe,Ve,G);R(T,Ae)&&z(re),ge.__currentVersion=ge.version,T.onUpdate&&T.onUpdate(T)}P.__version=T.version}function de(P,T,q){if(T.image.length!==6)return;const re=Ee(P,T),pe=T.source;if(t.activeTexture(33984+q),t.bindTexture(34067,P.__webglTexture),pe.version!==pe.__currentVersion||re===!0){i.pixelStorei(37440,T.flipY),i.pixelStorei(37441,T.premultiplyAlpha),i.pixelStorei(3317,T.unpackAlignment),i.pixelStorei(37443,0);const ge=T.isCompressedTexture||T.image[0].isCompressedTexture,be=T.image[0]&&T.image[0].isDataTexture,G=[];for(let ze=0;ze<6;ze++)!ge&&!be?G[ze]=S(T.image[ze],!1,!0,h):G[ze]=be?T.image[ze].image:T.image[ze],G[ze]=V(T,G[ze]);const Ae=G[0],Fe=b(Ae)||a,Ve=s.convert(T.format,T.encoding),oe=s.convert(T.type),Ne=I(T.internalFormat,Ve,oe,T.encoding),Je=a&&T.isVideoTexture!==!0,ae=P.__version===void 0;let Te=N(T,Ae,Fe);Z(34067,T,Fe);let Ge;if(ge){Je&&ae&&t.texStorage2D(34067,Te,Ne,Ae.width,Ae.height);for(let ze=0;ze<6;ze++){Ge=G[ze].mipmaps;for(let ct=0;ct<Ge.length;ct++){const Pt=Ge[ct];T.format!==ur?Ve!==null?Je?t.compressedTexSubImage2D(34069+ze,ct,0,0,Pt.width,Pt.height,Ve,Pt.data):t.compressedTexImage2D(34069+ze,ct,Ne,Pt.width,Pt.height,0,Pt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Je?t.texSubImage2D(34069+ze,ct,0,0,Pt.width,Pt.height,Ve,oe,Pt.data):t.texImage2D(34069+ze,ct,Ne,Pt.width,Pt.height,0,Ve,oe,Pt.data)}}}else{Ge=T.mipmaps,Je&&ae&&(Ge.length>0&&Te++,t.texStorage2D(34067,Te,Ne,G[0].width,G[0].height));for(let ze=0;ze<6;ze++)if(be){Je?t.texSubImage2D(34069+ze,0,0,0,G[ze].width,G[ze].height,Ve,oe,G[ze].data):t.texImage2D(34069+ze,0,Ne,G[ze].width,G[ze].height,0,Ve,oe,G[ze].data);for(let ct=0;ct<Ge.length;ct++){const xt=Ge[ct].image[ze].image;Je?t.texSubImage2D(34069+ze,ct+1,0,0,xt.width,xt.height,Ve,oe,xt.data):t.texImage2D(34069+ze,ct+1,Ne,xt.width,xt.height,0,Ve,oe,xt.data)}}else{Je?t.texSubImage2D(34069+ze,0,0,0,Ve,oe,G[ze]):t.texImage2D(34069+ze,0,Ne,Ve,oe,G[ze]);for(let ct=0;ct<Ge.length;ct++){const Pt=Ge[ct];Je?t.texSubImage2D(34069+ze,ct+1,0,0,Ve,oe,Pt.image[ze]):t.texImage2D(34069+ze,ct+1,Ne,Ve,oe,Pt.image[ze])}}}R(T,Fe)&&z(34067),pe.__currentVersion=pe.version,T.onUpdate&&T.onUpdate(T)}P.__version=T.version}function he(P,T,q,re,pe){const ge=s.convert(q.format,q.encoding),be=s.convert(q.type),G=I(q.internalFormat,ge,be,q.encoding);n.get(T).__hasExternalTextures||(pe===32879||pe===35866?t.texImage3D(pe,0,G,T.width,T.height,T.depth,0,ge,be,null):t.texImage2D(pe,0,G,T.width,T.height,0,ge,be,null)),t.bindFramebuffer(36160,P),et(T)?u.framebufferTexture2DMultisampleEXT(36160,re,pe,n.get(q).__webglTexture,0,$e(T)):i.framebufferTexture2D(36160,re,pe,n.get(q).__webglTexture,0),t.bindFramebuffer(36160,null)}function Ce(P,T,q){if(i.bindRenderbuffer(36161,P),T.depthBuffer&&!T.stencilBuffer){let re=33189;if(q||et(T)){const pe=T.depthTexture;pe&&pe.isDepthTexture&&(pe.type===_o?re=36012:pe.type===md&&(re=33190));const ge=$e(T);et(T)?u.renderbufferStorageMultisampleEXT(36161,ge,re,T.width,T.height):i.renderbufferStorageMultisample(36161,ge,re,T.width,T.height)}else i.renderbufferStorage(36161,re,T.width,T.height);i.framebufferRenderbuffer(36160,36096,36161,P)}else if(T.depthBuffer&&T.stencilBuffer){const re=$e(T);q&&et(T)===!1?i.renderbufferStorageMultisample(36161,re,35056,T.width,T.height):et(T)?u.renderbufferStorageMultisampleEXT(36161,re,35056,T.width,T.height):i.renderbufferStorage(36161,34041,T.width,T.height),i.framebufferRenderbuffer(36160,33306,36161,P)}else{const re=T.isWebGLMultipleRenderTargets===!0?T.texture[0]:T.texture,pe=s.convert(re.format,re.encoding),ge=s.convert(re.type),be=I(re.internalFormat,pe,ge,re.encoding),G=$e(T);q&&et(T)===!1?i.renderbufferStorageMultisample(36161,G,be,T.width,T.height):et(T)?u.renderbufferStorageMultisampleEXT(36161,G,be,T.width,T.height):i.renderbufferStorage(36161,be,T.width,T.height)}i.bindRenderbuffer(36161,null)}function me(P,T){if(T&&T.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,P),!(T.depthTexture&&T.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get(T.depthTexture).__webglTexture||T.depthTexture.image.width!==T.width||T.depthTexture.image.height!==T.height)&&(T.depthTexture.image.width=T.width,T.depthTexture.image.height=T.height,T.depthTexture.needsUpdate=!0),Y(T.depthTexture,0);const re=n.get(T.depthTexture).__webglTexture,pe=$e(T);if(T.depthTexture.format===ba)et(T)?u.framebufferTexture2DMultisampleEXT(36160,36096,3553,re,0,pe):i.framebufferTexture2D(36160,36096,3553,re,0);else if(T.depthTexture.format===Bl)et(T)?u.framebufferTexture2DMultisampleEXT(36160,33306,3553,re,0,pe):i.framebufferTexture2D(36160,33306,3553,re,0);else throw new Error("Unknown depthTexture format")}function fe(P){const T=n.get(P),q=P.isWebGLCubeRenderTarget===!0;if(P.depthTexture&&!T.__autoAllocateDepthBuffer){if(q)throw new Error("target.depthTexture not supported in Cube render targets");me(T.__webglFramebuffer,P)}else if(q){T.__webglDepthbuffer=[];for(let re=0;re<6;re++)t.bindFramebuffer(36160,T.__webglFramebuffer[re]),T.__webglDepthbuffer[re]=i.createRenderbuffer(),Ce(T.__webglDepthbuffer[re],P,!1)}else t.bindFramebuffer(36160,T.__webglFramebuffer),T.__webglDepthbuffer=i.createRenderbuffer(),Ce(T.__webglDepthbuffer,P,!1);t.bindFramebuffer(36160,null)}function we(P,T,q){const re=n.get(P);T!==void 0&&he(re.__webglFramebuffer,P,P.texture,36064,3553),q!==void 0&&fe(P)}function ye(P){const T=P.texture,q=n.get(P),re=n.get(T);P.addEventListener("dispose",O),P.isWebGLMultipleRenderTargets!==!0&&(re.__webglTexture===void 0&&(re.__webglTexture=i.createTexture()),re.__version=T.version,o.memory.textures++);const pe=P.isWebGLCubeRenderTarget===!0,ge=P.isWebGLMultipleRenderTargets===!0,be=b(P)||a;if(pe){q.__webglFramebuffer=[];for(let G=0;G<6;G++)q.__webglFramebuffer[G]=i.createFramebuffer()}else if(q.__webglFramebuffer=i.createFramebuffer(),ge)if(r.drawBuffers){const G=P.texture;for(let Ae=0,Fe=G.length;Ae<Fe;Ae++){const Ve=n.get(G[Ae]);Ve.__webglTexture===void 0&&(Ve.__webglTexture=i.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(a&&P.samples>0&&et(P)===!1){q.__webglMultisampledFramebuffer=i.createFramebuffer(),q.__webglColorRenderbuffer=i.createRenderbuffer(),i.bindRenderbuffer(36161,q.__webglColorRenderbuffer);const G=s.convert(T.format,T.encoding),Ae=s.convert(T.type),Fe=I(T.internalFormat,G,Ae,T.encoding),Ve=$e(P);i.renderbufferStorageMultisample(36161,Ve,Fe,P.width,P.height),t.bindFramebuffer(36160,q.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(36160,36064,36161,q.__webglColorRenderbuffer),i.bindRenderbuffer(36161,null),P.depthBuffer&&(q.__webglDepthRenderbuffer=i.createRenderbuffer(),Ce(q.__webglDepthRenderbuffer,P,!0)),t.bindFramebuffer(36160,null)}if(pe){t.bindTexture(34067,re.__webglTexture),Z(34067,T,be);for(let G=0;G<6;G++)he(q.__webglFramebuffer[G],P,T,36064,34069+G);R(T,be)&&z(34067),t.unbindTexture()}else if(ge){const G=P.texture;for(let Ae=0,Fe=G.length;Ae<Fe;Ae++){const Ve=G[Ae],oe=n.get(Ve);t.bindTexture(3553,oe.__webglTexture),Z(3553,Ve,be),he(q.__webglFramebuffer,P,Ve,36064+Ae,3553),R(Ve,be)&&z(3553)}t.unbindTexture()}else{let G=3553;(P.isWebGL3DRenderTarget||P.isWebGLArrayRenderTarget)&&(a?G=P.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(G,re.__webglTexture),Z(G,T,be),he(q.__webglFramebuffer,P,T,36064,G),R(T,be)&&z(G),t.unbindTexture()}P.depthBuffer&&fe(P)}function _e(P){const T=b(P)||a,q=P.isWebGLMultipleRenderTargets===!0?P.texture:[P.texture];for(let re=0,pe=q.length;re<pe;re++){const ge=q[re];if(R(ge,T)){const be=P.isWebGLCubeRenderTarget?34067:3553,G=n.get(ge).__webglTexture;t.bindTexture(be,G),z(be),t.unbindTexture()}}}function it(P){if(a&&P.samples>0&&et(P)===!1){const T=P.width,q=P.height;let re=16384;const pe=[36064],ge=P.stencilBuffer?33306:36096;P.depthBuffer&&pe.push(ge);const be=n.get(P),G=be.__ignoreDepthValues!==void 0?be.__ignoreDepthValues:!1;G===!1&&(P.depthBuffer&&(re|=256),P.stencilBuffer&&(re|=1024)),t.bindFramebuffer(36008,be.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,be.__webglFramebuffer),G===!0&&(i.invalidateFramebuffer(36008,[ge]),i.invalidateFramebuffer(36009,[ge])),i.blitFramebuffer(0,0,T,q,0,0,T,q,re,9728),p&&i.invalidateFramebuffer(36008,pe),t.bindFramebuffer(36008,null),t.bindFramebuffer(36009,be.__webglMultisampledFramebuffer)}}function $e(P){return Math.min(l,P.samples)}function et(P){const T=n.get(P);return a&&P.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&T.__useRenderToTexture!==!1}function L(P){const T=o.render.frame;g.get(P)!==T&&(g.set(P,T),P.update())}function V(P,T){const q=P.encoding,re=P.format,pe=P.type;return P.isCompressedTexture===!0||P.isVideoTexture===!0||P.format===Lg||q!==Ts&&(q===Ht?a===!1?e.has("EXT_sRGB")===!0&&re===ur?(P.format=Lg,P.minFilter=jt,P.generateMipmaps=!1):T=Ua.sRGBToLinear(T):(re!==ur||pe!==ka)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",q)),T}this.allocateTextureUnit=k,this.resetTextureUnits=j,this.setTexture2D=Y,this.setTexture2DArray=H,this.setTexture3D=J,this.setTextureCube=K,this.rebindTextures=we,this.setupRenderTarget=ye,this.updateRenderTargetMipmap=_e,this.updateMultisampleRenderTarget=it,this.setupDepthRenderbuffer=fe,this.setupFrameBufferTexture=he,this.useMultisampledRTT=et}function V3(i,e,t){const n=t.isWebGL2;function r(s,o=null){let a;if(s===ka)return 5121;if(s===JC)return 32819;if(s===e3)return 32820;if(s===QC)return 5120;if(s===ZC)return 5122;if(s===_u)return 5123;if(s===KC)return 5124;if(s===md)return 5125;if(s===_o)return 5126;if(s===Tl)return n?5131:(a=e.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(s===t3)return 6406;if(s===ur)return 6408;if(s===i3)return 6409;if(s===r3)return 6410;if(s===ba)return 6402;if(s===Bl)return 34041;if(s===s3)return 6403;if(s===n3)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(s===Lg)return a=e.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(s===o3)return 36244;if(s===a3)return 33319;if(s===l3)return 33320;if(s===c3)return 36249;if(s===Ym||s===$m||s===Qm||s===Zm)if(o===Ht)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(s===Ym)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===$m)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===Qm)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===Zm)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(s===Ym)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===$m)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===Qm)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===Zm)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===sw||s===ow||s===aw||s===lw)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(s===sw)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===ow)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===aw)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===lw)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===u3)return a=e.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===cw||s===uw)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(s===cw)return o===Ht?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===uw)return o===Ht?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===hw||s===dw||s===fw||s===pw||s===mw||s===gw||s===vw||s===yw||s===xw||s===ww||s===_w||s===Sw||s===bw||s===Mw)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(s===hw)return o===Ht?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===dw)return o===Ht?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===fw)return o===Ht?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===pw)return o===Ht?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===mw)return o===Ht?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===gw)return o===Ht?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===vw)return o===Ht?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===yw)return o===Ht?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===xw)return o===Ht?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===ww)return o===Ht?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===_w)return o===Ht?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===Sw)return o===Ht?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===bw)return o===Ht?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===Mw)return o===Ht?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===Ew)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(s===Ew)return o===Ht?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(s===Al)return n?34042:(a=e.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null)}return{convert:r}}class o1 extends Mn{constructor(e=[]){super(),this.cameras=e}}o1.prototype.isArrayCamera=!0;class Jr extends ft{constructor(){super(),this.type="Group"}}Jr.prototype.isGroup=!0;const vO={type:"move"};class Iy{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Jr,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Jr,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new B,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new B),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Jr,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new B,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new B),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let r=null,s=null,o=null;const a=this._targetRay,c=this._grip,h=this._hand;if(e&&t.session.visibilityState!=="visible-blurred")if(a!==null&&(r=t.getPose(e.targetRaySpace,n),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(vO))),h&&e.hand){o=!0;for(const y of e.hand.values()){const x=t.getJointPose(y,n);if(h.joints[y.jointName]===void 0){const w=new Jr;w.matrixAutoUpdate=!1,w.visible=!1,h.joints[y.jointName]=w,h.add(w)}const v=h.joints[y.jointName];x!==null&&(v.matrix.fromArray(x.transform.matrix),v.matrix.decompose(v.position,v.rotation,v.scale),v.jointRadius=x.radius),v.visible=x!==null}const d=h.joints["index-finger-tip"],l=h.joints["thumb-tip"],u=d.position.distanceTo(l.position),p=.02,g=.005;h.inputState.pinching&&u>p+g?(h.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!h.inputState.pinching&&u<=p-g&&(h.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else c!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,n),s!==null&&(c.matrix.fromArray(s.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),s.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(s.linearVelocity)):c.hasLinearVelocity=!1,s.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(s.angularVelocity)):c.hasAngularVelocity=!1));return a!==null&&(a.visible=r!==null),c!==null&&(c.visible=s!==null),h!==null&&(h.visible=o!==null),this}}class a1 extends hn{constructor(e,t,n,r,s,o,a,c,h,d){if(d=d!==void 0?d:ba,d!==ba&&d!==Bl)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&d===ba&&(n=_u),n===void 0&&d===Bl&&(n=Al),super(null,r,s,o,a,c,d,n,h),this.image={width:e,height:t},this.magFilter=a!==void 0?a:Kt,this.minFilter=c!==void 0?c:Kt,this.flipY=!1,this.generateMipmaps=!1}}a1.prototype.isDepthTexture=!0;class yO extends Bo{constructor(e,t){super();const n=this;let r=null,s=1,o=null,a="local-floor",c=null,h=null,d=null,l=null,u=null;const p=t.getContextAttributes();let g=null,y=null;const x=[],v=new Map,w=new Mn;w.layers.enable(1),w.viewport=new Jt;const S=new Mn;S.layers.enable(2),S.viewport=new Jt;const b=[w,S],E=new o1;E.layers.enable(1),E.layers.enable(2);let R=null,z=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(k){let W=x[k];return W===void 0&&(W=new Iy,x[k]=W),W.getTargetRaySpace()},this.getControllerGrip=function(k){let W=x[k];return W===void 0&&(W=new Iy,x[k]=W),W.getGripSpace()},this.getHand=function(k){let W=x[k];return W===void 0&&(W=new Iy,x[k]=W),W.getHandSpace()};function I(k){const W=v.get(k.inputSource);W&&W.dispatchEvent({type:k.type,data:k.inputSource})}function N(){v.forEach(function(k,W){k.disconnect(W)}),v.clear(),R=null,z=null,e.setRenderTarget(g),l=null,d=null,h=null,r=null,y=null,j.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(k){s=k,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(k){a=k,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return o},this.getBaseLayer=function(){return d!==null?d:l},this.getBinding=function(){return h},this.getFrame=function(){return u},this.getSession=function(){return r},this.setSession=async function(k){if(r=k,r!==null){if(g=e.getRenderTarget(),r.addEventListener("select",I),r.addEventListener("selectstart",I),r.addEventListener("selectend",I),r.addEventListener("squeeze",I),r.addEventListener("squeezestart",I),r.addEventListener("squeezeend",I),r.addEventListener("end",N),r.addEventListener("inputsourceschange",F),p.xrCompatible!==!0&&await t.makeXRCompatible(),r.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const W={antialias:r.renderState.layers===void 0?p.antialias:!0,alpha:p.alpha,depth:p.depth,stencil:p.stencil,framebufferScaleFactor:s};l=new XRWebGLLayer(r,t,W),r.updateRenderState({baseLayer:l}),y=new Gi(l.framebufferWidth,l.framebufferHeight,{format:ur,type:ka,encoding:e.outputEncoding})}else{let W=null,Y=null,H=null;p.depth&&(H=p.stencil?35056:33190,W=p.stencil?Bl:ba,Y=p.stencil?Al:_u);const J={colorFormat:e.outputEncoding===Ht?35907:32856,depthFormat:H,scaleFactor:s};h=new XRWebGLBinding(r,t),d=h.createProjectionLayer(J),r.updateRenderState({layers:[d]}),y=new Gi(d.textureWidth,d.textureHeight,{format:ur,type:ka,depthTexture:new a1(d.textureWidth,d.textureHeight,Y,void 0,void 0,void 0,void 0,void 0,void 0,W),stencilBuffer:p.stencil,encoding:e.outputEncoding,samples:p.antialias?4:0});const K=e.properties.get(y);K.__ignoreDepthValues=d.ignoreDepthValues}y.isXRRenderTarget=!0,this.setFoveation(1),o=await r.requestReferenceSpace(a),j.setContext(r),j.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}};function F(k){const W=r.inputSources;for(let Y=0;Y<x.length;Y++)v.set(W[Y],x[Y]);for(let Y=0;Y<k.removed.length;Y++){const H=k.removed[Y],J=v.get(H);J&&(J.dispatchEvent({type:"disconnected",data:H}),v.delete(H))}for(let Y=0;Y<k.added.length;Y++){const H=k.added[Y],J=v.get(H);J&&J.dispatchEvent({type:"connected",data:H})}}const C=new B,O=new B;function X(k,W,Y){C.setFromMatrixPosition(W.matrixWorld),O.setFromMatrixPosition(Y.matrixWorld);const H=C.distanceTo(O),J=W.projectionMatrix.elements,K=Y.projectionMatrix.elements,ee=J[14]/(J[10]-1),$=J[14]/(J[10]+1),Z=(J[9]+1)/J[5],Ee=(J[9]-1)/J[5],Se=(J[8]-1)/J[0],de=(K[8]+1)/K[0],he=ee*Se,Ce=ee*de,me=H/(-Se+de),fe=me*-Se;W.matrixWorld.decompose(k.position,k.quaternion,k.scale),k.translateX(fe),k.translateZ(me),k.matrixWorld.compose(k.position,k.quaternion,k.scale),k.matrixWorldInverse.copy(k.matrixWorld).invert();const we=ee+me,ye=$+me,_e=he-fe,it=Ce+(H-fe),$e=Z*$/ye*we,et=Ee*$/ye*we;k.projectionMatrix.makePerspective(_e,it,$e,et,we,ye)}function U(k,W){W===null?k.matrixWorld.copy(k.matrix):k.matrixWorld.multiplyMatrices(W.matrixWorld,k.matrix),k.matrixWorldInverse.copy(k.matrixWorld).invert()}this.updateCamera=function(k){if(r===null)return;E.near=S.near=w.near=k.near,E.far=S.far=w.far=k.far,(R!==E.near||z!==E.far)&&(r.updateRenderState({depthNear:E.near,depthFar:E.far}),R=E.near,z=E.far);const W=k.parent,Y=E.cameras;U(E,W);for(let J=0;J<Y.length;J++)U(Y[J],W);E.matrixWorld.decompose(E.position,E.quaternion,E.scale),k.position.copy(E.position),k.quaternion.copy(E.quaternion),k.scale.copy(E.scale),k.matrix.copy(E.matrix),k.matrixWorld.copy(E.matrixWorld);const H=k.children;for(let J=0,K=H.length;J<K;J++)H[J].updateMatrixWorld(!0);Y.length===2?X(E,w,S):E.projectionMatrix.copy(w.projectionMatrix)},this.getCamera=function(){return E},this.getFoveation=function(){if(d!==null)return d.fixedFoveation;if(l!==null)return l.fixedFoveation},this.setFoveation=function(k){d!==null&&(d.fixedFoveation=k),l!==null&&l.fixedFoveation!==void 0&&(l.fixedFoveation=k)};let te=null;function ne(k,W){if(c=W.getViewerPose(o),u=W,c!==null){const H=c.views;l!==null&&(e.setRenderTargetFramebuffer(y,l.framebuffer),e.setRenderTarget(y));let J=!1;H.length!==E.cameras.length&&(E.cameras.length=0,J=!0);for(let K=0;K<H.length;K++){const ee=H[K];let $=null;if(l!==null)$=l.getViewport(ee);else{const Ee=h.getViewSubImage(d,ee);$=Ee.viewport,K===0&&(e.setRenderTargetTextures(y,Ee.colorTexture,d.ignoreDepthValues?void 0:Ee.depthStencilTexture),e.setRenderTarget(y))}const Z=b[K];Z.matrix.fromArray(ee.transform.matrix),Z.projectionMatrix.fromArray(ee.projectionMatrix),Z.viewport.set($.x,$.y,$.width,$.height),K===0&&E.matrix.copy(Z.matrix),J===!0&&E.cameras.push(Z)}}const Y=r.inputSources;for(let H=0;H<x.length;H++){const J=x[H],K=Y[H];J.update(K,W,o)}te&&te(k,W),u=null}const j=new I3;j.setAnimationLoop(ne),this.setAnimationLoop=function(k){te=k},this.dispose=function(){}}}function xO(i,e){function t(y,x){y.fogColor.value.copy(x.color),x.isFog?(y.fogNear.value=x.near,y.fogFar.value=x.far):x.isFogExp2&&(y.fogDensity.value=x.density)}function n(y,x,v,w,S){x.isMeshBasicMaterial||x.isMeshLambertMaterial?r(y,x):x.isMeshToonMaterial?(r(y,x),d(y,x)):x.isMeshPhongMaterial?(r(y,x),h(y,x)):x.isMeshStandardMaterial?(r(y,x),l(y,x),x.isMeshPhysicalMaterial&&u(y,x,S)):x.isMeshMatcapMaterial?(r(y,x),p(y,x)):x.isMeshDepthMaterial?r(y,x):x.isMeshDistanceMaterial?(r(y,x),g(y,x)):x.isMeshNormalMaterial?r(y,x):x.isLineBasicMaterial?(s(y,x),x.isLineDashedMaterial&&o(y,x)):x.isPointsMaterial?a(y,x,v,w):x.isSpriteMaterial?c(y,x):x.isShadowMaterial?(y.color.value.copy(x.color),y.opacity.value=x.opacity):x.isShaderMaterial&&(x.uniformsNeedUpdate=!1)}function r(y,x){y.opacity.value=x.opacity,x.color&&y.diffuse.value.copy(x.color),x.emissive&&y.emissive.value.copy(x.emissive).multiplyScalar(x.emissiveIntensity),x.map&&(y.map.value=x.map),x.alphaMap&&(y.alphaMap.value=x.alphaMap),x.bumpMap&&(y.bumpMap.value=x.bumpMap,y.bumpScale.value=x.bumpScale,x.side===kr&&(y.bumpScale.value*=-1)),x.displacementMap&&(y.displacementMap.value=x.displacementMap,y.displacementScale.value=x.displacementScale,y.displacementBias.value=x.displacementBias),x.emissiveMap&&(y.emissiveMap.value=x.emissiveMap),x.normalMap&&(y.normalMap.value=x.normalMap,y.normalScale.value.copy(x.normalScale),x.side===kr&&y.normalScale.value.negate()),x.specularMap&&(y.specularMap.value=x.specularMap),x.alphaTest>0&&(y.alphaTest.value=x.alphaTest);const v=e.get(x).envMap;if(v&&(y.envMap.value=v,y.flipEnvMap.value=v.isCubeTexture&&v.isRenderTargetTexture===!1?-1:1,y.reflectivity.value=x.reflectivity,y.ior.value=x.ior,y.refractionRatio.value=x.refractionRatio),x.lightMap){y.lightMap.value=x.lightMap;const b=i.physicallyCorrectLights!==!0?Math.PI:1;y.lightMapIntensity.value=x.lightMapIntensity*b}x.aoMap&&(y.aoMap.value=x.aoMap,y.aoMapIntensity.value=x.aoMapIntensity);let w;x.map?w=x.map:x.specularMap?w=x.specularMap:x.displacementMap?w=x.displacementMap:x.normalMap?w=x.normalMap:x.bumpMap?w=x.bumpMap:x.roughnessMap?w=x.roughnessMap:x.metalnessMap?w=x.metalnessMap:x.alphaMap?w=x.alphaMap:x.emissiveMap?w=x.emissiveMap:x.clearcoatMap?w=x.clearcoatMap:x.clearcoatNormalMap?w=x.clearcoatNormalMap:x.clearcoatRoughnessMap?w=x.clearcoatRoughnessMap:x.specularIntensityMap?w=x.specularIntensityMap:x.specularColorMap?w=x.specularColorMap:x.transmissionMap?w=x.transmissionMap:x.thicknessMap?w=x.thicknessMap:x.sheenColorMap?w=x.sheenColorMap:x.sheenRoughnessMap&&(w=x.sheenRoughnessMap),w!==void 0&&(w.isWebGLRenderTarget&&(w=w.texture),w.matrixAutoUpdate===!0&&w.updateMatrix(),y.uvTransform.value.copy(w.matrix));let S;x.aoMap?S=x.aoMap:x.lightMap&&(S=x.lightMap),S!==void 0&&(S.isWebGLRenderTarget&&(S=S.texture),S.matrixAutoUpdate===!0&&S.updateMatrix(),y.uv2Transform.value.copy(S.matrix))}function s(y,x){y.diffuse.value.copy(x.color),y.opacity.value=x.opacity}function o(y,x){y.dashSize.value=x.dashSize,y.totalSize.value=x.dashSize+x.gapSize,y.scale.value=x.scale}function a(y,x,v,w){y.diffuse.value.copy(x.color),y.opacity.value=x.opacity,y.size.value=x.size*v,y.scale.value=w*.5,x.map&&(y.map.value=x.map),x.alphaMap&&(y.alphaMap.value=x.alphaMap),x.alphaTest>0&&(y.alphaTest.value=x.alphaTest);let S;x.map?S=x.map:x.alphaMap&&(S=x.alphaMap),S!==void 0&&(S.matrixAutoUpdate===!0&&S.updateMatrix(),y.uvTransform.value.copy(S.matrix))}function c(y,x){y.diffuse.value.copy(x.color),y.opacity.value=x.opacity,y.rotation.value=x.rotation,x.map&&(y.map.value=x.map),x.alphaMap&&(y.alphaMap.value=x.alphaMap),x.alphaTest>0&&(y.alphaTest.value=x.alphaTest);let v;x.map?v=x.map:x.alphaMap&&(v=x.alphaMap),v!==void 0&&(v.matrixAutoUpdate===!0&&v.updateMatrix(),y.uvTransform.value.copy(v.matrix))}function h(y,x){y.specular.value.copy(x.specular),y.shininess.value=Math.max(x.shininess,1e-4)}function d(y,x){x.gradientMap&&(y.gradientMap.value=x.gradientMap)}function l(y,x){y.roughness.value=x.roughness,y.metalness.value=x.metalness,x.roughnessMap&&(y.roughnessMap.value=x.roughnessMap),x.metalnessMap&&(y.metalnessMap.value=x.metalnessMap),e.get(x).envMap&&(y.envMapIntensity.value=x.envMapIntensity)}function u(y,x,v){y.ior.value=x.ior,x.sheen>0&&(y.sheenColor.value.copy(x.sheenColor).multiplyScalar(x.sheen),y.sheenRoughness.value=x.sheenRoughness,x.sheenColorMap&&(y.sheenColorMap.value=x.sheenColorMap),x.sheenRoughnessMap&&(y.sheenRoughnessMap.value=x.sheenRoughnessMap)),x.clearcoat>0&&(y.clearcoat.value=x.clearcoat,y.clearcoatRoughness.value=x.clearcoatRoughness,x.clearcoatMap&&(y.clearcoatMap.value=x.clearcoatMap),x.clearcoatRoughnessMap&&(y.clearcoatRoughnessMap.value=x.clearcoatRoughnessMap),x.clearcoatNormalMap&&(y.clearcoatNormalScale.value.copy(x.clearcoatNormalScale),y.clearcoatNormalMap.value=x.clearcoatNormalMap,x.side===kr&&y.clearcoatNormalScale.value.negate())),x.transmission>0&&(y.transmission.value=x.transmission,y.transmissionSamplerMap.value=v.texture,y.transmissionSamplerSize.value.set(v.width,v.height),x.transmissionMap&&(y.transmissionMap.value=x.transmissionMap),y.thickness.value=x.thickness,x.thicknessMap&&(y.thicknessMap.value=x.thicknessMap),y.attenuationDistance.value=x.attenuationDistance,y.attenuationColor.value.copy(x.attenuationColor)),y.specularIntensity.value=x.specularIntensity,y.specularColor.value.copy(x.specularColor),x.specularIntensityMap&&(y.specularIntensityMap.value=x.specularIntensityMap),x.specularColorMap&&(y.specularColorMap.value=x.specularColorMap)}function p(y,x){x.matcap&&(y.matcap.value=x.matcap)}function g(y,x){y.referencePosition.value.copy(x.referencePosition),y.nearDistance.value=x.nearDistance,y.farDistance.value=x.farDistance}return{refreshFogUniforms:t,refreshMaterialUniforms:n}}function wO(){const i=Xd("canvas");return i.style.display="block",i}function ln(i={}){const e=i.canvas!==void 0?i.canvas:wO(),t=i.context!==void 0?i.context:null,n=i.depth!==void 0?i.depth:!0,r=i.stencil!==void 0?i.stencil:!0,s=i.antialias!==void 0?i.antialias:!1,o=i.premultipliedAlpha!==void 0?i.premultipliedAlpha:!0,a=i.preserveDrawingBuffer!==void 0?i.preserveDrawingBuffer:!1,c=i.powerPreference!==void 0?i.powerPreference:"default",h=i.failIfMajorPerformanceCaveat!==void 0?i.failIfMajorPerformanceCaveat:!1;let d;i.context!==void 0?d=t.getContextAttributes().alpha:d=i.alpha!==void 0?i.alpha:!1;let l=null,u=null;const p=[],g=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Ts,this.physicallyCorrectLights=!1,this.toneMapping=bs,this.toneMappingExposure=1;const y=this;let x=!1,v=0,w=0,S=null,b=-1,E=null;const R=new Jt,z=new Jt;let I=null,N=e.width,F=e.height,C=1,O=null,X=null;const U=new Jt(0,0,N,F),te=new Jt(0,0,N,F);let ne=!1;const j=new ff;let k=!1,W=!1,Y=null;const H=new st,J=new Me,K=new B,ee={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function $(){return S===null?C:1}let Z=t;function Ee(Q,le){for(let ue=0;ue<Q.length;ue++){const ce=Q[ue],ie=e.getContext(ce,le);if(ie!==null)return ie}return null}try{const Q={alpha:!0,depth:n,stencil:r,antialias:s,premultipliedAlpha:o,preserveDrawingBuffer:a,powerPreference:c,failIfMajorPerformanceCaveat:h};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${ov}`),e.addEventListener("webglcontextlost",oe,!1),e.addEventListener("webglcontextrestored",Ne,!1),Z===null){const le=["webgl2","webgl","experimental-webgl"];if(y.isWebGL1Renderer===!0&&le.shift(),Z=Ee(le,Q),Z===null)throw Ee(le)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}Z.getShaderPrecisionFormat===void 0&&(Z.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Q){throw console.error("THREE.WebGLRenderer: "+Q.message),Q}let Se,de,he,Ce,me,fe,we,ye,_e,it,$e,et,L,V,P,T,q,re,pe,ge,be,G,Ae;function Fe(){Se=new Nz(Z),de=new Iz(Z,Se,i),Se.init(de),G=new V3(Z,Se,de),he=new mO(Z,Se,de),Ce=new Vz,me=new rO,fe=new gO(Z,Se,he,me,de,G,Ce),we=new Dz(y),ye=new Oz(y),_e=new nD(Z,de),Ae=new Lz(Z,Se,_e,de),it=new Uz(Z,_e,Ce,Ae),$e=new Xz(Z,it,_e,Ce),pe=new jz(Z,de,fe),T=new Fz(me),et=new iO(y,we,ye,Se,de,Ae,T),L=new xO(y,me),V=new oO,P=new dO(Se,de),re=new Rz(y,we,he,$e,d,o),q=new H3(y,$e,de),ge=new kz(Z,Se,Ce,de),be=new Hz(Z,Se,Ce,de),Ce.programs=et.programs,y.capabilities=de,y.extensions=Se,y.properties=me,y.renderLists=V,y.shadowMap=q,y.state=he,y.info=Ce}Fe();const Ve=new yO(y,Z);this.xr=Ve,this.getContext=function(){return Z},this.getContextAttributes=function(){return Z.getContextAttributes()},this.forceContextLoss=function(){const Q=Se.get("WEBGL_lose_context");Q&&Q.loseContext()},this.forceContextRestore=function(){const Q=Se.get("WEBGL_lose_context");Q&&Q.restoreContext()},this.getPixelRatio=function(){return C},this.setPixelRatio=function(Q){Q!==void 0&&(C=Q,this.setSize(N,F,!1))},this.getSize=function(Q){return Q.set(N,F)},this.setSize=function(Q,le,ue){if(Ve.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}N=Q,F=le,e.width=Math.floor(Q*C),e.height=Math.floor(le*C),ue!==!1&&(e.style.width=Q+"px",e.style.height=le+"px"),this.setViewport(0,0,Q,le)},this.getDrawingBufferSize=function(Q){return Q.set(N*C,F*C).floor()},this.setDrawingBufferSize=function(Q,le,ue){N=Q,F=le,C=ue,e.width=Math.floor(Q*ue),e.height=Math.floor(le*ue),this.setViewport(0,0,Q,le)},this.getCurrentViewport=function(Q){return Q.copy(R)},this.getViewport=function(Q){return Q.copy(U)},this.setViewport=function(Q,le,ue,ce){Q.isVector4?U.set(Q.x,Q.y,Q.z,Q.w):U.set(Q,le,ue,ce),he.viewport(R.copy(U).multiplyScalar(C).floor())},this.getScissor=function(Q){return Q.copy(te)},this.setScissor=function(Q,le,ue,ce){Q.isVector4?te.set(Q.x,Q.y,Q.z,Q.w):te.set(Q,le,ue,ce),he.scissor(z.copy(te).multiplyScalar(C).floor())},this.getScissorTest=function(){return ne},this.setScissorTest=function(Q){he.setScissorTest(ne=Q)},this.setOpaqueSort=function(Q){O=Q},this.setTransparentSort=function(Q){X=Q},this.getClearColor=function(Q){return Q.copy(re.getClearColor())},this.setClearColor=function(){re.setClearColor.apply(re,arguments)},this.getClearAlpha=function(){return re.getClearAlpha()},this.setClearAlpha=function(){re.setClearAlpha.apply(re,arguments)},this.clear=function(Q=!0,le=!0,ue=!0){let ce=0;Q&&(ce|=16384),le&&(ce|=256),ue&&(ce|=1024),Z.clear(ce)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",oe,!1),e.removeEventListener("webglcontextrestored",Ne,!1),V.dispose(),P.dispose(),me.dispose(),we.dispose(),ye.dispose(),$e.dispose(),Ae.dispose(),et.dispose(),Ve.dispose(),Ve.removeEventListener("sessionstart",ct),Ve.removeEventListener("sessionend",Pt),Y&&(Y.dispose(),Y=null),xt.stop()};function oe(Q){Q.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),x=!0}function Ne(){console.log("THREE.WebGLRenderer: Context Restored."),x=!1;const Q=Ce.autoReset,le=q.enabled,ue=q.autoUpdate,ce=q.needsUpdate,ie=q.type;Fe(),Ce.autoReset=Q,q.enabled=le,q.autoUpdate=ue,q.needsUpdate=ce,q.type=ie}function Je(Q){const le=Q.target;le.removeEventListener("dispose",Je),ae(le)}function ae(Q){Te(Q),me.remove(Q)}function Te(Q){const le=me.get(Q).programs;le!==void 0&&(le.forEach(function(ue){et.releaseProgram(ue)}),Q.isShaderMaterial&&et.releaseShaderCache(Q))}this.renderBufferDirect=function(Q,le,ue,ce,ie,Ie){le===null&&(le=ee);const Ue=ie.isMesh&&ie.matrixWorld.determinant()<0,Ye=Be(Q,le,ue,ce,ie);he.setMaterial(ce,Ue);let Oe=ue.index;const He=ue.attributes.position;if(Oe===null){if(He===void 0||He.count===0)return}else if(Oe.count===0)return;let We=1;ce.wireframe===!0&&(Oe=it.getWireframeAttribute(ue),We=2),Ae.setup(ie,ce,Ye,ue,Oe);let nt,pt=ge;Oe!==null&&(nt=_e.get(Oe),pt=be,pt.setIndex(nt));const Ze=Oe!==null?Oe.count:He.count,Tt=ue.drawRange.start*We,Rt=ue.drawRange.count*We,Qt=Ie!==null?Ie.start*We:0,dt=Ie!==null?Ie.count*We:1/0,Lt=Math.max(Tt,Qt),at=Math.min(Ze,Tt+Rt,Qt+dt)-1,fn=Math.max(0,at-Lt+1);if(fn!==0){if(ie.isMesh)ce.wireframe===!0?(he.setLineWidth(ce.wireframeLinewidth*$()),pt.setMode(1)):pt.setMode(4);else if(ie.isLine){let wn=ce.linewidth;wn===void 0&&(wn=1),he.setLineWidth(wn*$()),ie.isLineSegments?pt.setMode(1):ie.isLineLoop?pt.setMode(2):pt.setMode(3)}else ie.isPoints?pt.setMode(0):ie.isSprite&&pt.setMode(4);if(ie.isInstancedMesh)pt.renderInstances(Lt,fn,ie.count);else if(ue.isInstancedBufferGeometry){const wn=Math.min(ue.instanceCount,ue._maxInstanceCount);pt.renderInstances(Lt,fn,wn)}else pt.render(Lt,fn)}},this.compile=function(Q,le){u=P.get(Q),u.init(),g.push(u),Q.traverseVisible(function(ue){ue.isLight&&ue.layers.test(le.layers)&&(u.pushLight(ue),ue.castShadow&&u.pushShadow(ue))}),u.setupLights(y.physicallyCorrectLights),Q.traverse(function(ue){const ce=ue.material;if(ce)if(Array.isArray(ce))for(let ie=0;ie<ce.length;ie++){const Ie=ce[ie];sn(Ie,Q,ue)}else sn(ce,Q,ue)}),g.pop(),u=null};let Ge=null;function ze(Q){Ge&&Ge(Q)}function ct(){xt.stop()}function Pt(){xt.start()}const xt=new I3;xt.setAnimationLoop(ze),typeof self!="undefined"&&xt.setContext(self),this.setAnimationLoop=function(Q){Ge=Q,Ve.setAnimationLoop(Q),Q===null?xt.stop():xt.start()},Ve.addEventListener("sessionstart",ct),Ve.addEventListener("sessionend",Pt),this.render=function(Q,le){if(le!==void 0&&le.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(x===!0)return;Q.autoUpdate===!0&&Q.updateMatrixWorld(),le.parent===null&&le.updateMatrixWorld(),Ve.enabled===!0&&Ve.isPresenting===!0&&(Ve.cameraAutoUpdate===!0&&Ve.updateCamera(le),le=Ve.getCamera()),Q.isScene===!0&&Q.onBeforeRender(y,Q,le,S),u=P.get(Q,g.length),u.init(),g.push(u),H.multiplyMatrices(le.projectionMatrix,le.matrixWorldInverse),j.setFromProjectionMatrix(H),W=this.localClippingEnabled,k=T.init(this.clippingPlanes,W,le),l=V.get(Q,p.length),l.init(),p.push(l),Xn(Q,le,0,y.sortObjects),l.finish(),y.sortObjects===!0&&l.sort(O,X),k===!0&&T.beginShadows();const ue=u.state.shadowsArray;if(q.render(ue,Q,le),k===!0&&T.endShadows(),this.info.autoReset===!0&&this.info.reset(),re.render(l,Q),u.setupLights(y.physicallyCorrectLights),le.isArrayCamera){const ce=le.cameras;for(let ie=0,Ie=ce.length;ie<Ie;ie++){const Ue=ce[ie];Cn(l,Q,Ue,Ue.viewport)}}else Cn(l,Q,le);S!==null&&(fe.updateMultisampleRenderTarget(S),fe.updateRenderTargetMipmap(S)),Q.isScene===!0&&Q.onAfterRender(y,Q,le),Ae.resetDefaultState(),b=-1,E=null,g.pop(),g.length>0?u=g[g.length-1]:u=null,p.pop(),p.length>0?l=p[p.length-1]:l=null};function Xn(Q,le,ue,ce){if(Q.visible===!1)return;if(Q.layers.test(le.layers)){if(Q.isGroup)ue=Q.renderOrder;else if(Q.isLOD)Q.autoUpdate===!0&&Q.update(le);else if(Q.isLight)u.pushLight(Q),Q.castShadow&&u.pushShadow(Q);else if(Q.isSprite){if(!Q.frustumCulled||j.intersectsSprite(Q)){ce&&K.setFromMatrixPosition(Q.matrixWorld).applyMatrix4(H);const Ue=$e.update(Q),Ye=Q.material;Ye.visible&&l.push(Q,Ue,Ye,ue,K.z,null)}}else if((Q.isMesh||Q.isLine||Q.isPoints)&&(Q.isSkinnedMesh&&Q.skeleton.frame!==Ce.render.frame&&(Q.skeleton.update(),Q.skeleton.frame=Ce.render.frame),!Q.frustumCulled||j.intersectsObject(Q))){ce&&K.setFromMatrixPosition(Q.matrixWorld).applyMatrix4(H);const Ue=$e.update(Q),Ye=Q.material;if(Array.isArray(Ye)){const Oe=Ue.groups;for(let He=0,We=Oe.length;He<We;He++){const nt=Oe[He],pt=Ye[nt.materialIndex];pt&&pt.visible&&l.push(Q,Ue,pt,ue,K.z,nt)}}else Ye.visible&&l.push(Q,Ue,Ye,ue,K.z,null)}}const Ie=Q.children;for(let Ue=0,Ye=Ie.length;Ue<Ye;Ue++)Xn(Ie[Ue],le,ue,ce)}function Cn(Q,le,ue,ce){const ie=Q.opaque,Ie=Q.transmissive,Ue=Q.transparent;u.setupLightsView(ue),Ie.length>0&&Un(ie,le,ue),ce&&he.viewport(R.copy(ce)),ie.length>0&&Fn(ie,le,ue),Ie.length>0&&Fn(Ie,le,ue),Ue.length>0&&Fn(Ue,le,ue),he.buffers.depth.setTest(!0),he.buffers.depth.setMask(!0),he.buffers.color.setMask(!0),he.setPolygonOffset(!1)}function Un(Q,le,ue){const ce=de.isWebGL2;Y===null&&(Y=new Gi(1,1,{generateMipmaps:!0,type:G.convert(Tl)!==null?Tl:ka,minFilter:Do,samples:ce&&s===!0?4:0})),y.getDrawingBufferSize(J),ce?Y.setSize(J.x,J.y):Y.setSize(kg(J.x),kg(J.y));const ie=y.getRenderTarget();y.setRenderTarget(Y),y.clear();const Ie=y.toneMapping;y.toneMapping=bs,Fn(Q,le,ue),y.toneMapping=Ie,fe.updateMultisampleRenderTarget(Y),fe.updateRenderTargetMipmap(Y),y.setRenderTarget(ie)}function Fn(Q,le,ue){const ce=le.isScene===!0?le.overrideMaterial:null;for(let ie=0,Ie=Q.length;ie<Ie;ie++){const Ue=Q[ie],Ye=Ue.object,Oe=Ue.geometry,He=ce===null?Ue.material:ce,We=Ue.group;Ye.layers.test(ue.layers)&&Ai(Ye,le,ue,Oe,He,We)}}function Ai(Q,le,ue,ce,ie,Ie){Q.onBeforeRender(y,le,ue,ce,ie,Ie),Q.modelViewMatrix.multiplyMatrices(ue.matrixWorldInverse,Q.matrixWorld),Q.normalMatrix.getNormalMatrix(Q.modelViewMatrix),ie.onBeforeRender(y,le,ue,ce,Q,Ie),ie.transparent===!0&&ie.side===Es?(ie.side=kr,ie.needsUpdate=!0,y.renderBufferDirect(ue,le,ce,ie,Q,Ie),ie.side=Pa,ie.needsUpdate=!0,y.renderBufferDirect(ue,le,ce,ie,Q,Ie),ie.side=Es):y.renderBufferDirect(ue,le,ce,ie,Q,Ie),Q.onAfterRender(y,le,ue,ce,ie,Ie)}function sn(Q,le,ue){le.isScene!==!0&&(le=ee);const ce=me.get(Q),ie=u.state.lights,Ie=u.state.shadowsArray,Ue=ie.state.version,Ye=et.getParameters(Q,ie.state,Ie,le,ue),Oe=et.getProgramCacheKey(Ye);let He=ce.programs;ce.environment=Q.isMeshStandardMaterial?le.environment:null,ce.fog=le.fog,ce.envMap=(Q.isMeshStandardMaterial?ye:we).get(Q.envMap||ce.environment),He===void 0&&(Q.addEventListener("dispose",Je),He=new Map,ce.programs=He);let We=He.get(Oe);if(We!==void 0){if(ce.currentProgram===We&&ce.lightsStateVersion===Ue)return Le(Q,Ye),We}else Ye.uniforms=et.getUniforms(Q),Q.onBuild(ue,Ye,y),Q.onBeforeCompile(Ye,y),We=et.acquireProgram(Ye,Oe),He.set(Oe,We),ce.uniforms=Ye.uniforms;const nt=ce.uniforms;(!Q.isShaderMaterial&&!Q.isRawShaderMaterial||Q.clipping===!0)&&(nt.clippingPlanes=T.uniform),Le(Q,Ye),ce.needsLights=Ke(Q),ce.lightsStateVersion=Ue,ce.needsLights&&(nt.ambientLightColor.value=ie.state.ambient,nt.lightProbe.value=ie.state.probe,nt.directionalLights.value=ie.state.directional,nt.directionalLightShadows.value=ie.state.directionalShadow,nt.spotLights.value=ie.state.spot,nt.spotLightShadows.value=ie.state.spotShadow,nt.rectAreaLights.value=ie.state.rectArea,nt.ltc_1.value=ie.state.rectAreaLTC1,nt.ltc_2.value=ie.state.rectAreaLTC2,nt.pointLights.value=ie.state.point,nt.pointLightShadows.value=ie.state.pointShadow,nt.hemisphereLights.value=ie.state.hemi,nt.directionalShadowMap.value=ie.state.directionalShadowMap,nt.directionalShadowMatrix.value=ie.state.directionalShadowMatrix,nt.spotShadowMap.value=ie.state.spotShadowMap,nt.spotShadowMatrix.value=ie.state.spotShadowMatrix,nt.pointShadowMap.value=ie.state.pointShadowMap,nt.pointShadowMatrix.value=ie.state.pointShadowMatrix);const pt=We.getUniforms(),Ze=Ma.seqWithValue(pt.seq,nt);return ce.currentProgram=We,ce.uniformsList=Ze,We}function Le(Q,le){const ue=me.get(Q);ue.outputEncoding=le.outputEncoding,ue.instancing=le.instancing,ue.skinning=le.skinning,ue.morphTargets=le.morphTargets,ue.morphNormals=le.morphNormals,ue.morphColors=le.morphColors,ue.morphTargetsCount=le.morphTargetsCount,ue.numClippingPlanes=le.numClippingPlanes,ue.numIntersection=le.numClipIntersection,ue.vertexAlphas=le.vertexAlphas,ue.vertexTangents=le.vertexTangents,ue.toneMapping=le.toneMapping}function Be(Q,le,ue,ce,ie){le.isScene!==!0&&(le=ee),fe.resetTextureUnits();const Ie=le.fog,Ue=ce.isMeshStandardMaterial?le.environment:null,Ye=S===null?y.outputEncoding:S.isXRRenderTarget===!0?S.texture.encoding:Ts,Oe=(ce.isMeshStandardMaterial?ye:we).get(ce.envMap||Ue),He=ce.vertexColors===!0&&!!ue.attributes.color&&ue.attributes.color.itemSize===4,We=!!ce.normalMap&&!!ue.attributes.tangent,nt=!!ue.morphAttributes.position,pt=!!ue.morphAttributes.normal,Ze=!!ue.morphAttributes.color,Tt=ce.toneMapped?y.toneMapping:bs,Rt=ue.morphAttributes.position||ue.morphAttributes.normal||ue.morphAttributes.color,Qt=Rt!==void 0?Rt.length:0,dt=me.get(ce),Lt=u.state.lights;if(k===!0&&(W===!0||Q!==E)){const yt=Q===E&&ce.id===b;T.setState(ce,Q,yt)}let at=!1;ce.version===dt.__version?(dt.needsLights&&dt.lightsStateVersion!==Lt.state.version||dt.outputEncoding!==Ye||ie.isInstancedMesh&&dt.instancing===!1||!ie.isInstancedMesh&&dt.instancing===!0||ie.isSkinnedMesh&&dt.skinning===!1||!ie.isSkinnedMesh&&dt.skinning===!0||dt.envMap!==Oe||ce.fog&&dt.fog!==Ie||dt.numClippingPlanes!==void 0&&(dt.numClippingPlanes!==T.numPlanes||dt.numIntersection!==T.numIntersection)||dt.vertexAlphas!==He||dt.vertexTangents!==We||dt.morphTargets!==nt||dt.morphNormals!==pt||dt.morphColors!==Ze||dt.toneMapping!==Tt||de.isWebGL2===!0&&dt.morphTargetsCount!==Qt)&&(at=!0):(at=!0,dt.__version=ce.version);let fn=dt.currentProgram;at===!0&&(fn=sn(ce,le,ie));let wn=!1,Hn=!1,Ci=!1;const Vt=fn.getUniforms(),Dt=dt.uniforms;if(he.useProgram(fn.program)&&(wn=!0,Hn=!0,Ci=!0),ce.id!==b&&(b=ce.id,Hn=!0),wn||E!==Q){if(Vt.setValue(Z,"projectionMatrix",Q.projectionMatrix),de.logarithmicDepthBuffer&&Vt.setValue(Z,"logDepthBufFC",2/(Math.log(Q.far+1)/Math.LN2)),E!==Q&&(E=Q,Hn=!0,Ci=!0),ce.isShaderMaterial||ce.isMeshPhongMaterial||ce.isMeshToonMaterial||ce.isMeshStandardMaterial||ce.envMap){const yt=Vt.map.cameraPosition;yt!==void 0&&yt.setValue(Z,K.setFromMatrixPosition(Q.matrixWorld))}(ce.isMeshPhongMaterial||ce.isMeshToonMaterial||ce.isMeshLambertMaterial||ce.isMeshBasicMaterial||ce.isMeshStandardMaterial||ce.isShaderMaterial)&&Vt.setValue(Z,"isOrthographic",Q.isOrthographicCamera===!0),(ce.isMeshPhongMaterial||ce.isMeshToonMaterial||ce.isMeshLambertMaterial||ce.isMeshBasicMaterial||ce.isMeshStandardMaterial||ce.isShaderMaterial||ce.isShadowMaterial||ie.isSkinnedMesh)&&Vt.setValue(Z,"viewMatrix",Q.matrixWorldInverse)}if(ie.isSkinnedMesh){Vt.setOptional(Z,ie,"bindMatrix"),Vt.setOptional(Z,ie,"bindMatrixInverse");const yt=ie.skeleton;yt&&(de.floatVertexTextures?(yt.boneTexture===null&&yt.computeBoneTexture(),Vt.setValue(Z,"boneTexture",yt.boneTexture,fe),Vt.setValue(Z,"boneTextureSize",yt.boneTextureSize)):Vt.setOptional(Z,yt,"boneMatrices"))}const Nt=ue.morphAttributes;return(Nt.position!==void 0||Nt.normal!==void 0||Nt.color!==void 0&&de.isWebGL2===!0)&&pe.update(ie,ue,ce,fn),(Hn||dt.receiveShadow!==ie.receiveShadow)&&(dt.receiveShadow=ie.receiveShadow,Vt.setValue(Z,"receiveShadow",ie.receiveShadow)),Hn&&(Vt.setValue(Z,"toneMappingExposure",y.toneMappingExposure),dt.needsLights&&Qe(Dt,Ci),Ie&&ce.fog&&L.refreshFogUniforms(Dt,Ie),L.refreshMaterialUniforms(Dt,ce,C,F,Y),Ma.upload(Z,dt.uniformsList,Dt,fe)),ce.isShaderMaterial&&ce.uniformsNeedUpdate===!0&&(Ma.upload(Z,dt.uniformsList,Dt,fe),ce.uniformsNeedUpdate=!1),ce.isSpriteMaterial&&Vt.setValue(Z,"center",ie.center),Vt.setValue(Z,"modelViewMatrix",ie.modelViewMatrix),Vt.setValue(Z,"normalMatrix",ie.normalMatrix),Vt.setValue(Z,"modelMatrix",ie.matrixWorld),fn}function Qe(Q,le){Q.ambientLightColor.needsUpdate=le,Q.lightProbe.needsUpdate=le,Q.directionalLights.needsUpdate=le,Q.directionalLightShadows.needsUpdate=le,Q.pointLights.needsUpdate=le,Q.pointLightShadows.needsUpdate=le,Q.spotLights.needsUpdate=le,Q.spotLightShadows.needsUpdate=le,Q.rectAreaLights.needsUpdate=le,Q.hemisphereLights.needsUpdate=le}function Ke(Q){return Q.isMeshLambertMaterial||Q.isMeshToonMaterial||Q.isMeshPhongMaterial||Q.isMeshStandardMaterial||Q.isShadowMaterial||Q.isShaderMaterial&&Q.lights===!0}this.getActiveCubeFace=function(){return v},this.getActiveMipmapLevel=function(){return w},this.getRenderTarget=function(){return S},this.setRenderTargetTextures=function(Q,le,ue){me.get(Q.texture).__webglTexture=le,me.get(Q.depthTexture).__webglTexture=ue;const ce=me.get(Q);ce.__hasExternalTextures=!0,ce.__hasExternalTextures&&(ce.__autoAllocateDepthBuffer=ue===void 0,ce.__autoAllocateDepthBuffer||Se.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),ce.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(Q,le){const ue=me.get(Q);ue.__webglFramebuffer=le,ue.__useDefaultFramebuffer=le===void 0},this.setRenderTarget=function(Q,le=0,ue=0){S=Q,v=le,w=ue;let ce=!0;if(Q){const Oe=me.get(Q);Oe.__useDefaultFramebuffer!==void 0?(he.bindFramebuffer(36160,null),ce=!1):Oe.__webglFramebuffer===void 0?fe.setupRenderTarget(Q):Oe.__hasExternalTextures&&fe.rebindTextures(Q,me.get(Q.texture).__webglTexture,me.get(Q.depthTexture).__webglTexture)}let ie=null,Ie=!1,Ue=!1;if(Q){const Oe=Q.texture;(Oe.isData3DTexture||Oe.isDataArrayTexture)&&(Ue=!0);const He=me.get(Q).__webglFramebuffer;Q.isWebGLCubeRenderTarget?(ie=He[le],Ie=!0):de.isWebGL2&&Q.samples>0&&fe.useMultisampledRTT(Q)===!1?ie=me.get(Q).__webglMultisampledFramebuffer:ie=He,R.copy(Q.viewport),z.copy(Q.scissor),I=Q.scissorTest}else R.copy(U).multiplyScalar(C).floor(),z.copy(te).multiplyScalar(C).floor(),I=ne;if(he.bindFramebuffer(36160,ie)&&de.drawBuffers&&ce&&he.drawBuffers(Q,ie),he.viewport(R),he.scissor(z),he.setScissorTest(I),Ie){const Oe=me.get(Q.texture);Z.framebufferTexture2D(36160,36064,34069+le,Oe.__webglTexture,ue)}else if(Ue){const Oe=me.get(Q.texture),He=le||0;Z.framebufferTextureLayer(36160,36064,Oe.__webglTexture,ue||0,He)}b=-1},this.readRenderTargetPixels=function(Q,le,ue,ce,ie,Ie,Ue){if(!(Q&&Q.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Ye=me.get(Q).__webglFramebuffer;if(Q.isWebGLCubeRenderTarget&&Ue!==void 0&&(Ye=Ye[Ue]),Ye){he.bindFramebuffer(36160,Ye);try{const Oe=Q.texture,He=Oe.format,We=Oe.type;if(He!==ur&&G.convert(He)!==Z.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const nt=We===Tl&&(Se.has("EXT_color_buffer_half_float")||de.isWebGL2&&Se.has("EXT_color_buffer_float"));if(We!==ka&&G.convert(We)!==Z.getParameter(35738)&&!(We===_o&&(de.isWebGL2||Se.has("OES_texture_float")||Se.has("WEBGL_color_buffer_float")))&&!nt){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}le>=0&&le<=Q.width-ce&&ue>=0&&ue<=Q.height-ie&&Z.readPixels(le,ue,ce,ie,G.convert(He),G.convert(We),Ie)}finally{const Oe=S!==null?me.get(S).__webglFramebuffer:null;he.bindFramebuffer(36160,Oe)}}},this.copyFramebufferToTexture=function(Q,le,ue=0){if(le.isFramebufferTexture!==!0){console.error("THREE.WebGLRenderer: copyFramebufferToTexture() can only be used with FramebufferTexture.");return}const ce=Math.pow(2,-ue),ie=Math.floor(le.image.width*ce),Ie=Math.floor(le.image.height*ce);fe.setTexture2D(le,0),Z.copyTexSubImage2D(3553,ue,0,0,Q.x,Q.y,ie,Ie),he.unbindTexture()},this.copyTextureToTexture=function(Q,le,ue,ce=0){const ie=le.image.width,Ie=le.image.height,Ue=G.convert(ue.format),Ye=G.convert(ue.type);fe.setTexture2D(ue,0),Z.pixelStorei(37440,ue.flipY),Z.pixelStorei(37441,ue.premultiplyAlpha),Z.pixelStorei(3317,ue.unpackAlignment),le.isDataTexture?Z.texSubImage2D(3553,ce,Q.x,Q.y,ie,Ie,Ue,Ye,le.image.data):le.isCompressedTexture?Z.compressedTexSubImage2D(3553,ce,Q.x,Q.y,le.mipmaps[0].width,le.mipmaps[0].height,Ue,le.mipmaps[0].data):Z.texSubImage2D(3553,ce,Q.x,Q.y,Ue,Ye,le.image),ce===0&&ue.generateMipmaps&&Z.generateMipmap(3553),he.unbindTexture()},this.copyTextureToTexture3D=function(Q,le,ue,ce,ie=0){if(y.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const Ie=Q.max.x-Q.min.x+1,Ue=Q.max.y-Q.min.y+1,Ye=Q.max.z-Q.min.z+1,Oe=G.convert(ce.format),He=G.convert(ce.type);let We;if(ce.isData3DTexture)fe.setTexture3D(ce,0),We=32879;else if(ce.isDataArrayTexture)fe.setTexture2DArray(ce,0),We=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}Z.pixelStorei(37440,ce.flipY),Z.pixelStorei(37441,ce.premultiplyAlpha),Z.pixelStorei(3317,ce.unpackAlignment);const nt=Z.getParameter(3314),pt=Z.getParameter(32878),Ze=Z.getParameter(3316),Tt=Z.getParameter(3315),Rt=Z.getParameter(32877),Qt=ue.isCompressedTexture?ue.mipmaps[0]:ue.image;Z.pixelStorei(3314,Qt.width),Z.pixelStorei(32878,Qt.height),Z.pixelStorei(3316,Q.min.x),Z.pixelStorei(3315,Q.min.y),Z.pixelStorei(32877,Q.min.z),ue.isDataTexture||ue.isData3DTexture?Z.texSubImage3D(We,ie,le.x,le.y,le.z,Ie,Ue,Ye,Oe,He,Qt.data):ue.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Z.compressedTexSubImage3D(We,ie,le.x,le.y,le.z,Ie,Ue,Ye,Oe,Qt.data)):Z.texSubImage3D(We,ie,le.x,le.y,le.z,Ie,Ue,Ye,Oe,He,Qt),Z.pixelStorei(3314,nt),Z.pixelStorei(32878,pt),Z.pixelStorei(3316,Ze),Z.pixelStorei(3315,Tt),Z.pixelStorei(32877,Rt),ie===0&&ce.generateMipmaps&&Z.generateMipmap(We),he.unbindTexture()},this.initTexture=function(Q){fe.setTexture2D(Q,0),he.unbindTexture()},this.resetState=function(){v=0,w=0,S=null,he.reset(),Ae.reset()},typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}ln.prototype.isWebGLRenderer=!0;class G3 extends ln{}G3.prototype.isWebGL1Renderer=!0;class pf{constructor(e,t=25e-5){this.name="",this.color=new qe(e),this.density=t}clone(){return new pf(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}pf.prototype.isFogExp2=!0;class mf{constructor(e,t=1,n=1e3){this.name="",this.color=new qe(e),this.near=t,this.far=n}clone(){return new mf(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}mf.prototype.isFog=!0;class $u extends ft{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),t}}$u.prototype.isScene=!0;class Ha{constructor(e,t){this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=bu,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Ir()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[n+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Ir()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Ir()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}Ha.prototype.isInterleavedBuffer=!0;const Yi=new B;class Po{constructor(e,t,n,r=!1){this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=r===!0}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)Yi.fromBufferAttribute(this,t),Yi.applyMatrix4(e),this.setXYZ(t,Yi.x,Yi.y,Yi.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Yi.fromBufferAttribute(this,t),Yi.applyNormalMatrix(e),this.setXYZ(t,Yi.x,Yi.y,Yi.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Yi.fromBufferAttribute(this,t),Yi.transformDirection(e),this.setXYZ(t,Yi.x,Yi.y,Yi.z);return this}setX(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){return this.data.array[e*this.data.stride+this.offset]}getY(e){return this.data.array[e*this.data.stride+this.offset+1]}getZ(e){return this.data.array[e*this.data.stride+this.offset+2]}getW(e){return this.data.array[e*this.data.stride+this.offset+3]}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}setXYZW(e,t,n,r,s){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new zt(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Po(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}Po.prototype.isInterleavedBufferAttribute=!0;class gv extends An{constructor(e){super(),this.type="SpriteMaterial",this.color=new qe(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this}}gv.prototype.isSpriteMaterial=!0;let Pc;const Uh=new B,Rc=new B,Lc=new B,kc=new Me,Hh=new Me,W3=new st,im=new B,Vh=new B,rm=new B,SE=new Me,Fy=new Me,bE=new Me;class vv extends ft{constructor(e){if(super(),this.type="Sprite",Pc===void 0){Pc=new vt;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new Ha(t,5);Pc.setIndex([0,1,2,0,2,3]),Pc.setAttribute("position",new Po(n,3,0,!1)),Pc.setAttribute("uv",new Po(n,2,3,!1))}this.geometry=Pc,this.material=e!==void 0?e:new gv,this.center=new Me(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Rc.setFromMatrixScale(this.matrixWorld),W3.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Lc.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Rc.multiplyScalar(-Lc.z);const n=this.material.rotation;let r,s;n!==0&&(s=Math.cos(n),r=Math.sin(n));const o=this.center;sm(im.set(-.5,-.5,0),Lc,o,Rc,r,s),sm(Vh.set(.5,-.5,0),Lc,o,Rc,r,s),sm(rm.set(.5,.5,0),Lc,o,Rc,r,s),SE.set(0,0),Fy.set(1,0),bE.set(1,1);let a=e.ray.intersectTriangle(im,Vh,rm,!1,Uh);if(a===null&&(sm(Vh.set(-.5,.5,0),Lc,o,Rc,r,s),Fy.set(0,1),a=e.ray.intersectTriangle(im,rm,Vh,!1,Uh),a===null))return;const c=e.ray.origin.distanceTo(Uh);c<e.near||c>e.far||t.push({distance:c,point:Uh.clone(),uv:ti.getUV(Uh,im,Vh,rm,SE,Fy,bE,new Me),face:null,object:this})}copy(e){return super.copy(e),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}vv.prototype.isSprite=!0;function sm(i,e,t,n,r,s){kc.subVectors(i,t).addScalar(.5).multiply(n),r!==void 0?(Hh.x=s*kc.x-r*kc.y,Hh.y=r*kc.x+s*kc.y):Hh.copy(kc),i.copy(e),i.x+=Hh.x,i.y+=Hh.y,i.applyMatrix4(W3)}const om=new B,ME=new B;class j3 extends ft{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let n=0,r=t.length;n<r;n++){const s=t[n];this.addLevel(s.object.clone(),s.distance)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0){t=Math.abs(t);const n=this.levels;let r;for(r=0;r<n.length&&!(t<n[r].distance);r++);return n.splice(r,0,{distance:t,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,r;for(n=1,r=t.length;n<r&&!(e<t[n].distance);n++);return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){om.setFromMatrixPosition(this.matrixWorld);const r=e.ray.origin.distanceTo(om);this.getObjectForDistance(r).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){om.setFromMatrixPosition(e.matrixWorld),ME.setFromMatrixPosition(this.matrixWorld);const n=om.distanceTo(ME)/e.zoom;t[0].object.visible=!0;let r,s;for(r=1,s=t.length;r<s&&n>=t[r].distance;r++)t[r-1].object.visible=!1,t[r].object.visible=!0;for(this._currentLevel=r-1;r<s;r++)t[r].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let r=0,s=n.length;r<s;r++){const o=n[r];t.object.levels.push({object:o.object.uuid,distance:o.distance})}return t}}const EE=new B,TE=new Jt,AE=new Jt,_O=new B,CE=new st;class Qu extends je{constructor(e,t){super(e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new st,this.bindMatrixInverse=new st}copy(e){return super.copy(e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Jt,t=this.geometry.attributes.skinWeight;for(let n=0,r=t.count;n<r;n++){e.fromBufferAttribute(t,n);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){const n=this.skeleton,r=this.geometry;TE.fromBufferAttribute(r.attributes.skinIndex,e),AE.fromBufferAttribute(r.attributes.skinWeight,e),EE.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=AE.getComponent(s);if(o!==0){const a=TE.getComponent(s);CE.multiplyMatrices(n.bones[a].matrixWorld,n.boneInverses[a]),t.addScaledVector(_O.copy(EE).applyMatrix4(CE),o)}}return t.applyMatrix4(this.bindMatrixInverse)}}Qu.prototype.isSkinnedMesh=!0;class Ol extends ft{constructor(){super(),this.type="Bone"}}Ol.prototype.isBone=!0;class Ea extends hn{constructor(e=null,t=1,n=1,r,s,o,a,c,h=Kt,d=Kt,l,u){super(null,o,a,c,h,d,r,s,l,u),this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}Ea.prototype.isDataTexture=!0;const PE=new st,SO=new st;class Zu{constructor(e=[],t=[]){this.uuid=Ir(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new st)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const n=new st;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++){const a=e[s]?e[s].matrixWorld:SO;PE.multiplyMatrices(a,t[s]),PE.toArray(n,s*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new Zu(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=w3(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new Ea(t,e,e,ur,_o);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,r=e.bones.length;n<r;n++){const s=e.bones[n];let o=t[s];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new Ol),this.bones.push(o),this.boneInverses.push(new st().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let r=0,s=t.length;r<s;r++){const o=t[r];e.bones.push(o.uuid);const a=n[r];e.boneInverses.push(a.toArray())}return e}}class Nl extends zt{constructor(e,t,n,r=1){typeof n=="number"&&(r=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(e,t,n),this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}Nl.prototype.isInstancedBufferAttribute=!0;const RE=new st,LE=new st,am=[],Gh=new je;class l1 extends je{constructor(e,t,n){super(e,t),this.instanceMatrix=new Nl(new Float32Array(n*16),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}copy(e){return super.copy(e),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}raycast(e,t){const n=this.matrixWorld,r=this.count;if(Gh.geometry=this.geometry,Gh.material=this.material,Gh.material!==void 0)for(let s=0;s<r;s++){this.getMatrixAt(s,RE),LE.multiplyMatrices(n,RE),Gh.matrixWorld=LE,Gh.raycast(e,am);for(let o=0,a=am.length;o<a;o++){const c=am[o];c.instanceId=s,c.object=this,t.push(c)}am.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new Nl(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}l1.prototype.isInstancedMesh=!0;class ni extends An{constructor(e){super(),this.type="LineBasicMaterial",this.color=new qe(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this}}ni.prototype.isLineBasicMaterial=!0;const kE=new B,IE=new B,FE=new st,Dy=new Oo,lm=new zo;class di extends ft{constructor(e=new vt,t=new ni){super(),this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(e.index===null){const t=e.attributes.position,n=[0];for(let r=1,s=t.count;r<s;r++)kE.fromBufferAttribute(t,r-1),IE.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=kE.distanceTo(IE);e.setAttribute("lineDistance",new lt(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),lm.copy(n.boundingSphere),lm.applyMatrix4(r),lm.radius+=s,e.ray.intersectsSphere(lm)===!1)return;FE.copy(r).invert(),Dy.copy(e.ray).applyMatrix4(FE);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),c=a*a,h=new B,d=new B,l=new B,u=new B,p=this.isLineSegments?2:1;if(n.isBufferGeometry){const g=n.index,x=n.attributes.position;if(g!==null){const v=Math.max(0,o.start),w=Math.min(g.count,o.start+o.count);for(let S=v,b=w-1;S<b;S+=p){const E=g.getX(S),R=g.getX(S+1);if(h.fromBufferAttribute(x,E),d.fromBufferAttribute(x,R),Dy.distanceSqToSegment(h,d,u,l)>c)continue;u.applyMatrix4(this.matrixWorld);const I=e.ray.origin.distanceTo(u);I<e.near||I>e.far||t.push({distance:I,point:l.clone().applyMatrix4(this.matrixWorld),index:S,face:null,faceIndex:null,object:this})}}else{const v=Math.max(0,o.start),w=Math.min(x.count,o.start+o.count);for(let S=v,b=w-1;S<b;S+=p){if(h.fromBufferAttribute(x,S),d.fromBufferAttribute(x,S+1),Dy.distanceSqToSegment(h,d,u,l)>c)continue;u.applyMatrix4(this.matrixWorld);const R=e.ray.origin.distanceTo(u);R<e.near||R>e.far||t.push({distance:R,point:l.clone().applyMatrix4(this.matrixWorld),index:S,face:null,faceIndex:null,object:this})}}}else n.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}else{const t=e.morphTargets;t!==void 0&&t.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}di.prototype.isLine=!0;const DE=new B,BE=new B;class Ji extends di{constructor(e,t){super(e,t),this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(e.index===null){const t=e.attributes.position,n=[];for(let r=0,s=t.count;r<s;r+=2)DE.fromBufferAttribute(t,r),BE.fromBufferAttribute(t,r+1),n[r]=r===0?0:n[r-1],n[r+1]=n[r]+DE.distanceTo(BE);e.setAttribute("lineDistance",new lt(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}Ji.prototype.isLineSegments=!0;class yv extends di{constructor(e,t){super(e,t),this.type="LineLoop"}}yv.prototype.isLineLoop=!0;class Va extends An{constructor(e){super(),this.type="PointsMaterial",this.color=new qe(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this}}Va.prototype.isPointsMaterial=!0;const zE=new st,Rw=new Oo,cm=new zo,um=new B;class Ku extends ft{constructor(e=new vt,t=new Va){super(),this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),cm.copy(n.boundingSphere),cm.applyMatrix4(r),cm.radius+=s,e.ray.intersectsSphere(cm)===!1)return;zE.copy(r).invert(),Rw.copy(e.ray).applyMatrix4(zE);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),c=a*a;if(n.isBufferGeometry){const h=n.index,l=n.attributes.position;if(h!==null){const u=Math.max(0,o.start),p=Math.min(h.count,o.start+o.count);for(let g=u,y=p;g<y;g++){const x=h.getX(g);um.fromBufferAttribute(l,x),OE(um,x,c,r,e,t,this)}}else{const u=Math.max(0,o.start),p=Math.min(l.count,o.start+o.count);for(let g=u,y=p;g<y;g++)um.fromBufferAttribute(l,g),OE(um,g,c,r,e,t,this)}}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}else{const t=e.morphTargets;t!==void 0&&t.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}Ku.prototype.isPoints=!0;function OE(i,e,t,n,r,s,o){const a=Rw.distanceSqToPoint(i);if(a<t){const c=new B;Rw.closestPointToPoint(i,c),c.applyMatrix4(n);const h=r.ray.origin.distanceTo(c);if(h<r.near||h>r.far)return;s.push({distance:h,distanceToRay:Math.sqrt(a),point:c,index:e,face:null,object:o})}}class X3 extends hn{constructor(e,t,n,r,s,o,a,c,h){super(e,t,n,r,s,o,a,c,h),this.minFilter=o!==void 0?o:jt,this.magFilter=s!==void 0?s:jt,this.generateMipmaps=!1;const d=this;function l(){d.needsUpdate=!0,e.requestVideoFrameCallback(l)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(l)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}X3.prototype.isVideoTexture=!0;class q3 extends hn{constructor(e,t,n){super({width:e,height:t}),this.format=n,this.magFilter=Kt,this.minFilter=Kt,this.generateMipmaps=!1,this.needsUpdate=!0}}q3.prototype.isFramebufferTexture=!0;class c1 extends hn{constructor(e,t,n,r,s,o,a,c,h,d,l,u){super(null,o,a,c,h,d,r,s,l,u),this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}c1.prototype.isCompressedTexture=!0;class Y3 extends hn{constructor(e,t,n,r,s,o,a,c,h){super(e,t,n,r,s,o,a,c,h),this.needsUpdate=!0}}Y3.prototype.isCanvasTexture=!0;class gr{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,r=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)n=this.getPoint(o/e),s+=n.distanceTo(r),t.push(s),r=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const n=this.getLengths();let r=0;const s=n.length;let o;t?o=t:o=e*n[s-1];let a=0,c=s-1,h;for(;a<=c;)if(r=Math.floor(a+(c-a)/2),h=n[r]-o,h<0)a=r+1;else if(h>0)c=r-1;else{c=r;break}if(r=c,n[r]===o)return r/(s-1);const d=n[r],u=n[r+1]-d,p=(o-d)/u;return(r+p)/(s-1)}getTangent(e,t){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const o=this.getPoint(r),a=this.getPoint(s),c=t||(o.isVector2?new Me:new B);return c.copy(a).sub(o).normalize(),c}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){const n=new B,r=[],s=[],o=[],a=new B,c=new st;for(let p=0;p<=e;p++){const g=p/e;r[p]=this.getTangentAt(g,new B)}s[0]=new B,o[0]=new B;let h=Number.MAX_VALUE;const d=Math.abs(r[0].x),l=Math.abs(r[0].y),u=Math.abs(r[0].z);d<=h&&(h=d,n.set(1,0,0)),l<=h&&(h=l,n.set(0,1,0)),u<=h&&n.set(0,0,1),a.crossVectors(r[0],n).normalize(),s[0].crossVectors(r[0],a),o[0].crossVectors(r[0],s[0]);for(let p=1;p<=e;p++){if(s[p]=s[p-1].clone(),o[p]=o[p-1].clone(),a.crossVectors(r[p-1],r[p]),a.length()>Number.EPSILON){a.normalize();const g=Math.acos(Jn(r[p-1].dot(r[p]),-1,1));s[p].applyMatrix4(c.makeRotationAxis(a,g))}o[p].crossVectors(r[p],s[p])}if(t===!0){let p=Math.acos(Jn(s[0].dot(s[e]),-1,1));p/=e,r[0].dot(a.crossVectors(s[0],s[e]))>0&&(p=-p);for(let g=1;g<=e;g++)s[g].applyMatrix4(c.makeRotationAxis(r[g],p*g)),o[g].crossVectors(r[g],s[g])}return{tangents:r,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class gf extends gr{constructor(e=0,t=0,n=1,r=1,s=0,o=Math.PI*2,a=!1,c=0){super(),this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=c}getPoint(e,t){const n=t||new Me,r=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(o?s=0:s=r),this.aClockwise===!0&&!o&&(s===r?s=-r:s=s-r);const a=this.aStartAngle+e*s;let c=this.aX+this.xRadius*Math.cos(a),h=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){const d=Math.cos(this.aRotation),l=Math.sin(this.aRotation),u=c-this.aX,p=h-this.aY;c=u*d-p*l+this.aX,h=u*l+p*d+this.aY}return n.set(c,h)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}gf.prototype.isEllipseCurve=!0;class u1 extends gf{constructor(e,t,n,r,s,o){super(e,t,n,n,r,s,o),this.type="ArcCurve"}}u1.prototype.isArcCurve=!0;function h1(){let i=0,e=0,t=0,n=0;function r(s,o,a,c){i=s,e=a,t=-3*s+3*o-2*a-c,n=2*s-2*o+a+c}return{initCatmullRom:function(s,o,a,c,h){r(o,a,h*(a-s),h*(c-o))},initNonuniformCatmullRom:function(s,o,a,c,h,d,l){let u=(o-s)/h-(a-s)/(h+d)+(a-o)/d,p=(a-o)/d-(c-o)/(d+l)+(c-a)/l;u*=d,p*=d,r(o,a,u,p)},calc:function(s){const o=s*s,a=o*s;return i+e*s+t*o+n*a}}}const hm=new B,By=new h1,zy=new h1,Oy=new h1;class d1 extends gr{constructor(e=[],t=!1,n="centripetal",r=.5){super(),this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=r}getPoint(e,t=new B){const n=t,r=this.points,s=r.length,o=(s-(this.closed?0:1))*e;let a=Math.floor(o),c=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:c===0&&a===s-1&&(a=s-2,c=1);let h,d;this.closed||a>0?h=r[(a-1)%s]:(hm.subVectors(r[0],r[1]).add(r[0]),h=hm);const l=r[a%s],u=r[(a+1)%s];if(this.closed||a+2<s?d=r[(a+2)%s]:(hm.subVectors(r[s-1],r[s-2]).add(r[s-1]),d=hm),this.curveType==="centripetal"||this.curveType==="chordal"){const p=this.curveType==="chordal"?.5:.25;let g=Math.pow(h.distanceToSquared(l),p),y=Math.pow(l.distanceToSquared(u),p),x=Math.pow(u.distanceToSquared(d),p);y<1e-4&&(y=1),g<1e-4&&(g=y),x<1e-4&&(x=y),By.initNonuniformCatmullRom(h.x,l.x,u.x,d.x,g,y,x),zy.initNonuniformCatmullRom(h.y,l.y,u.y,d.y,g,y,x),Oy.initNonuniformCatmullRom(h.z,l.z,u.z,d.z,g,y,x)}else this.curveType==="catmullrom"&&(By.initCatmullRom(h.x,l.x,u.x,d.x,this.tension),zy.initCatmullRom(h.y,l.y,u.y,d.y,this.tension),Oy.initCatmullRom(h.z,l.z,u.z,d.z,this.tension));return n.set(By.calc(c),zy.calc(c),Oy.calc(c)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(new B().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}d1.prototype.isCatmullRomCurve3=!0;function NE(i,e,t,n,r){const s=(n-e)*.5,o=(r-t)*.5,a=i*i,c=i*a;return(2*t-2*n+s+o)*c+(-3*t+3*n-2*s-o)*a+s*i+t}function bO(i,e){const t=1-i;return t*t*e}function MO(i,e){return 2*(1-i)*i*e}function EO(i,e){return i*i*e}function vd(i,e,t,n){return bO(i,e)+MO(i,t)+EO(i,n)}function TO(i,e){const t=1-i;return t*t*t*e}function AO(i,e){const t=1-i;return 3*t*t*i*e}function CO(i,e){return 3*(1-i)*i*i*e}function PO(i,e){return i*i*i*e}function yd(i,e,t,n,r){return TO(i,e)+AO(i,t)+CO(i,n)+PO(i,r)}class xv extends gr{constructor(e=new Me,t=new Me,n=new Me,r=new Me){super(),this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new Me){const n=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return n.set(yd(e,r.x,s.x,o.x,a.x),yd(e,r.y,s.y,o.y,a.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}xv.prototype.isCubicBezierCurve=!0;class f1 extends gr{constructor(e=new B,t=new B,n=new B,r=new B){super(),this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new B){const n=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return n.set(yd(e,r.x,s.x,o.x,a.x),yd(e,r.y,s.y,o.y,a.y),yd(e,r.z,s.z,o.z,a.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}f1.prototype.isCubicBezierCurve3=!0;class vf extends gr{constructor(e=new Me,t=new Me){super(),this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new Me){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){const n=t||new Me;return n.copy(this.v2).sub(this.v1).normalize(),n}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}vf.prototype.isLineCurve=!0;class $3 extends gr{constructor(e=new B,t=new B){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=e,this.v2=t}getPoint(e,t=new B){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class wv extends gr{constructor(e=new Me,t=new Me,n=new Me){super(),this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new Me){const n=t,r=this.v0,s=this.v1,o=this.v2;return n.set(vd(e,r.x,s.x,o.x),vd(e,r.y,s.y,o.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}wv.prototype.isQuadraticBezierCurve=!0;class _v extends gr{constructor(e=new B,t=new B,n=new B){super(),this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new B){const n=t,r=this.v0,s=this.v1,o=this.v2;return n.set(vd(e,r.x,s.x,o.x),vd(e,r.y,s.y,o.y),vd(e,r.z,s.z,o.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}_v.prototype.isQuadraticBezierCurve3=!0;class Sv extends gr{constructor(e=[]){super(),this.type="SplineCurve",this.points=e}getPoint(e,t=new Me){const n=t,r=this.points,s=(r.length-1)*e,o=Math.floor(s),a=s-o,c=r[o===0?o:o-1],h=r[o],d=r[o>r.length-2?r.length-1:o+1],l=r[o>r.length-3?r.length-1:o+2];return n.set(NE(a,c.x,h.x,d.x,l.x),NE(a,c.y,h.y,d.y,l.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const r=this.points[t];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(new Me().fromArray(r))}return this}}Sv.prototype.isSplineCurve=!0;var p1=Object.freeze({__proto__:null,ArcCurve:u1,CatmullRomCurve3:d1,CubicBezierCurve:xv,CubicBezierCurve3:f1,EllipseCurve:gf,LineCurve:vf,LineCurve3:$3,QuadraticBezierCurve:wv,QuadraticBezierCurve3:_v,SplineCurve:Sv});class Q3 extends gr{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new vf(t,e))}getPoint(e,t){const n=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=n){const o=r[s]-n,a=this.curves[s],c=a.getLength(),h=c===0?0:1-o/c;return a.getPointAt(h,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let r=0,s=this.curves;r<s.length;r++){const o=s[r],a=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,c=o.getPoints(a);for(let h=0;h<c.length;h++){const d=c[h];n&&n.equals(d)||(t.push(d),n=d)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const r=this.curves[t];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const r=e.curves[t];this.curves.push(new p1[r.type]().fromJSON(r))}return this}}class Tu extends Q3{constructor(e){super(),this.type="Path",this.currentPoint=new Me,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new vf(this.currentPoint.clone(),new Me(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,r){const s=new wv(this.currentPoint.clone(),new Me(e,t),new Me(n,r));return this.curves.push(s),this.currentPoint.set(n,r),this}bezierCurveTo(e,t,n,r,s,o){const a=new xv(this.currentPoint.clone(),new Me(e,t),new Me(n,r),new Me(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new Sv(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,r,s,o){const a=this.currentPoint.x,c=this.currentPoint.y;return this.absarc(e+a,t+c,n,r,s,o),this}absarc(e,t,n,r,s,o){return this.absellipse(e,t,n,n,r,s,o),this}ellipse(e,t,n,r,s,o,a,c){const h=this.currentPoint.x,d=this.currentPoint.y;return this.absellipse(e+h,t+d,n,r,s,o,a,c),this}absellipse(e,t,n,r,s,o,a,c){const h=new gf(e,t,n,r,s,o,a,c);if(this.curves.length>0){const l=h.getPoint(0);l.equals(this.currentPoint)||this.lineTo(l.x,l.y)}this.curves.push(h);const d=h.getPoint(1);return this.currentPoint.copy(d),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Ul extends vt{constructor(e=[new Me(0,.5),new Me(.5,0),new Me(0,-.5)],t=12,n=0,r=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},t=Math.floor(t),r=Jn(r,0,Math.PI*2);const s=[],o=[],a=[],c=[],h=[],d=1/t,l=new B,u=new Me,p=new B,g=new B,y=new B;let x=0,v=0;for(let w=0;w<=e.length-1;w++)switch(w){case 0:x=e[w+1].x-e[w].x,v=e[w+1].y-e[w].y,p.x=v*1,p.y=-x,p.z=v*0,y.copy(p),p.normalize(),c.push(p.x,p.y,p.z);break;case e.length-1:c.push(y.x,y.y,y.z);break;default:x=e[w+1].x-e[w].x,v=e[w+1].y-e[w].y,p.x=v*1,p.y=-x,p.z=v*0,g.copy(p),p.x+=y.x,p.y+=y.y,p.z+=y.z,p.normalize(),c.push(p.x,p.y,p.z),y.copy(g)}for(let w=0;w<=t;w++){const S=n+w*d*r,b=Math.sin(S),E=Math.cos(S);for(let R=0;R<=e.length-1;R++){l.x=e[R].x*b,l.y=e[R].y,l.z=e[R].x*E,o.push(l.x,l.y,l.z),u.x=w/t,u.y=R/(e.length-1),a.push(u.x,u.y);const z=c[3*R+0]*b,I=c[3*R+1],N=c[3*R+0]*E;h.push(z,I,N)}}for(let w=0;w<t;w++)for(let S=0;S<e.length-1;S++){const b=S+w*e.length,E=b,R=b+e.length,z=b+e.length+1,I=b+1;s.push(E,R,I),s.push(z,I,R)}this.setIndex(s),this.setAttribute("position",new lt(o,3)),this.setAttribute("uv",new lt(a,2)),this.setAttribute("normal",new lt(h,3))}static fromJSON(e){return new Ul(e.points,e.segments,e.phiStart,e.phiLength)}}class Au extends Ul{constructor(e=1,t=1,n=4,r=8){const s=new Tu;s.absarc(0,-t/2,e,Math.PI*1.5,0),s.absarc(0,t/2,e,0,Math.PI*.5),super(s.getPoints(n),r),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:n,radialSegments:r}}static fromJSON(e){return new Au(e.radius,e.length,e.capSegments,e.radialSegments)}}class Cu extends vt{constructor(e=1,t=8,n=0,r=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},t=Math.max(3,t);const s=[],o=[],a=[],c=[],h=new B,d=new Me;o.push(0,0,0),a.push(0,0,1),c.push(.5,.5);for(let l=0,u=3;l<=t;l++,u+=3){const p=n+l/t*r;h.x=e*Math.cos(p),h.y=e*Math.sin(p),o.push(h.x,h.y,h.z),a.push(0,0,1),d.x=(o[u]/e+1)/2,d.y=(o[u+1]/e+1)/2,c.push(d.x,d.y)}for(let l=1;l<=t;l++)s.push(l,l+1,0);this.setIndex(s),this.setAttribute("position",new lt(o,3)),this.setAttribute("normal",new lt(a,3)),this.setAttribute("uv",new lt(c,2))}static fromJSON(e){return new Cu(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class kn extends vt{constructor(e=1,t=1,n=1,r=8,s=1,o=!1,a=0,c=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:c};const h=this;r=Math.floor(r),s=Math.floor(s);const d=[],l=[],u=[],p=[];let g=0;const y=[],x=n/2;let v=0;w(),o===!1&&(e>0&&S(!0),t>0&&S(!1)),this.setIndex(d),this.setAttribute("position",new lt(l,3)),this.setAttribute("normal",new lt(u,3)),this.setAttribute("uv",new lt(p,2));function w(){const b=new B,E=new B;let R=0;const z=(t-e)/n;for(let I=0;I<=s;I++){const N=[],F=I/s,C=F*(t-e)+e;for(let O=0;O<=r;O++){const X=O/r,U=X*c+a,te=Math.sin(U),ne=Math.cos(U);E.x=C*te,E.y=-F*n+x,E.z=C*ne,l.push(E.x,E.y,E.z),b.set(te,z,ne).normalize(),u.push(b.x,b.y,b.z),p.push(X,1-F),N.push(g++)}y.push(N)}for(let I=0;I<r;I++)for(let N=0;N<s;N++){const F=y[N][I],C=y[N+1][I],O=y[N+1][I+1],X=y[N][I+1];d.push(F,C,X),d.push(C,O,X),R+=6}h.addGroup(v,R,0),v+=R}function S(b){const E=g,R=new Me,z=new B;let I=0;const N=b===!0?e:t,F=b===!0?1:-1;for(let O=1;O<=r;O++)l.push(0,x*F,0),u.push(0,F,0),p.push(.5,.5),g++;const C=g;for(let O=0;O<=r;O++){const U=O/r*c+a,te=Math.cos(U),ne=Math.sin(U);z.x=N*ne,z.y=x*F,z.z=N*te,l.push(z.x,z.y,z.z),u.push(0,F,0),R.x=te*.5+.5,R.y=ne*.5*F+.5,p.push(R.x,R.y),g++}for(let O=0;O<r;O++){const X=E+O,U=C+O;b===!0?d.push(U,U+1,X):d.push(U+1,U,X),I+=3}h.addGroup(v,I,b===!0?1:2),v+=I}}static fromJSON(e){return new kn(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Pu extends kn{constructor(e=1,t=1,n=8,r=1,s=!1,o=0,a=Math.PI*2){super(0,e,t,n,r,s,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:s,thetaStart:o,thetaLength:a}}static fromJSON(e){return new Pu(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Ks extends vt{constructor(e=[],t=[],n=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r};const s=[],o=[];a(r),h(n),d(),this.setAttribute("position",new lt(s,3)),this.setAttribute("normal",new lt(s.slice(),3)),this.setAttribute("uv",new lt(o,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function a(w){const S=new B,b=new B,E=new B;for(let R=0;R<t.length;R+=3)p(t[R+0],S),p(t[R+1],b),p(t[R+2],E),c(S,b,E,w)}function c(w,S,b,E){const R=E+1,z=[];for(let I=0;I<=R;I++){z[I]=[];const N=w.clone().lerp(b,I/R),F=S.clone().lerp(b,I/R),C=R-I;for(let O=0;O<=C;O++)O===0&&I===R?z[I][O]=N:z[I][O]=N.clone().lerp(F,O/C)}for(let I=0;I<R;I++)for(let N=0;N<2*(R-I)-1;N++){const F=Math.floor(N/2);N%2===0?(u(z[I][F+1]),u(z[I+1][F]),u(z[I][F])):(u(z[I][F+1]),u(z[I+1][F+1]),u(z[I+1][F]))}}function h(w){const S=new B;for(let b=0;b<s.length;b+=3)S.x=s[b+0],S.y=s[b+1],S.z=s[b+2],S.normalize().multiplyScalar(w),s[b+0]=S.x,s[b+1]=S.y,s[b+2]=S.z}function d(){const w=new B;for(let S=0;S<s.length;S+=3){w.x=s[S+0],w.y=s[S+1],w.z=s[S+2];const b=x(w)/2/Math.PI+.5,E=v(w)/Math.PI+.5;o.push(b,1-E)}g(),l()}function l(){for(let w=0;w<o.length;w+=6){const S=o[w+0],b=o[w+2],E=o[w+4],R=Math.max(S,b,E),z=Math.min(S,b,E);R>.9&&z<.1&&(S<.2&&(o[w+0]+=1),b<.2&&(o[w+2]+=1),E<.2&&(o[w+4]+=1))}}function u(w){s.push(w.x,w.y,w.z)}function p(w,S){const b=w*3;S.x=e[b+0],S.y=e[b+1],S.z=e[b+2]}function g(){const w=new B,S=new B,b=new B,E=new B,R=new Me,z=new Me,I=new Me;for(let N=0,F=0;N<s.length;N+=9,F+=6){w.set(s[N+0],s[N+1],s[N+2]),S.set(s[N+3],s[N+4],s[N+5]),b.set(s[N+6],s[N+7],s[N+8]),R.set(o[F+0],o[F+1]),z.set(o[F+2],o[F+3]),I.set(o[F+4],o[F+5]),E.copy(w).add(S).add(b).divideScalar(3);const C=x(E);y(R,F+0,w,C),y(z,F+2,S,C),y(I,F+4,b,C)}}function y(w,S,b,E){E<0&&w.x===1&&(o[S]=w.x-1),b.x===0&&b.z===0&&(o[S]=E/2/Math.PI+.5)}function x(w){return Math.atan2(w.z,-w.x)}function v(w){return Math.atan2(-w.y,Math.sqrt(w.x*w.x+w.z*w.z))}}static fromJSON(e){return new Ks(e.vertices,e.indices,e.radius,e.details)}}class Ru extends Ks{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,r=1/n,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,o,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Ru(e.radius,e.detail)}}const dm=new B,fm=new B,Ny=new B,pm=new ti;class m1 extends vt{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const r=Math.pow(10,4),s=Math.cos(Cl*t),o=e.getIndex(),a=e.getAttribute("position"),c=o?o.count:a.count,h=[0,0,0],d=["a","b","c"],l=new Array(3),u={},p=[];for(let g=0;g<c;g+=3){o?(h[0]=o.getX(g),h[1]=o.getX(g+1),h[2]=o.getX(g+2)):(h[0]=g,h[1]=g+1,h[2]=g+2);const{a:y,b:x,c:v}=pm;if(y.fromBufferAttribute(a,h[0]),x.fromBufferAttribute(a,h[1]),v.fromBufferAttribute(a,h[2]),pm.getNormal(Ny),l[0]=`${Math.round(y.x*r)},${Math.round(y.y*r)},${Math.round(y.z*r)}`,l[1]=`${Math.round(x.x*r)},${Math.round(x.y*r)},${Math.round(x.z*r)}`,l[2]=`${Math.round(v.x*r)},${Math.round(v.y*r)},${Math.round(v.z*r)}`,!(l[0]===l[1]||l[1]===l[2]||l[2]===l[0]))for(let w=0;w<3;w++){const S=(w+1)%3,b=l[w],E=l[S],R=pm[d[w]],z=pm[d[S]],I=`${b}_${E}`,N=`${E}_${b}`;N in u&&u[N]?(Ny.dot(u[N].normal)<=s&&(p.push(R.x,R.y,R.z),p.push(z.x,z.y,z.z)),u[N]=null):I in u||(u[I]={index0:h[w],index1:h[S],normal:Ny.clone()})}}for(const g in u)if(u[g]){const{index0:y,index1:x}=u[g];dm.fromBufferAttribute(a,y),fm.fromBufferAttribute(a,x),p.push(dm.x,dm.y,dm.z),p.push(fm.x,fm.y,fm.z)}this.setAttribute("position",new lt(p,3))}}}class $s extends Tu{constructor(e){super(e),this.uuid=Ir(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const r=e.holes[t];this.holes.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const r=this.holes[t];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const r=e.holes[t];this.holes.push(new Tu().fromJSON(r))}return this}}const RO={triangulate:function(i,e,t=2){const n=e&&e.length,r=n?e[0]*t:i.length;let s=Z3(i,0,r,t,!0);const o=[];if(!s||s.next===s.prev)return o;let a,c,h,d,l,u,p;if(n&&(s=DO(i,e,s,t)),i.length>80*t){a=h=i[0],c=d=i[1];for(let g=t;g<r;g+=t)l=i[g],u=i[g+1],l<a&&(a=l),u<c&&(c=u),l>h&&(h=l),u>d&&(d=u);p=Math.max(h-a,d-c),p=p!==0?1/p:0}return qd(s,o,t,a,c,p),o}};function Z3(i,e,t,n,r){let s,o;if(r===XO(i,e,t,n)>0)for(s=e;s<t;s+=n)o=UE(s,i[s],i[s+1],o);else for(s=t-n;s>=e;s-=n)o=UE(s,i[s],i[s+1],o);return o&&bv(o,o.next)&&($d(o),o=o.next),o}function Ia(i,e){if(!i)return i;e||(e=i);let t=i,n;do if(n=!1,!t.steiner&&(bv(t,t.next)||zn(t.prev,t,t.next)===0)){if($d(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}function qd(i,e,t,n,r,s,o){if(!i)return;!o&&s&&UO(i,n,r,s);let a=i,c,h;for(;i.prev!==i.next;){if(c=i.prev,h=i.next,s?kO(i,n,r,s):LO(i)){e.push(c.i/t),e.push(i.i/t),e.push(h.i/t),$d(i),i=h.next,a=h.next;continue}if(i=h,i===a){o?o===1?(i=IO(Ia(i),e,t),qd(i,e,t,n,r,s,2)):o===2&&FO(i,e,t,n,r,s):qd(Ia(i),e,t,n,r,s,1);break}}}function LO(i){const e=i.prev,t=i,n=i.next;if(zn(e,t,n)>=0)return!1;let r=i.next.next;for(;r!==i.prev;){if(nu(e.x,e.y,t.x,t.y,n.x,n.y,r.x,r.y)&&zn(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function kO(i,e,t,n){const r=i.prev,s=i,o=i.next;if(zn(r,s,o)>=0)return!1;const a=r.x<s.x?r.x<o.x?r.x:o.x:s.x<o.x?s.x:o.x,c=r.y<s.y?r.y<o.y?r.y:o.y:s.y<o.y?s.y:o.y,h=r.x>s.x?r.x>o.x?r.x:o.x:s.x>o.x?s.x:o.x,d=r.y>s.y?r.y>o.y?r.y:o.y:s.y>o.y?s.y:o.y,l=Lw(a,c,e,t,n),u=Lw(h,d,e,t,n);let p=i.prevZ,g=i.nextZ;for(;p&&p.z>=l&&g&&g.z<=u;){if(p!==i.prev&&p!==i.next&&nu(r.x,r.y,s.x,s.y,o.x,o.y,p.x,p.y)&&zn(p.prev,p,p.next)>=0||(p=p.prevZ,g!==i.prev&&g!==i.next&&nu(r.x,r.y,s.x,s.y,o.x,o.y,g.x,g.y)&&zn(g.prev,g,g.next)>=0))return!1;g=g.nextZ}for(;p&&p.z>=l;){if(p!==i.prev&&p!==i.next&&nu(r.x,r.y,s.x,s.y,o.x,o.y,p.x,p.y)&&zn(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;g&&g.z<=u;){if(g!==i.prev&&g!==i.next&&nu(r.x,r.y,s.x,s.y,o.x,o.y,g.x,g.y)&&zn(g.prev,g,g.next)>=0)return!1;g=g.nextZ}return!0}function IO(i,e,t){let n=i;do{const r=n.prev,s=n.next.next;!bv(r,s)&&K3(r,n,n.next,s)&&Yd(r,s)&&Yd(s,r)&&(e.push(r.i/t),e.push(n.i/t),e.push(s.i/t),$d(n),$d(n.next),n=i=s),n=n.next}while(n!==i);return Ia(n)}function FO(i,e,t,n,r,s){let o=i;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&GO(o,a)){let c=J3(o,a);o=Ia(o,o.next),c=Ia(c,c.next),qd(o,e,t,n,r,s),qd(c,e,t,n,r,s);return}a=a.next}o=o.next}while(o!==i)}function DO(i,e,t,n){const r=[];let s,o,a,c,h;for(s=0,o=e.length;s<o;s++)a=e[s]*n,c=s<o-1?e[s+1]*n:i.length,h=Z3(i,a,c,n,!1),h===h.next&&(h.steiner=!0),r.push(VO(h));for(r.sort(BO),s=0;s<r.length;s++)zO(r[s],t),t=Ia(t,t.next);return t}function BO(i,e){return i.x-e.x}function zO(i,e){if(e=OO(i,e),e){const t=J3(e,i);Ia(e,e.next),Ia(t,t.next)}}function OO(i,e){let t=e;const n=i.x,r=i.y;let s=-1/0,o;do{if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){const u=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(u<=n&&u>s){if(s=u,u===n){if(r===t.y)return t;if(r===t.next.y)return t.next}o=t.x<t.next.x?t:t.next}}t=t.next}while(t!==e);if(!o)return null;if(n===s)return o;const a=o,c=o.x,h=o.y;let d=1/0,l;t=o;do n>=t.x&&t.x>=c&&n!==t.x&&nu(r<h?n:s,r,c,h,r<h?s:n,r,t.x,t.y)&&(l=Math.abs(r-t.y)/(n-t.x),Yd(t,i)&&(l<d||l===d&&(t.x>o.x||t.x===o.x&&NO(o,t)))&&(o=t,d=l)),t=t.next;while(t!==a);return o}function NO(i,e){return zn(i.prev,i,e.prev)<0&&zn(e.next,i,i.next)<0}function UO(i,e,t,n){let r=i;do r.z===null&&(r.z=Lw(r.x,r.y,e,t,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==i);r.prevZ.nextZ=null,r.prevZ=null,HO(r)}function HO(i){let e,t,n,r,s,o,a,c,h=1;do{for(t=i,i=null,s=null,o=0;t;){for(o++,n=t,a=0,e=0;e<h&&(a++,n=n.nextZ,!!n);e++);for(c=h;a>0||c>0&&n;)a!==0&&(c===0||!n||t.z<=n.z)?(r=t,t=t.nextZ,a--):(r=n,n=n.nextZ,c--),s?s.nextZ=r:i=r,r.prevZ=s,s=r;t=n}s.nextZ=null,h*=2}while(o>1);return i}function Lw(i,e,t,n,r){return i=32767*(i-t)*r,e=32767*(e-n)*r,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,i|e<<1}function VO(i){let e=i,t=i;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==i);return t}function nu(i,e,t,n,r,s,o,a){return(r-o)*(e-a)-(i-o)*(s-a)>=0&&(i-o)*(n-a)-(t-o)*(e-a)>=0&&(t-o)*(s-a)-(r-o)*(n-a)>=0}function GO(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!WO(i,e)&&(Yd(i,e)&&Yd(e,i)&&jO(i,e)&&(zn(i.prev,i,e.prev)||zn(i,e.prev,e))||bv(i,e)&&zn(i.prev,i,i.next)>0&&zn(e.prev,e,e.next)>0)}function zn(i,e,t){return(e.y-i.y)*(t.x-e.x)-(e.x-i.x)*(t.y-e.y)}function bv(i,e){return i.x===e.x&&i.y===e.y}function K3(i,e,t,n){const r=gm(zn(i,e,t)),s=gm(zn(i,e,n)),o=gm(zn(t,n,i)),a=gm(zn(t,n,e));return!!(r!==s&&o!==a||r===0&&mm(i,t,e)||s===0&&mm(i,n,e)||o===0&&mm(t,i,n)||a===0&&mm(t,e,n))}function mm(i,e,t){return e.x<=Math.max(i.x,t.x)&&e.x>=Math.min(i.x,t.x)&&e.y<=Math.max(i.y,t.y)&&e.y>=Math.min(i.y,t.y)}function gm(i){return i>0?1:i<0?-1:0}function WO(i,e){let t=i;do{if(t.i!==i.i&&t.next.i!==i.i&&t.i!==e.i&&t.next.i!==e.i&&K3(t,t.next,i,e))return!0;t=t.next}while(t!==i);return!1}function Yd(i,e){return zn(i.prev,i,i.next)<0?zn(i,e,i.next)>=0&&zn(i,i.prev,e)>=0:zn(i,e,i.prev)<0||zn(i,i.next,e)<0}function jO(i,e){let t=i,n=!1;const r=(i.x+e.x)/2,s=(i.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==i);return n}function J3(i,e){const t=new kw(i.i,i.x,i.y),n=new kw(e.i,e.x,e.y),r=i.next,s=e.prev;return i.next=e,e.prev=i,t.next=r,r.prev=t,n.next=t,t.prev=n,s.next=n,n.prev=s,n}function UE(i,e,t,n){const r=new kw(i,e,t);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function $d(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function kw(i,e,t){this.i=i,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function XO(i,e,t,n){let r=0;for(let s=e,o=t-n;s<t;s+=n)r+=(i[o]-i[s])*(i[s+1]+i[o+1]),o=s;return r}class Qs{static area(e){const t=e.length;let n=0;for(let r=t-1,s=0;s<t;r=s++)n+=e[r].x*e[s].y-e[s].x*e[r].y;return n*.5}static isClockWise(e){return Qs.area(e)<0}static triangulateShape(e,t){const n=[],r=[],s=[];HE(e),VE(n,e);let o=e.length;t.forEach(HE);for(let c=0;c<t.length;c++)r.push(o),o+=t[c].length,VE(n,t[c]);const a=RO.triangulate(n,r);for(let c=0;c<a.length;c+=3)s.push(a.slice(c,c+3));return s}}function HE(i){const e=i.length;e>2&&i[e-1].equals(i[0])&&i.pop()}function VE(i,e){for(let t=0;t<e.length;t++)i.push(e[t].x),i.push(e[t].y)}class Js extends vt{constructor(e=new $s([new Me(.5,.5),new Me(-.5,.5),new Me(-.5,-.5),new Me(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,r=[],s=[];for(let a=0,c=e.length;a<c;a++){const h=e[a];o(h)}this.setAttribute("position",new lt(r,3)),this.setAttribute("uv",new lt(s,2)),this.computeVertexNormals();function o(a){const c=[],h=t.curveSegments!==void 0?t.curveSegments:12,d=t.steps!==void 0?t.steps:1;let l=t.depth!==void 0?t.depth:1,u=t.bevelEnabled!==void 0?t.bevelEnabled:!0,p=t.bevelThickness!==void 0?t.bevelThickness:.2,g=t.bevelSize!==void 0?t.bevelSize:p-.1,y=t.bevelOffset!==void 0?t.bevelOffset:0,x=t.bevelSegments!==void 0?t.bevelSegments:3;const v=t.extrudePath,w=t.UVGenerator!==void 0?t.UVGenerator:qO;t.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),l=t.amount);let S,b=!1,E,R,z,I;v&&(S=v.getSpacedPoints(d),b=!0,u=!1,E=v.computeFrenetFrames(d,!1),R=new B,z=new B,I=new B),u||(x=0,p=0,g=0,y=0);const N=a.extractPoints(h);let F=N.shape;const C=N.holes;if(!Qs.isClockWise(F)){F=F.reverse();for(let me=0,fe=C.length;me<fe;me++){const we=C[me];Qs.isClockWise(we)&&(C[me]=we.reverse())}}const X=Qs.triangulateShape(F,C),U=F;for(let me=0,fe=C.length;me<fe;me++){const we=C[me];F=F.concat(we)}function te(me,fe,we){return fe||console.error("THREE.ExtrudeGeometry: vec does not exist"),fe.clone().multiplyScalar(we).add(me)}const ne=F.length,j=X.length;function k(me,fe,we){let ye,_e,it;const $e=me.x-fe.x,et=me.y-fe.y,L=we.x-me.x,V=we.y-me.y,P=$e*$e+et*et,T=$e*V-et*L;if(Math.abs(T)>Number.EPSILON){const q=Math.sqrt(P),re=Math.sqrt(L*L+V*V),pe=fe.x-et/q,ge=fe.y+$e/q,be=we.x-V/re,G=we.y+L/re,Ae=((be-pe)*V-(G-ge)*L)/($e*V-et*L);ye=pe+$e*Ae-me.x,_e=ge+et*Ae-me.y;const Fe=ye*ye+_e*_e;if(Fe<=2)return new Me(ye,_e);it=Math.sqrt(Fe/2)}else{let q=!1;$e>Number.EPSILON?L>Number.EPSILON&&(q=!0):$e<-Number.EPSILON?L<-Number.EPSILON&&(q=!0):Math.sign(et)===Math.sign(V)&&(q=!0),q?(ye=-et,_e=$e,it=Math.sqrt(P)):(ye=$e,_e=et,it=Math.sqrt(P/2))}return new Me(ye/it,_e/it)}const W=[];for(let me=0,fe=U.length,we=fe-1,ye=me+1;me<fe;me++,we++,ye++)we===fe&&(we=0),ye===fe&&(ye=0),W[me]=k(U[me],U[we],U[ye]);const Y=[];let H,J=W.concat();for(let me=0,fe=C.length;me<fe;me++){const we=C[me];H=[];for(let ye=0,_e=we.length,it=_e-1,$e=ye+1;ye<_e;ye++,it++,$e++)it===_e&&(it=0),$e===_e&&($e=0),H[ye]=k(we[ye],we[it],we[$e]);Y.push(H),J=J.concat(H)}for(let me=0;me<x;me++){const fe=me/x,we=p*Math.cos(fe*Math.PI/2),ye=g*Math.sin(fe*Math.PI/2)+y;for(let _e=0,it=U.length;_e<it;_e++){const $e=te(U[_e],W[_e],ye);Ee($e.x,$e.y,-we)}for(let _e=0,it=C.length;_e<it;_e++){const $e=C[_e];H=Y[_e];for(let et=0,L=$e.length;et<L;et++){const V=te($e[et],H[et],ye);Ee(V.x,V.y,-we)}}}const K=g+y;for(let me=0;me<ne;me++){const fe=u?te(F[me],J[me],K):F[me];b?(z.copy(E.normals[0]).multiplyScalar(fe.x),R.copy(E.binormals[0]).multiplyScalar(fe.y),I.copy(S[0]).add(z).add(R),Ee(I.x,I.y,I.z)):Ee(fe.x,fe.y,0)}for(let me=1;me<=d;me++)for(let fe=0;fe<ne;fe++){const we=u?te(F[fe],J[fe],K):F[fe];b?(z.copy(E.normals[me]).multiplyScalar(we.x),R.copy(E.binormals[me]).multiplyScalar(we.y),I.copy(S[me]).add(z).add(R),Ee(I.x,I.y,I.z)):Ee(we.x,we.y,l/d*me)}for(let me=x-1;me>=0;me--){const fe=me/x,we=p*Math.cos(fe*Math.PI/2),ye=g*Math.sin(fe*Math.PI/2)+y;for(let _e=0,it=U.length;_e<it;_e++){const $e=te(U[_e],W[_e],ye);Ee($e.x,$e.y,l+we)}for(let _e=0,it=C.length;_e<it;_e++){const $e=C[_e];H=Y[_e];for(let et=0,L=$e.length;et<L;et++){const V=te($e[et],H[et],ye);b?Ee(V.x,V.y+S[d-1].y,S[d-1].x+we):Ee(V.x,V.y,l+we)}}}ee(),$();function ee(){const me=r.length/3;if(u){let fe=0,we=ne*fe;for(let ye=0;ye<j;ye++){const _e=X[ye];Se(_e[2]+we,_e[1]+we,_e[0]+we)}fe=d+x*2,we=ne*fe;for(let ye=0;ye<j;ye++){const _e=X[ye];Se(_e[0]+we,_e[1]+we,_e[2]+we)}}else{for(let fe=0;fe<j;fe++){const we=X[fe];Se(we[2],we[1],we[0])}for(let fe=0;fe<j;fe++){const we=X[fe];Se(we[0]+ne*d,we[1]+ne*d,we[2]+ne*d)}}n.addGroup(me,r.length/3-me,0)}function $(){const me=r.length/3;let fe=0;Z(U,fe),fe+=U.length;for(let we=0,ye=C.length;we<ye;we++){const _e=C[we];Z(_e,fe),fe+=_e.length}n.addGroup(me,r.length/3-me,1)}function Z(me,fe){let we=me.length;for(;--we>=0;){const ye=we;let _e=we-1;_e<0&&(_e=me.length-1);for(let it=0,$e=d+x*2;it<$e;it++){const et=ne*it,L=ne*(it+1),V=fe+ye+et,P=fe+_e+et,T=fe+_e+L,q=fe+ye+L;de(V,P,T,q)}}}function Ee(me,fe,we){c.push(me),c.push(fe),c.push(we)}function Se(me,fe,we){he(me),he(fe),he(we);const ye=r.length/3,_e=w.generateTopUV(n,r,ye-3,ye-2,ye-1);Ce(_e[0]),Ce(_e[1]),Ce(_e[2])}function de(me,fe,we,ye){he(me),he(fe),he(ye),he(fe),he(we),he(ye);const _e=r.length/3,it=w.generateSideWallUV(n,r,_e-6,_e-3,_e-2,_e-1);Ce(it[0]),Ce(it[1]),Ce(it[3]),Ce(it[1]),Ce(it[2]),Ce(it[3])}function he(me){r.push(c[me*3+0]),r.push(c[me*3+1]),r.push(c[me*3+2])}function Ce(me){s.push(me.x),s.push(me.y)}}}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,n=this.parameters.options;return YO(t,n,e)}static fromJSON(e,t){const n=[];for(let s=0,o=e.shapes.length;s<o;s++){const a=t[e.shapes[s]];n.push(a)}const r=e.options.extrudePath;return r!==void 0&&(e.options.extrudePath=new p1[r.type]().fromJSON(r)),new Js(n,e.options)}}const qO={generateTopUV:function(i,e,t,n,r){const s=e[t*3],o=e[t*3+1],a=e[n*3],c=e[n*3+1],h=e[r*3],d=e[r*3+1];return[new Me(s,o),new Me(a,c),new Me(h,d)]},generateSideWallUV:function(i,e,t,n,r,s){const o=e[t*3],a=e[t*3+1],c=e[t*3+2],h=e[n*3],d=e[n*3+1],l=e[n*3+2],u=e[r*3],p=e[r*3+1],g=e[r*3+2],y=e[s*3],x=e[s*3+1],v=e[s*3+2];return Math.abs(a-d)<Math.abs(o-h)?[new Me(o,1-c),new Me(h,1-l),new Me(u,1-g),new Me(y,1-v)]:[new Me(a,1-c),new Me(d,1-l),new Me(p,1-g),new Me(x,1-v)]}};function YO(i,e,t){if(t.shapes=[],Array.isArray(i))for(let n=0,r=i.length;n<r;n++){const s=i[n];t.shapes.push(s.uuid)}else t.shapes.push(i.uuid);return e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class Lu extends Ks{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,r=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(r,s,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Lu(e.radius,e.detail)}}class ws extends Ks{constructor(e=1,t=0){const n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(n,r,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new ws(e.radius,e.detail)}}class ku extends vt{constructor(e=.5,t=1,n=8,r=1,s=0,o=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:s,thetaLength:o},n=Math.max(3,n),r=Math.max(1,r);const a=[],c=[],h=[],d=[];let l=e;const u=(t-e)/r,p=new B,g=new Me;for(let y=0;y<=r;y++){for(let x=0;x<=n;x++){const v=s+x/n*o;p.x=l*Math.cos(v),p.y=l*Math.sin(v),c.push(p.x,p.y,p.z),h.push(0,0,1),g.x=(p.x/t+1)/2,g.y=(p.y/t+1)/2,d.push(g.x,g.y)}l+=u}for(let y=0;y<r;y++){const x=y*(n+1);for(let v=0;v<n;v++){const w=v+x,S=w,b=w+n+1,E=w+n+2,R=w+1;a.push(S,b,R),a.push(b,E,R)}}this.setIndex(a),this.setAttribute("position",new lt(c,3)),this.setAttribute("normal",new lt(h,3)),this.setAttribute("uv",new lt(d,2))}static fromJSON(e){return new ku(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class Hl extends vt{constructor(e=new $s([new Me(0,.5),new Me(-.5,-.5),new Me(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],r=[],s=[],o=[];let a=0,c=0;if(Array.isArray(e)===!1)h(e);else for(let d=0;d<e.length;d++)h(e[d]),this.addGroup(a,c,d),a+=c,c=0;this.setIndex(n),this.setAttribute("position",new lt(r,3)),this.setAttribute("normal",new lt(s,3)),this.setAttribute("uv",new lt(o,2));function h(d){const l=r.length/3,u=d.extractPoints(t);let p=u.shape;const g=u.holes;Qs.isClockWise(p)===!1&&(p=p.reverse());for(let x=0,v=g.length;x<v;x++){const w=g[x];Qs.isClockWise(w)===!0&&(g[x]=w.reverse())}const y=Qs.triangulateShape(p,g);for(let x=0,v=g.length;x<v;x++){const w=g[x];p=p.concat(w)}for(let x=0,v=p.length;x<v;x++){const w=p[x];r.push(w.x,w.y,0),s.push(0,0,1),o.push(w.x,w.y)}for(let x=0,v=y.length;x<v;x++){const w=y[x],S=w[0]+l,b=w[1]+l,E=w[2]+l;n.push(S,b,E),c+=3}}}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return $O(t,e)}static fromJSON(e,t){const n=[];for(let r=0,s=e.shapes.length;r<s;r++){const o=t[e.shapes[r]];n.push(o)}return new Hl(n,e.curveSegments)}}function $O(i,e){if(e.shapes=[],Array.isArray(i))for(let t=0,n=i.length;t<n;t++){const r=i[t];e.shapes.push(r.uuid)}else e.shapes.push(i.uuid);return e}class Ro extends vt{constructor(e=1,t=32,n=16,r=0,s=Math.PI*2,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const c=Math.min(o+a,Math.PI);let h=0;const d=[],l=new B,u=new B,p=[],g=[],y=[],x=[];for(let v=0;v<=n;v++){const w=[],S=v/n;let b=0;v==0&&o==0?b=.5/t:v==n&&c==Math.PI&&(b=-.5/t);for(let E=0;E<=t;E++){const R=E/t;l.x=-e*Math.cos(r+R*s)*Math.sin(o+S*a),l.y=e*Math.cos(o+S*a),l.z=e*Math.sin(r+R*s)*Math.sin(o+S*a),g.push(l.x,l.y,l.z),u.copy(l).normalize(),y.push(u.x,u.y,u.z),x.push(R+b,1-S),w.push(h++)}d.push(w)}for(let v=0;v<n;v++)for(let w=0;w<t;w++){const S=d[v][w+1],b=d[v][w],E=d[v+1][w],R=d[v+1][w+1];(v!==0||o>0)&&p.push(S,b,R),(v!==n-1||c<Math.PI)&&p.push(b,E,R)}this.setIndex(p),this.setAttribute("position",new lt(g,3)),this.setAttribute("normal",new lt(y,3)),this.setAttribute("uv",new lt(x,2))}static fromJSON(e){return new Ro(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Iu extends Ks{constructor(e=1,t=0){const n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],r=[2,1,0,0,3,2,1,3,0,2,3,1];super(n,r,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Iu(e.radius,e.detail)}}class xs extends vt{constructor(e=1,t=.4,n=8,r=6,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:s},n=Math.floor(n),r=Math.floor(r);const o=[],a=[],c=[],h=[],d=new B,l=new B,u=new B;for(let p=0;p<=n;p++)for(let g=0;g<=r;g++){const y=g/r*s,x=p/n*Math.PI*2;l.x=(e+t*Math.cos(x))*Math.cos(y),l.y=(e+t*Math.cos(x))*Math.sin(y),l.z=t*Math.sin(x),a.push(l.x,l.y,l.z),d.x=e*Math.cos(y),d.y=e*Math.sin(y),u.subVectors(l,d).normalize(),c.push(u.x,u.y,u.z),h.push(g/r),h.push(p/n)}for(let p=1;p<=n;p++)for(let g=1;g<=r;g++){const y=(r+1)*p+g-1,x=(r+1)*(p-1)+g-1,v=(r+1)*(p-1)+g,w=(r+1)*p+g;o.push(y,x,w),o.push(x,v,w)}this.setIndex(o),this.setAttribute("position",new lt(a,3)),this.setAttribute("normal",new lt(c,3)),this.setAttribute("uv",new lt(h,2))}static fromJSON(e){return new xs(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class Fu extends vt{constructor(e=1,t=.4,n=64,r=8,s=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:s,q:o},n=Math.floor(n),r=Math.floor(r);const a=[],c=[],h=[],d=[],l=new B,u=new B,p=new B,g=new B,y=new B,x=new B,v=new B;for(let S=0;S<=n;++S){const b=S/n*s*Math.PI*2;w(b,s,o,e,p),w(b+.01,s,o,e,g),x.subVectors(g,p),v.addVectors(g,p),y.crossVectors(x,v),v.crossVectors(y,x),y.normalize(),v.normalize();for(let E=0;E<=r;++E){const R=E/r*Math.PI*2,z=-t*Math.cos(R),I=t*Math.sin(R);l.x=p.x+(z*v.x+I*y.x),l.y=p.y+(z*v.y+I*y.y),l.z=p.z+(z*v.z+I*y.z),c.push(l.x,l.y,l.z),u.subVectors(l,p).normalize(),h.push(u.x,u.y,u.z),d.push(S/n),d.push(E/r)}}for(let S=1;S<=n;S++)for(let b=1;b<=r;b++){const E=(r+1)*(S-1)+(b-1),R=(r+1)*S+(b-1),z=(r+1)*S+b,I=(r+1)*(S-1)+b;a.push(E,R,I),a.push(R,z,I)}this.setIndex(a),this.setAttribute("position",new lt(c,3)),this.setAttribute("normal",new lt(h,3)),this.setAttribute("uv",new lt(d,2));function w(S,b,E,R,z){const I=Math.cos(S),N=Math.sin(S),F=E/b*S,C=Math.cos(F);z.x=R*(2+C)*.5*I,z.y=R*(2+C)*N*.5,z.z=R*Math.sin(F)*.5}}static fromJSON(e){return new Fu(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class Du extends vt{constructor(e=new _v(new B(-1,-1,0),new B(-1,1,0),new B(1,1,0)),t=64,n=1,r=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:s};const o=e.computeFrenetFrames(t,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new B,c=new B,h=new Me;let d=new B;const l=[],u=[],p=[],g=[];y(),this.setIndex(g),this.setAttribute("position",new lt(l,3)),this.setAttribute("normal",new lt(u,3)),this.setAttribute("uv",new lt(p,2));function y(){for(let S=0;S<t;S++)x(S);x(s===!1?t:0),w(),v()}function x(S){d=e.getPointAt(S/t,d);const b=o.normals[S],E=o.binormals[S];for(let R=0;R<=r;R++){const z=R/r*Math.PI*2,I=Math.sin(z),N=-Math.cos(z);c.x=N*b.x+I*E.x,c.y=N*b.y+I*E.y,c.z=N*b.z+I*E.z,c.normalize(),u.push(c.x,c.y,c.z),a.x=d.x+n*c.x,a.y=d.y+n*c.y,a.z=d.z+n*c.z,l.push(a.x,a.y,a.z)}}function v(){for(let S=1;S<=t;S++)for(let b=1;b<=r;b++){const E=(r+1)*(S-1)+(b-1),R=(r+1)*S+(b-1),z=(r+1)*S+b,I=(r+1)*(S-1)+b;g.push(E,R,I),g.push(R,z,I)}}function w(){for(let S=0;S<=t;S++)for(let b=0;b<=r;b++)h.x=S/t,h.y=b/r,p.push(h.x,h.y)}}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new Du(new p1[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class g1 extends vt{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],n=new Set,r=new B,s=new B;if(e.index!==null){const o=e.attributes.position,a=e.index;let c=e.groups;c.length===0&&(c=[{start:0,count:a.count,materialIndex:0}]);for(let h=0,d=c.length;h<d;++h){const l=c[h],u=l.start,p=l.count;for(let g=u,y=u+p;g<y;g+=3)for(let x=0;x<3;x++){const v=a.getX(g+x),w=a.getX(g+(x+1)%3);r.fromBufferAttribute(o,v),s.fromBufferAttribute(o,w),GE(r,s,n)===!0&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}}else{const o=e.attributes.position;for(let a=0,c=o.count/3;a<c;a++)for(let h=0;h<3;h++){const d=3*a+h,l=3*a+(h+1)%3;r.fromBufferAttribute(o,d),s.fromBufferAttribute(o,l),GE(r,s,n)===!0&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new lt(t,3))}}}function GE(i,e,t){const n=`${i.x},${i.y},${i.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${i.x},${i.y},${i.z}`;return t.has(n)===!0||t.has(r)===!0?!1:(t.add(n),t.add(r),!0)}var WE=Object.freeze({__proto__:null,BoxGeometry:dn,BoxBufferGeometry:dn,CapsuleGeometry:Au,CapsuleBufferGeometry:Au,CircleGeometry:Cu,CircleBufferGeometry:Cu,ConeGeometry:Pu,ConeBufferGeometry:Pu,CylinderGeometry:kn,CylinderBufferGeometry:kn,DodecahedronGeometry:Ru,DodecahedronBufferGeometry:Ru,EdgesGeometry:m1,ExtrudeGeometry:Js,ExtrudeBufferGeometry:Js,IcosahedronGeometry:Lu,IcosahedronBufferGeometry:Lu,LatheGeometry:Ul,LatheBufferGeometry:Ul,OctahedronGeometry:ws,OctahedronBufferGeometry:ws,PlaneGeometry:xn,PlaneBufferGeometry:xn,PolyhedronGeometry:Ks,PolyhedronBufferGeometry:Ks,RingGeometry:ku,RingBufferGeometry:ku,ShapeGeometry:Hl,ShapeBufferGeometry:Hl,SphereGeometry:Ro,SphereBufferGeometry:Ro,TetrahedronGeometry:Iu,TetrahedronBufferGeometry:Iu,TorusGeometry:xs,TorusBufferGeometry:xs,TorusKnotGeometry:Fu,TorusKnotBufferGeometry:Fu,TubeGeometry:Du,TubeBufferGeometry:Du,WireframeGeometry:g1});class v1 extends An{constructor(e){super(),this.type="ShadowMaterial",this.color=new qe(0),this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this}}v1.prototype.isShadowMaterial=!0;class y1 extends jn{constructor(e){super(e),this.type="RawShaderMaterial"}}y1.prototype.isRawShaderMaterial=!0;class $l extends An{constructor(e){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new qe(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new qe(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Na,this.normalScale=new Me(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}$l.prototype.isMeshStandardMaterial=!0;class No extends $l{constructor(e){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Me(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Jn(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.sheenColor=new qe(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new qe(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new qe(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}No.prototype.isMeshPhysicalMaterial=!0;class uu extends An{constructor(e){super(),this.type="MeshPhongMaterial",this.color=new qe(16777215),this.specular=new qe(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new qe(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Na,this.normalScale=new Me(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=uf,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}uu.prototype.isMeshPhongMaterial=!0;class x1 extends An{constructor(e){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new qe(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new qe(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Na,this.normalScale=new Me(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}x1.prototype.isMeshToonMaterial=!0;class Bu extends An{constructor(e){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Na,this.normalScale=new Me(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}Bu.prototype.isMeshNormalMaterial=!0;class Mv extends An{constructor(e){super(),this.type="MeshLambertMaterial",this.color=new qe(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new qe(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=uf,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}Mv.prototype.isMeshLambertMaterial=!0;class w1 extends An{constructor(e){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new qe(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Na,this.normalScale=new Me(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this}}w1.prototype.isMeshMatcapMaterial=!0;class _1 extends ni{constructor(e){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}_1.prototype.isLineDashedMaterial=!0;const QO={ShadowMaterial:v1,SpriteMaterial:gv,RawShaderMaterial:y1,ShaderMaterial:jn,PointsMaterial:Va,MeshPhysicalMaterial:No,MeshStandardMaterial:$l,MeshPhongMaterial:uu,MeshToonMaterial:x1,MeshNormalMaterial:Bu,MeshLambertMaterial:Mv,MeshDepthMaterial:pv,MeshDistanceMaterial:mv,MeshBasicMaterial:Bt,MeshMatcapMaterial:w1,LineDashedMaterial:_1,LineBasicMaterial:ni,Material:An};An.fromType=function(i){return new QO[i]};const bn={arraySlice:function(i,e,t){return bn.isTypedArray(i)?new i.constructor(i.subarray(e,t!==void 0?t:i.length)):i.slice(e,t)},convertArray:function(i,e,t){return!i||!t&&i.constructor===e?i:typeof e.BYTES_PER_ELEMENT=="number"?new e(i):Array.prototype.slice.call(i)},isTypedArray:function(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)},getKeyframeOrder:function(i){function e(r,s){return i[r]-i[s]}const t=i.length,n=new Array(t);for(let r=0;r!==t;++r)n[r]=r;return n.sort(e),n},sortedArray:function(i,e,t){const n=i.length,r=new i.constructor(n);for(let s=0,o=0;o!==n;++s){const a=t[s]*e;for(let c=0;c!==e;++c)r[o++]=i[a+c]}return r},flattenJSON:function(i,e,t,n){let r=1,s=i[0];for(;s!==void 0&&s[n]===void 0;)s=i[r++];if(s===void 0)return;let o=s[n];if(o!==void 0)if(Array.isArray(o))do o=s[n],o!==void 0&&(e.push(s.time),t.push.apply(t,o)),s=i[r++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[n],o!==void 0&&(e.push(s.time),o.toArray(t,t.length)),s=i[r++];while(s!==void 0);else do o=s[n],o!==void 0&&(e.push(s.time),t.push(o)),s=i[r++];while(s!==void 0)},subclip:function(i,e,t,n,r=30){const s=i.clone();s.name=e;const o=[];for(let c=0;c<s.tracks.length;++c){const h=s.tracks[c],d=h.getValueSize(),l=[],u=[];for(let p=0;p<h.times.length;++p){const g=h.times[p]*r;if(!(g<t||g>=n)){l.push(h.times[p]);for(let y=0;y<d;++y)u.push(h.values[p*d+y])}}l.length!==0&&(h.times=bn.convertArray(l,h.times.constructor),h.values=bn.convertArray(u,h.values.constructor),o.push(h))}s.tracks=o;let a=1/0;for(let c=0;c<s.tracks.length;++c)a>s.tracks[c].times[0]&&(a=s.tracks[c].times[0]);for(let c=0;c<s.tracks.length;++c)s.tracks[c].shift(-1*a);return s.resetDuration(),s},makeClipAdditive:function(i,e=0,t=i,n=30){n<=0&&(n=30);const r=t.tracks.length,s=e/n;for(let o=0;o<r;++o){const a=t.tracks[o],c=a.ValueTypeName;if(c==="bool"||c==="string")continue;const h=i.tracks.find(function(v){return v.name===a.name&&v.ValueTypeName===c});if(h===void 0)continue;let d=0;const l=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(d=l/3);let u=0;const p=h.getValueSize();h.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=p/3);const g=a.times.length-1;let y;if(s<=a.times[0]){const v=d,w=l-d;y=bn.arraySlice(a.values,v,w)}else if(s>=a.times[g]){const v=g*l+d,w=v+l-d;y=bn.arraySlice(a.values,v,w)}else{const v=a.createInterpolant(),w=d,S=l-d;v.evaluate(s),y=bn.arraySlice(v.resultBuffer,w,S)}c==="quaternion"&&new qt().fromArray(y).normalize().conjugate().toArray(y);const x=h.times.length;for(let v=0;v<x;++v){const w=v*p+u;if(c==="quaternion")qt.multiplyQuaternionsFlat(h.values,w,y,0,h.values,w);else{const S=p-u*2;for(let b=0;b<S;++b)h.values[w+b]-=y[b]}}}return i.blendMode=t1,i}};class eo{constructor(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,r=t[n],s=t[n-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=n+2;;){if(r===void 0){if(e<s)break i;return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,e,s)}if(n===a)break;if(s=r,r=t[++n],e<r)break t}o=t.length;break n}if(!(e>=s)){const a=t[1];e<a&&(n=2,s=a);for(let c=n-2;;){if(s===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,r);if(n===c)break;if(r=s,s=t[--n-1],e>=s)break t}o=n,n=0;break n}break e}for(;n<o;){const a=n+o>>>1;e<t[a]?o=a:n=a+1}if(r=t[n],s=t[n-1],s===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,r);if(r===void 0)return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,s,e)}this._cachedIndex=n,this.intervalChanged_(n,s,r)}return this.interpolate_(n,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=n[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}eo.prototype.beforeStart_=eo.prototype.copySampleValue_;eo.prototype.afterEnd_=eo.prototype.copySampleValue_;class eP extends eo{constructor(e,t,n,r){super(e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:wl,endingEnd:wl}}intervalChanged_(e,t,n){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],c=r[o];if(a===void 0)switch(this.getSettings_().endingStart){case _l:s=e,a=2*t-n;break;case Wd:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=n}if(c===void 0)switch(this.getSettings_().endingEnd){case _l:o=e,c=2*n-t;break;case Wd:o=1,c=n+r[1]-r[0];break;default:o=e-1,c=t}const h=(n-t)*.5,d=this.valueSize;this._weightPrev=h/(t-a),this._weightNext=h/(c-n),this._offsetPrev=s*d,this._offsetNext=o*d}interpolate_(e,t,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=e*a,h=c-a,d=this._offsetPrev,l=this._offsetNext,u=this._weightPrev,p=this._weightNext,g=(n-t)/(r-t),y=g*g,x=y*g,v=-u*x+2*u*y-u*g,w=(1+u)*x+(-1.5-2*u)*y+(-.5+u)*g+1,S=(-1-p)*x+(1.5+p)*y+.5*g,b=p*x-p*y;for(let E=0;E!==a;++E)s[E]=v*o[d+E]+w*o[h+E]+S*o[c+E]+b*o[l+E];return s}}class S1 extends eo{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=e*a,h=c-a,d=(n-t)/(r-t),l=1-d;for(let u=0;u!==a;++u)s[u]=o[h+u]*l+o[c+u]*d;return s}}class tP extends eo{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class Cs{constructor(e,t,n,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=bn.convertArray(t,this.TimeBufferType),this.values=bn.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:bn.convertArray(e.times,Array),values:bn.convertArray(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(n.interpolation=r)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new tP(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new S1(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new eP(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Su:t=this.InterpolantFactoryMethodDiscrete;break;case zl:t=this.InterpolantFactoryMethodLinear;break;case Km:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Su;case this.InterpolantFactoryMethodLinear:return zl;case this.InterpolantFactoryMethodSmooth:return Km}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){const n=this.times,r=n.length;let s=0,o=r-1;for(;s!==r&&n[s]<e;)++s;for(;o!==-1&&n[o]>t;)--o;if(++o,s!==0||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=bn.arraySlice(n,s,o),this.values=bn.arraySlice(this.values,s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,r=this.values,s=n.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const c=n[a];if(typeof c=="number"&&isNaN(c)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,c),e=!1;break}if(o!==null&&o>c){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,c,o),e=!1;break}o=c}if(r!==void 0&&bn.isTypedArray(r))for(let a=0,c=r.length;a!==c;++a){const h=r[a];if(isNaN(h)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,h),e=!1;break}}return e}optimize(){const e=bn.arraySlice(this.times),t=bn.arraySlice(this.values),n=this.getValueSize(),r=this.getInterpolation()===Km,s=e.length-1;let o=1;for(let a=1;a<s;++a){let c=!1;const h=e[a],d=e[a+1];if(h!==d&&(a!==1||h!==e[0]))if(r)c=!0;else{const l=a*n,u=l-n,p=l+n;for(let g=0;g!==n;++g){const y=t[l+g];if(y!==t[u+g]||y!==t[p+g]){c=!0;break}}}if(c){if(a!==o){e[o]=e[a];const l=a*n,u=o*n;for(let p=0;p!==n;++p)t[u+p]=t[l+p]}++o}}if(s>0){e[o]=e[s];for(let a=s*n,c=o*n,h=0;h!==n;++h)t[c+h]=t[a+h];++o}return o!==e.length?(this.times=bn.arraySlice(e,0,o),this.values=bn.arraySlice(t,0,o*n)):(this.times=e,this.values=t),this}clone(){const e=bn.arraySlice(this.times,0),t=bn.arraySlice(this.values,0),n=this.constructor,r=new n(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}Cs.prototype.TimeBufferType=Float32Array;Cs.prototype.ValueBufferType=Float32Array;Cs.prototype.DefaultInterpolation=zl;class Ql extends Cs{}Ql.prototype.ValueTypeName="bool";Ql.prototype.ValueBufferType=Array;Ql.prototype.DefaultInterpolation=Su;Ql.prototype.InterpolantFactoryMethodLinear=void 0;Ql.prototype.InterpolantFactoryMethodSmooth=void 0;class b1 extends Cs{}b1.prototype.ValueTypeName="color";class Vl extends Cs{}Vl.prototype.ValueTypeName="number";class nP extends eo{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=(n-t)/(r-t);let h=e*a;for(let d=h+a;h!==d;h+=4)qt.slerpFlat(s,0,o,h-a,o,h,c);return s}}class Lo extends Cs{InterpolantFactoryMethodLinear(e){return new nP(this.times,this.values,this.getValueSize(),e)}}Lo.prototype.ValueTypeName="quaternion";Lo.prototype.DefaultInterpolation=zl;Lo.prototype.InterpolantFactoryMethodSmooth=void 0;class Zl extends Cs{}Zl.prototype.ValueTypeName="string";Zl.prototype.ValueBufferType=Array;Zl.prototype.DefaultInterpolation=Su;Zl.prototype.InterpolantFactoryMethodLinear=void 0;Zl.prototype.InterpolantFactoryMethodSmooth=void 0;class Gl extends Cs{}Gl.prototype.ValueTypeName="vector";class Wl{constructor(e,t=-1,n,r=cv){this.name=e,this.tracks=n,this.duration=t,this.blendMode=r,this.uuid=Ir(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,r=1/(e.fps||1);for(let o=0,a=n.length;o!==a;++o)t.push(KO(n[o]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=n.length;s!==o;++s)t.push(Cs.toJSON(n[s]));return r}static CreateFromMorphTargetSequence(e,t,n,r){const s=t.length,o=[];for(let a=0;a<s;a++){let c=[],h=[];c.push((a+s-1)%s,a,(a+1)%s),h.push(0,1,0);const d=bn.getKeyframeOrder(c);c=bn.sortedArray(c,1,d),h=bn.sortedArray(h,1,d),!r&&c[0]===0&&(c.push(s),h.push(h[0])),o.push(new Vl(".morphTargetInfluences["+t[a].name+"]",c,h).scale(1/n))}return new this(e,-1,o)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const r=e;n=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<n.length;r++)if(n[r].name===t)return n[r];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,c=e.length;a<c;a++){const h=e[a],d=h.name.match(s);if(d&&d.length>1){const l=d[1];let u=r[l];u||(r[l]=u=[]),u.push(h)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],t,n));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(l,u,p,g,y){if(p.length!==0){const x=[],v=[];bn.flattenJSON(p,x,v,g),x.length!==0&&y.push(new l(u,x,v))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let c=e.length||-1;const h=e.hierarchy||[];for(let l=0;l<h.length;l++){const u=h[l].keys;if(!(!u||u.length===0))if(u[0].morphTargets){const p={};let g;for(g=0;g<u.length;g++)if(u[g].morphTargets)for(let y=0;y<u[g].morphTargets.length;y++)p[u[g].morphTargets[y]]=-1;for(const y in p){const x=[],v=[];for(let w=0;w!==u[g].morphTargets.length;++w){const S=u[g];x.push(S.time),v.push(S.morphTarget===y?1:0)}r.push(new Vl(".morphTargetInfluence["+y+"]",x,v))}c=p.length*o}else{const p=".bones["+t[l].name+"]";n(Gl,p+".position",u,"pos",r),n(Lo,p+".quaternion",u,"rot",r),n(Gl,p+".scale",u,"scl",r)}}return r.length===0?null:new this(s,c,r,a)}resetDuration(){const e=this.tracks;let t=0;for(let n=0,r=e.length;n!==r;++n){const s=this.tracks[n];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function ZO(i){switch(i.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Vl;case"vector":case"vector2":case"vector3":case"vector4":return Gl;case"color":return b1;case"quaternion":return Lo;case"bool":case"boolean":return Ql;case"string":return Zl}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+i)}function KO(i){if(i.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=ZO(i.type);if(i.times===void 0){const t=[],n=[];bn.flattenJSON(i.keys,t,n,"value"),i.times=t,i.values=n}return e.parse!==void 0?e.parse(i):new e(i.name,i.times,i.values,i.interpolation)}const jl={enabled:!1,files:{},add:function(i,e){this.enabled!==!1&&(this.files[i]=e)},get:function(i){if(this.enabled!==!1)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}};class M1{constructor(e,t,n){const r=this;let s=!1,o=0,a=0,c;const h=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(d){a++,s===!1&&r.onStart!==void 0&&r.onStart(d,o,a),s=!0},this.itemEnd=function(d){o++,r.onProgress!==void 0&&r.onProgress(d,o,a),o===a&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(d){r.onError!==void 0&&r.onError(d)},this.resolveURL=function(d){return c?c(d):d},this.setURLModifier=function(d){return c=d,this},this.addHandler=function(d,l){return h.push(d,l),this},this.removeHandler=function(d){const l=h.indexOf(d);return l!==-1&&h.splice(l,2),this},this.getHandler=function(d){for(let l=0,u=h.length;l<u;l+=2){const p=h[l],g=h[l+1];if(p.global&&(p.lastIndex=0),p.test(d))return g}return null}}}const iP=new M1;class Ei{constructor(e){this.manager=e!==void 0?e:iP,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(r,s){n.load(e,r,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const po={};class er extends Ei{constructor(e){super(e)}load(e,t,n,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=jl.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(po[e]!==void 0){po[e].push({onLoad:t,onProgress:n,onError:r});return}po[e]=[],po[e].push({onLoad:t,onProgress:n,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,c=this.responseType;fetch(o).then(h=>{if(h.status===200||h.status===0){if(h.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream=="undefined"||h.body===void 0||h.body.getReader===void 0)return h;const d=po[e],l=h.body.getReader(),u=h.headers.get("Content-Length"),p=u?parseInt(u):0,g=p!==0;let y=0;const x=new ReadableStream({start(v){w();function w(){l.read().then(({done:S,value:b})=>{if(S)v.close();else{y+=b.byteLength;const E=new ProgressEvent("progress",{lengthComputable:g,loaded:y,total:p});for(let R=0,z=d.length;R<z;R++){const I=d[R];I.onProgress&&I.onProgress(E)}v.enqueue(b),w()}})}}});return new Response(x)}else throw Error(`fetch for "${h.url}" responded with ${h.status}: ${h.statusText}`)}).then(h=>{switch(c){case"arraybuffer":return h.arrayBuffer();case"blob":return h.blob();case"document":return h.text().then(d=>new DOMParser().parseFromString(d,a));case"json":return h.json();default:if(a===void 0)return h.text();{const l=/charset="?([^;"\s]*)"?/i.exec(a),u=l&&l[1]?l[1].toLowerCase():void 0,p=new TextDecoder(u);return h.arrayBuffer().then(g=>p.decode(g))}}}).then(h=>{jl.add(e,h);const d=po[e];delete po[e];for(let l=0,u=d.length;l<u;l++){const p=d[l];p.onLoad&&p.onLoad(h)}}).catch(h=>{const d=po[e];if(d===void 0)throw this.manager.itemError(e),h;delete po[e];for(let l=0,u=d.length;l<u;l++){const p=d[l];p.onError&&p.onError(h)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class JO extends Ei{constructor(e){super(e)}load(e,t,n,r){const s=this,o=new er(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(c){r?r(c):console.error(c),s.manager.itemError(e)}},n,r)}parse(e){const t=[];for(let n=0;n<e.length;n++){const r=Wl.parse(e[n]);t.push(r)}return t}}class eN extends Ei{constructor(e){super(e)}load(e,t,n,r){const s=this,o=[],a=new c1,c=new er(this.manager);c.setPath(this.path),c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setWithCredentials(s.withCredentials);let h=0;function d(l){c.load(e[l],function(u){const p=s.parse(u,!0);o[l]={width:p.width,height:p.height,format:p.format,mipmaps:p.mipmaps},h+=1,h===6&&(p.mipmapCount===1&&(a.minFilter=jt),a.image=o,a.format=p.format,a.needsUpdate=!0,t&&t(a))},n,r)}if(Array.isArray(e))for(let l=0,u=e.length;l<u;++l)d(l);else c.load(e,function(l){const u=s.parse(l,!0);if(u.isCubemap){const p=u.mipmaps.length/u.mipmapCount;for(let g=0;g<p;g++){o[g]={mipmaps:[]};for(let y=0;y<u.mipmapCount;y++)o[g].mipmaps.push(u.mipmaps[g*u.mipmapCount+y]),o[g].format=u.format,o[g].width=u.width,o[g].height=u.height}a.image=o}else a.image.width=u.width,a.image.height=u.height,a.mipmaps=u.mipmaps;u.mipmapCount===1&&(a.minFilter=jt),a.format=u.format,a.needsUpdate=!0,t&&t(a)},n,r);return a}}class Qd extends Ei{constructor(e){super(e)}load(e,t,n,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=jl.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=Xd("img");function c(){d(),jl.add(e,this),t&&t(this),s.manager.itemEnd(e)}function h(l){d(),r&&r(l),s.manager.itemError(e),s.manager.itemEnd(e)}function d(){a.removeEventListener("load",c,!1),a.removeEventListener("error",h,!1)}return a.addEventListener("load",c,!1),a.addEventListener("error",h,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class rP extends Ei{constructor(e){super(e)}load(e,t,n,r){const s=new qu,o=new Qd(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function c(h){o.load(e[h],function(d){s.images[h]=d,a++,a===6&&(s.needsUpdate=!0,t&&t(s))},void 0,r)}for(let h=0;h<e.length;++h)c(h);return s}}class sP extends Ei{constructor(e){super(e)}load(e,t,n,r){const s=this,o=new Ea,a=new er(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(s.withCredentials),a.load(e,function(c){const h=s.parse(c);!h||(h.image!==void 0?o.image=h.image:h.data!==void 0&&(o.image.width=h.width,o.image.height=h.height,o.image.data=h.data),o.wrapS=h.wrapS!==void 0?h.wrapS:_i,o.wrapT=h.wrapT!==void 0?h.wrapT:_i,o.magFilter=h.magFilter!==void 0?h.magFilter:jt,o.minFilter=h.minFilter!==void 0?h.minFilter:jt,o.anisotropy=h.anisotropy!==void 0?h.anisotropy:1,h.encoding!==void 0&&(o.encoding=h.encoding),h.flipY!==void 0&&(o.flipY=h.flipY),h.format!==void 0&&(o.format=h.format),h.type!==void 0&&(o.type=h.type),h.mipmaps!==void 0&&(o.mipmaps=h.mipmaps,o.minFilter=Do),h.mipmapCount===1&&(o.minFilter=jt),h.generateMipmaps!==void 0&&(o.generateMipmaps=h.generateMipmaps),o.needsUpdate=!0,t&&t(o,h))},n,r),o}}class Ev extends Ei{constructor(e){super(e)}load(e,t,n,r){const s=new hn,o=new Qd(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,t!==void 0&&t(s)},n,r),s}}class As extends ft{constructor(e,t=1){super(),this.type="Light",this.color=new qe(e),this.intensity=t}dispose(){}copy(e){return super.copy(e),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}}As.prototype.isLight=!0;class E1 extends As{constructor(e,t,n){super(e,n),this.type="HemisphereLight",this.position.copy(ft.DefaultUp),this.updateMatrix(),this.groundColor=new qe(t)}copy(e){return As.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}E1.prototype.isHemisphereLight=!0;const jE=new st,XE=new B,qE=new B;class T1{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Me(512,512),this.map=null,this.mapPass=null,this.matrix=new st,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new ff,this._frameExtents=new Me(1,1),this._viewportCount=1,this._viewports=[new Jt(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;XE.setFromMatrixPosition(e.matrixWorld),t.position.copy(XE),qE.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(qE),t.updateMatrixWorld(),jE.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(jE),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(t.projectionMatrix),n.multiply(t.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class oP extends T1{constructor(){super(new Mn(50,1,.5,500)),this.focus=1}updateMatrices(e){const t=this.camera,n=jd*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(n!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=n,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}oP.prototype.isSpotLightShadow=!0;class yf extends As{constructor(e,t,n=0,r=Math.PI/3,s=0,o=1){super(e,t),this.type="SpotLight",this.position.copy(ft.DefaultUp),this.updateMatrix(),this.target=new ft,this.distance=n,this.angle=r,this.penumbra=s,this.decay=o,this.shadow=new oP}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}yf.prototype.isSpotLight=!0;const YE=new st,Wh=new B,Uy=new B;class aP extends T1{constructor(){super(new Mn(90,1,.5,500)),this._frameExtents=new Me(4,2),this._viewportCount=6,this._viewports=[new Jt(2,1,1,1),new Jt(0,1,1,1),new Jt(3,1,1,1),new Jt(1,1,1,1),new Jt(3,0,1,1),new Jt(1,0,1,1)],this._cubeDirections=[new B(1,0,0),new B(-1,0,0),new B(0,0,1),new B(0,0,-1),new B(0,1,0),new B(0,-1,0)],this._cubeUps=[new B(0,1,0),new B(0,1,0),new B(0,1,0),new B(0,1,0),new B(0,0,1),new B(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,r=this.matrix,s=e.distance||n.far;s!==n.far&&(n.far=s,n.updateProjectionMatrix()),Wh.setFromMatrixPosition(e.matrixWorld),n.position.copy(Wh),Uy.copy(n.position),Uy.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(Uy),n.updateMatrixWorld(),r.makeTranslation(-Wh.x,-Wh.y,-Wh.z),YE.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(YE)}}aP.prototype.isPointLightShadow=!0;class zu extends As{constructor(e,t,n=0,r=1){super(e,t),this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new aP}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}zu.prototype.isPointLight=!0;class lP extends T1{constructor(){super(new Fr(-5,5,5,-5,.5,500))}}lP.prototype.isDirectionalLightShadow=!0;class xf extends As{constructor(e,t){super(e,t),this.type="DirectionalLight",this.position.copy(ft.DefaultUp),this.updateMatrix(),this.target=new ft,this.shadow=new lP}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}xf.prototype.isDirectionalLight=!0;class Tv extends As{constructor(e,t){super(e,t),this.type="AmbientLight"}}Tv.prototype.isAmbientLight=!0;class A1 extends As{constructor(e,t,n=10,r=10){super(e,t),this.type="RectAreaLight",this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}A1.prototype.isRectAreaLight=!0;class C1{constructor(){this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new B)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*r),t.addScaledVector(o[2],.488603*s),t.addScaledVector(o[3],.488603*n),t.addScaledVector(o[4],1.092548*(n*r)),t.addScaledVector(o[5],1.092548*(r*s)),t.addScaledVector(o[6],.315392*(3*s*s-1)),t.addScaledVector(o[7],1.092548*(n*s)),t.addScaledVector(o[8],.546274*(n*n-r*r)),t}getIrradianceAt(e,t){const n=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],2*.511664*r),t.addScaledVector(o[2],2*.511664*s),t.addScaledVector(o[3],2*.511664*n),t.addScaledVector(o[4],2*.429043*n*r),t.addScaledVector(o[5],2*.429043*r*s),t.addScaledVector(o[6],.743125*s*s-.247708),t.addScaledVector(o[7],2*.429043*n*s),t.addScaledVector(o[8],.429043*(n*n-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(e,t+r*3);return this}toArray(e=[],t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(e,t+r*3);return e}static getBasisAt(e,t){const n=e.x,r=e.y,s=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*s,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*n*s,t[8]=.546274*(n*n-r*r)}}C1.prototype.isSphericalHarmonics3=!0;class wf extends As{constructor(e=new C1,t=1){super(void 0,t),this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}wf.prototype.isLightProbe=!0;class cP extends Ei{constructor(e){super(e),this.textures={}}load(e,t,n,r){const s=this,o=new er(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(c){r?r(c):console.error(c),s.manager.itemError(e)}},n,r)}parse(e){const t=this.textures;function n(s){return t[s]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",s),t[s]}const r=An.fromType(e.type);if(e.uuid!==void 0&&(r.uuid=e.uuid),e.name!==void 0&&(r.name=e.name),e.color!==void 0&&r.color!==void 0&&r.color.setHex(e.color),e.roughness!==void 0&&(r.roughness=e.roughness),e.metalness!==void 0&&(r.metalness=e.metalness),e.sheen!==void 0&&(r.sheen=e.sheen),e.sheenColor!==void 0&&(r.sheenColor=new qe().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(r.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&r.emissive!==void 0&&r.emissive.setHex(e.emissive),e.specular!==void 0&&r.specular!==void 0&&r.specular.setHex(e.specular),e.specularIntensity!==void 0&&(r.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&r.specularColor!==void 0&&r.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(r.shininess=e.shininess),e.clearcoat!==void 0&&(r.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=e.clearcoatRoughness),e.transmission!==void 0&&(r.transmission=e.transmission),e.thickness!==void 0&&(r.thickness=e.thickness),e.attenuationDistance!==void 0&&(r.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&r.attenuationColor!==void 0&&r.attenuationColor.setHex(e.attenuationColor),e.fog!==void 0&&(r.fog=e.fog),e.flatShading!==void 0&&(r.flatShading=e.flatShading),e.blending!==void 0&&(r.blending=e.blending),e.combine!==void 0&&(r.combine=e.combine),e.side!==void 0&&(r.side=e.side),e.shadowSide!==void 0&&(r.shadowSide=e.shadowSide),e.opacity!==void 0&&(r.opacity=e.opacity),e.transparent!==void 0&&(r.transparent=e.transparent),e.alphaTest!==void 0&&(r.alphaTest=e.alphaTest),e.depthTest!==void 0&&(r.depthTest=e.depthTest),e.depthWrite!==void 0&&(r.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(r.colorWrite=e.colorWrite),e.stencilWrite!==void 0&&(r.stencilWrite=e.stencilWrite),e.stencilWriteMask!==void 0&&(r.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(r.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(r.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(r.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(r.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(r.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(r.stencilZPass=e.stencilZPass),e.wireframe!==void 0&&(r.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(r.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(r.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(r.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(r.rotation=e.rotation),e.linewidth!==1&&(r.linewidth=e.linewidth),e.dashSize!==void 0&&(r.dashSize=e.dashSize),e.gapSize!==void 0&&(r.gapSize=e.gapSize),e.scale!==void 0&&(r.scale=e.scale),e.polygonOffset!==void 0&&(r.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(r.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(r.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(r.dithering=e.dithering),e.alphaToCoverage!==void 0&&(r.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(r.premultipliedAlpha=e.premultipliedAlpha),e.visible!==void 0&&(r.visible=e.visible),e.toneMapped!==void 0&&(r.toneMapped=e.toneMapped),e.userData!==void 0&&(r.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const s in e.uniforms){const o=e.uniforms[s];switch(r.uniforms[s]={},o.type){case"t":r.uniforms[s].value=n(o.value);break;case"c":r.uniforms[s].value=new qe().setHex(o.value);break;case"v2":r.uniforms[s].value=new Me().fromArray(o.value);break;case"v3":r.uniforms[s].value=new B().fromArray(o.value);break;case"v4":r.uniforms[s].value=new Jt().fromArray(o.value);break;case"m3":r.uniforms[s].value=new ai().fromArray(o.value);break;case"m4":r.uniforms[s].value=new st().fromArray(o.value);break;default:r.uniforms[s].value=o.value}}if(e.defines!==void 0&&(r.defines=e.defines),e.vertexShader!==void 0&&(r.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(r.fragmentShader=e.fragmentShader),e.extensions!==void 0)for(const s in e.extensions)r.extensions[s]=e.extensions[s];if(e.shading!==void 0&&(r.flatShading=e.shading===1),e.size!==void 0&&(r.size=e.size),e.sizeAttenuation!==void 0&&(r.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(r.map=n(e.map)),e.matcap!==void 0&&(r.matcap=n(e.matcap)),e.alphaMap!==void 0&&(r.alphaMap=n(e.alphaMap)),e.bumpMap!==void 0&&(r.bumpMap=n(e.bumpMap)),e.bumpScale!==void 0&&(r.bumpScale=e.bumpScale),e.normalMap!==void 0&&(r.normalMap=n(e.normalMap)),e.normalMapType!==void 0&&(r.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),r.normalScale=new Me().fromArray(s)}return e.displacementMap!==void 0&&(r.displacementMap=n(e.displacementMap)),e.displacementScale!==void 0&&(r.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(r.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(r.roughnessMap=n(e.roughnessMap)),e.metalnessMap!==void 0&&(r.metalnessMap=n(e.metalnessMap)),e.emissiveMap!==void 0&&(r.emissiveMap=n(e.emissiveMap)),e.emissiveIntensity!==void 0&&(r.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(r.specularMap=n(e.specularMap)),e.specularIntensityMap!==void 0&&(r.specularIntensityMap=n(e.specularIntensityMap)),e.specularColorMap!==void 0&&(r.specularColorMap=n(e.specularColorMap)),e.envMap!==void 0&&(r.envMap=n(e.envMap)),e.envMapIntensity!==void 0&&(r.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(r.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(r.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(r.lightMap=n(e.lightMap)),e.lightMapIntensity!==void 0&&(r.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(r.aoMap=n(e.aoMap)),e.aoMapIntensity!==void 0&&(r.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(r.gradientMap=n(e.gradientMap)),e.clearcoatMap!==void 0&&(r.clearcoatMap=n(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(r.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(r.clearcoatNormalMap=n(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(r.clearcoatNormalScale=new Me().fromArray(e.clearcoatNormalScale)),e.transmissionMap!==void 0&&(r.transmissionMap=n(e.transmissionMap)),e.thicknessMap!==void 0&&(r.thicknessMap=n(e.thicknessMap)),e.sheenColorMap!==void 0&&(r.sheenColorMap=n(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(r.sheenRoughnessMap=n(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}}class pr{static decodeText(e){if(typeof TextDecoder!="undefined")return new TextDecoder().decode(e);let t="";for(let n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class P1 extends vt{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}clone(){return new this.constructor().copy(this)}toJSON(){const e=super.toJSON(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}P1.prototype.isInstancedBufferGeometry=!0;class uP extends Ei{constructor(e){super(e)}load(e,t,n,r){const s=this,o=new er(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(c){r?r(c):console.error(c),s.manager.itemError(e)}},n,r)}parse(e){const t={},n={};function r(p,g){if(t[g]!==void 0)return t[g];const x=p.interleavedBuffers[g],v=s(p,x.buffer),w=eu(x.type,v),S=new Ha(w,x.stride);return S.uuid=x.uuid,t[g]=S,S}function s(p,g){if(n[g]!==void 0)return n[g];const x=p.arrayBuffers[g],v=new Uint32Array(x).buffer;return n[g]=v,v}const o=e.isInstancedBufferGeometry?new P1:new vt,a=e.data.index;if(a!==void 0){const p=eu(a.type,a.array);o.setIndex(new zt(p,1))}const c=e.data.attributes;for(const p in c){const g=c[p];let y;if(g.isInterleavedBufferAttribute){const x=r(e.data,g.data);y=new Po(x,g.itemSize,g.offset,g.normalized)}else{const x=eu(g.type,g.array),v=g.isInstancedBufferAttribute?Nl:zt;y=new v(x,g.itemSize,g.normalized)}g.name!==void 0&&(y.name=g.name),g.usage!==void 0&&y.setUsage(g.usage),g.updateRange!==void 0&&(y.updateRange.offset=g.updateRange.offset,y.updateRange.count=g.updateRange.count),o.setAttribute(p,y)}const h=e.data.morphAttributes;if(h)for(const p in h){const g=h[p],y=[];for(let x=0,v=g.length;x<v;x++){const w=g[x];let S;if(w.isInterleavedBufferAttribute){const b=r(e.data,w.data);S=new Po(b,w.itemSize,w.offset,w.normalized)}else{const b=eu(w.type,w.array);S=new zt(b,w.itemSize,w.normalized)}w.name!==void 0&&(S.name=w.name),y.push(S)}o.morphAttributes[p]=y}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const l=e.data.groups||e.data.drawcalls||e.data.offsets;if(l!==void 0)for(let p=0,g=l.length;p!==g;++p){const y=l[p];o.addGroup(y.start,y.count,y.materialIndex)}const u=e.data.boundingSphere;if(u!==void 0){const p=new B;u.center!==void 0&&p.fromArray(u.center),o.boundingSphere=new zo(p,u.radius)}return e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class tN extends Ei{constructor(e){super(e)}load(e,t,n,r){const s=this,o=this.path===""?pr.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const a=new er(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(c){let h=null;try{h=JSON.parse(c)}catch(l){r!==void 0&&r(l),console.error("THREE:ObjectLoader: Can't parse "+e+".",l.message);return}const d=h.metadata;if(d===void 0||d.type===void 0||d.type.toLowerCase()==="geometry"){console.error("THREE.ObjectLoader: Can't load "+e);return}s.parse(h,t)},n,r)}async loadAsync(e,t){const n=this,r=this.path===""?pr.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||r;const s=new er(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const o=await s.loadAsync(e,t),a=JSON.parse(o),c=a.metadata;if(c===void 0||c.type===void 0||c.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await n.parseAsync(a)}parse(e,t){const n=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,r),o=this.parseImages(e.images,function(){t!==void 0&&t(h)}),a=this.parseTextures(e.textures,o),c=this.parseMaterials(e.materials,a),h=this.parseObject(e.object,s,c,a,n),d=this.parseSkeletons(e.skeletons,h);if(this.bindSkeletons(h,d),t!==void 0){let l=!1;for(const u in o)if(o[u]instanceof HTMLImageElement){l=!0;break}l===!1&&t(h)}return h}async parseAsync(e){const t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,n),s=await this.parseImagesAsync(e.images),o=this.parseTextures(e.textures,s),a=this.parseMaterials(e.materials,o),c=this.parseObject(e.object,r,a,o,t),h=this.parseSkeletons(e.skeletons,c);return this.bindSkeletons(c,h),c}parseShapes(e){const t={};if(e!==void 0)for(let n=0,r=e.length;n<r;n++){const s=new $s().fromJSON(e[n]);t[s.uuid]=s}return t}parseSkeletons(e,t){const n={},r={};if(t.traverse(function(s){s.isBone&&(r[s.uuid]=s)}),e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=new Zu().fromJSON(e[s],r);n[a.uuid]=a}return n}parseGeometries(e,t){const n={};if(e!==void 0){const r=new uP;for(let s=0,o=e.length;s<o;s++){let a;const c=e[s];switch(c.type){case"BufferGeometry":case"InstancedBufferGeometry":a=r.parse(c);break;case"Geometry":console.error("THREE.ObjectLoader: The legacy Geometry type is no longer supported.");break;default:c.type in WE?a=WE[c.type].fromJSON(c,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${c.type}"`)}a.uuid=c.uuid,c.name!==void 0&&(a.name=c.name),a.isBufferGeometry===!0&&c.userData!==void 0&&(a.userData=c.userData),n[c.uuid]=a}}return n}parseMaterials(e,t){const n={},r={};if(e!==void 0){const s=new cP;s.setTextures(t);for(let o=0,a=e.length;o<a;o++){const c=e[o];if(c.type==="MultiMaterial"){const h=[];for(let d=0;d<c.materials.length;d++){const l=c.materials[d];n[l.uuid]===void 0&&(n[l.uuid]=s.parse(l)),h.push(n[l.uuid])}r[c.uuid]=h}else n[c.uuid]===void 0&&(n[c.uuid]=s.parse(c)),r[c.uuid]=n[c.uuid]}}return r}parseAnimations(e){const t={};if(e!==void 0)for(let n=0;n<e.length;n++){const r=e[n],s=Wl.parse(r);t[s.uuid]=s}return t}parseImages(e,t){const n=this,r={};let s;function o(c){return n.manager.itemStart(c),s.load(c,function(){n.manager.itemEnd(c)},void 0,function(){n.manager.itemError(c),n.manager.itemEnd(c)})}function a(c){if(typeof c=="string"){const h=c,d=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(h)?h:n.resourcePath+h;return o(d)}else return c.data?{data:eu(c.type,c.data),width:c.width,height:c.height}:null}if(e!==void 0&&e.length>0){const c=new M1(t);s=new Qd(c),s.setCrossOrigin(this.crossOrigin);for(let h=0,d=e.length;h<d;h++){const l=e[h],u=l.url;if(Array.isArray(u)){const p=[];for(let g=0,y=u.length;g<y;g++){const x=u[g],v=a(x);v!==null&&(v instanceof HTMLImageElement?p.push(v):p.push(new Ea(v.data,v.width,v.height)))}r[l.uuid]=new Sl(p)}else{const p=a(l.url);r[l.uuid]=new Sl(p)}}}return r}async parseImagesAsync(e){const t=this,n={};let r;async function s(o){if(typeof o=="string"){const a=o,c=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(a)?a:t.resourcePath+a;return await r.loadAsync(c)}else return o.data?{data:eu(o.type,o.data),width:o.width,height:o.height}:null}if(e!==void 0&&e.length>0){r=new Qd(this.manager),r.setCrossOrigin(this.crossOrigin);for(let o=0,a=e.length;o<a;o++){const c=e[o],h=c.url;if(Array.isArray(h)){const d=[];for(let l=0,u=h.length;l<u;l++){const p=h[l],g=await s(p);g!==null&&(g instanceof HTMLImageElement?d.push(g):d.push(new Ea(g.data,g.width,g.height)))}n[c.uuid]=new Sl(d)}else{const d=await s(c.url);n[c.uuid]=new Sl(d)}}}return n}parseTextures(e,t){function n(s,o){return typeof s=="number"?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),o[s])}const r={};if(e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=e[s];a.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),t[a.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",a.image);const c=t[a.image],h=c.data;let d;Array.isArray(h)?(d=new qu,h.length===6&&(d.needsUpdate=!0)):(h&&h.data?d=new Ea:d=new hn,h&&(d.needsUpdate=!0)),d.source=c,d.uuid=a.uuid,a.name!==void 0&&(d.name=a.name),a.mapping!==void 0&&(d.mapping=n(a.mapping,nN)),a.offset!==void 0&&d.offset.fromArray(a.offset),a.repeat!==void 0&&d.repeat.fromArray(a.repeat),a.center!==void 0&&d.center.fromArray(a.center),a.rotation!==void 0&&(d.rotation=a.rotation),a.wrap!==void 0&&(d.wrapS=n(a.wrap[0],$E),d.wrapT=n(a.wrap[1],$E)),a.format!==void 0&&(d.format=a.format),a.type!==void 0&&(d.type=a.type),a.encoding!==void 0&&(d.encoding=a.encoding),a.minFilter!==void 0&&(d.minFilter=n(a.minFilter,QE)),a.magFilter!==void 0&&(d.magFilter=n(a.magFilter,QE)),a.anisotropy!==void 0&&(d.anisotropy=a.anisotropy),a.flipY!==void 0&&(d.flipY=a.flipY),a.premultiplyAlpha!==void 0&&(d.premultiplyAlpha=a.premultiplyAlpha),a.unpackAlignment!==void 0&&(d.unpackAlignment=a.unpackAlignment),a.userData!==void 0&&(d.userData=a.userData),r[a.uuid]=d}return r}parseObject(e,t,n,r,s){let o;function a(u){return t[u]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",u),t[u]}function c(u){if(u!==void 0){if(Array.isArray(u)){const p=[];for(let g=0,y=u.length;g<y;g++){const x=u[g];n[x]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",x),p.push(n[x])}return p}return n[u]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",u),n[u]}}function h(u){return r[u]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",u),r[u]}let d,l;switch(e.type){case"Scene":o=new $u,e.background!==void 0&&(Number.isInteger(e.background)?o.background=new qe(e.background):o.background=h(e.background)),e.environment!==void 0&&(o.environment=h(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?o.fog=new mf(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(o.fog=new pf(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":o=new Mn(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(o.focus=e.focus),e.zoom!==void 0&&(o.zoom=e.zoom),e.filmGauge!==void 0&&(o.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(o.filmOffset=e.filmOffset),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new Fr(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(o.zoom=e.zoom),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new Tv(e.color,e.intensity);break;case"DirectionalLight":o=new xf(e.color,e.intensity);break;case"PointLight":o=new zu(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new A1(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new yf(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":o=new E1(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=new wf().fromJSON(e);break;case"SkinnedMesh":d=a(e.geometry),l=c(e.material),o=new Qu(d,l),e.bindMode!==void 0&&(o.bindMode=e.bindMode),e.bindMatrix!==void 0&&o.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(o.skeleton=e.skeleton);break;case"Mesh":d=a(e.geometry),l=c(e.material),o=new je(d,l);break;case"InstancedMesh":d=a(e.geometry),l=c(e.material);const u=e.count,p=e.instanceMatrix,g=e.instanceColor;o=new l1(d,l,u),o.instanceMatrix=new Nl(new Float32Array(p.array),16),g!==void 0&&(o.instanceColor=new Nl(new Float32Array(g.array),g.itemSize));break;case"LOD":o=new j3;break;case"Line":o=new di(a(e.geometry),c(e.material));break;case"LineLoop":o=new yv(a(e.geometry),c(e.material));break;case"LineSegments":o=new Ji(a(e.geometry),c(e.material));break;case"PointCloud":case"Points":o=new Ku(a(e.geometry),c(e.material));break;case"Sprite":o=new vv(c(e.material));break;case"Group":o=new Jr;break;case"Bone":o=new Ol;break;default:o=new ft}if(o.uuid=e.uuid,e.name!==void 0&&(o.name=e.name),e.matrix!==void 0?(o.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(e.position!==void 0&&o.position.fromArray(e.position),e.rotation!==void 0&&o.rotation.fromArray(e.rotation),e.quaternion!==void 0&&o.quaternion.fromArray(e.quaternion),e.scale!==void 0&&o.scale.fromArray(e.scale)),e.castShadow!==void 0&&(o.castShadow=e.castShadow),e.receiveShadow!==void 0&&(o.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(o.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(o.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(o.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&o.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(o.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(o.visible=e.visible),e.frustumCulled!==void 0&&(o.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(o.renderOrder=e.renderOrder),e.userData!==void 0&&(o.userData=e.userData),e.layers!==void 0&&(o.layers.mask=e.layers),e.children!==void 0){const u=e.children;for(let p=0;p<u.length;p++)o.add(this.parseObject(u[p],t,n,r,s))}if(e.animations!==void 0){const u=e.animations;for(let p=0;p<u.length;p++){const g=u[p];o.animations.push(s[g])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(o.autoUpdate=e.autoUpdate);const u=e.levels;for(let p=0;p<u.length;p++){const g=u[p],y=o.getObjectByProperty("uuid",g.object);y!==void 0&&o.addLevel(y,g.distance)}}return o}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(n){if(n.isSkinnedMesh===!0&&n.skeleton!==void 0){const r=t[n.skeleton];r===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",n.skeleton):n.bind(r,n.bindMatrix)}})}setTexturePath(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}const nN={UVMapping:av,CubeReflectionMapping:Ra,CubeRefractionMapping:La,EquirectangularReflectionMapping:xu,EquirectangularRefractionMapping:Hd,CubeUVReflectionMapping:Wu},$E={RepeatWrapping:Zs,ClampToEdgeWrapping:_i,MirroredRepeatWrapping:wu},QE={NearestFilter:Kt,NearestMipmapNearestFilter:Vd,NearestMipmapLinearFilter:Gd,LinearFilter:jt,LinearMipmapNearestFilter:lv,LinearMipmapLinearFilter:Do};class R1 extends Ei{constructor(e){super(e),typeof createImageBitmap=="undefined"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch=="undefined"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=jl.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then(function(c){return c.blob()}).then(function(c){return createImageBitmap(c,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(c){jl.add(e,c),t&&t(c),s.manager.itemEnd(e)}).catch(function(c){r&&r(c),s.manager.itemError(e),s.manager.itemEnd(e)}),s.manager.itemStart(e)}}R1.prototype.isImageBitmapLoader=!0;let vm;const L1={getContext:function(){return vm===void 0&&(vm=new(window.AudioContext||window.webkitAudioContext)),vm},setContext:function(i){vm=i}};class hP extends Ei{constructor(e){super(e)}load(e,t,n,r){const s=this,o=new er(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{const c=a.slice(0);L1.getContext().decodeAudioData(c,function(d){t(d)})}catch(c){r?r(c):console.error(c),s.manager.itemError(e)}},n,r)}}class dP extends wf{constructor(e,t,n=1){super(void 0,n);const r=new qe().set(e),s=new qe().set(t),o=new B(r.r,r.g,r.b),a=new B(s.r,s.g,s.b),c=Math.sqrt(Math.PI),h=c*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(a).multiplyScalar(c),this.sh.coefficients[1].copy(o).sub(a).multiplyScalar(h)}}dP.prototype.isHemisphereLightProbe=!0;class fP extends wf{constructor(e,t=1){super(void 0,t);const n=new qe().set(e);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}}fP.prototype.isAmbientLightProbe=!0;const ZE=new st,KE=new st,rl=new st;class iN{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Mn,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Mn,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,rl.copy(e.projectionMatrix);const r=t.eyeSep/2,s=r*t.near/t.focus,o=t.near*Math.tan(Cl*t.fov*.5)/t.zoom;let a,c;KE.elements[12]=-r,ZE.elements[12]=r,a=-o*t.aspect+s,c=o*t.aspect+s,rl.elements[0]=2*t.near/(c-a),rl.elements[8]=(c+a)/(c-a),this.cameraL.projectionMatrix.copy(rl),a=-o*t.aspect-s,c=o*t.aspect-s,rl.elements[0]=2*t.near/(c-a),rl.elements[8]=(c+a)/(c-a),this.cameraR.projectionMatrix.copy(rl)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(KE),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(ZE)}}class Av{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=JE(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=JE();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function JE(){return(typeof performance=="undefined"?Date:performance).now()}const sl=new B,eT=new qt,rN=new B,ol=new B;class sN extends ft{constructor(){super(),this.type="AudioListener",this.context=L1.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Av}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(sl,eT,rN),ol.set(0,0,-1).applyQuaternion(eT),t.positionX){const r=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(sl.x,r),t.positionY.linearRampToValueAtTime(sl.y,r),t.positionZ.linearRampToValueAtTime(sl.z,r),t.forwardX.linearRampToValueAtTime(ol.x,r),t.forwardY.linearRampToValueAtTime(ol.y,r),t.forwardZ.linearRampToValueAtTime(ol.z,r),t.upX.linearRampToValueAtTime(n.x,r),t.upY.linearRampToValueAtTime(n.y,r),t.upZ.linearRampToValueAtTime(n.z,r)}else t.setPosition(sl.x,sl.y,sl.z),t.setOrientation(ol.x,ol.y,ol.z,n.x,n.y,n.z)}}class k1 extends ft{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const al=new B,tT=new qt,oN=new B,ll=new B;class aN extends k1{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(al,tT,oN),ll.set(0,0,1).applyQuaternion(tT);const t=this.panner;if(t.positionX){const n=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(al.x,n),t.positionY.linearRampToValueAtTime(al.y,n),t.positionZ.linearRampToValueAtTime(al.z,n),t.orientationX.linearRampToValueAtTime(ll.x,n),t.orientationY.linearRampToValueAtTime(ll.y,n),t.orientationZ.linearRampToValueAtTime(ll.z,n)}else t.setPosition(al.x,al.y,al.z),t.setOrientation(ll.x,ll.y,ll.z)}}class pP{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class mP{constructor(e,t,n){this.binding=e,this.valueSize=n;let r,s,o;switch(t){case"quaternion":r=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:r=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,r=this.valueSize,s=e*r+r;let o=this.cumulativeWeight;if(o===0){for(let a=0;a!==r;++a)n[s+a]=n[a];o=t}else{o+=t;const a=t/o;this._mixBufferRegion(n,s,0,a,r)}this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,r=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,r=e*t+t,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const c=t*this._origIndex;this._mixBufferRegion(n,r,c,1-s,t)}o>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*t,1,t);for(let c=t,h=t+t;c!==h;++c)if(n[c]!==n[c+t]){a.setValue(n,r);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,r=n*this._origIndex;e.getValue(t,r);for(let s=n,o=r;s!==o;++s)t[s]=t[r+s%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,r,s){if(r>=.5)for(let o=0;o!==s;++o)e[t+o]=e[n+o]}_slerp(e,t,n,r){qt.slerpFlat(e,t,e,t,e,n,r)}_slerpAdditive(e,t,n,r,s){const o=this._workIndex*s;qt.multiplyQuaternionsFlat(e,o,e,t,e,n),qt.slerpFlat(e,t,e,t,e,o,r)}_lerp(e,t,n,r,s){const o=1-r;for(let a=0;a!==s;++a){const c=t+a;e[c]=e[c]*o+e[n+a]*r}}_lerpAdditive(e,t,n,r,s){for(let o=0;o!==s;++o){const a=t+o;e[a]=e[a]+e[n+o]*r}}}const I1="\\[\\]\\.:\\/",lN=new RegExp("["+I1+"]","g"),F1="[^"+I1+"]",cN="[^"+I1.replace("\\.","")+"]",uN=/((?:WC+[\/:])*)/.source.replace("WC",F1),hN=/(WCOD+)?/.source.replace("WCOD",cN),dN=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",F1),fN=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",F1),pN=new RegExp("^"+uN+hN+dN+fN+"$"),mN=["material","materials","bones"];class gN{constructor(e,t,n){const r=n||Wt.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,r=this._bindings[n];r!==void 0&&r.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=n.length;r!==s;++r)n[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}class Wt{constructor(e,t,n){this.path=t,this.parsedPath=n||Wt.parseTrackName(t),this.node=Wt.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new Wt.Composite(e,t,n):new Wt(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(lN,"")}static parseTrackName(e){const t=pN.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const s=n.nodeName.substring(r+1);mN.indexOf(s)!==-1&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=s)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(n!==void 0)return n}if(e.children){const n=function(s){for(let o=0;o<s.length;o++){const a=s[o];if(a.name===t||a.uuid===t)return a;const c=n(a.children);if(c)return c}return null},r=n(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)e[t++]=n[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)n[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,r=t.propertyName;let s=t.propertyIndex;if(e||(e=Wt.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(n){let h=t.objectIndex;switch(n){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let d=0;d<e.length;d++)if(e[d].name===h){h=d;break}break;default:if(e[n]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[n]}if(h!==void 0){if(e[h]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[h]}}const o=e[r];if(o===void 0){const h=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+h+"."+r+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(s!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}else{console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);return}}c=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=s}else o.fromArray!==void 0&&o.toArray!==void 0?(c=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(c=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Wt.Composite=gN;Wt.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Wt.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Wt.prototype.GetterByBindingType=[Wt.prototype._getValue_direct,Wt.prototype._getValue_array,Wt.prototype._getValue_arrayElement,Wt.prototype._getValue_toArray];Wt.prototype.SetterByBindingTypeAndVersioning=[[Wt.prototype._setValue_direct,Wt.prototype._setValue_direct_setNeedsUpdate,Wt.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Wt.prototype._setValue_array,Wt.prototype._setValue_array_setNeedsUpdate,Wt.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Wt.prototype._setValue_arrayElement,Wt.prototype._setValue_arrayElement_setNeedsUpdate,Wt.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Wt.prototype._setValue_fromArray,Wt.prototype._setValue_fromArray_setNeedsUpdate,Wt.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class gP{constructor(){this.uuid=Ir(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,r=arguments.length;n!==r;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,r=this._parsedPaths,s=this._bindings,o=s.length;let a,c=e.length,h=this.nCachedObjects_;for(let d=0,l=arguments.length;d!==l;++d){const u=arguments[d],p=u.uuid;let g=t[p];if(g===void 0){g=c++,t[p]=g,e.push(u);for(let y=0,x=o;y!==x;++y)s[y].push(new Wt(u,n[y],r[y]))}else if(g<h){a=e[g];const y=--h,x=e[y];t[x.uuid]=g,e[g]=x,t[p]=y,e[y]=u;for(let v=0,w=o;v!==w;++v){const S=s[v],b=S[y];let E=S[g];S[g]=b,E===void 0&&(E=new Wt(u,n[v],r[v])),S[y]=E}}else e[g]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=h}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let s=this.nCachedObjects_;for(let o=0,a=arguments.length;o!==a;++o){const c=arguments[o],h=c.uuid,d=t[h];if(d!==void 0&&d>=s){const l=s++,u=e[l];t[u.uuid]=d,e[d]=u,t[h]=l,e[l]=c;for(let p=0,g=r;p!==g;++p){const y=n[p],x=y[l],v=y[d];y[d]=x,y[l]=v}}}this.nCachedObjects_=s}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let s=this.nCachedObjects_,o=e.length;for(let a=0,c=arguments.length;a!==c;++a){const h=arguments[a],d=h.uuid,l=t[d];if(l!==void 0)if(delete t[d],l<s){const u=--s,p=e[u],g=--o,y=e[g];t[p.uuid]=l,e[l]=p,t[y.uuid]=u,e[u]=y,e.pop();for(let x=0,v=r;x!==v;++x){const w=n[x],S=w[u],b=w[g];w[l]=S,w[u]=b,w.pop()}}else{const u=--o,p=e[u];u>0&&(t[p.uuid]=l),e[l]=p,e.pop();for(let g=0,y=r;g!==y;++g){const x=n[g];x[l]=x[u],x.pop()}}}this.nCachedObjects_=s}subscribe_(e,t){const n=this._bindingsIndicesByPath;let r=n[e];const s=this._bindings;if(r!==void 0)return s[r];const o=this._paths,a=this._parsedPaths,c=this._objects,h=c.length,d=this.nCachedObjects_,l=new Array(h);r=s.length,n[e]=r,o.push(e),a.push(t),s.push(l);for(let u=d,p=c.length;u!==p;++u){const g=c[u];l[u]=new Wt(g,e,t)}return l}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(n!==void 0){const r=this._paths,s=this._parsedPaths,o=this._bindings,a=o.length-1,c=o[a],h=e[a];t[h]=n,o[n]=c,o.pop(),s[n]=s[a],s.pop(),r[n]=r[a],r.pop()}}}gP.prototype.isAnimationObjectGroup=!0;class vN{constructor(e,t,n=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=r;const s=t.tracks,o=s.length,a=new Array(o),c={endingStart:wl,endingEnd:wl};for(let h=0;h!==o;++h){const d=s[h].createInterpolant(null);a[h]=d,d.settings=c}this._interpolantSettings=c,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=d3,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){const r=this._clip.duration,s=e._clip.duration,o=s/r,a=r/s;e.warp(1,o,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,n){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const r=this._mixer,s=r.time,o=this.timeScale;let a=this._timeScaleInterpolant;a===null&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);const c=a.parameterPositions,h=a.sampleValues;return c[0]=s,c[1]=s+n,h[0]=e/o,h[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,r){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const c=(e-s)*n;if(c<0||n===0)return;this._startTime=null,t=n*c}t*=this._updateTimeScale(e);const o=this._updateTime(t),a=this._updateWeight(e);if(a>0){const c=this._interpolants,h=this._propertyBindings;switch(this.blendMode){case t1:for(let d=0,l=c.length;d!==l;++d)c[d].evaluate(o),h[d].accumulateAdditive(a);break;case cv:default:for(let d=0,l=c.length;d!==l;++d)c[d].evaluate(o),h[d].accumulate(r,a)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(n!==null){const r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;n!==null&&(t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t))}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let r=this.time+e,s=this._loopCount;const o=n===f3;if(e===0)return s===-1?r:o&&(s&1)===1?t-r:r;if(n===h3){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),r>=t||r<0){const a=Math.floor(r/t);r-=t*a,s+=Math.abs(a);const c=this.repetitions-s;if(c<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(c===1){const h=e<0;this._setEndings(h,!h,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(o&&(s&1)===1)return t-r}return r}_setEndings(e,t,n){const r=this._interpolantSettings;n?(r.endingStart=_l,r.endingEnd=_l):(e?r.endingStart=this.zeroSlopeAtStart?_l:wl:r.endingStart=Wd,t?r.endingEnd=this.zeroSlopeAtEnd?_l:wl:r.endingEnd=Wd)}_scheduleFading(e,t,n){const r=this._mixer,s=r.time;let o=this._weightInterpolant;o===null&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,c=o.sampleValues;return a[0]=s,c[0]=t,a[1]=s+e,c[1]=n,this}}class vP extends Bo{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,r=e._clip.tracks,s=r.length,o=e._propertyBindings,a=e._interpolants,c=n.uuid,h=this._bindingsByRootAndName;let d=h[c];d===void 0&&(d={},h[c]=d);for(let l=0;l!==s;++l){const u=r[l],p=u.name;let g=d[p];if(g!==void 0)++g.referenceCount,o[l]=g;else{if(g=o[l],g!==void 0){g._cacheIndex===null&&(++g.referenceCount,this._addInactiveBinding(g,c,p));continue}const y=t&&t._propertyBindings[l].binding.parsedPath;g=new mP(Wt.create(n,p,y),u.ValueTypeName,u.getValueSize()),++g.referenceCount,this._addInactiveBinding(g,c,p),o[l]=g}a[l].resultBuffer=g.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const n=(e._localRoot||this._root).uuid,r=e._clip.uuid,s=this._actionsByClip[r];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,r,n)}const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const s=t[n];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const s=t[n];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,n){const r=this._actions,s=this._actionsByClip;let o=s[t];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=o;else{const a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=r.length,r.push(e),o.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,o=this._actionsByClip,a=o[s],c=a.knownActions,h=c[c.length-1],d=e._byClipCacheIndex;h._byClipCacheIndex=d,c[d]=h,c.pop(),e._byClipCacheIndex=null;const l=a.actionByRoot,u=(e._localRoot||this._root).uuid;delete l[u],c.length===0&&delete o[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const s=t[n];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_addInactiveBinding(e,t,n){const r=this._bindingsByRootAndName,s=this._bindings;let o=r[t];o===void 0&&(o={},r[t]=o),o[n]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,r=n.rootNode.uuid,s=n.path,o=this._bindingsByRootAndName,a=o[r],c=t[t.length-1],h=e._cacheIndex;c._cacheIndex=h,t[h]=c,t.pop(),delete a[s],Object.keys(a).length===0&&delete o[r]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return n===void 0&&(n=new S1(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,s=t[r];e.__cacheIndex=r,t[r]=e,s.__cacheIndex=n,t[n]=s}clipAction(e,t,n){const r=t||this._root,s=r.uuid;let o=typeof e=="string"?Wl.findByName(r,e):e;const a=o!==null?o.uuid:e,c=this._actionsByClip[a];let h=null;if(n===void 0&&(o!==null?n=o.blendMode:n=cv),c!==void 0){const l=c.actionByRoot[s];if(l!==void 0&&l.blendMode===n)return l;h=c.knownActions[0],o===null&&(o=h._clip)}if(o===null)return null;const d=new vN(this,o,t,n);return this._bindAction(d,h),this._addInactiveAction(d,a,s),d}existingAction(e,t){const n=t||this._root,r=n.uuid,s=typeof e=="string"?Wl.findByName(n,e):e,o=s?s.uuid:e,a=this._actionsByClip[o];return a!==void 0&&a.actionByRoot[r]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let n=t-1;n>=0;--n)e[n].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,r=this.time+=e,s=Math.sign(e),o=this._accuIndex^=1;for(let h=0;h!==n;++h)t[h]._update(r,e,s,o);const a=this._bindings,c=this._nActiveBindings;for(let h=0;h!==c;++h)a[h].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,r=this._actionsByClip,s=r[n];if(s!==void 0){const o=s.knownActions;for(let a=0,c=o.length;a!==c;++a){const h=o[a];this._deactivateAction(h);const d=h._cacheIndex,l=t[t.length-1];h._cacheIndex=null,h._byClipCacheIndex=null,l._cacheIndex=d,t[d]=l,t.pop(),this._removeInactiveBindingsForAction(h)}delete r[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const o in n){const a=n[o].actionByRoot,c=a[t];c!==void 0&&(this._deactivateAction(c),this._removeInactiveAction(c))}const r=this._bindingsByRootAndName,s=r[t];if(s!==void 0)for(const o in s){const a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){const n=this.existingAction(e,t);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}}vP.prototype._controlInterpolantsResultBuffer=new Float32Array(1);class Cv{constructor(e){typeof e=="string"&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}clone(){return new Cv(this.value.clone===void 0?this.value:this.value.clone())}}class yP extends Ha{constructor(e,t,n=1){super(e,t),this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}yP.prototype.isInstancedInterleavedBuffer=!0;class xP{constructor(e,t,n,r,s){this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=r,this.count=s,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}xP.prototype.isGLBufferAttribute=!0;class _f{constructor(e,t,n=0,r=1/0){this.ray=new Oo(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new Rl,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,n=[]){return Iw(e,this,n,t),n.sort(nT),n}intersectObjects(e,t=!0,n=[]){for(let r=0,s=e.length;r<s;r++)Iw(e[r],this,n,t);return n.sort(nT),n}}function nT(i,e){return i.distance-e.distance}function Iw(i,e,t,n){if(i.layers.test(e.layers)&&i.raycast(e,t),n===!0){const r=i.children;for(let s=0,o=r.length;s<o;s++)Iw(r[s],e,t,!0)}}class Zd{constructor(e=1,t=0,n=0){return this.radius=e,this.phi=t,this.theta=n,this}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Jn(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class yN{constructor(e=1,t=0,n=0){return this.radius=e,this.theta=t,this.y=n,this}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return new this.constructor().copy(this)}}const iT=new Me;class Ju{constructor(e=new Me(1/0,1/0),t=new Me(-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=iT.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return iT.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}Ju.prototype.isBox2=!0;const rT=new B,ym=new B;class wP{constructor(e=new B,t=new B){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){rT.subVectors(e,this.start),ym.subVectors(this.end,this.start);const n=ym.dot(ym);let s=ym.dot(rT)/n;return t&&(s=Jn(s,0,1)),s}closestPointToPoint(e,t,n){const r=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const sT=new B;class xN extends ft{constructor(e,t){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;const n=new vt,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,a=1,c=32;o<c;o++,a++){const h=o/c*Math.PI*2,d=a/c*Math.PI*2;r.push(Math.cos(h),Math.sin(h),1,Math.cos(d),Math.sin(d),1)}n.setAttribute("position",new lt(r,3));const s=new ni({fog:!1,toneMapped:!1});this.cone=new Ji(n,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateMatrixWorld();const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),sT.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(sT),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const na=new B,xm=new st,Hy=new st;class _P extends Ji{constructor(e){const t=SP(e),n=new vt,r=[],s=[],o=new qe(0,0,1),a=new qe(0,1,0);for(let h=0;h<t.length;h++){const d=t[h];d.parent&&d.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),s.push(o.r,o.g,o.b),s.push(a.r,a.g,a.b))}n.setAttribute("position",new lt(r,3)),n.setAttribute("color",new lt(s,3));const c=new ni({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,c),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,n=this.geometry,r=n.getAttribute("position");Hy.copy(this.root.matrixWorld).invert();for(let s=0,o=0;s<t.length;s++){const a=t[s];a.parent&&a.parent.isBone&&(xm.multiplyMatrices(Hy,a.matrixWorld),na.setFromMatrixPosition(xm),r.setXYZ(o,na.x,na.y,na.z),xm.multiplyMatrices(Hy,a.parent.matrixWorld),na.setFromMatrixPosition(xm),r.setXYZ(o+1,na.x,na.y,na.z),o+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}}function SP(i){const e=[];i.isBone===!0&&e.push(i);for(let t=0;t<i.children.length;t++)e.push.apply(e,SP(i.children[t]));return e}class wN extends je{constructor(e,t,n){const r=new Ro(t,4,2),s=new Bt({wireframe:!0,fog:!1,toneMapped:!1});super(r,s),this.light=e,this.light.updateMatrixWorld(),this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const _N=new B,oT=new qe,aT=new qe;class SN extends ft{constructor(e,t,n){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;const r=new ws(t);r.rotateY(Math.PI*.5),this.material=new Bt({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=r.getAttribute("position"),o=new Float32Array(s.count*3);r.setAttribute("color",new zt(o,3)),this.add(new je(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");oT.copy(this.light.color),aT.copy(this.light.groundColor);for(let n=0,r=t.count;n<r;n++){const s=n<r/2?oT:aT;t.setXYZ(n,s.r,s.g,s.b)}t.needsUpdate=!0}e.lookAt(_N.setFromMatrixPosition(this.light.matrixWorld).negate())}}class bP extends Ji{constructor(e=10,t=10,n=4473924,r=8947848){n=new qe(n),r=new qe(r);const s=t/2,o=e/t,a=e/2,c=[],h=[];for(let u=0,p=0,g=-a;u<=t;u++,g+=o){c.push(-a,0,g,a,0,g),c.push(g,0,-a,g,0,a);const y=u===s?n:r;y.toArray(h,p),p+=3,y.toArray(h,p),p+=3,y.toArray(h,p),p+=3,y.toArray(h,p),p+=3}const d=new vt;d.setAttribute("position",new lt(c,3)),d.setAttribute("color",new lt(h,3));const l=new ni({vertexColors:!0,toneMapped:!1});super(d,l),this.type="GridHelper"}}class bN extends Ji{constructor(e=10,t=16,n=8,r=64,s=4473924,o=8947848){s=new qe(s),o=new qe(o);const a=[],c=[];for(let l=0;l<=t;l++){const u=l/t*(Math.PI*2),p=Math.sin(u)*e,g=Math.cos(u)*e;a.push(0,0,0),a.push(p,0,g);const y=l&1?s:o;c.push(y.r,y.g,y.b),c.push(y.r,y.g,y.b)}for(let l=0;l<=n;l++){const u=l&1?s:o,p=e-e/n*l;for(let g=0;g<r;g++){let y=g/r*(Math.PI*2),x=Math.sin(y)*p,v=Math.cos(y)*p;a.push(x,0,v),c.push(u.r,u.g,u.b),y=(g+1)/r*(Math.PI*2),x=Math.sin(y)*p,v=Math.cos(y)*p,a.push(x,0,v),c.push(u.r,u.g,u.b)}}const h=new vt;h.setAttribute("position",new lt(a,3)),h.setAttribute("color",new lt(c,3));const d=new ni({vertexColors:!0,toneMapped:!1});super(h,d),this.type="PolarGridHelper"}}const lT=new B,wm=new B,cT=new B;class MN extends ft{constructor(e,t,n){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,t===void 0&&(t=1);let r=new vt;r.setAttribute("position",new lt([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const s=new ni({fog:!1,toneMapped:!1});this.lightPlane=new di(r,s),this.add(this.lightPlane),r=new vt,r.setAttribute("position",new lt([0,0,0,0,0,1],3)),this.targetLine=new di(r,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){lT.setFromMatrixPosition(this.light.matrixWorld),wm.setFromMatrixPosition(this.light.target.matrixWorld),cT.subVectors(wm,lT),this.lightPlane.lookAt(wm),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(wm),this.targetLine.scale.z=cT.length()}}const _m=new B,Gn=new Xu;class EN extends Ji{constructor(e){const t=new vt,n=new ni({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],s=[],o={},a=new qe(16755200),c=new qe(16711680),h=new qe(43775),d=new qe(16777215),l=new qe(3355443);u("n1","n2",a),u("n2","n4",a),u("n4","n3",a),u("n3","n1",a),u("f1","f2",a),u("f2","f4",a),u("f4","f3",a),u("f3","f1",a),u("n1","f1",a),u("n2","f2",a),u("n3","f3",a),u("n4","f4",a),u("p","n1",c),u("p","n2",c),u("p","n3",c),u("p","n4",c),u("u1","u2",h),u("u2","u3",h),u("u3","u1",h),u("c","t",d),u("p","c",l),u("cn1","cn2",l),u("cn3","cn4",l),u("cf1","cf2",l),u("cf3","cf4",l);function u(g,y,x){p(g,x),p(y,x)}function p(g,y){r.push(0,0,0),s.push(y.r,y.g,y.b),o[g]===void 0&&(o[g]=[]),o[g].push(r.length/3-1)}t.setAttribute("position",new lt(r,3)),t.setAttribute("color",new lt(s,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update()}update(){const e=this.geometry,t=this.pointMap,n=1,r=1;Gn.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),$n("c",t,e,Gn,0,0,-1),$n("t",t,e,Gn,0,0,1),$n("n1",t,e,Gn,-n,-r,-1),$n("n2",t,e,Gn,n,-r,-1),$n("n3",t,e,Gn,-n,r,-1),$n("n4",t,e,Gn,n,r,-1),$n("f1",t,e,Gn,-n,-r,1),$n("f2",t,e,Gn,n,-r,1),$n("f3",t,e,Gn,-n,r,1),$n("f4",t,e,Gn,n,r,1),$n("u1",t,e,Gn,n*.7,r*1.1,-1),$n("u2",t,e,Gn,-n*.7,r*1.1,-1),$n("u3",t,e,Gn,0,r*2,-1),$n("cf1",t,e,Gn,-n,0,1),$n("cf2",t,e,Gn,n,0,1),$n("cf3",t,e,Gn,0,-r,1),$n("cf4",t,e,Gn,0,r,1),$n("cn1",t,e,Gn,-n,0,-1),$n("cn2",t,e,Gn,n,0,-1),$n("cn3",t,e,Gn,0,-r,-1),$n("cn4",t,e,Gn,0,r,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function $n(i,e,t,n,r,s,o){_m.set(r,s,o).unproject(n);const a=e[i];if(a!==void 0){const c=t.getAttribute("position");for(let h=0,d=a.length;h<d;h++)c.setXYZ(a[h],_m.x,_m.y,_m.z)}}const Sm=new vr;class MP extends Ji{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(8*3),s=new vt;s.setIndex(new zt(n,1)),s.setAttribute("position",new zt(r,3)),super(s,new ni({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&Sm.setFromObject(this.object),Sm.isEmpty())return;const t=Sm.min,n=Sm.max,r=this.geometry.attributes.position,s=r.array;s[0]=n.x,s[1]=n.y,s[2]=n.z,s[3]=t.x,s[4]=n.y,s[5]=n.z,s[6]=t.x,s[7]=t.y,s[8]=n.z,s[9]=n.x,s[10]=t.y,s[11]=n.z,s[12]=n.x,s[13]=n.y,s[14]=t.z,s[15]=t.x,s[16]=n.y,s[17]=t.z,s[18]=t.x,s[19]=t.y,s[20]=t.z,s[21]=n.x,s[22]=t.y,s[23]=t.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e){return Ji.prototype.copy.call(this,e),this.object=e.object,this}}class TN extends Ji{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new vt;s.setIndex(new zt(n,1)),s.setAttribute("position",new lt(r,3)),super(s,new ni({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}}class AN extends di{constructor(e,t=1,n=16776960){const r=n,s=[1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],o=new vt;o.setAttribute("position",new lt(s,3)),o.computeBoundingSphere(),super(o,new ni({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const a=[1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],c=new vt;c.setAttribute("position",new lt(a,3)),c.computeBoundingSphere(),this.add(new je(c,new Bt({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){let t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=t<0?kr:Pa,this.lookAt(this.plane.normal),super.updateMatrixWorld(e)}}const uT=new B;let bm,Vy;class EP extends ft{constructor(e=new B(0,0,1),t=new B(0,0,0),n=1,r=16776960,s=n*.2,o=s*.2){super(),this.type="ArrowHelper",bm===void 0&&(bm=new vt,bm.setAttribute("position",new lt([0,0,0,0,1,0],3)),Vy=new kn(0,.5,1,5,1),Vy.translate(0,-.5,0)),this.position.copy(t),this.line=new di(bm,new ni({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new je(Vy,new Bt({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,s,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{uT.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(uT,t)}}setLength(e,t=e*.2,n=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}}class D1 extends Ji{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new vt;r.setAttribute("position",new lt(t,3)),r.setAttribute("color",new lt(n,3));const s=new ni({vertexColors:!0,toneMapped:!1});super(r,s),this.type="AxesHelper"}setColors(e,t,n){const r=new qe,s=this.geometry.attributes.color.array;return r.set(e),r.toArray(s,0),r.toArray(s,3),r.set(t),r.toArray(s,6),r.toArray(s,9),r.set(n),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class CN{constructor(){this.type="ShapePath",this.color=new qe,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new Tu,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this}bezierCurveTo(e,t,n,r,s,o){return this.currentPath.bezierCurveTo(e,t,n,r,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e,t){function n(w){const S=[];for(let b=0,E=w.length;b<E;b++){const R=w[b],z=new $s;z.curves=R.curves,S.push(z)}return S}function r(w,S){const b=S.length;let E=!1;for(let R=b-1,z=0;z<b;R=z++){let I=S[R],N=S[z],F=N.x-I.x,C=N.y-I.y;if(Math.abs(C)>Number.EPSILON){if(C<0&&(I=S[z],F=-F,N=S[R],C=-C),w.y<I.y||w.y>N.y)continue;if(w.y===I.y){if(w.x===I.x)return!0}else{const O=C*(w.x-I.x)-F*(w.y-I.y);if(O===0)return!0;if(O<0)continue;E=!E}}else{if(w.y!==I.y)continue;if(N.x<=w.x&&w.x<=I.x||I.x<=w.x&&w.x<=N.x)return!0}}return E}const s=Qs.isClockWise,o=this.subPaths;if(o.length===0)return[];if(t===!0)return n(o);let a,c,h;const d=[];if(o.length===1)return c=o[0],h=new $s,h.curves=c.curves,d.push(h),d;let l=!s(o[0].getPoints());l=e?!l:l;const u=[],p=[];let g=[],y=0,x;p[y]=void 0,g[y]=[];for(let w=0,S=o.length;w<S;w++)c=o[w],x=c.getPoints(),a=s(x),a=e?!a:a,a?(!l&&p[y]&&y++,p[y]={s:new $s,p:x},p[y].s.curves=c.curves,l&&y++,g[y]=[]):g[y].push({h:c,p:x[0]});if(!p[0])return n(o);if(p.length>1){let w=!1,S=0;for(let b=0,E=p.length;b<E;b++)u[b]=[];for(let b=0,E=p.length;b<E;b++){const R=g[b];for(let z=0;z<R.length;z++){const I=R[z];let N=!0;for(let F=0;F<p.length;F++)r(I.p,p[F].p)&&(b!==F&&S++,N?(N=!1,u[F].push(I)):w=!0);N&&u[b].push(I)}}S>0&&w===!1&&(g=u)}let v;for(let w=0,S=p.length;w<S;w++){h=p[w].s,d.push(h),v=g[w];for(let b=0,E=v.length;b<E;b++)h.holes.push(v[b].h)}return d}}class PN{static toHalfFloat(e){Math.abs(e)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),e=Jn(e,-65504,65504),hT[0]=e;const t=dT[0],n=t>>23&511;return ds[n]+((t&8388607)>>fs[n])}static fromHalfFloat(e){const t=e>>10;return dT[0]=B1[AP[t]+(e&1023)]+eh[t],hT[0]}}const TP=new ArrayBuffer(4),hT=new Float32Array(TP),dT=new Uint32Array(TP),ds=new Uint32Array(512),fs=new Uint32Array(512);for(let i=0;i<256;++i){const e=i-127;e<-27?(ds[i]=0,ds[i|256]=32768,fs[i]=24,fs[i|256]=24):e<-14?(ds[i]=1024>>-e-14,ds[i|256]=1024>>-e-14|32768,fs[i]=-e-1,fs[i|256]=-e-1):e<=15?(ds[i]=e+15<<10,ds[i|256]=e+15<<10|32768,fs[i]=13,fs[i|256]=13):e<128?(ds[i]=31744,ds[i|256]=64512,fs[i]=24,fs[i|256]=24):(ds[i]=31744,ds[i|256]=64512,fs[i]=13,fs[i|256]=13)}const B1=new Uint32Array(2048),eh=new Uint32Array(64),AP=new Uint32Array(64);for(let i=1;i<1024;++i){let e=i<<13,t=0;for(;(e&8388608)===0;)e<<=1,t-=8388608;e&=-8388609,t+=947912704,B1[i]=e|t}for(let i=1024;i<2048;++i)B1[i]=939524096+(i-1024<<13);for(let i=1;i<31;++i)eh[i]=i<<23;eh[31]=1199570944;eh[32]=2147483648;for(let i=33;i<63;++i)eh[i]=2147483648+(i-32<<23);eh[63]=3347054592;for(let i=1;i<64;++i)i!==32&&(AP[i]=1024);const RN=0,LN=1,kN=0,IN=1,FN=2;function DN(i){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),i}function BN(i=[]){return console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),i.isMultiMaterial=!0,i.materials=i,i.clone=function(){return i.slice()},i}class zN extends Ku{constructor(e,t){console.warn("THREE.PointCloud has been renamed to THREE.Points."),super(e,t)}}class ON extends vv{constructor(e){console.warn("THREE.Particle has been renamed to THREE.Sprite."),super(e)}}class NN extends Ku{constructor(e,t){console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),super(e,t)}}class UN extends Va{constructor(e){console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),super(e)}}class HN extends Va{constructor(e){console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),super(e)}}class VN extends Va{constructor(e){console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),super(e)}}class GN extends B{constructor(e,t,n){console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),super(e,t,n)}}class WN extends zt{constructor(e,t){console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),super(e,t),this.setUsage(Mu)}}class jN extends T3{constructor(e,t){console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),super(e,t)}}class XN extends A3{constructor(e,t){console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),super(e,t)}}class qN extends C3{constructor(e,t){console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),super(e,t)}}class YN extends P3{constructor(e,t){console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),super(e,t)}}class $N extends df{constructor(e,t){console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),super(e,t)}}class QN extends R3{constructor(e,t){console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),super(e,t)}}class ZN extends uv{constructor(e,t){console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),super(e,t)}}class KN extends lt{constructor(e,t){console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),super(e,t)}}class JN extends k3{constructor(e,t){console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),super(e,t)}}gr.create=function(i,e){return console.log("THREE.Curve.create() has been deprecated"),i.prototype=Object.create(gr.prototype),i.prototype.constructor=i,i.prototype.getPoint=e,i};Tu.prototype.fromPoints=function(i){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(i)};class e4 extends D1{constructor(e){console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),super(e)}}class t4 extends MP{constructor(e,t){console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),super(e,t)}}class n4 extends Ji{constructor(e,t){console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),super(new m1(e.geometry),new ni({color:t!==void 0?t:16777215}))}}bP.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")};_P.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")};class i4 extends Ji{constructor(e,t){console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),super(new g1(e.geometry),new ni({color:t!==void 0?t:16777215}))}}Ei.prototype.extractUrlBase=function(i){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),pr.extractUrlBase(i)};Ei.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}};class r4 extends er{constructor(e){console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),super(e)}}class s4 extends sP{constructor(e){console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),super(e)}}Ju.prototype.center=function(i){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(i)};Ju.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()};Ju.prototype.isIntersectionBox=function(i){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(i)};Ju.prototype.size=function(i){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(i)};vr.prototype.center=function(i){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(i)};vr.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()};vr.prototype.isIntersectionBox=function(i){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(i)};vr.prototype.isIntersectionSphere=function(i){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(i)};vr.prototype.size=function(i){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(i)};Et.prototype.toVector3=function(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")};zo.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()};ff.prototype.setFromMatrix=function(i){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(i)};wP.prototype.center=function(i){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(i)};ai.prototype.flattenToArrayOffset=function(i,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(i,e)};ai.prototype.multiplyVector3=function(i){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),i.applyMatrix3(this)};ai.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")};ai.prototype.applyToBufferAttribute=function(i){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),i.applyMatrix3(this)};ai.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")};ai.prototype.getInverse=function(i){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(i).invert()};st.prototype.extractPosition=function(i){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(i)};st.prototype.flattenToArrayOffset=function(i,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(i,e)};st.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new B().setFromMatrixColumn(this,3)};st.prototype.setRotationFromQuaternion=function(i){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(i)};st.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")};st.prototype.multiplyVector3=function(i){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),i.applyMatrix4(this)};st.prototype.multiplyVector4=function(i){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),i.applyMatrix4(this)};st.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")};st.prototype.rotateAxis=function(i){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),i.transformDirection(this)};st.prototype.crossVector=function(i){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),i.applyMatrix4(this)};st.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")};st.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")};st.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")};st.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")};st.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")};st.prototype.applyToBufferAttribute=function(i){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),i.applyMatrix4(this)};st.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")};st.prototype.makeFrustum=function(i,e,t,n,r,s){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(i,e,n,t,r,s)};st.prototype.getInverse=function(i){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(i).invert()};vs.prototype.isIntersectionLine=function(i){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(i)};qt.prototype.multiplyVector3=function(i){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),i.applyQuaternion(this)};qt.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()};Oo.prototype.isIntersectionBox=function(i){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(i)};Oo.prototype.isIntersectionPlane=function(i){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(i)};Oo.prototype.isIntersectionSphere=function(i){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(i)};ti.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()};ti.prototype.barycoordFromPoint=function(i,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(i,e)};ti.prototype.midpoint=function(i){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(i)};ti.prototypenormal=function(i){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(i)};ti.prototype.plane=function(i){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(i)};ti.barycoordFromPoint=function(i,e,t,n,r){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),ti.getBarycoord(i,e,t,n,r)};ti.normal=function(i,e,t,n){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),ti.getNormal(i,e,t,n)};$s.prototype.extractAllPoints=function(i){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(i)};$s.prototype.extrude=function(i){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Js(this,i)};$s.prototype.makeGeometry=function(i){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Hl(this,i)};Me.prototype.fromAttribute=function(i,e,t){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(i,e,t)};Me.prototype.distanceToManhattan=function(i){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(i)};Me.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()};B.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")};B.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")};B.prototype.getPositionFromMatrix=function(i){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(i)};B.prototype.getScaleFromMatrix=function(i){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(i)};B.prototype.getColumnFromMatrix=function(i,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,i)};B.prototype.applyProjection=function(i){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(i)};B.prototype.fromAttribute=function(i,e,t){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(i,e,t)};B.prototype.distanceToManhattan=function(i){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(i)};B.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()};Jt.prototype.fromAttribute=function(i,e,t){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(i,e,t)};Jt.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()};ft.prototype.getChildByName=function(i){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(i)};ft.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")};ft.prototype.translate=function(i,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,i)};ft.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")};ft.prototype.applyMatrix=function(i){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(i)};Object.defineProperties(ft.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(i){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=i}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}});je.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")};Object.defineProperties(je.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),p3},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}});Qu.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")};Mn.prototype.setLens=function(i,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),e!==void 0&&(this.filmGauge=e),this.setFocalLength(i)};Object.defineProperties(As.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(i){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=i}},shadowCameraLeft:{set:function(i){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=i}},shadowCameraRight:{set:function(i){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=i}},shadowCameraTop:{set:function(i){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=i}},shadowCameraBottom:{set:function(i){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=i}},shadowCameraNear:{set:function(i){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=i}},shadowCameraFar:{set:function(i){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=i}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(i){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=i}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(i){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=i}},shadowMapHeight:{set:function(i){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=i}}});Object.defineProperties(zt.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Mu},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Mu)}}});zt.prototype.setDynamic=function(i){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(i===!0?Mu:bu),this};zt.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},zt.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")};vt.prototype.addIndex=function(i){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(i)};vt.prototype.addAttribute=function(i,e){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),!(e&&e.isBufferAttribute)&&!(e&&e.isInterleavedBufferAttribute)?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(i,new zt(arguments[1],arguments[2]))):i==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(i,e)};vt.prototype.addDrawCall=function(i,e,t){t!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(i,e)};vt.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()};vt.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")};vt.prototype.removeAttribute=function(i){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(i)};vt.prototype.applyMatrix=function(i){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(i)};Object.defineProperties(vt.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}});Ha.prototype.setDynamic=function(i){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(i===!0?Mu:bu),this};Ha.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")};Js.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")};Js.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")};Js.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")};$u.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")};Cv.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this};Object.defineProperties(An.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new qe}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(i){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=i===Z_}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(i){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=i}},vertexTangents:{get:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")},set:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}});Object.defineProperties(jn.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(i){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=i}}});ln.prototype.clearTarget=function(i,e,t,n){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(i),this.clear(e,t,n)};ln.prototype.animate=function(i){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(i)};ln.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()};ln.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()};ln.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision};ln.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()};ln.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")};ln.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")};ln.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")};ln.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")};ln.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")};ln.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")};ln.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures};ln.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")};ln.prototype.enableScissorTest=function(i){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(i)};ln.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")};ln.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")};ln.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")};ln.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")};ln.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")};ln.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")};ln.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")};ln.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")};ln.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")};ln.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()};Object.defineProperties(ln.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(i){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=i}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(i){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=i}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(i){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=i===!0?Ht:Ts}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}},gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}});Object.defineProperties(H3.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}});class o4 extends dv{constructor(e,t,n){console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),super(e,n)}}Object.defineProperties(Gi.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(i){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=i}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(i){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=i}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(i){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=i}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(i){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=i}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(i){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=i}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(i){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=i}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(i){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=i}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(i){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=i}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(i){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=i}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(i){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=i}}});k1.prototype.load=function(i){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const e=this;return new hP().load(i,function(n){e.setBuffer(n)}),this};pP.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()};hv.prototype.updateCubeMap=function(i,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(i,e)};hv.prototype.clear=function(i,e,t,n){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(i,e,t,n)};Ua.crossOrigin=void 0;Ua.loadTexture=function(i,e,t,n){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const r=new Ev;r.setCrossOrigin(this.crossOrigin);const s=r.load(i,t,void 0,n);return e&&(s.mapping=e),s};Ua.loadTextureCube=function(i,e,t,n){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const r=new rP;r.setCrossOrigin(this.crossOrigin);const s=r.load(i,t,void 0,n);return e&&(s.mapping=e),s};Ua.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")};Ua.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};function a4(){console.error("THREE.CanvasRenderer has been removed")}function l4(){console.error("THREE.JSONLoader has been removed.")}const c4={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};function u4(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")}class h4 extends vt{constructor(){console.error("THREE.ParametricGeometry has been moved to /examples/jsm/geometries/ParametricGeometry.js"),super()}}class d4 extends vt{constructor(){console.error("THREE.TextGeometry has been moved to /examples/jsm/geometries/TextGeometry.js"),super()}}function f4(){console.error("THREE.FontLoader has been moved to /examples/jsm/loaders/FontLoader.js")}function p4(){console.error("THREE.Font has been moved to /examples/jsm/loaders/FontLoader.js")}function m4(){console.error("THREE.ImmediateRenderObject has been removed.")}class g4 extends Gi{constructor(e,t,n){console.error('THREE.WebGLMultisampleRenderTarget has been removed. Use a normal render target and set the "samples" property to greater 0 to enable multisampling.'),super(e,t,n),this.samples=4}}class v4 extends ju{constructor(e,t,n,r){console.warn("THREE.DataTexture2DArray has been renamed to DataArrayTexture."),super(e,t,n,r)}}class y4 extends hf{constructor(e,t,n,r){console.warn("THREE.DataTexture3D has been renamed to Data3DTexture."),super(e,t,n,r)}}typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:ov}}));typeof window!="undefined"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=ov);var Ig=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:e1,AddEquation:ml,AddOperation:jC,AdditiveAnimationBlendMode:t1,AdditiveBlending:ew,AlphaFormat:t3,AlwaysDepth:OC,AlwaysStencilFunc:x3,AmbientLight:Tv,AmbientLightProbe:fP,AnimationClip:Wl,AnimationLoader:JO,AnimationMixer:vP,AnimationObjectGroup:gP,AnimationUtils:bn,ArcCurve:u1,ArrayCamera:o1,ArrowHelper:EP,Audio:k1,AudioAnalyser:pP,AudioContext:L1,AudioListener:sN,AudioLoader:hP,AxesHelper:D1,AxisHelper:e4,BackSide:kr,BasicDepthPacking:g3,BasicShadowMap:QI,BinaryTextureLoader:s4,Bone:Ol,BooleanKeyframeTrack:Ql,BoundingBoxHelper:t4,Box2:Ju,Box3:vr,Box3Helper:TN,BoxBufferGeometry:dn,BoxGeometry:dn,BoxHelper:MP,BufferAttribute:zt,BufferGeometry:vt,BufferGeometryLoader:uP,ByteType:QC,Cache:jl,Camera:Xu,CameraHelper:EN,CanvasRenderer:a4,CanvasTexture:Y3,CapsuleBufferGeometry:Au,CapsuleGeometry:Au,CatmullRomCurve3:d1,CineonToneMapping:YC,CircleBufferGeometry:Cu,CircleGeometry:Cu,ClampToEdgeWrapping:_i,Clock:Av,Color:qe,ColorKeyframeTrack:b1,ColorManagement:Yr,CompressedTexture:c1,CompressedTextureLoader:eN,ConeBufferGeometry:Pu,ConeGeometry:Pu,CubeCamera:hv,CubeReflectionMapping:Ra,CubeRefractionMapping:La,CubeTexture:qu,CubeTextureLoader:rP,CubeUVReflectionMapping:Wu,CubicBezierCurve:xv,CubicBezierCurve3:f1,CubicInterpolant:eP,CullFaceBack:Jx,CullFaceFront:MC,CullFaceFrontBack:$I,CullFaceNone:bC,Curve:gr,CurvePath:Q3,CustomBlending:EC,CustomToneMapping:$C,CylinderBufferGeometry:kn,CylinderGeometry:kn,Cylindrical:yN,Data3DTexture:hf,DataArrayTexture:ju,DataTexture:Ea,DataTexture2DArray:v4,DataTexture3D:y4,DataTextureLoader:sP,DataUtils:PN,DecrementStencilOp:oF,DecrementWrapStencilOp:lF,DefaultLoadingManager:iP,DepthFormat:ba,DepthStencilFormat:Bl,DepthTexture:a1,DirectionalLight:xf,DirectionalLightHelper:MN,DiscreteInterpolant:tP,DodecahedronBufferGeometry:Ru,DodecahedronGeometry:Ru,DoubleSide:Es,DstAlphaFactor:kC,DstColorFactor:FC,DynamicBufferAttribute:WN,DynamicCopyUsage:SF,DynamicDrawUsage:Mu,DynamicReadUsage:xF,EdgesGeometry:m1,EdgesHelper:n4,EllipseCurve:gf,EqualDepth:UC,EqualStencilFunc:dF,EquirectangularReflectionMapping:xu,EquirectangularRefractionMapping:Hd,Euler:Et,EventDispatcher:Bo,ExtrudeBufferGeometry:Js,ExtrudeGeometry:Js,FaceColors:IN,FileLoader:er,FlatShading:Z_,Float16BufferAttribute:L3,Float32Attribute:KN,Float32BufferAttribute:lt,Float64Attribute:JN,Float64BufferAttribute:k3,FloatType:_o,Fog:mf,FogExp2:pf,Font:p4,FontLoader:f4,FramebufferTexture:q3,FrontSide:Pa,Frustum:ff,GLBufferAttribute:xP,GLSL1:MF,GLSL3:Tw,GreaterDepth:VC,GreaterEqualDepth:HC,GreaterEqualStencilFunc:gF,GreaterStencilFunc:pF,GridHelper:bP,Group:Jr,HalfFloatType:Tl,HemisphereLight:E1,HemisphereLightHelper:SN,HemisphereLightProbe:dP,IcosahedronBufferGeometry:Lu,IcosahedronGeometry:Lu,ImageBitmapLoader:R1,ImageLoader:Qd,ImageUtils:Ua,ImmediateRenderObject:m4,IncrementStencilOp:sF,IncrementWrapStencilOp:aF,InstancedBufferAttribute:Nl,InstancedBufferGeometry:P1,InstancedInterleavedBuffer:yP,InstancedMesh:l1,Int16Attribute:YN,Int16BufferAttribute:P3,Int32Attribute:QN,Int32BufferAttribute:R3,Int8Attribute:jN,Int8BufferAttribute:T3,IntType:KC,InterleavedBuffer:Ha,InterleavedBufferAttribute:Po,Interpolant:eo,InterpolateDiscrete:Su,InterpolateLinear:zl,InterpolateSmooth:Km,InvertStencilOp:cF,JSONLoader:l4,KeepStencilOp:Jm,KeyframeTrack:Cs,LOD:j3,LatheBufferGeometry:Ul,LatheGeometry:Ul,Layers:Rl,LensFlare:u4,LessDepth:NC,LessEqualDepth:Rg,LessEqualStencilFunc:fF,LessStencilFunc:hF,Light:As,LightProbe:wf,Line:di,Line3:wP,LineBasicMaterial:ni,LineCurve:vf,LineCurve3:$3,LineDashedMaterial:_1,LineLoop:yv,LinePieces:LN,LineSegments:Ji,LineStrip:RN,LinearEncoding:Ts,LinearFilter:jt,LinearInterpolant:S1,LinearMipMapLinearFilter:tF,LinearMipMapNearestFilter:eF,LinearMipmapLinearFilter:Do,LinearMipmapNearestFilter:lv,LinearSRGBColorSpace:fa,LinearToneMapping:XC,Loader:Ei,LoaderUtils:pr,LoadingManager:M1,LoopOnce:h3,LoopPingPong:f3,LoopRepeat:d3,LuminanceAlphaFormat:r3,LuminanceFormat:i3,MOUSE:Ar,Material:An,MaterialLoader:cP,Math:Pr,MathUtils:Pr,Matrix3:ai,Matrix4:st,MaxEquation:rw,Mesh:je,MeshBasicMaterial:Bt,MeshDepthMaterial:pv,MeshDistanceMaterial:mv,MeshFaceMaterial:DN,MeshLambertMaterial:Mv,MeshMatcapMaterial:w1,MeshNormalMaterial:Bu,MeshPhongMaterial:uu,MeshPhysicalMaterial:No,MeshStandardMaterial:$l,MeshToonMaterial:x1,MinEquation:iw,MirroredRepeatWrapping:wu,MixOperation:WC,MultiMaterial:BN,MultiplyBlending:nw,MultiplyOperation:uf,NearestFilter:Kt,NearestMipMapLinearFilter:JI,NearestMipMapNearestFilter:KI,NearestMipmapLinearFilter:Gd,NearestMipmapNearestFilter:Vd,NeverDepth:zC,NeverStencilFunc:uF,NoBlending:Mo,NoColorSpace:nF,NoColors:kN,NoToneMapping:bs,NormalAnimationBlendMode:cv,NormalBlending:El,NotEqualDepth:GC,NotEqualStencilFunc:mF,NumberKeyframeTrack:Vl,Object3D:ft,ObjectLoader:tN,ObjectSpaceNormalMap:y3,OctahedronBufferGeometry:ws,OctahedronGeometry:ws,OneFactor:PC,OneMinusDstAlphaFactor:IC,OneMinusDstColorFactor:DC,OneMinusSrcAlphaFactor:J_,OneMinusSrcColorFactor:LC,OrthographicCamera:Fr,PCFShadowMap:$_,PCFSoftShadowMap:Q_,PMREMGenerator:Cw,ParametricGeometry:h4,Particle:ON,ParticleBasicMaterial:HN,ParticleSystem:NN,ParticleSystemMaterial:VN,Path:Tu,PerspectiveCamera:Mn,Plane:vs,PlaneBufferGeometry:xn,PlaneGeometry:xn,PlaneHelper:AN,PointCloud:zN,PointCloudMaterial:UN,PointLight:zu,PointLightHelper:wN,Points:Ku,PointsMaterial:Va,PolarGridHelper:bN,PolyhedronBufferGeometry:Ks,PolyhedronGeometry:Ks,PositionalAudio:aN,PropertyBinding:Wt,PropertyMixer:mP,QuadraticBezierCurve:wv,QuadraticBezierCurve3:_v,Quaternion:qt,QuaternionKeyframeTrack:Lo,QuaternionLinearInterpolant:nP,REVISION:ov,RGBADepthPacking:v3,RGBAFormat:ur,RGBAIntegerFormat:c3,RGBA_ASTC_10x10_Format:Sw,RGBA_ASTC_10x5_Format:xw,RGBA_ASTC_10x6_Format:ww,RGBA_ASTC_10x8_Format:_w,RGBA_ASTC_12x10_Format:bw,RGBA_ASTC_12x12_Format:Mw,RGBA_ASTC_4x4_Format:hw,RGBA_ASTC_5x4_Format:dw,RGBA_ASTC_5x5_Format:fw,RGBA_ASTC_6x5_Format:pw,RGBA_ASTC_6x6_Format:mw,RGBA_ASTC_8x5_Format:gw,RGBA_ASTC_8x6_Format:vw,RGBA_ASTC_8x8_Format:yw,RGBA_BPTC_Format:Ew,RGBA_ETC2_EAC_Format:uw,RGBA_PVRTC_2BPPV1_Format:lw,RGBA_PVRTC_4BPPV1_Format:aw,RGBA_S3TC_DXT1_Format:$m,RGBA_S3TC_DXT3_Format:Qm,RGBA_S3TC_DXT5_Format:Zm,RGBFormat:n3,RGB_ETC1_Format:u3,RGB_ETC2_Format:cw,RGB_PVRTC_2BPPV1_Format:ow,RGB_PVRTC_4BPPV1_Format:sw,RGB_S3TC_DXT1_Format:Ym,RGFormat:a3,RGIntegerFormat:l3,RawShaderMaterial:y1,Ray:Oo,Raycaster:_f,RectAreaLight:A1,RedFormat:s3,RedIntegerFormat:o3,ReinhardToneMapping:qC,RepeatWrapping:Zs,ReplaceStencilOp:rF,ReverseSubtractEquation:AC,RingBufferGeometry:ku,RingGeometry:ku,SRGBColorSpace:js,Scene:$u,SceneUtils:c4,ShaderChunk:Gt,ShaderLib:ys,ShaderMaterial:jn,ShadowMaterial:v1,Shape:$s,ShapeBufferGeometry:Hl,ShapeGeometry:Hl,ShapePath:CN,ShapeUtils:Qs,ShortType:ZC,Skeleton:Zu,SkeletonHelper:_P,SkinnedMesh:Qu,SmoothShading:ZI,Source:Sl,Sphere:zo,SphereBufferGeometry:Ro,SphereGeometry:Ro,Spherical:Zd,SphericalHarmonics3:C1,SplineCurve:Sv,SpotLight:yf,SpotLightHelper:xN,Sprite:vv,SpriteMaterial:gv,SrcAlphaFactor:K_,SrcAlphaSaturateFactor:BC,SrcColorFactor:RC,StaticCopyUsage:_F,StaticDrawUsage:bu,StaticReadUsage:yF,StereoCamera:iN,StreamCopyUsage:bF,StreamDrawUsage:vF,StreamReadUsage:wF,StringKeyframeTrack:Zl,SubtractEquation:TC,SubtractiveBlending:tw,TOUCH:Cr,TangentSpaceNormalMap:Na,TetrahedronBufferGeometry:Iu,TetrahedronGeometry:Iu,TextGeometry:d4,Texture:hn,TextureLoader:Ev,TorusBufferGeometry:xs,TorusGeometry:xs,TorusKnotBufferGeometry:Fu,TorusKnotGeometry:Fu,Triangle:ti,TriangleFanDrawMode:n1,TriangleStripDrawMode:m3,TrianglesDrawMode:p3,TubeBufferGeometry:Du,TubeGeometry:Du,UVMapping:av,Uint16Attribute:$N,Uint16BufferAttribute:df,Uint32Attribute:ZN,Uint32BufferAttribute:uv,Uint8Attribute:XN,Uint8BufferAttribute:A3,Uint8ClampedAttribute:qN,Uint8ClampedBufferAttribute:C3,Uniform:Cv,UniformsLib:ot,UniformsUtils:r1,UnsignedByteType:ka,UnsignedInt248Type:Al,UnsignedIntType:md,UnsignedShort4444Type:JC,UnsignedShort5551Type:e3,UnsignedShortType:_u,VSMShadowMap:Jc,Vector2:Me,Vector3:B,Vector4:Jt,VectorKeyframeTrack:Gl,Vertex:GN,VertexColors:FN,VideoTexture:X3,WebGL1Renderer:G3,WebGL3DRenderTarget:M3,WebGLArrayRenderTarget:b3,WebGLCubeRenderTarget:dv,WebGLMultipleRenderTargets:E3,WebGLMultisampleRenderTarget:g4,WebGLRenderTarget:Gi,WebGLRenderTargetCube:o4,WebGLRenderer:ln,WebGLUtils:V3,WireframeGeometry:g1,WireframeHelper:i4,WrapAroundEnding:Wd,XHRLoader:r4,ZeroCurvatureEnding:wl,ZeroFactor:CC,ZeroSlopeEnding:_l,ZeroStencilOp:iF,_SRGBAFormat:Lg,sRGBEncoding:Ht},Symbol.toStringTag,{value:"Module"})),hu={exports:{}},Kl={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */Kl.ConcurrentRoot=1;Kl.ContinuousEventPriority=4;Kl.DefaultEventPriority=16;Kl.DiscreteEventPriority=1;Kl.IdleEventPriority=536870912;Kl.LegacyRoot=0;hu.exports=Kl;function x4(i){let e;const t=new Set,n=(h,d)=>{const l=typeof h=="function"?h(e):h;if(l!==e){const u=e;e=d?l:Object.assign({},e,l),t.forEach(p=>p(e,u))}},r=()=>e,s=(h,d=r,l=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let u=d(e);function p(){const g=d(e);if(!l(u,g)){const y=u;h(u=g,y)}}return t.add(p),()=>t.delete(p)},c={setState:n,getState:r,subscribe:(h,d,l)=>d||l?s(h,d,l):(t.add(h),()=>t.delete(h)),destroy:()=>t.clear()};return e=i(n,r,c),c}const w4=typeof window=="undefined"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),fT=w4?St.exports.useEffect:St.exports.useLayoutEffect;function _4(i){const e=typeof i=="function"?x4(i):i,t=(n=e.getState,r=Object.is)=>{const[,s]=St.exports.useReducer(x=>x+1,0),o=e.getState(),a=St.exports.useRef(o),c=St.exports.useRef(n),h=St.exports.useRef(r),d=St.exports.useRef(!1),l=St.exports.useRef();l.current===void 0&&(l.current=n(o));let u,p=!1;(a.current!==o||c.current!==n||h.current!==r||d.current)&&(u=n(o),p=!r(l.current,u)),fT(()=>{p&&(l.current=u),a.current=o,c.current=n,h.current=r,d.current=!1});const g=St.exports.useRef(o);fT(()=>{const x=()=>{try{const w=e.getState(),S=c.current(w);h.current(l.current,S)||(a.current=w,l.current=S,s())}catch{d.current=!0,s()}},v=e.subscribe(x);return e.getState()!==g.current&&x(),v},[]);const y=p?u:l.current;return St.exports.useDebugValue(y),y};return Object.assign(t,e),t[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const n=[t,e];return{next(){const r=n.length<=0;return{value:n.shift(),done:r}}}},t}var CP={exports:{}},Fg={exports:{}},PP={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(i){function e(k,W){var Y=k.length;k.push(W);e:for(;0<Y;){var H=Y-1>>>1,J=k[H];if(0<r(J,W))k[H]=W,k[Y]=J,Y=H;else break e}}function t(k){return k.length===0?null:k[0]}function n(k){if(k.length===0)return null;var W=k[0],Y=k.pop();if(Y!==W){k[0]=Y;e:for(var H=0,J=k.length,K=J>>>1;H<K;){var ee=2*(H+1)-1,$=k[ee],Z=ee+1,Ee=k[Z];if(0>r($,Y))Z<J&&0>r(Ee,$)?(k[H]=Ee,k[Z]=Y,H=Z):(k[H]=$,k[ee]=Y,H=ee);else if(Z<J&&0>r(Ee,Y))k[H]=Ee,k[Z]=Y,H=Z;else break e}}return W}function r(k,W){var Y=k.sortIndex-W.sortIndex;return Y!==0?Y:k.id-W.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;i.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();i.unstable_now=function(){return o.now()-a}}var c=[],h=[],d=1,l=null,u=3,p=!1,g=!1,y=!1,x=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate!="undefined"?setImmediate:null;typeof navigator!="undefined"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(k){for(var W=t(h);W!==null;){if(W.callback===null)n(h);else if(W.startTime<=k)n(h),W.sortIndex=W.expirationTime,e(c,W);else break;W=t(h)}}function b(k){if(y=!1,S(k),!g)if(t(c)!==null)g=!0,ne(E);else{var W=t(h);W!==null&&j(b,W.startTime-k)}}function E(k,W){g=!1,y&&(y=!1,v(I),I=-1),p=!0;var Y=u;try{for(S(W),l=t(c);l!==null&&(!(l.expirationTime>W)||k&&!C());){var H=l.callback;if(typeof H=="function"){l.callback=null,u=l.priorityLevel;var J=H(l.expirationTime<=W);W=i.unstable_now(),typeof J=="function"?l.callback=J:l===t(c)&&n(c),S(W)}else n(c);l=t(c)}if(l!==null)var K=!0;else{var ee=t(h);ee!==null&&j(b,ee.startTime-W),K=!1}return K}finally{l=null,u=Y,p=!1}}var R=!1,z=null,I=-1,N=5,F=-1;function C(){return!(i.unstable_now()-F<N)}function O(){if(z!==null){var k=i.unstable_now();F=k;var W=!0;try{W=z(!0,k)}finally{W?X():(R=!1,z=null)}}else R=!1}var X;if(typeof w=="function")X=function(){w(O)};else if(typeof MessageChannel!="undefined"){var U=new MessageChannel,te=U.port2;U.port1.onmessage=O,X=function(){te.postMessage(null)}}else X=function(){x(O,0)};function ne(k){z=k,R||(R=!0,X())}function j(k,W){I=x(function(){k(i.unstable_now())},W)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(k){k.callback=null},i.unstable_continueExecution=function(){g||p||(g=!0,ne(E))},i.unstable_forceFrameRate=function(k){0>k||125<k?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<k?Math.floor(1e3/k):5},i.unstable_getCurrentPriorityLevel=function(){return u},i.unstable_getFirstCallbackNode=function(){return t(c)},i.unstable_next=function(k){switch(u){case 1:case 2:case 3:var W=3;break;default:W=u}var Y=u;u=W;try{return k()}finally{u=Y}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(k,W){switch(k){case 1:case 2:case 3:case 4:case 5:break;default:k=3}var Y=u;u=k;try{return W()}finally{u=Y}},i.unstable_scheduleCallback=function(k,W,Y){var H=i.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?H+Y:H):Y=H,k){case 1:var J=-1;break;case 2:J=250;break;case 5:J=1073741823;break;case 4:J=1e4;break;default:J=5e3}return J=Y+J,k={id:d++,callback:W,priorityLevel:k,startTime:Y,expirationTime:J,sortIndex:-1},Y>H?(k.sortIndex=Y,e(h,k),t(c)===null&&k===t(h)&&(y?(v(I),I=-1):y=!0,j(b,Y-H))):(k.sortIndex=J,e(c,k),g||p||(g=!0,ne(E))),k},i.unstable_shouldYield=C,i.unstable_wrapCallback=function(k){var W=u;return function(){var Y=u;u=W;try{return k.apply(this,arguments)}finally{u=Y}}}})(PP);Fg.exports=PP;/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var S4=function(e){var t={},n=St.exports,r=Fg.exports,s=Object.assign;function o(f){for(var m="https://reactjs.org/docs/error-decoder.html?invariant="+f,_=1;_<arguments.length;_++)m+="&args[]="+encodeURIComponent(arguments[_]);return"Minified React error #"+f+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,c=Symbol.for("react.element"),h=Symbol.for("react.portal"),d=Symbol.for("react.fragment"),l=Symbol.for("react.strict_mode"),u=Symbol.for("react.profiler"),p=Symbol.for("react.provider"),g=Symbol.for("react.context"),y=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),v=Symbol.for("react.suspense_list"),w=Symbol.for("react.memo"),S=Symbol.for("react.lazy"),b=Symbol.for("react.offscreen"),E=Symbol.iterator;function R(f){return f===null||typeof f!="object"?null:(f=E&&f[E]||f["@@iterator"],typeof f=="function"?f:null)}function z(f){if(f==null)return null;if(typeof f=="function")return f.displayName||f.name||null;if(typeof f=="string")return f;switch(f){case d:return"Fragment";case h:return"Portal";case u:return"Profiler";case l:return"StrictMode";case x:return"Suspense";case v:return"SuspenseList"}if(typeof f=="object")switch(f.$$typeof){case g:return(f.displayName||"Context")+".Consumer";case p:return(f._context.displayName||"Context")+".Provider";case y:var m=f.render;return f=f.displayName,f||(f=m.displayName||m.name||"",f=f!==""?"ForwardRef("+f+")":"ForwardRef"),f;case w:return m=f.displayName||null,m!==null?m:z(f.type)||"Memo";case S:m=f._payload,f=f._init;try{return z(f(m))}catch{}}return null}function I(f){var m=f.type;switch(f.tag){case 24:return"Cache";case 9:return(m.displayName||"Context")+".Consumer";case 10:return(m._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return f=m.render,f=f.displayName||f.name||"",m.displayName||(f!==""?"ForwardRef("+f+")":"ForwardRef");case 7:return"Fragment";case 5:return m;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return z(m);case 8:return m===l?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof m=="function")return m.displayName||m.name||null;if(typeof m=="string")return m}return null}function N(f){var m=f,_=f;if(f.alternate)for(;m.return;)m=m.return;else{f=m;do m=f,(m.flags&4098)!==0&&(_=m.return),f=m.return;while(f)}return m.tag===3?_:null}function F(f){if(N(f)!==f)throw Error(o(188))}function C(f){var m=f.alternate;if(!m){if(m=N(f),m===null)throw Error(o(188));return m!==f?null:f}for(var _=f,M=m;;){var A=_.return;if(A===null)break;var D=A.alternate;if(D===null){if(M=A.return,M!==null){_=M;continue}break}if(A.child===D.child){for(D=A.child;D;){if(D===_)return F(A),f;if(D===M)return F(A),m;D=D.sibling}throw Error(o(188))}if(_.return!==M.return)_=A,M=D;else{for(var se=!1,ve=A.child;ve;){if(ve===_){se=!0,_=A,M=D;break}if(ve===M){se=!0,M=A,_=D;break}ve=ve.sibling}if(!se){for(ve=D.child;ve;){if(ve===_){se=!0,_=D,M=A;break}if(ve===M){se=!0,M=D,_=A;break}ve=ve.sibling}if(!se)throw Error(o(189))}}if(_.alternate!==M)throw Error(o(190))}if(_.tag!==3)throw Error(o(188));return _.stateNode.current===_?f:m}function O(f){return f=C(f),f!==null?X(f):null}function X(f){if(f.tag===5||f.tag===6)return f;for(f=f.child;f!==null;){var m=X(f);if(m!==null)return m;f=f.sibling}return null}function U(f){if(f.tag===5||f.tag===6)return f;for(f=f.child;f!==null;){if(f.tag!==4){var m=U(f);if(m!==null)return m}f=f.sibling}return null}var te=Array.isArray,ne=e.getPublicInstance,j=e.getRootHostContext,k=e.getChildHostContext,W=e.prepareForCommit,Y=e.resetAfterCommit,H=e.createInstance,J=e.appendInitialChild,K=e.finalizeInitialChildren,ee=e.prepareUpdate,$=e.shouldSetTextContent,Z=e.createTextInstance,Ee=e.scheduleTimeout,Se=e.cancelTimeout,de=e.noTimeout,he=e.isPrimaryRenderer,Ce=e.supportsMutation,me=e.supportsPersistence,fe=e.supportsHydration,we=e.getInstanceFromNode,ye=e.preparePortalMount,_e=e.getCurrentEventPriority,it=e.detachDeletedInstance,$e=e.supportsMicrotasks,et=e.scheduleMicrotask,L=e.supportsTestSelectors,V=e.findFiberRoot,P=e.getBoundingRect,T=e.getTextContent,q=e.isHiddenSubtree,re=e.matchAccessibilityRole,pe=e.setFocusIfFocusable,ge=e.setupIntersectionObserver,be=e.appendChild,G=e.appendChildToContainer,Ae=e.commitTextUpdate,Fe=e.commitMount,Ve=e.commitUpdate,oe=e.insertBefore,Ne=e.insertInContainerBefore,Je=e.removeChild,ae=e.removeChildFromContainer,Te=e.resetTextContent,Ge=e.hideInstance,ze=e.hideTextInstance,ct=e.unhideInstance,Pt=e.unhideTextInstance,xt=e.clearContainer,Xn=e.cloneInstance,Cn=e.createContainerChildSet,Un=e.appendChildToContainerChildSet,Fn=e.finalizeContainerChildren,Ai=e.replaceContainerChildren,sn=e.cloneHiddenInstance,Le=e.cloneHiddenTextInstance,Be=e.canHydrateInstance,Qe=e.canHydrateTextInstance,Ke=e.canHydrateSuspenseInstance,Q=e.isSuspenseInstancePending,le=e.isSuspenseInstanceFallback,ue=e.registerSuspenseInstanceRetry,ce=e.getNextHydratableSibling,ie=e.getFirstHydratableChild,Ie=e.getFirstHydratableChildWithinContainer,Ue=e.getFirstHydratableChildWithinSuspenseInstance,Ye=e.hydrateInstance,Oe=e.hydrateTextInstance,He=e.hydrateSuspenseInstance,We=e.getNextHydratableInstanceAfterSuspenseInstance,nt=e.commitHydratedContainer,pt=e.commitHydratedSuspenseInstance,Ze=e.clearSuspenseBoundary,Tt=e.clearSuspenseBoundaryFromContainer,Rt=e.shouldDeleteUnhydratedTailInstances,Qt=e.didNotMatchHydratedContainerTextInstance,dt=e.didNotMatchHydratedTextInstance,Lt;function at(f){if(Lt===void 0)try{throw Error()}catch(_){var m=_.stack.trim().match(/\n( *(at )?)/);Lt=m&&m[1]||""}return`
`+Lt+f}var fn=!1;function wn(f,m){if(!f||fn)return"";fn=!0;var _=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(m)if(m=function(){throw Error()},Object.defineProperty(m.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(m,[])}catch(rt){var M=rt}Reflect.construct(f,[],m)}else{try{m.call()}catch(rt){M=rt}f.call(m.prototype)}else{try{throw Error()}catch(rt){M=rt}f()}}catch(rt){if(rt&&M&&typeof rt.stack=="string"){for(var A=rt.stack.split(`
`),D=M.stack.split(`
`),se=A.length-1,ve=D.length-1;1<=se&&0<=ve&&A[se]!==D[ve];)ve--;for(;1<=se&&0<=ve;se--,ve--)if(A[se]!==D[ve]){if(se!==1||ve!==1)do if(se--,ve--,0>ve||A[se]!==D[ve]){var De=`
`+A[se].replace(" at new "," at ");return f.displayName&&De.includes("<anonymous>")&&(De=De.replace("<anonymous>",f.displayName)),De}while(1<=se&&0<=ve);break}}}finally{fn=!1,Error.prepareStackTrace=_}return(f=f?f.displayName||f.name:"")?at(f):""}var Hn=Object.prototype.hasOwnProperty,Ci=[],Vt=-1;function Dt(f){return{current:f}}function Nt(f){0>Vt||(f.current=Ci[Vt],Ci[Vt]=null,Vt--)}function yt(f,m){Vt++,Ci[Vt]=f.current,f.current=m}var pi={},on=Dt(pi),an=Dt(!1),_n=pi;function li(f,m){var _=f.type.contextTypes;if(!_)return pi;var M=f.stateNode;if(M&&M.__reactInternalMemoizedUnmaskedChildContext===m)return M.__reactInternalMemoizedMaskedChildContext;var A={},D;for(D in _)A[D]=m[D];return M&&(f=f.stateNode,f.__reactInternalMemoizedUnmaskedChildContext=m,f.__reactInternalMemoizedMaskedChildContext=A),A}function Pn(f){return f=f.childContextTypes,f!=null}function At(){Nt(an),Nt(on)}function Fi(f,m,_){if(on.current!==pi)throw Error(o(168));yt(on,m),yt(an,_)}function qn(f,m,_){var M=f.stateNode;if(m=m.childContextTypes,typeof M.getChildContext!="function")return _;M=M.getChildContext();for(var A in M)if(!(A in m))throw Error(o(108,I(f)||"Unknown",A));return s({},_,M)}function Or(f){return f=(f=f.stateNode)&&f.__reactInternalMemoizedMergedChildContext||pi,_n=on.current,yt(on,f),yt(an,an.current),!0}function Ls(f,m,_){var M=f.stateNode;if(!M)throw Error(o(169));_?(f=qn(f,m,_n),M.__reactInternalMemoizedMergedChildContext=f,Nt(an),Nt(on),yt(on,f)):Nt(an),yt(an,_)}var yr=Math.clz32?Math.clz32:UR,Lv=Math.log,gn=Math.LN2;function UR(f){return f>>>=0,f===0?32:31-(Lv(f)/gn|0)|0}var Af=64,Cf=4194304;function ch(f){switch(f&-f){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return f&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return f}}function Pf(f,m){var _=f.pendingLanes;if(_===0)return 0;var M=0,A=f.suspendedLanes,D=f.pingedLanes,se=_&268435455;if(se!==0){var ve=se&~A;ve!==0?M=ch(ve):(D&=se,D!==0&&(M=ch(D)))}else se=_&~A,se!==0?M=ch(se):D!==0&&(M=ch(D));if(M===0)return 0;if(m!==0&&m!==M&&(m&A)===0&&(A=M&-M,D=m&-m,A>=D||A===16&&(D&4194240)!==0))return m;if((M&4)!==0&&(M|=_&16),m=f.entangledLanes,m!==0)for(f=f.entanglements,m&=M;0<m;)_=31-yr(m),A=1<<_,M|=f[_],m&=~A;return M}function HR(f,m){switch(f){case 1:case 2:case 4:return m+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return m+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function VR(f,m){for(var _=f.suspendedLanes,M=f.pingedLanes,A=f.expirationTimes,D=f.pendingLanes;0<D;){var se=31-yr(D),ve=1<<se,De=A[se];De===-1?((ve&_)===0||(ve&M)!==0)&&(A[se]=HR(ve,m)):De<=m&&(f.expiredLanes|=ve),D&=~ve}}function kv(f){return f=f.pendingLanes&-1073741825,f!==0?f:f&1073741824?1073741824:0}function Iv(f){for(var m=[],_=0;31>_;_++)m.push(f);return m}function uh(f,m,_){f.pendingLanes|=m,m!==536870912&&(f.suspendedLanes=0,f.pingedLanes=0),f=f.eventTimes,m=31-yr(m),f[m]=_}function GR(f,m){var _=f.pendingLanes&~m;f.pendingLanes=m,f.suspendedLanes=0,f.pingedLanes=0,f.expiredLanes&=m,f.mutableReadLanes&=m,f.entangledLanes&=m,m=f.entanglements;var M=f.eventTimes;for(f=f.expirationTimes;0<_;){var A=31-yr(_),D=1<<A;m[A]=0,M[A]=-1,f[A]=-1,_&=~D}}function Fv(f,m){var _=f.entangledLanes|=m;for(f=f.entanglements;_;){var M=31-yr(_),A=1<<M;A&m|f[M]&m&&(f[M]|=m),_&=~A}}var tn=0;function iS(f){return f&=-f,1<f?4<f?(f&268435455)!==0?16:536870912:4:1}var Dv=r.unstable_scheduleCallback,rS=r.unstable_cancelCallback,WR=r.unstable_shouldYield,jR=r.unstable_requestPaint,mi=r.unstable_now,Bv=r.unstable_ImmediatePriority,XR=r.unstable_UserBlockingPriority,zv=r.unstable_NormalPriority,qR=r.unstable_IdlePriority,Rf=null,ks=null;function YR(f){if(ks&&typeof ks.onCommitFiberRoot=="function")try{ks.onCommitFiberRoot(Rf,f,void 0,(f.current.flags&128)===128)}catch{}}function $R(f,m){return f===m&&(f!==0||1/f===1/m)||f!==f&&m!==m}var Is=typeof Object.is=="function"?Object.is:$R,no=null,Lf=!1,Ov=!1;function sS(f){no===null?no=[f]:no.push(f)}function QR(f){Lf=!0,sS(f)}function Fs(){if(!Ov&&no!==null){Ov=!0;var f=0,m=tn;try{var _=no;for(tn=1;f<_.length;f++){var M=_[f];do M=M(!0);while(M!==null)}no=null,Lf=!1}catch(A){throw no!==null&&(no=no.slice(f+1)),Dv(Bv,Fs),A}finally{tn=m,Ov=!1}}return null}var ZR=a.ReactCurrentBatchConfig;function kf(f,m){if(Is(f,m))return!0;if(typeof f!="object"||f===null||typeof m!="object"||m===null)return!1;var _=Object.keys(f),M=Object.keys(m);if(_.length!==M.length)return!1;for(M=0;M<_.length;M++){var A=_[M];if(!Hn.call(m,A)||!Is(f[A],m[A]))return!1}return!0}function KR(f){switch(f.tag){case 5:return at(f.type);case 16:return at("Lazy");case 13:return at("Suspense");case 19:return at("SuspenseList");case 0:case 2:case 15:return f=wn(f.type,!1),f;case 11:return f=wn(f.type.render,!1),f;case 1:return f=wn(f.type,!0),f;default:return""}}function os(f,m){if(f&&f.defaultProps){m=s({},m),f=f.defaultProps;for(var _ in f)m[_]===void 0&&(m[_]=f[_]);return m}return m}var If=Dt(null),Ff=null,nc=null,Nv=null;function Uv(){Nv=nc=Ff=null}function oS(f,m,_){he?(yt(If,m._currentValue),m._currentValue=_):(yt(If,m._currentValue2),m._currentValue2=_)}function Hv(f){var m=If.current;Nt(If),he?f._currentValue=m:f._currentValue2=m}function Vv(f,m,_){for(;f!==null;){var M=f.alternate;if((f.childLanes&m)!==m?(f.childLanes|=m,M!==null&&(M.childLanes|=m)):M!==null&&(M.childLanes&m)!==m&&(M.childLanes|=m),f===_)break;f=f.return}}function ic(f,m){Ff=f,Nv=nc=null,f=f.dependencies,f!==null&&f.firstContext!==null&&((f.lanes&m)!==0&&(_r=!0),f.firstContext=null)}function Nr(f){var m=he?f._currentValue:f._currentValue2;if(Nv!==f)if(f={context:f,memoizedValue:m,next:null},nc===null){if(Ff===null)throw Error(o(308));nc=f,Ff.dependencies={lanes:0,firstContext:f}}else nc=nc.next=f;return m}var Ds=null,Uo=!1;function Gv(f){f.updateQueue={baseState:f.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function aS(f,m){f=f.updateQueue,m.updateQueue===f&&(m.updateQueue={baseState:f.baseState,firstBaseUpdate:f.firstBaseUpdate,lastBaseUpdate:f.lastBaseUpdate,shared:f.shared,effects:f.effects})}function io(f,m){return{eventTime:f,lane:m,tag:0,payload:null,callback:null,next:null}}function Ho(f,m){var _=f.updateQueue;_!==null&&(_=_.shared,ii!==null&&(f.mode&1)!==0&&(Ut&2)===0?(f=_.interleaved,f===null?(m.next=m,Ds===null?Ds=[_]:Ds.push(_)):(m.next=f.next,f.next=m),_.interleaved=m):(f=_.pending,f===null?m.next=m:(m.next=f.next,f.next=m),_.pending=m))}function Df(f,m,_){if(m=m.updateQueue,m!==null&&(m=m.shared,(_&4194240)!==0)){var M=m.lanes;M&=f.pendingLanes,_|=M,m.lanes=_,Fv(f,_)}}function lS(f,m){var _=f.updateQueue,M=f.alternate;if(M!==null&&(M=M.updateQueue,_===M)){var A=null,D=null;if(_=_.firstBaseUpdate,_!==null){do{var se={eventTime:_.eventTime,lane:_.lane,tag:_.tag,payload:_.payload,callback:_.callback,next:null};D===null?A=D=se:D=D.next=se,_=_.next}while(_!==null);D===null?A=D=m:D=D.next=m}else A=D=m;_={baseState:M.baseState,firstBaseUpdate:A,lastBaseUpdate:D,shared:M.shared,effects:M.effects},f.updateQueue=_;return}f=_.lastBaseUpdate,f===null?_.firstBaseUpdate=m:f.next=m,_.lastBaseUpdate=m}function Bf(f,m,_,M){var A=f.updateQueue;Uo=!1;var D=A.firstBaseUpdate,se=A.lastBaseUpdate,ve=A.shared.pending;if(ve!==null){A.shared.pending=null;var De=ve,rt=De.next;De.next=null,se===null?D=rt:se.next=rt,se=De;var gt=f.alternate;gt!==null&&(gt=gt.updateQueue,ve=gt.lastBaseUpdate,ve!==se&&(ve===null?gt.firstBaseUpdate=rt:ve.next=rt,gt.lastBaseUpdate=De))}if(D!==null){var It=A.baseState;se=0,gt=rt=De=null,ve=D;do{var bt=ve.lane,pn=ve.eventTime;if((M&bt)===bt){gt!==null&&(gt=gt.next={eventTime:pn,lane:0,tag:ve.tag,payload:ve.payload,callback:ve.callback,next:null});e:{var _t=f,Oi=ve;switch(bt=m,pn=_,Oi.tag){case 1:if(_t=Oi.payload,typeof _t=="function"){It=_t.call(pn,It,bt);break e}It=_t;break e;case 3:_t.flags=_t.flags&-65537|128;case 0:if(_t=Oi.payload,bt=typeof _t=="function"?_t.call(pn,It,bt):_t,bt==null)break e;It=s({},It,bt);break e;case 2:Uo=!0}}ve.callback!==null&&ve.lane!==0&&(f.flags|=64,bt=A.effects,bt===null?A.effects=[ve]:bt.push(ve))}else pn={eventTime:pn,lane:bt,tag:ve.tag,payload:ve.payload,callback:ve.callback,next:null},gt===null?(rt=gt=pn,De=It):gt=gt.next=pn,se|=bt;if(ve=ve.next,ve===null){if(ve=A.shared.pending,ve===null)break;bt=ve,ve=bt.next,bt.next=null,A.lastBaseUpdate=bt,A.shared.pending=null}}while(1);if(gt===null&&(De=It),A.baseState=De,A.firstBaseUpdate=rt,A.lastBaseUpdate=gt,m=A.shared.interleaved,m!==null){A=m;do se|=A.lane,A=A.next;while(A!==m)}else D===null&&(A.shared.lanes=0);dc|=se,f.lanes=se,f.memoizedState=It}}function cS(f,m,_){if(f=m.effects,m.effects=null,f!==null)for(m=0;m<f.length;m++){var M=f[m],A=M.callback;if(A!==null){if(M.callback=null,M=_,typeof A!="function")throw Error(o(191,A));A.call(M)}}}var uS=new n.Component().refs;function Wv(f,m,_,M){m=f.memoizedState,_=_(M,m),_=_==null?m:s({},m,_),f.memoizedState=_,f.lanes===0&&(f.updateQueue.baseState=_)}var zf={isMounted:function(f){return(f=f._reactInternals)?N(f)===f:!1},enqueueSetState:function(f,m,_){f=f._reactInternals;var M=qi(),A=Wo(f),D=io(M,A);D.payload=m,_!=null&&(D.callback=_),Ho(f,D),m=Wr(f,A,M),m!==null&&Df(m,f,A)},enqueueReplaceState:function(f,m,_){f=f._reactInternals;var M=qi(),A=Wo(f),D=io(M,A);D.tag=1,D.payload=m,_!=null&&(D.callback=_),Ho(f,D),m=Wr(f,A,M),m!==null&&Df(m,f,A)},enqueueForceUpdate:function(f,m){f=f._reactInternals;var _=qi(),M=Wo(f),A=io(_,M);A.tag=2,m!=null&&(A.callback=m),Ho(f,A),m=Wr(f,M,_),m!==null&&Df(m,f,M)}};function hS(f,m,_,M,A,D,se){return f=f.stateNode,typeof f.shouldComponentUpdate=="function"?f.shouldComponentUpdate(M,D,se):m.prototype&&m.prototype.isPureReactComponent?!kf(_,M)||!kf(A,D):!0}function dS(f,m,_){var M=!1,A=pi,D=m.contextType;return typeof D=="object"&&D!==null?D=Nr(D):(A=Pn(m)?_n:on.current,M=m.contextTypes,D=(M=M!=null)?li(f,A):pi),m=new m(_,D),f.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=zf,f.stateNode=m,m._reactInternals=f,M&&(f=f.stateNode,f.__reactInternalMemoizedUnmaskedChildContext=A,f.__reactInternalMemoizedMaskedChildContext=D),m}function fS(f,m,_,M){f=m.state,typeof m.componentWillReceiveProps=="function"&&m.componentWillReceiveProps(_,M),typeof m.UNSAFE_componentWillReceiveProps=="function"&&m.UNSAFE_componentWillReceiveProps(_,M),m.state!==f&&zf.enqueueReplaceState(m,m.state,null)}function jv(f,m,_,M){var A=f.stateNode;A.props=_,A.state=f.memoizedState,A.refs=uS,Gv(f);var D=m.contextType;typeof D=="object"&&D!==null?A.context=Nr(D):(D=Pn(m)?_n:on.current,A.context=li(f,D)),A.state=f.memoizedState,D=m.getDerivedStateFromProps,typeof D=="function"&&(Wv(f,m,D,_),A.state=f.memoizedState),typeof m.getDerivedStateFromProps=="function"||typeof A.getSnapshotBeforeUpdate=="function"||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(m=A.state,typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount(),m!==A.state&&zf.enqueueReplaceState(A,A.state,null),Bf(f,_,A,M),A.state=f.memoizedState),typeof A.componentDidMount=="function"&&(f.flags|=4194308)}var rc=[],sc=0,Of=null,Nf=0,Ur=[],Hr=0,Xa=null,ro=1,so="";function qa(f,m){rc[sc++]=Nf,rc[sc++]=Of,Of=f,Nf=m}function pS(f,m,_){Ur[Hr++]=ro,Ur[Hr++]=so,Ur[Hr++]=Xa,Xa=f;var M=ro;f=so;var A=32-yr(M)-1;M&=~(1<<A),_+=1;var D=32-yr(m)+A;if(30<D){var se=A-A%5;D=(M&(1<<se)-1).toString(32),M>>=se,A-=se,ro=1<<32-yr(m)+A|_<<A|M,so=D+f}else ro=1<<D|_<<A|M,so=f}function Xv(f){f.return!==null&&(qa(f,1),pS(f,1,0))}function qv(f){for(;f===Of;)Of=rc[--sc],rc[sc]=null,Nf=rc[--sc],rc[sc]=null;for(;f===Xa;)Xa=Ur[--Hr],Ur[Hr]=null,so=Ur[--Hr],Ur[Hr]=null,ro=Ur[--Hr],Ur[Hr]=null}var xr=null,wr=null,Rn=!1,hh=!1,as=null;function mS(f,m){var _=jr(5,null,null,0);_.elementType="DELETED",_.stateNode=m,_.return=f,m=f.deletions,m===null?(f.deletions=[_],f.flags|=16):m.push(_)}function gS(f,m){switch(f.tag){case 5:return m=Be(m,f.type,f.pendingProps),m!==null?(f.stateNode=m,xr=f,wr=ie(m),!0):!1;case 6:return m=Qe(m,f.pendingProps),m!==null?(f.stateNode=m,xr=f,wr=null,!0):!1;case 13:if(m=Ke(m),m!==null){var _=Xa!==null?{id:ro,overflow:so}:null;return f.memoizedState={dehydrated:m,treeContext:_,retryLane:1073741824},_=jr(18,null,null,0),_.stateNode=m,_.return=f,f.child=_,xr=f,wr=null,!0}return!1;default:return!1}}function Yv(f){return(f.mode&1)!==0&&(f.flags&128)===0}function $v(f){if(Rn){var m=wr;if(m){var _=m;if(!gS(f,m)){if(Yv(f))throw Error(o(418));m=ce(_);var M=xr;m&&gS(f,m)?mS(M,_):(f.flags=f.flags&-4097|2,Rn=!1,xr=f)}}else{if(Yv(f))throw Error(o(418));f.flags=f.flags&-4097|2,Rn=!1,xr=f}}}function vS(f){for(f=f.return;f!==null&&f.tag!==5&&f.tag!==3&&f.tag!==13;)f=f.return;xr=f}function dh(f){if(!fe||f!==xr)return!1;if(!Rn)return vS(f),Rn=!0,!1;if(f.tag!==3&&(f.tag!==5||Rt(f.type)&&!$(f.type,f.memoizedProps))){var m=wr;if(m){if(Yv(f)){for(f=wr;f;)f=ce(f);throw Error(o(418))}for(;m;)mS(f,m),m=ce(m)}}if(vS(f),f.tag===13){if(!fe)throw Error(o(316));if(f=f.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(o(317));wr=We(f)}else wr=xr?ce(f.stateNode):null;return!0}function oc(){fe&&(wr=xr=null,hh=Rn=!1)}function Qv(f){as===null?as=[f]:as.push(f)}function fh(f,m,_){if(f=_.ref,f!==null&&typeof f!="function"&&typeof f!="object"){if(_._owner){if(_=_._owner,_){if(_.tag!==1)throw Error(o(309));var M=_.stateNode}if(!M)throw Error(o(147,f));var A=M,D=""+f;return m!==null&&m.ref!==null&&typeof m.ref=="function"&&m.ref._stringRef===D?m.ref:(m=function(se){var ve=A.refs;ve===uS&&(ve=A.refs={}),se===null?delete ve[D]:ve[D]=se},m._stringRef=D,m)}if(typeof f!="string")throw Error(o(284));if(!_._owner)throw Error(o(290,f))}return f}function Uf(f,m){throw f=Object.prototype.toString.call(m),Error(o(31,f==="[object Object]"?"object with keys {"+Object.keys(m).join(", ")+"}":f))}function yS(f){var m=f._init;return m(f._payload)}function xS(f){function m(Pe,xe){if(f){var ke=Pe.deletions;ke===null?(Pe.deletions=[xe],Pe.flags|=16):ke.push(xe)}}function _(Pe,xe){if(!f)return null;for(;xe!==null;)m(Pe,xe),xe=xe.sibling;return null}function M(Pe,xe){for(Pe=new Map;xe!==null;)xe.key!==null?Pe.set(xe.key,xe):Pe.set(xe.index,xe),xe=xe.sibling;return Pe}function A(Pe,xe){return Pe=Xo(Pe,xe),Pe.index=0,Pe.sibling=null,Pe}function D(Pe,xe,ke){return Pe.index=ke,f?(ke=Pe.alternate,ke!==null?(ke=ke.index,ke<xe?(Pe.flags|=2,xe):ke):(Pe.flags|=2,xe)):(Pe.flags|=1048576,xe)}function se(Pe){return f&&Pe.alternate===null&&(Pe.flags|=2),Pe}function ve(Pe,xe,ke,ht){return xe===null||xe.tag!==6?(xe=I0(ke,Pe.mode,ht),xe.return=Pe,xe):(xe=A(xe,ke),xe.return=Pe,xe)}function De(Pe,xe,ke,ht){var wt=ke.type;return wt===d?gt(Pe,xe,ke.props.children,ht,ke.key):xe!==null&&(xe.elementType===wt||typeof wt=="object"&&wt!==null&&wt.$$typeof===S&&yS(wt)===xe.type)?(ht=A(xe,ke.props),ht.ref=fh(Pe,xe,ke),ht.return=Pe,ht):(ht=vp(ke.type,ke.key,ke.props,null,Pe.mode,ht),ht.ref=fh(Pe,xe,ke),ht.return=Pe,ht)}function rt(Pe,xe,ke,ht){return xe===null||xe.tag!==4||xe.stateNode.containerInfo!==ke.containerInfo||xe.stateNode.implementation!==ke.implementation?(xe=F0(ke,Pe.mode,ht),xe.return=Pe,xe):(xe=A(xe,ke.children||[]),xe.return=Pe,xe)}function gt(Pe,xe,ke,ht,wt){return xe===null||xe.tag!==7?(xe=el(ke,Pe.mode,ht,wt),xe.return=Pe,xe):(xe=A(xe,ke),xe.return=Pe,xe)}function It(Pe,xe,ke){if(typeof xe=="string"&&xe!==""||typeof xe=="number")return xe=I0(""+xe,Pe.mode,ke),xe.return=Pe,xe;if(typeof xe=="object"&&xe!==null){switch(xe.$$typeof){case c:return ke=vp(xe.type,xe.key,xe.props,null,Pe.mode,ke),ke.ref=fh(Pe,null,xe),ke.return=Pe,ke;case h:return xe=F0(xe,Pe.mode,ke),xe.return=Pe,xe;case S:var ht=xe._init;return It(Pe,ht(xe._payload),ke)}if(te(xe)||R(xe))return xe=el(xe,Pe.mode,ke,null),xe.return=Pe,xe;Uf(Pe,xe)}return null}function bt(Pe,xe,ke,ht){var wt=xe!==null?xe.key:null;if(typeof ke=="string"&&ke!==""||typeof ke=="number")return wt!==null?null:ve(Pe,xe,""+ke,ht);if(typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case c:return ke.key===wt?De(Pe,xe,ke,ht):null;case h:return ke.key===wt?rt(Pe,xe,ke,ht):null;case S:return wt=ke._init,bt(Pe,xe,wt(ke._payload),ht)}if(te(ke)||R(ke))return wt!==null?null:gt(Pe,xe,ke,ht,null);Uf(Pe,ke)}return null}function pn(Pe,xe,ke,ht,wt){if(typeof ht=="string"&&ht!==""||typeof ht=="number")return Pe=Pe.get(ke)||null,ve(xe,Pe,""+ht,wt);if(typeof ht=="object"&&ht!==null){switch(ht.$$typeof){case c:return Pe=Pe.get(ht.key===null?ke:ht.key)||null,De(xe,Pe,ht,wt);case h:return Pe=Pe.get(ht.key===null?ke:ht.key)||null,rt(xe,Pe,ht,wt);case S:var Ot=ht._init;return pn(Pe,xe,ke,Ot(ht._payload),wt)}if(te(ht)||R(ht))return Pe=Pe.get(ke)||null,gt(xe,Pe,ht,wt,null);Uf(xe,ht)}return null}function _t(Pe,xe,ke,ht){for(var wt=null,Ot=null,Ft=xe,nn=xe=0,vi=null;Ft!==null&&nn<ke.length;nn++){Ft.index>nn?(vi=Ft,Ft=null):vi=Ft.sibling;var rn=bt(Pe,Ft,ke[nn],ht);if(rn===null){Ft===null&&(Ft=vi);break}f&&Ft&&rn.alternate===null&&m(Pe,Ft),xe=D(rn,xe,nn),Ot===null?wt=rn:Ot.sibling=rn,Ot=rn,Ft=vi}if(nn===ke.length)return _(Pe,Ft),Rn&&qa(Pe,nn),wt;if(Ft===null){for(;nn<ke.length;nn++)Ft=It(Pe,ke[nn],ht),Ft!==null&&(xe=D(Ft,xe,nn),Ot===null?wt=Ft:Ot.sibling=Ft,Ot=Ft);return Rn&&qa(Pe,nn),wt}for(Ft=M(Pe,Ft);nn<ke.length;nn++)vi=pn(Ft,Pe,nn,ke[nn],ht),vi!==null&&(f&&vi.alternate!==null&&Ft.delete(vi.key===null?nn:vi.key),xe=D(vi,xe,nn),Ot===null?wt=vi:Ot.sibling=vi,Ot=vi);return f&&Ft.forEach(function(qo){return m(Pe,qo)}),Rn&&qa(Pe,nn),wt}function Oi(Pe,xe,ke,ht){var wt=R(ke);if(typeof wt!="function")throw Error(o(150));if(ke=wt.call(ke),ke==null)throw Error(o(151));for(var Ot=wt=null,Ft=xe,nn=xe=0,vi=null,rn=ke.next();Ft!==null&&!rn.done;nn++,rn=ke.next()){Ft.index>nn?(vi=Ft,Ft=null):vi=Ft.sibling;var qo=bt(Pe,Ft,rn.value,ht);if(qo===null){Ft===null&&(Ft=vi);break}f&&Ft&&qo.alternate===null&&m(Pe,Ft),xe=D(qo,xe,nn),Ot===null?wt=qo:Ot.sibling=qo,Ot=qo,Ft=vi}if(rn.done)return _(Pe,Ft),Rn&&qa(Pe,nn),wt;if(Ft===null){for(;!rn.done;nn++,rn=ke.next())rn=It(Pe,rn.value,ht),rn!==null&&(xe=D(rn,xe,nn),Ot===null?wt=rn:Ot.sibling=rn,Ot=rn);return Rn&&qa(Pe,nn),wt}for(Ft=M(Pe,Ft);!rn.done;nn++,rn=ke.next())rn=pn(Ft,Pe,nn,rn.value,ht),rn!==null&&(f&&rn.alternate!==null&&Ft.delete(rn.key===null?nn:rn.key),xe=D(rn,xe,nn),Ot===null?wt=rn:Ot.sibling=rn,Ot=rn);return f&&Ft.forEach(function(CL){return m(Pe,CL)}),Rn&&qa(Pe,nn),wt}function Xr(Pe,xe,ke,ht){if(typeof ke=="object"&&ke!==null&&ke.type===d&&ke.key===null&&(ke=ke.props.children),typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case c:e:{for(var wt=ke.key,Ot=xe;Ot!==null;){if(Ot.key===wt){if(wt=ke.type,wt===d){if(Ot.tag===7){_(Pe,Ot.sibling),xe=A(Ot,ke.props.children),xe.return=Pe,Pe=xe;break e}}else if(Ot.elementType===wt||typeof wt=="object"&&wt!==null&&wt.$$typeof===S&&yS(wt)===Ot.type){_(Pe,Ot.sibling),xe=A(Ot,ke.props),xe.ref=fh(Pe,Ot,ke),xe.return=Pe,Pe=xe;break e}_(Pe,Ot);break}else m(Pe,Ot);Ot=Ot.sibling}ke.type===d?(xe=el(ke.props.children,Pe.mode,ht,ke.key),xe.return=Pe,Pe=xe):(ht=vp(ke.type,ke.key,ke.props,null,Pe.mode,ht),ht.ref=fh(Pe,xe,ke),ht.return=Pe,Pe=ht)}return se(Pe);case h:e:{for(Ot=ke.key;xe!==null;){if(xe.key===Ot)if(xe.tag===4&&xe.stateNode.containerInfo===ke.containerInfo&&xe.stateNode.implementation===ke.implementation){_(Pe,xe.sibling),xe=A(xe,ke.children||[]),xe.return=Pe,Pe=xe;break e}else{_(Pe,xe);break}else m(Pe,xe);xe=xe.sibling}xe=F0(ke,Pe.mode,ht),xe.return=Pe,Pe=xe}return se(Pe);case S:return Ot=ke._init,Xr(Pe,xe,Ot(ke._payload),ht)}if(te(ke))return _t(Pe,xe,ke,ht);if(R(ke))return Oi(Pe,xe,ke,ht);Uf(Pe,ke)}return typeof ke=="string"&&ke!==""||typeof ke=="number"?(ke=""+ke,xe!==null&&xe.tag===6?(_(Pe,xe.sibling),xe=A(xe,ke),xe.return=Pe,Pe=xe):(_(Pe,xe),xe=I0(ke,Pe.mode,ht),xe.return=Pe,Pe=xe),se(Pe)):_(Pe,xe)}return Xr}var ac=xS(!0),wS=xS(!1),ph={},Vr=Dt(ph),mh=Dt(ph),lc=Dt(ph);function Bs(f){if(f===ph)throw Error(o(174));return f}function Zv(f,m){yt(lc,m),yt(mh,f),yt(Vr,ph),f=j(m),Nt(Vr),yt(Vr,f)}function cc(){Nt(Vr),Nt(mh),Nt(lc)}function _S(f){var m=Bs(lc.current),_=Bs(Vr.current);m=k(_,f.type,m),_!==m&&(yt(mh,f),yt(Vr,m))}function Kv(f){mh.current===f&&(Nt(Vr),Nt(mh))}var Dn=Dt(0);function Hf(f){for(var m=f;m!==null;){if(m.tag===13){var _=m.memoizedState;if(_!==null&&(_=_.dehydrated,_===null||Q(_)||le(_)))return m}else if(m.tag===19&&m.memoizedProps.revealOrder!==void 0){if((m.flags&128)!==0)return m}else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===f)break;for(;m.sibling===null;){if(m.return===null||m.return===f)return null;m=m.return}m.sibling.return=m.return,m=m.sibling}return null}var Jv=[];function e0(){for(var f=0;f<Jv.length;f++){var m=Jv[f];he?m._workInProgressVersionPrimary=null:m._workInProgressVersionSecondary=null}Jv.length=0}var Vf=a.ReactCurrentDispatcher,Gr=a.ReactCurrentBatchConfig,uc=0,Vn=null,Di=null,gi=null,Gf=!1,gh=!1,vh=0,JR=0;function Bi(){throw Error(o(321))}function t0(f,m){if(m===null)return!1;for(var _=0;_<m.length&&_<f.length;_++)if(!Is(f[_],m[_]))return!1;return!0}function n0(f,m,_,M,A,D){if(uc=D,Vn=m,m.memoizedState=null,m.updateQueue=null,m.lanes=0,Vf.current=f===null||f.memoizedState===null?iL:rL,f=_(M,A),gh){D=0;do{if(gh=!1,vh=0,25<=D)throw Error(o(301));D+=1,gi=Di=null,m.updateQueue=null,Vf.current=sL,f=_(M,A)}while(gh)}if(Vf.current=Yf,m=Di!==null&&Di.next!==null,uc=0,gi=Di=Vn=null,Gf=!1,m)throw Error(o(300));return f}function i0(){var f=vh!==0;return vh=0,f}function oo(){var f={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return gi===null?Vn.memoizedState=gi=f:gi=gi.next=f,gi}function zs(){if(Di===null){var f=Vn.alternate;f=f!==null?f.memoizedState:null}else f=Di.next;var m=gi===null?Vn.memoizedState:gi.next;if(m!==null)gi=m,Di=f;else{if(f===null)throw Error(o(310));Di=f,f={memoizedState:Di.memoizedState,baseState:Di.baseState,baseQueue:Di.baseQueue,queue:Di.queue,next:null},gi===null?Vn.memoizedState=gi=f:gi=gi.next=f}return gi}function Ya(f,m){return typeof m=="function"?m(f):m}function Wf(f){var m=zs(),_=m.queue;if(_===null)throw Error(o(311));_.lastRenderedReducer=f;var M=Di,A=M.baseQueue,D=_.pending;if(D!==null){if(A!==null){var se=A.next;A.next=D.next,D.next=se}M.baseQueue=A=D,_.pending=null}if(A!==null){D=A.next,M=M.baseState;var ve=se=null,De=null,rt=D;do{var gt=rt.lane;if((uc&gt)===gt)De!==null&&(De=De.next={lane:0,action:rt.action,hasEagerState:rt.hasEagerState,eagerState:rt.eagerState,next:null}),M=rt.hasEagerState?rt.eagerState:f(M,rt.action);else{var It={lane:gt,action:rt.action,hasEagerState:rt.hasEagerState,eagerState:rt.eagerState,next:null};De===null?(ve=De=It,se=M):De=De.next=It,Vn.lanes|=gt,dc|=gt}rt=rt.next}while(rt!==null&&rt!==D);De===null?se=M:De.next=ve,Is(M,m.memoizedState)||(_r=!0),m.memoizedState=M,m.baseState=se,m.baseQueue=De,_.lastRenderedState=M}if(f=_.interleaved,f!==null){A=f;do D=A.lane,Vn.lanes|=D,dc|=D,A=A.next;while(A!==f)}else A===null&&(_.lanes=0);return[m.memoizedState,_.dispatch]}function jf(f){var m=zs(),_=m.queue;if(_===null)throw Error(o(311));_.lastRenderedReducer=f;var M=_.dispatch,A=_.pending,D=m.memoizedState;if(A!==null){_.pending=null;var se=A=A.next;do D=f(D,se.action),se=se.next;while(se!==A);Is(D,m.memoizedState)||(_r=!0),m.memoizedState=D,m.baseQueue===null&&(m.baseState=D),_.lastRenderedState=D}return[D,M]}function SS(){}function bS(f,m){var _=Vn,M=zs(),A=m(),D=!Is(M.memoizedState,A);if(D&&(M.memoizedState=A,_r=!0),M=M.queue,xh(TS.bind(null,_,M,f),[f]),M.getSnapshot!==m||D||gi!==null&&gi.memoizedState.tag&1){if(_.flags|=2048,yh(9,ES.bind(null,_,M,A,m),void 0,null),ii===null)throw Error(o(349));(uc&30)!==0||MS(_,m,A)}return A}function MS(f,m,_){f.flags|=16384,f={getSnapshot:m,value:_},m=Vn.updateQueue,m===null?(m={lastEffect:null,stores:null},Vn.updateQueue=m,m.stores=[f]):(_=m.stores,_===null?m.stores=[f]:_.push(f))}function ES(f,m,_,M){m.value=_,m.getSnapshot=M,AS(m)&&Wr(f,1,-1)}function TS(f,m,_){return _(function(){AS(m)&&Wr(f,1,-1)})}function AS(f){var m=f.getSnapshot;f=f.value;try{var _=m();return!Is(f,_)}catch{return!0}}function r0(f){var m=oo();return typeof f=="function"&&(f=f()),m.memoizedState=m.baseState=f,f={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ya,lastRenderedState:f},m.queue=f,f=f.dispatch=nL.bind(null,Vn,f),[m.memoizedState,f]}function yh(f,m,_,M){return f={tag:f,create:m,destroy:_,deps:M,next:null},m=Vn.updateQueue,m===null?(m={lastEffect:null,stores:null},Vn.updateQueue=m,m.lastEffect=f.next=f):(_=m.lastEffect,_===null?m.lastEffect=f.next=f:(M=_.next,_.next=f,f.next=M,m.lastEffect=f)),f}function CS(){return zs().memoizedState}function Xf(f,m,_,M){var A=oo();Vn.flags|=f,A.memoizedState=yh(1|m,_,void 0,M===void 0?null:M)}function qf(f,m,_,M){var A=zs();M=M===void 0?null:M;var D=void 0;if(Di!==null){var se=Di.memoizedState;if(D=se.destroy,M!==null&&t0(M,se.deps)){A.memoizedState=yh(m,_,D,M);return}}Vn.flags|=f,A.memoizedState=yh(1|m,_,D,M)}function s0(f,m){return Xf(8390656,8,f,m)}function xh(f,m){return qf(2048,8,f,m)}function PS(f,m){return qf(4,2,f,m)}function RS(f,m){return qf(4,4,f,m)}function LS(f,m){if(typeof m=="function")return f=f(),m(f),function(){m(null)};if(m!=null)return f=f(),m.current=f,function(){m.current=null}}function kS(f,m,_){return _=_!=null?_.concat([f]):null,qf(4,4,LS.bind(null,m,f),_)}function o0(){}function IS(f,m){var _=zs();m=m===void 0?null:m;var M=_.memoizedState;return M!==null&&m!==null&&t0(m,M[1])?M[0]:(_.memoizedState=[f,m],f)}function FS(f,m){var _=zs();m=m===void 0?null:m;var M=_.memoizedState;return M!==null&&m!==null&&t0(m,M[1])?M[0]:(f=f(),_.memoizedState=[f,m],f)}function eL(f,m){var _=tn;tn=_!==0&&4>_?_:4,f(!0);var M=Gr.transition;Gr.transition={};try{f(!1),m()}finally{tn=_,Gr.transition=M}}function DS(){return zs().memoizedState}function tL(f,m,_){var M=Wo(f);_={lane:M,action:_,hasEagerState:!1,eagerState:null,next:null},BS(f)?zS(m,_):(OS(f,m,_),_=qi(),f=Wr(f,M,_),f!==null&&NS(f,m,M))}function nL(f,m,_){var M=Wo(f),A={lane:M,action:_,hasEagerState:!1,eagerState:null,next:null};if(BS(f))zS(m,A);else{OS(f,m,A);var D=f.alternate;if(f.lanes===0&&(D===null||D.lanes===0)&&(D=m.lastRenderedReducer,D!==null))try{var se=m.lastRenderedState,ve=D(se,_);if(A.hasEagerState=!0,A.eagerState=ve,Is(ve,se))return}catch{}finally{}_=qi(),f=Wr(f,M,_),f!==null&&NS(f,m,M)}}function BS(f){var m=f.alternate;return f===Vn||m!==null&&m===Vn}function zS(f,m){gh=Gf=!0;var _=f.pending;_===null?m.next=m:(m.next=_.next,_.next=m),f.pending=m}function OS(f,m,_){ii!==null&&(f.mode&1)!==0&&(Ut&2)===0?(f=m.interleaved,f===null?(_.next=_,Ds===null?Ds=[m]:Ds.push(m)):(_.next=f.next,f.next=_),m.interleaved=_):(f=m.pending,f===null?_.next=_:(_.next=f.next,f.next=_),m.pending=_)}function NS(f,m,_){if((_&4194240)!==0){var M=m.lanes;M&=f.pendingLanes,_|=M,m.lanes=_,Fv(f,_)}}var Yf={readContext:Nr,useCallback:Bi,useContext:Bi,useEffect:Bi,useImperativeHandle:Bi,useInsertionEffect:Bi,useLayoutEffect:Bi,useMemo:Bi,useReducer:Bi,useRef:Bi,useState:Bi,useDebugValue:Bi,useDeferredValue:Bi,useTransition:Bi,useMutableSource:Bi,useSyncExternalStore:Bi,useId:Bi,unstable_isNewReconciler:!1},iL={readContext:Nr,useCallback:function(f,m){return oo().memoizedState=[f,m===void 0?null:m],f},useContext:Nr,useEffect:s0,useImperativeHandle:function(f,m,_){return _=_!=null?_.concat([f]):null,Xf(4194308,4,LS.bind(null,m,f),_)},useLayoutEffect:function(f,m){return Xf(4194308,4,f,m)},useInsertionEffect:function(f,m){return Xf(4,2,f,m)},useMemo:function(f,m){var _=oo();return m=m===void 0?null:m,f=f(),_.memoizedState=[f,m],f},useReducer:function(f,m,_){var M=oo();return m=_!==void 0?_(m):m,M.memoizedState=M.baseState=m,f={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:f,lastRenderedState:m},M.queue=f,f=f.dispatch=tL.bind(null,Vn,f),[M.memoizedState,f]},useRef:function(f){var m=oo();return f={current:f},m.memoizedState=f},useState:r0,useDebugValue:o0,useDeferredValue:function(f){var m=r0(f),_=m[0],M=m[1];return s0(function(){var A=Gr.transition;Gr.transition={};try{M(f)}finally{Gr.transition=A}},[f]),_},useTransition:function(){var f=r0(!1),m=f[0];return f=eL.bind(null,f[1]),oo().memoizedState=f,[m,f]},useMutableSource:function(){},useSyncExternalStore:function(f,m,_){var M=Vn,A=oo();if(Rn){if(_===void 0)throw Error(o(407));_=_()}else{if(_=m(),ii===null)throw Error(o(349));(uc&30)!==0||MS(M,m,_)}A.memoizedState=_;var D={value:_,getSnapshot:m};return A.queue=D,s0(TS.bind(null,M,D,f),[f]),M.flags|=2048,yh(9,ES.bind(null,M,D,_,m),void 0,null),_},useId:function(){var f=oo(),m=ii.identifierPrefix;if(Rn){var _=so,M=ro;_=(M&~(1<<32-yr(M)-1)).toString(32)+_,m=":"+m+"R"+_,_=vh++,0<_&&(m+="H"+_.toString(32)),m+=":"}else _=JR++,m=":"+m+"r"+_.toString(32)+":";return f.memoizedState=m},unstable_isNewReconciler:!1},rL={readContext:Nr,useCallback:IS,useContext:Nr,useEffect:xh,useImperativeHandle:kS,useInsertionEffect:PS,useLayoutEffect:RS,useMemo:FS,useReducer:Wf,useRef:CS,useState:function(){return Wf(Ya)},useDebugValue:o0,useDeferredValue:function(f){var m=Wf(Ya),_=m[0],M=m[1];return xh(function(){var A=Gr.transition;Gr.transition={};try{M(f)}finally{Gr.transition=A}},[f]),_},useTransition:function(){var f=Wf(Ya)[0],m=zs().memoizedState;return[f,m]},useMutableSource:SS,useSyncExternalStore:bS,useId:DS,unstable_isNewReconciler:!1},sL={readContext:Nr,useCallback:IS,useContext:Nr,useEffect:xh,useImperativeHandle:kS,useInsertionEffect:PS,useLayoutEffect:RS,useMemo:FS,useReducer:jf,useRef:CS,useState:function(){return jf(Ya)},useDebugValue:o0,useDeferredValue:function(f){var m=jf(Ya),_=m[0],M=m[1];return xh(function(){var A=Gr.transition;Gr.transition={};try{M(f)}finally{Gr.transition=A}},[f]),_},useTransition:function(){var f=jf(Ya)[0],m=zs().memoizedState;return[f,m]},useMutableSource:SS,useSyncExternalStore:bS,useId:DS,unstable_isNewReconciler:!1};function a0(f,m){try{var _="",M=m;do _+=KR(M),M=M.return;while(M);var A=_}catch(D){A=`
Error generating stack: `+D.message+`
`+D.stack}return{value:f,source:m,stack:A}}function l0(f,m){try{console.error(m.value)}catch(_){setTimeout(function(){throw _})}}var oL=typeof WeakMap=="function"?WeakMap:Map;function US(f,m,_){_=io(-1,_),_.tag=3,_.payload={element:null};var M=m.value;return _.callback=function(){up||(up=!0,T0=M),l0(f,m)},_}function HS(f,m,_){_=io(-1,_),_.tag=3;var M=f.type.getDerivedStateFromError;if(typeof M=="function"){var A=m.value;_.payload=function(){return M(A)},_.callback=function(){l0(f,m)}}var D=f.stateNode;return D!==null&&typeof D.componentDidCatch=="function"&&(_.callback=function(){l0(f,m),typeof M!="function"&&(Vo===null?Vo=new Set([this]):Vo.add(this));var se=m.stack;this.componentDidCatch(m.value,{componentStack:se!==null?se:""})}),_}function VS(f,m,_){var M=f.pingCache;if(M===null){M=f.pingCache=new oL;var A=new Set;M.set(m,A)}else A=M.get(m),A===void 0&&(A=new Set,M.set(m,A));A.has(_)||(A.add(_),f=wL.bind(null,f,m,_),m.then(f,f))}function GS(f){do{var m;if((m=f.tag===13)&&(m=f.memoizedState,m=m!==null?m.dehydrated!==null:!0),m)return f;f=f.return}while(f!==null);return null}function WS(f,m,_,M,A){return(f.mode&1)===0?(f===m?f.flags|=65536:(f.flags|=128,_.flags|=131072,_.flags&=-52805,_.tag===1&&(_.alternate===null?_.tag=17:(m=io(-1,1),m.tag=2,Ho(_,m))),_.lanes|=1),f):(f.flags|=65536,f.lanes=A,f)}function Os(f){f.flags|=4}function jS(f,m){if(f!==null&&f.child===m.child)return!0;if((m.flags&16)!==0)return!1;for(f=m.child;f!==null;){if((f.flags&12854)!==0||(f.subtreeFlags&12854)!==0)return!1;f=f.sibling}return!0}var wh,_h,$f,Qf;if(Ce)wh=function(f,m){for(var _=m.child;_!==null;){if(_.tag===5||_.tag===6)J(f,_.stateNode);else if(_.tag!==4&&_.child!==null){_.child.return=_,_=_.child;continue}if(_===m)break;for(;_.sibling===null;){if(_.return===null||_.return===m)return;_=_.return}_.sibling.return=_.return,_=_.sibling}},_h=function(){},$f=function(f,m,_,M,A){if(f=f.memoizedProps,f!==M){var D=m.stateNode,se=Bs(Vr.current);_=ee(D,_,f,M,A,se),(m.updateQueue=_)&&Os(m)}},Qf=function(f,m,_,M){_!==M&&Os(m)};else if(me){wh=function(f,m,_,M){for(var A=m.child;A!==null;){if(A.tag===5){var D=A.stateNode;_&&M&&(D=sn(D,A.type,A.memoizedProps,A)),J(f,D)}else if(A.tag===6)D=A.stateNode,_&&M&&(D=Le(D,A.memoizedProps,A)),J(f,D);else if(A.tag!==4){if(A.tag===22&&A.memoizedState!==null)D=A.child,D!==null&&(D.return=A),wh(f,A,!0,!0);else if(A.child!==null){A.child.return=A,A=A.child;continue}}if(A===m)break;for(;A.sibling===null;){if(A.return===null||A.return===m)return;A=A.return}A.sibling.return=A.return,A=A.sibling}};var XS=function(f,m,_,M){for(var A=m.child;A!==null;){if(A.tag===5){var D=A.stateNode;_&&M&&(D=sn(D,A.type,A.memoizedProps,A)),Un(f,D)}else if(A.tag===6)D=A.stateNode,_&&M&&(D=Le(D,A.memoizedProps,A)),Un(f,D);else if(A.tag!==4){if(A.tag===22&&A.memoizedState!==null)D=A.child,D!==null&&(D.return=A),XS(f,A,!0,!0);else if(A.child!==null){A.child.return=A,A=A.child;continue}}if(A===m)break;for(;A.sibling===null;){if(A.return===null||A.return===m)return;A=A.return}A.sibling.return=A.return,A=A.sibling}};_h=function(f,m){var _=m.stateNode;if(!jS(f,m)){f=_.containerInfo;var M=Cn(f);XS(M,m,!1,!1),_.pendingChildren=M,Os(m),Fn(f,M)}},$f=function(f,m,_,M,A){var D=f.stateNode,se=f.memoizedProps;if((f=jS(f,m))&&se===M)m.stateNode=D;else{var ve=m.stateNode,De=Bs(Vr.current),rt=null;se!==M&&(rt=ee(ve,_,se,M,A,De)),f&&rt===null?m.stateNode=D:(D=Xn(D,rt,_,se,M,m,f,ve),K(D,_,M,A,De)&&Os(m),m.stateNode=D,f?Os(m):wh(D,m,!1,!1))}},Qf=function(f,m,_,M){_!==M?(f=Bs(lc.current),_=Bs(Vr.current),m.stateNode=Z(M,f,_,m),Os(m)):m.stateNode=f.stateNode}}else _h=function(){},$f=function(){},Qf=function(){};function Sh(f,m){if(!Rn)switch(f.tailMode){case"hidden":m=f.tail;for(var _=null;m!==null;)m.alternate!==null&&(_=m),m=m.sibling;_===null?f.tail=null:_.sibling=null;break;case"collapsed":_=f.tail;for(var M=null;_!==null;)_.alternate!==null&&(M=_),_=_.sibling;M===null?m||f.tail===null?f.tail=null:f.tail.sibling=null:M.sibling=null}}function zi(f){var m=f.alternate!==null&&f.alternate.child===f.child,_=0,M=0;if(m)for(var A=f.child;A!==null;)_|=A.lanes|A.childLanes,M|=A.subtreeFlags&14680064,M|=A.flags&14680064,A.return=f,A=A.sibling;else for(A=f.child;A!==null;)_|=A.lanes|A.childLanes,M|=A.subtreeFlags,M|=A.flags,A.return=f,A=A.sibling;return f.subtreeFlags|=M,f.childLanes=_,m}function aL(f,m,_){var M=m.pendingProps;switch(qv(m),m.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return zi(m),null;case 1:return Pn(m.type)&&At(),zi(m),null;case 3:return M=m.stateNode,cc(),Nt(an),Nt(on),e0(),M.pendingContext&&(M.context=M.pendingContext,M.pendingContext=null),(f===null||f.child===null)&&(dh(m)?Os(m):f===null||f.memoizedState.isDehydrated&&(m.flags&256)===0||(m.flags|=1024,as!==null&&(P0(as),as=null))),_h(f,m),zi(m),null;case 5:Kv(m),_=Bs(lc.current);var A=m.type;if(f!==null&&m.stateNode!=null)$f(f,m,A,M,_),f.ref!==m.ref&&(m.flags|=512,m.flags|=2097152);else{if(!M){if(m.stateNode===null)throw Error(o(166));return zi(m),null}if(f=Bs(Vr.current),dh(m)){if(!fe)throw Error(o(175));f=Ye(m.stateNode,m.type,m.memoizedProps,_,f,m,!hh),m.updateQueue=f,f!==null&&Os(m)}else{var D=H(A,M,_,f,m);wh(D,m,!1,!1),m.stateNode=D,K(D,A,M,_,f)&&Os(m)}m.ref!==null&&(m.flags|=512,m.flags|=2097152)}return zi(m),null;case 6:if(f&&m.stateNode!=null)Qf(f,m,f.memoizedProps,M);else{if(typeof M!="string"&&m.stateNode===null)throw Error(o(166));if(f=Bs(lc.current),_=Bs(Vr.current),dh(m)){if(!fe)throw Error(o(176));if(f=m.stateNode,M=m.memoizedProps,(_=Oe(f,M,m,!hh))&&(A=xr,A!==null))switch(D=(A.mode&1)!==0,A.tag){case 3:Qt(A.stateNode.containerInfo,f,M,D);break;case 5:dt(A.type,A.memoizedProps,A.stateNode,f,M,D)}_&&Os(m)}else m.stateNode=Z(M,f,_,m)}return zi(m),null;case 13:if(Nt(Dn),M=m.memoizedState,Rn&&wr!==null&&(m.mode&1)!==0&&(m.flags&128)===0){for(f=wr;f;)f=ce(f);return oc(),m.flags|=98560,m}if(M!==null&&M.dehydrated!==null){if(M=dh(m),f===null){if(!M)throw Error(o(318));if(!fe)throw Error(o(344));if(f=m.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(o(317));He(f,m)}else oc(),(m.flags&128)===0&&(m.memoizedState=null),m.flags|=4;return zi(m),null}return as!==null&&(P0(as),as=null),(m.flags&128)!==0?(m.lanes=_,m):(M=M!==null,_=!1,f===null?dh(m):_=f.memoizedState!==null,M&&!_&&(m.child.flags|=8192,(m.mode&1)!==0&&(f===null||(Dn.current&1)!==0?ci===0&&(ci=3):L0())),m.updateQueue!==null&&(m.flags|=4),zi(m),null);case 4:return cc(),_h(f,m),f===null&&ye(m.stateNode.containerInfo),zi(m),null;case 10:return Hv(m.type._context),zi(m),null;case 17:return Pn(m.type)&&At(),zi(m),null;case 19:if(Nt(Dn),A=m.memoizedState,A===null)return zi(m),null;if(M=(m.flags&128)!==0,D=A.rendering,D===null)if(M)Sh(A,!1);else{if(ci!==0||f!==null&&(f.flags&128)!==0)for(f=m.child;f!==null;){if(D=Hf(f),D!==null){for(m.flags|=128,Sh(A,!1),f=D.updateQueue,f!==null&&(m.updateQueue=f,m.flags|=4),m.subtreeFlags=0,f=_,M=m.child;M!==null;)_=M,A=f,_.flags&=14680066,D=_.alternate,D===null?(_.childLanes=0,_.lanes=A,_.child=null,_.subtreeFlags=0,_.memoizedProps=null,_.memoizedState=null,_.updateQueue=null,_.dependencies=null,_.stateNode=null):(_.childLanes=D.childLanes,_.lanes=D.lanes,_.child=D.child,_.subtreeFlags=0,_.deletions=null,_.memoizedProps=D.memoizedProps,_.memoizedState=D.memoizedState,_.updateQueue=D.updateQueue,_.type=D.type,A=D.dependencies,_.dependencies=A===null?null:{lanes:A.lanes,firstContext:A.firstContext}),M=M.sibling;return yt(Dn,Dn.current&1|2),m.child}f=f.sibling}A.tail!==null&&mi()>E0&&(m.flags|=128,M=!0,Sh(A,!1),m.lanes=4194304)}else{if(!M)if(f=Hf(D),f!==null){if(m.flags|=128,M=!0,f=f.updateQueue,f!==null&&(m.updateQueue=f,m.flags|=4),Sh(A,!0),A.tail===null&&A.tailMode==="hidden"&&!D.alternate&&!Rn)return zi(m),null}else 2*mi()-A.renderingStartTime>E0&&_!==1073741824&&(m.flags|=128,M=!0,Sh(A,!1),m.lanes=4194304);A.isBackwards?(D.sibling=m.child,m.child=D):(f=A.last,f!==null?f.sibling=D:m.child=D,A.last=D)}return A.tail!==null?(m=A.tail,A.rendering=m,A.tail=m.sibling,A.renderingStartTime=mi(),m.sibling=null,f=Dn.current,yt(Dn,M?f&1|2:f&1),m):(zi(m),null);case 22:case 23:return R0(),M=m.memoizedState!==null,f!==null&&f.memoizedState!==null!==M&&(m.flags|=8192),M&&(m.mode&1)!==0?(Sr&1073741824)!==0&&(zi(m),Ce&&m.subtreeFlags&6&&(m.flags|=8192)):zi(m),null;case 24:return null;case 25:return null}throw Error(o(156,m.tag))}var lL=a.ReactCurrentOwner,_r=!1;function Xi(f,m,_,M){m.child=f===null?wS(m,null,_,M):ac(m,f.child,_,M)}function qS(f,m,_,M,A){_=_.render;var D=m.ref;return ic(m,A),M=n0(f,m,_,M,D,A),_=i0(),f!==null&&!_r?(m.updateQueue=f.updateQueue,m.flags&=-2053,f.lanes&=~A,ao(f,m,A)):(Rn&&_&&Xv(m),m.flags|=1,Xi(f,m,M,A),m.child)}function YS(f,m,_,M,A){if(f===null){var D=_.type;return typeof D=="function"&&!k0(D)&&D.defaultProps===void 0&&_.compare===null&&_.defaultProps===void 0?(m.tag=15,m.type=D,$S(f,m,D,M,A)):(f=vp(_.type,null,M,m,m.mode,A),f.ref=m.ref,f.return=m,m.child=f)}if(D=f.child,(f.lanes&A)===0){var se=D.memoizedProps;if(_=_.compare,_=_!==null?_:kf,_(se,M)&&f.ref===m.ref)return ao(f,m,A)}return m.flags|=1,f=Xo(D,M),f.ref=m.ref,f.return=m,m.child=f}function $S(f,m,_,M,A){if(f!==null&&kf(f.memoizedProps,M)&&f.ref===m.ref)if(_r=!1,(f.lanes&A)!==0)(f.flags&131072)!==0&&(_r=!0);else return m.lanes=f.lanes,ao(f,m,A);return c0(f,m,_,M,A)}function QS(f,m,_){var M=m.pendingProps,A=M.children,D=f!==null?f.memoizedState:null;if(M.mode==="hidden")if((m.mode&1)===0)m.memoizedState={baseLanes:0,cachePool:null},yt(hc,Sr),Sr|=_;else if((_&1073741824)!==0)m.memoizedState={baseLanes:0,cachePool:null},M=D!==null?D.baseLanes:_,yt(hc,Sr),Sr|=M;else return f=D!==null?D.baseLanes|_:_,m.lanes=m.childLanes=1073741824,m.memoizedState={baseLanes:f,cachePool:null},m.updateQueue=null,yt(hc,Sr),Sr|=f,null;else D!==null?(M=D.baseLanes|_,m.memoizedState=null):M=_,yt(hc,Sr),Sr|=M;return Xi(f,m,A,_),m.child}function ZS(f,m){var _=m.ref;(f===null&&_!==null||f!==null&&f.ref!==_)&&(m.flags|=512,m.flags|=2097152)}function c0(f,m,_,M,A){var D=Pn(_)?_n:on.current;return D=li(m,D),ic(m,A),_=n0(f,m,_,M,D,A),M=i0(),f!==null&&!_r?(m.updateQueue=f.updateQueue,m.flags&=-2053,f.lanes&=~A,ao(f,m,A)):(Rn&&M&&Xv(m),m.flags|=1,Xi(f,m,_,A),m.child)}function KS(f,m,_,M,A){if(Pn(_)){var D=!0;Or(m)}else D=!1;if(ic(m,A),m.stateNode===null)f!==null&&(f.alternate=null,m.alternate=null,m.flags|=2),dS(m,_,M),jv(m,_,M,A),M=!0;else if(f===null){var se=m.stateNode,ve=m.memoizedProps;se.props=ve;var De=se.context,rt=_.contextType;typeof rt=="object"&&rt!==null?rt=Nr(rt):(rt=Pn(_)?_n:on.current,rt=li(m,rt));var gt=_.getDerivedStateFromProps,It=typeof gt=="function"||typeof se.getSnapshotBeforeUpdate=="function";It||typeof se.UNSAFE_componentWillReceiveProps!="function"&&typeof se.componentWillReceiveProps!="function"||(ve!==M||De!==rt)&&fS(m,se,M,rt),Uo=!1;var bt=m.memoizedState;se.state=bt,Bf(m,M,se,A),De=m.memoizedState,ve!==M||bt!==De||an.current||Uo?(typeof gt=="function"&&(Wv(m,_,gt,M),De=m.memoizedState),(ve=Uo||hS(m,_,ve,M,bt,De,rt))?(It||typeof se.UNSAFE_componentWillMount!="function"&&typeof se.componentWillMount!="function"||(typeof se.componentWillMount=="function"&&se.componentWillMount(),typeof se.UNSAFE_componentWillMount=="function"&&se.UNSAFE_componentWillMount()),typeof se.componentDidMount=="function"&&(m.flags|=4194308)):(typeof se.componentDidMount=="function"&&(m.flags|=4194308),m.memoizedProps=M,m.memoizedState=De),se.props=M,se.state=De,se.context=rt,M=ve):(typeof se.componentDidMount=="function"&&(m.flags|=4194308),M=!1)}else{se=m.stateNode,aS(f,m),ve=m.memoizedProps,rt=m.type===m.elementType?ve:os(m.type,ve),se.props=rt,It=m.pendingProps,bt=se.context,De=_.contextType,typeof De=="object"&&De!==null?De=Nr(De):(De=Pn(_)?_n:on.current,De=li(m,De));var pn=_.getDerivedStateFromProps;(gt=typeof pn=="function"||typeof se.getSnapshotBeforeUpdate=="function")||typeof se.UNSAFE_componentWillReceiveProps!="function"&&typeof se.componentWillReceiveProps!="function"||(ve!==It||bt!==De)&&fS(m,se,M,De),Uo=!1,bt=m.memoizedState,se.state=bt,Bf(m,M,se,A);var _t=m.memoizedState;ve!==It||bt!==_t||an.current||Uo?(typeof pn=="function"&&(Wv(m,_,pn,M),_t=m.memoizedState),(rt=Uo||hS(m,_,rt,M,bt,_t,De)||!1)?(gt||typeof se.UNSAFE_componentWillUpdate!="function"&&typeof se.componentWillUpdate!="function"||(typeof se.componentWillUpdate=="function"&&se.componentWillUpdate(M,_t,De),typeof se.UNSAFE_componentWillUpdate=="function"&&se.UNSAFE_componentWillUpdate(M,_t,De)),typeof se.componentDidUpdate=="function"&&(m.flags|=4),typeof se.getSnapshotBeforeUpdate=="function"&&(m.flags|=1024)):(typeof se.componentDidUpdate!="function"||ve===f.memoizedProps&&bt===f.memoizedState||(m.flags|=4),typeof se.getSnapshotBeforeUpdate!="function"||ve===f.memoizedProps&&bt===f.memoizedState||(m.flags|=1024),m.memoizedProps=M,m.memoizedState=_t),se.props=M,se.state=_t,se.context=De,M=rt):(typeof se.componentDidUpdate!="function"||ve===f.memoizedProps&&bt===f.memoizedState||(m.flags|=4),typeof se.getSnapshotBeforeUpdate!="function"||ve===f.memoizedProps&&bt===f.memoizedState||(m.flags|=1024),M=!1)}return u0(f,m,_,M,D,A)}function u0(f,m,_,M,A,D){ZS(f,m);var se=(m.flags&128)!==0;if(!M&&!se)return A&&Ls(m,_,!1),ao(f,m,D);M=m.stateNode,lL.current=m;var ve=se&&typeof _.getDerivedStateFromError!="function"?null:M.render();return m.flags|=1,f!==null&&se?(m.child=ac(m,f.child,null,D),m.child=ac(m,null,ve,D)):Xi(f,m,ve,D),m.memoizedState=M.state,A&&Ls(m,_,!0),m.child}function JS(f){var m=f.stateNode;m.pendingContext?Fi(f,m.pendingContext,m.pendingContext!==m.context):m.context&&Fi(f,m.context,!1),Zv(f,m.containerInfo)}function eb(f,m,_,M,A){return oc(),Qv(A),m.flags|=256,Xi(f,m,_,M),m.child}var Zf={dehydrated:null,treeContext:null,retryLane:0};function Kf(f){return{baseLanes:f,cachePool:null}}function tb(f,m,_){var M=m.pendingProps,A=Dn.current,D=!1,se=(m.flags&128)!==0,ve;if((ve=se)||(ve=f!==null&&f.memoizedState===null?!1:(A&2)!==0),ve?(D=!0,m.flags&=-129):(f===null||f.memoizedState!==null)&&(A|=1),yt(Dn,A&1),f===null)return $v(m),f=m.memoizedState,f!==null&&(f=f.dehydrated,f!==null)?((m.mode&1)===0?m.lanes=1:le(f)?m.lanes=8:m.lanes=1073741824,null):(A=M.children,f=M.fallback,D?(M=m.mode,D=m.child,A={mode:"hidden",children:A},(M&1)===0&&D!==null?(D.childLanes=0,D.pendingProps=A):D=yp(A,M,0,null),f=el(f,M,_,null),D.return=m,f.return=m,D.sibling=f,m.child=D,m.child.memoizedState=Kf(_),m.memoizedState=Zf,f):h0(m,A));if(A=f.memoizedState,A!==null){if(ve=A.dehydrated,ve!==null){if(se)return m.flags&256?(m.flags&=-257,Jf(f,m,_,Error(o(422)))):m.memoizedState!==null?(m.child=f.child,m.flags|=128,null):(D=M.fallback,A=m.mode,M=yp({mode:"visible",children:M.children},A,0,null),D=el(D,A,_,null),D.flags|=2,M.return=m,D.return=m,M.sibling=D,m.child=M,(m.mode&1)!==0&&ac(m,f.child,null,_),m.child.memoizedState=Kf(_),m.memoizedState=Zf,D);if((m.mode&1)===0)m=Jf(f,m,_,null);else if(le(ve))m=Jf(f,m,_,Error(o(419)));else if(M=(_&f.childLanes)!==0,_r||M){if(M=ii,M!==null){switch(_&-_){case 4:D=2;break;case 16:D=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:D=32;break;case 536870912:D=268435456;break;default:D=0}M=(D&(M.suspendedLanes|_))!==0?0:D,M!==0&&M!==A.retryLane&&(A.retryLane=M,Wr(f,M,-1))}L0(),m=Jf(f,m,_,Error(o(421)))}else Q(ve)?(m.flags|=128,m.child=f.child,m=_L.bind(null,f),ue(ve,m),m=null):(_=A.treeContext,fe&&(wr=Ue(ve),xr=m,Rn=!0,as=null,hh=!1,_!==null&&(Ur[Hr++]=ro,Ur[Hr++]=so,Ur[Hr++]=Xa,ro=_.id,so=_.overflow,Xa=m)),m=h0(m,m.pendingProps.children),m.flags|=4096);return m}return D?(M=ib(f,m,M.children,M.fallback,_),D=m.child,A=f.child.memoizedState,D.memoizedState=A===null?Kf(_):{baseLanes:A.baseLanes|_,cachePool:null},D.childLanes=f.childLanes&~_,m.memoizedState=Zf,M):(_=nb(f,m,M.children,_),m.memoizedState=null,_)}return D?(M=ib(f,m,M.children,M.fallback,_),D=m.child,A=f.child.memoizedState,D.memoizedState=A===null?Kf(_):{baseLanes:A.baseLanes|_,cachePool:null},D.childLanes=f.childLanes&~_,m.memoizedState=Zf,M):(_=nb(f,m,M.children,_),m.memoizedState=null,_)}function h0(f,m){return m=yp({mode:"visible",children:m},f.mode,0,null),m.return=f,f.child=m}function nb(f,m,_,M){var A=f.child;return f=A.sibling,_=Xo(A,{mode:"visible",children:_}),(m.mode&1)===0&&(_.lanes=M),_.return=m,_.sibling=null,f!==null&&(M=m.deletions,M===null?(m.deletions=[f],m.flags|=16):M.push(f)),m.child=_}function ib(f,m,_,M,A){var D=m.mode;f=f.child;var se=f.sibling,ve={mode:"hidden",children:_};return(D&1)===0&&m.child!==f?(_=m.child,_.childLanes=0,_.pendingProps=ve,m.deletions=null):(_=Xo(f,ve),_.subtreeFlags=f.subtreeFlags&14680064),se!==null?M=Xo(se,M):(M=el(M,D,A,null),M.flags|=2),M.return=m,_.return=m,_.sibling=M,m.child=_,M}function Jf(f,m,_,M){return M!==null&&Qv(M),ac(m,f.child,null,_),f=h0(m,m.pendingProps.children),f.flags|=2,m.memoizedState=null,f}function rb(f,m,_){f.lanes|=m;var M=f.alternate;M!==null&&(M.lanes|=m),Vv(f.return,m,_)}function d0(f,m,_,M,A){var D=f.memoizedState;D===null?f.memoizedState={isBackwards:m,rendering:null,renderingStartTime:0,last:M,tail:_,tailMode:A}:(D.isBackwards=m,D.rendering=null,D.renderingStartTime=0,D.last=M,D.tail=_,D.tailMode=A)}function sb(f,m,_){var M=m.pendingProps,A=M.revealOrder,D=M.tail;if(Xi(f,m,M.children,_),M=Dn.current,(M&2)!==0)M=M&1|2,m.flags|=128;else{if(f!==null&&(f.flags&128)!==0)e:for(f=m.child;f!==null;){if(f.tag===13)f.memoizedState!==null&&rb(f,_,m);else if(f.tag===19)rb(f,_,m);else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===m)break e;for(;f.sibling===null;){if(f.return===null||f.return===m)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}M&=1}if(yt(Dn,M),(m.mode&1)===0)m.memoizedState=null;else switch(A){case"forwards":for(_=m.child,A=null;_!==null;)f=_.alternate,f!==null&&Hf(f)===null&&(A=_),_=_.sibling;_=A,_===null?(A=m.child,m.child=null):(A=_.sibling,_.sibling=null),d0(m,!1,A,_,D);break;case"backwards":for(_=null,A=m.child,m.child=null;A!==null;){if(f=A.alternate,f!==null&&Hf(f)===null){m.child=A;break}f=A.sibling,A.sibling=_,_=A,A=f}d0(m,!0,_,null,D);break;case"together":d0(m,!1,null,null,void 0);break;default:m.memoizedState=null}return m.child}function ao(f,m,_){if(f!==null&&(m.dependencies=f.dependencies),dc|=m.lanes,(_&m.childLanes)===0)return null;if(f!==null&&m.child!==f.child)throw Error(o(153));if(m.child!==null){for(f=m.child,_=Xo(f,f.pendingProps),m.child=_,_.return=m;f.sibling!==null;)f=f.sibling,_=_.sibling=Xo(f,f.pendingProps),_.return=m;_.sibling=null}return m.child}function cL(f,m,_){switch(m.tag){case 3:JS(m),oc();break;case 5:_S(m);break;case 1:Pn(m.type)&&Or(m);break;case 4:Zv(m,m.stateNode.containerInfo);break;case 10:oS(m,m.type._context,m.memoizedProps.value);break;case 13:var M=m.memoizedState;if(M!==null)return M.dehydrated!==null?(yt(Dn,Dn.current&1),m.flags|=128,null):(_&m.child.childLanes)!==0?tb(f,m,_):(yt(Dn,Dn.current&1),f=ao(f,m,_),f!==null?f.sibling:null);yt(Dn,Dn.current&1);break;case 19:if(M=(_&m.childLanes)!==0,(f.flags&128)!==0){if(M)return sb(f,m,_);m.flags|=128}var A=m.memoizedState;if(A!==null&&(A.rendering=null,A.tail=null,A.lastEffect=null),yt(Dn,Dn.current),M)break;return null;case 22:case 23:return m.lanes=0,QS(f,m,_)}return ao(f,m,_)}function uL(f,m){switch(qv(m),m.tag){case 1:return Pn(m.type)&&At(),f=m.flags,f&65536?(m.flags=f&-65537|128,m):null;case 3:return cc(),Nt(an),Nt(on),e0(),f=m.flags,(f&65536)!==0&&(f&128)===0?(m.flags=f&-65537|128,m):null;case 5:return Kv(m),null;case 13:if(Nt(Dn),f=m.memoizedState,f!==null&&f.dehydrated!==null){if(m.alternate===null)throw Error(o(340));oc()}return f=m.flags,f&65536?(m.flags=f&-65537|128,m):null;case 19:return Nt(Dn),null;case 4:return cc(),null;case 10:return Hv(m.type._context),null;case 22:case 23:return R0(),null;case 24:return null;default:return null}}var ep=!1,$a=!1,hL=typeof WeakSet=="function"?WeakSet:Set,ut=null;function tp(f,m){var _=f.ref;if(_!==null)if(typeof _=="function")try{_(null)}catch(M){sr(f,m,M)}else _.current=null}function f0(f,m,_){try{_()}catch(M){sr(f,m,M)}}var ob=!1;function dL(f,m){for(W(f.containerInfo),ut=m;ut!==null;)if(f=ut,m=f.child,(f.subtreeFlags&1028)!==0&&m!==null)m.return=f,ut=m;else for(;ut!==null;){f=ut;try{var _=f.alternate;if((f.flags&1024)!==0)switch(f.tag){case 0:case 11:case 15:break;case 1:if(_!==null){var M=_.memoizedProps,A=_.memoizedState,D=f.stateNode,se=D.getSnapshotBeforeUpdate(f.elementType===f.type?M:os(f.type,M),A);D.__reactInternalSnapshotBeforeUpdate=se}break;case 3:Ce&&xt(f.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(o(163))}}catch(ve){sr(f,f.return,ve)}if(m=f.sibling,m!==null){m.return=f.return,ut=m;break}ut=f.return}return _=ob,ob=!1,_}function Qa(f,m,_){var M=m.updateQueue;if(M=M!==null?M.lastEffect:null,M!==null){var A=M=M.next;do{if((A.tag&f)===f){var D=A.destroy;A.destroy=void 0,D!==void 0&&f0(m,_,D)}A=A.next}while(A!==M)}}function bh(f,m){if(m=m.updateQueue,m=m!==null?m.lastEffect:null,m!==null){var _=m=m.next;do{if((_.tag&f)===f){var M=_.create;_.destroy=M()}_=_.next}while(_!==m)}}function p0(f){var m=f.ref;if(m!==null){var _=f.stateNode;switch(f.tag){case 5:f=ne(_);break;default:f=_}typeof m=="function"?m(f):m.current=f}}function ab(f,m,_){if(ks&&typeof ks.onCommitFiberUnmount=="function")try{ks.onCommitFiberUnmount(Rf,m)}catch{}switch(m.tag){case 0:case 11:case 14:case 15:if(f=m.updateQueue,f!==null&&(f=f.lastEffect,f!==null)){var M=f=f.next;do{var A=M,D=A.destroy;A=A.tag,D!==void 0&&((A&2)!==0||(A&4)!==0)&&f0(m,_,D),M=M.next}while(M!==f)}break;case 1:if(tp(m,_),f=m.stateNode,typeof f.componentWillUnmount=="function")try{f.props=m.memoizedProps,f.state=m.memoizedState,f.componentWillUnmount()}catch(se){sr(m,_,se)}break;case 5:tp(m,_);break;case 4:Ce?fb(f,m,_):me&&me&&(m=m.stateNode.containerInfo,_=Cn(m),Ai(m,_))}}function lb(f,m,_){for(var M=m;;)if(ab(f,M,_),M.child===null||Ce&&M.tag===4){if(M===m)break;for(;M.sibling===null;){if(M.return===null||M.return===m)return;M=M.return}M.sibling.return=M.return,M=M.sibling}else M.child.return=M,M=M.child}function cb(f){var m=f.alternate;m!==null&&(f.alternate=null,cb(m)),f.child=null,f.deletions=null,f.sibling=null,f.tag===5&&(m=f.stateNode,m!==null&&it(m)),f.stateNode=null,f.return=null,f.dependencies=null,f.memoizedProps=null,f.memoizedState=null,f.pendingProps=null,f.stateNode=null,f.updateQueue=null}function ub(f){return f.tag===5||f.tag===3||f.tag===4}function hb(f){e:for(;;){for(;f.sibling===null;){if(f.return===null||ub(f.return))return null;f=f.return}for(f.sibling.return=f.return,f=f.sibling;f.tag!==5&&f.tag!==6&&f.tag!==18;){if(f.flags&2||f.child===null||f.tag===4)continue e;f.child.return=f,f=f.child}if(!(f.flags&2))return f.stateNode}}function db(f){if(Ce){e:{for(var m=f.return;m!==null;){if(ub(m))break e;m=m.return}throw Error(o(160))}var _=m;switch(_.tag){case 5:m=_.stateNode,_.flags&32&&(Te(m),_.flags&=-33),_=hb(f),g0(f,_,m);break;case 3:case 4:m=_.stateNode.containerInfo,_=hb(f),m0(f,_,m);break;default:throw Error(o(161))}}}function m0(f,m,_){var M=f.tag;if(M===5||M===6)f=f.stateNode,m?Ne(_,f,m):G(_,f);else if(M!==4&&(f=f.child,f!==null))for(m0(f,m,_),f=f.sibling;f!==null;)m0(f,m,_),f=f.sibling}function g0(f,m,_){var M=f.tag;if(M===5||M===6)f=f.stateNode,m?oe(_,f,m):be(_,f);else if(M!==4&&(f=f.child,f!==null))for(g0(f,m,_),f=f.sibling;f!==null;)g0(f,m,_),f=f.sibling}function fb(f,m,_){for(var M=m,A=!1,D,se;;){if(!A){A=M.return;e:for(;;){if(A===null)throw Error(o(160));switch(D=A.stateNode,A.tag){case 5:se=!1;break e;case 3:D=D.containerInfo,se=!0;break e;case 4:D=D.containerInfo,se=!0;break e}A=A.return}A=!0}if(M.tag===5||M.tag===6)lb(f,M,_),se?ae(D,M.stateNode):Je(D,M.stateNode);else if(M.tag===18)se?Tt(D,M.stateNode):Ze(D,M.stateNode);else if(M.tag===4){if(M.child!==null){D=M.stateNode.containerInfo,se=!0,M.child.return=M,M=M.child;continue}}else if(ab(f,M,_),M.child!==null){M.child.return=M,M=M.child;continue}if(M===m)break;for(;M.sibling===null;){if(M.return===null||M.return===m)return;M=M.return,M.tag===4&&(A=!1)}M.sibling.return=M.return,M=M.sibling}}function v0(f,m){if(Ce){switch(m.tag){case 0:case 11:case 14:case 15:Qa(3,m,m.return),bh(3,m),Qa(5,m,m.return);return;case 1:return;case 5:var _=m.stateNode;if(_!=null){var M=m.memoizedProps;f=f!==null?f.memoizedProps:M;var A=m.type,D=m.updateQueue;m.updateQueue=null,D!==null&&Ve(_,D,A,f,M,m)}return;case 6:if(m.stateNode===null)throw Error(o(162));_=m.memoizedProps,Ae(m.stateNode,f!==null?f.memoizedProps:_,_);return;case 3:fe&&f!==null&&f.memoizedState.isDehydrated&&nt(m.stateNode.containerInfo);return;case 12:return;case 13:np(m);return;case 19:np(m);return;case 17:return}throw Error(o(163))}switch(m.tag){case 0:case 11:case 14:case 15:Qa(3,m,m.return),bh(3,m),Qa(5,m,m.return);return;case 12:return;case 13:np(m);return;case 19:np(m);return;case 3:fe&&f!==null&&f.memoizedState.isDehydrated&&nt(m.stateNode.containerInfo);break;case 22:case 23:return}e:if(me){switch(m.tag){case 1:case 5:case 6:break e;case 3:case 4:m=m.stateNode,Ai(m.containerInfo,m.pendingChildren);break e}throw Error(o(163))}}function np(f){var m=f.updateQueue;if(m!==null){f.updateQueue=null;var _=f.stateNode;_===null&&(_=f.stateNode=new hL),m.forEach(function(M){var A=SL.bind(null,f,M);_.has(M)||(_.add(M),M.then(A,A))})}}function fL(f,m){for(ut=m;ut!==null;){m=ut;var _=m.deletions;if(_!==null)for(var M=0;M<_.length;M++){var A=_[M];try{var D=f;Ce?fb(D,A,m):lb(D,A,m);var se=A.alternate;se!==null&&(se.return=null),A.return=null}catch(wt){sr(A,m,wt)}}if(_=m.child,(m.subtreeFlags&12854)!==0&&_!==null)_.return=m,ut=_;else for(;ut!==null;){m=ut;try{var ve=m.flags;if(ve&32&&Ce&&Te(m.stateNode),ve&512){var De=m.alternate;if(De!==null){var rt=De.ref;rt!==null&&(typeof rt=="function"?rt(null):rt.current=null)}}if(ve&8192)switch(m.tag){case 13:if(m.memoizedState!==null){var gt=m.alternate;(gt===null||gt.memoizedState===null)&&(M0=mi())}break;case 22:var It=m.memoizedState!==null,bt=m.alternate,pn=bt!==null&&bt.memoizedState!==null;if(_=m,Ce){e:if(M=_,A=It,D=null,Ce)for(var _t=M;;){if(_t.tag===5){if(D===null){D=_t;var Oi=_t.stateNode;A?Ge(Oi):ct(_t.stateNode,_t.memoizedProps)}}else if(_t.tag===6){if(D===null){var Xr=_t.stateNode;A?ze(Xr):Pt(Xr,_t.memoizedProps)}}else if((_t.tag!==22&&_t.tag!==23||_t.memoizedState===null||_t===M)&&_t.child!==null){_t.child.return=_t,_t=_t.child;continue}if(_t===M)break;for(;_t.sibling===null;){if(_t.return===null||_t.return===M)break e;D===_t&&(D=null),_t=_t.return}D===_t&&(D=null),_t.sibling.return=_t.return,_t=_t.sibling}}if(It&&!pn&&(_.mode&1)!==0){ut=_;for(var Pe=_.child;Pe!==null;){for(_=ut=Pe;ut!==null;){M=ut;var xe=M.child;switch(M.tag){case 0:case 11:case 14:case 15:Qa(4,M,M.return);break;case 1:tp(M,M.return);var ke=M.stateNode;if(typeof ke.componentWillUnmount=="function"){var ht=M.return;try{ke.props=M.memoizedProps,ke.state=M.memoizedState,ke.componentWillUnmount()}catch(wt){sr(M,ht,wt)}}break;case 5:tp(M,M.return);break;case 22:if(M.memoizedState!==null){gb(_);continue}}xe!==null?(xe.return=M,ut=xe):gb(_)}Pe=Pe.sibling}}}switch(ve&4102){case 2:db(m),m.flags&=-3;break;case 6:db(m),m.flags&=-3,v0(m.alternate,m);break;case 4096:m.flags&=-4097;break;case 4100:m.flags&=-4097,v0(m.alternate,m);break;case 4:v0(m.alternate,m)}}catch(wt){sr(m,m.return,wt)}if(_=m.sibling,_!==null){_.return=m.return,ut=_;break}ut=m.return}}}function pL(f,m,_){ut=f,pb(f)}function pb(f,m,_){for(var M=(f.mode&1)!==0;ut!==null;){var A=ut,D=A.child;if(A.tag===22&&M){var se=A.memoizedState!==null||ep;if(!se){var ve=A.alternate,De=ve!==null&&ve.memoizedState!==null||$a;ve=ep;var rt=$a;if(ep=se,($a=De)&&!rt)for(ut=A;ut!==null;)se=ut,De=se.child,se.tag===22&&se.memoizedState!==null?vb(A):De!==null?(De.return=se,ut=De):vb(A);for(;D!==null;)ut=D,pb(D),D=D.sibling;ut=A,ep=ve,$a=rt}mb(f)}else(A.subtreeFlags&8772)!==0&&D!==null?(D.return=A,ut=D):mb(f)}}function mb(f){for(;ut!==null;){var m=ut;if((m.flags&8772)!==0){var _=m.alternate;try{if((m.flags&8772)!==0)switch(m.tag){case 0:case 11:case 15:$a||bh(5,m);break;case 1:var M=m.stateNode;if(m.flags&4&&!$a)if(_===null)M.componentDidMount();else{var A=m.elementType===m.type?_.memoizedProps:os(m.type,_.memoizedProps);M.componentDidUpdate(A,_.memoizedState,M.__reactInternalSnapshotBeforeUpdate)}var D=m.updateQueue;D!==null&&cS(m,D,M);break;case 3:var se=m.updateQueue;if(se!==null){if(_=null,m.child!==null)switch(m.child.tag){case 5:_=ne(m.child.stateNode);break;case 1:_=m.child.stateNode}cS(m,se,_)}break;case 5:var ve=m.stateNode;_===null&&m.flags&4&&Fe(ve,m.type,m.memoizedProps,m);break;case 6:break;case 4:break;case 12:break;case 13:if(fe&&m.memoizedState===null){var De=m.alternate;if(De!==null){var rt=De.memoizedState;if(rt!==null){var gt=rt.dehydrated;gt!==null&&pt(gt)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(o(163))}$a||m.flags&512&&p0(m)}catch(It){sr(m,m.return,It)}}if(m===f){ut=null;break}if(_=m.sibling,_!==null){_.return=m.return,ut=_;break}ut=m.return}}function gb(f){for(;ut!==null;){var m=ut;if(m===f){ut=null;break}var _=m.sibling;if(_!==null){_.return=m.return,ut=_;break}ut=m.return}}function vb(f){for(;ut!==null;){var m=ut;try{switch(m.tag){case 0:case 11:case 15:var _=m.return;try{bh(4,m)}catch(De){sr(m,_,De)}break;case 1:var M=m.stateNode;if(typeof M.componentDidMount=="function"){var A=m.return;try{M.componentDidMount()}catch(De){sr(m,A,De)}}var D=m.return;try{p0(m)}catch(De){sr(m,D,De)}break;case 5:var se=m.return;try{p0(m)}catch(De){sr(m,se,De)}}}catch(De){sr(m,m.return,De)}if(m===f){ut=null;break}var ve=m.sibling;if(ve!==null){ve.return=m.return,ut=ve;break}ut=m.return}}var ip=0,rp=1,sp=2,op=3,ap=4;if(typeof Symbol=="function"&&Symbol.for){var Mh=Symbol.for;ip=Mh("selector.component"),rp=Mh("selector.has_pseudo_class"),sp=Mh("selector.role"),op=Mh("selector.test_id"),ap=Mh("selector.text")}function y0(f){var m=we(f);if(m!=null){if(typeof m.memoizedProps["data-testname"]!="string")throw Error(o(364));return m}if(f=V(f),f===null)throw Error(o(362));return f.stateNode.current}function x0(f,m){switch(m.$$typeof){case ip:if(f.type===m.value)return!0;break;case rp:e:{m=m.value,f=[f,0];for(var _=0;_<f.length;){var M=f[_++],A=f[_++],D=m[A];if(M.tag!==5||!q(M)){for(;D!=null&&x0(M,D);)A++,D=m[A];if(A===m.length){m=!0;break e}else for(M=M.child;M!==null;)f.push(M,A),M=M.sibling}}m=!1}return m;case sp:if(f.tag===5&&re(f.stateNode,m.value))return!0;break;case ap:if((f.tag===5||f.tag===6)&&(f=T(f),f!==null&&0<=f.indexOf(m.value)))return!0;break;case op:if(f.tag===5&&(f=f.memoizedProps["data-testname"],typeof f=="string"&&f.toLowerCase()===m.value.toLowerCase()))return!0;break;default:throw Error(o(365))}return!1}function w0(f){switch(f.$$typeof){case ip:return"<"+(z(f.value)||"Unknown")+">";case rp:return":has("+(w0(f)||"")+")";case sp:return'[role="'+f.value+'"]';case ap:return'"'+f.value+'"';case op:return'[data-testname="'+f.value+'"]';default:throw Error(o(365))}}function yb(f,m){var _=[];f=[f,0];for(var M=0;M<f.length;){var A=f[M++],D=f[M++],se=m[D];if(A.tag!==5||!q(A)){for(;se!=null&&x0(A,se);)D++,se=m[D];if(D===m.length)_.push(A);else for(A=A.child;A!==null;)f.push(A,D),A=A.sibling}}return _}function _0(f,m){if(!L)throw Error(o(363));f=y0(f),f=yb(f,m),m=[],f=Array.from(f);for(var _=0;_<f.length;){var M=f[_++];if(M.tag===5)q(M)||m.push(M.stateNode);else for(M=M.child;M!==null;)f.push(M),M=M.sibling}return m}var mL=Math.ceil,lp=a.ReactCurrentDispatcher,S0=a.ReactCurrentOwner,Yn=a.ReactCurrentBatchConfig,Ut=0,ii=null,ri=null,Pi=0,Sr=0,hc=Dt(0),ci=0,Eh=null,dc=0,cp=0,b0=0,Th=null,ir=null,M0=0,E0=1/0;function fc(){E0=mi()+500}var up=!1,T0=null,Vo=null,hp=!1,Go=null,dp=0,Ah=0,A0=null,fp=-1,pp=0;function qi(){return(Ut&6)!==0?mi():fp!==-1?fp:fp=mi()}function Wo(f){return(f.mode&1)===0?1:(Ut&2)!==0&&Pi!==0?Pi&-Pi:ZR.transition!==null?(pp===0&&(f=Af,Af<<=1,(Af&4194240)===0&&(Af=64),pp=f),pp):(f=tn,f!==0?f:_e())}function Wr(f,m,_){if(50<Ah)throw Ah=0,A0=null,Error(o(185));var M=mp(f,m);return M===null?null:(uh(M,m,_),((Ut&2)===0||M!==ii)&&(M===ii&&((Ut&2)===0&&(cp|=m),ci===4&&jo(M,Pi)),rr(M,_),m===1&&Ut===0&&(f.mode&1)===0&&(fc(),Lf&&Fs())),M)}function mp(f,m){f.lanes|=m;var _=f.alternate;for(_!==null&&(_.lanes|=m),_=f,f=f.return;f!==null;)f.childLanes|=m,_=f.alternate,_!==null&&(_.childLanes|=m),_=f,f=f.return;return _.tag===3?_.stateNode:null}function rr(f,m){var _=f.callbackNode;VR(f,m);var M=Pf(f,f===ii?Pi:0);if(M===0)_!==null&&rS(_),f.callbackNode=null,f.callbackPriority=0;else if(m=M&-M,f.callbackPriority!==m){if(_!=null&&rS(_),m===1)f.tag===0?QR(wb.bind(null,f)):sS(wb.bind(null,f)),$e?et(function(){Ut===0&&Fs()}):Dv(Bv,Fs),_=null;else{switch(iS(M)){case 1:_=Bv;break;case 4:_=XR;break;case 16:_=zv;break;case 536870912:_=qR;break;default:_=zv}_=Pb(_,xb.bind(null,f))}f.callbackPriority=m,f.callbackNode=_}}function xb(f,m){if(fp=-1,pp=0,(Ut&6)!==0)throw Error(o(327));var _=f.callbackNode;if(Ja()&&f.callbackNode!==_)return null;var M=Pf(f,f===ii?Pi:0);if(M===0)return null;if((M&30)!==0||(M&f.expiredLanes)!==0||m)m=gp(f,M);else{m=M;var A=Ut;Ut|=2;var D=bb();(ii!==f||Pi!==m)&&(fc(),Za(f,m));do try{yL();break}catch(ve){Sb(f,ve)}while(1);Uv(),lp.current=D,Ut=A,ri!==null?m=0:(ii=null,Pi=0,m=ci)}if(m!==0){if(m===2&&(A=kv(f),A!==0&&(M=A,m=C0(f,A))),m===1)throw _=Eh,Za(f,0),jo(f,M),rr(f,mi()),_;if(m===6)jo(f,M);else{if(A=f.current.alternate,(M&30)===0&&!gL(A)&&(m=gp(f,M),m===2&&(D=kv(f),D!==0&&(M=D,m=C0(f,D))),m===1))throw _=Eh,Za(f,0),jo(f,M),rr(f,mi()),_;switch(f.finishedWork=A,f.finishedLanes=M,m){case 0:case 1:throw Error(o(345));case 2:Ka(f,ir);break;case 3:if(jo(f,M),(M&130023424)===M&&(m=M0+500-mi(),10<m)){if(Pf(f,0)!==0)break;if(A=f.suspendedLanes,(A&M)!==M){qi(),f.pingedLanes|=f.suspendedLanes&A;break}f.timeoutHandle=Ee(Ka.bind(null,f,ir),m);break}Ka(f,ir);break;case 4:if(jo(f,M),(M&4194240)===M)break;for(m=f.eventTimes,A=-1;0<M;){var se=31-yr(M);D=1<<se,se=m[se],se>A&&(A=se),M&=~D}if(M=A,M=mi()-M,M=(120>M?120:480>M?480:1080>M?1080:1920>M?1920:3e3>M?3e3:4320>M?4320:1960*mL(M/1960))-M,10<M){f.timeoutHandle=Ee(Ka.bind(null,f,ir),M);break}Ka(f,ir);break;case 5:Ka(f,ir);break;default:throw Error(o(329))}}}return rr(f,mi()),f.callbackNode===_?xb.bind(null,f):null}function C0(f,m){var _=Th;return f.current.memoizedState.isDehydrated&&(Za(f,m).flags|=256),f=gp(f,m),f!==2&&(m=ir,ir=_,m!==null&&P0(m)),f}function P0(f){ir===null?ir=f:ir.push.apply(ir,f)}function gL(f){for(var m=f;;){if(m.flags&16384){var _=m.updateQueue;if(_!==null&&(_=_.stores,_!==null))for(var M=0;M<_.length;M++){var A=_[M],D=A.getSnapshot;A=A.value;try{if(!Is(D(),A))return!1}catch{return!1}}}if(_=m.child,m.subtreeFlags&16384&&_!==null)_.return=m,m=_;else{if(m===f)break;for(;m.sibling===null;){if(m.return===null||m.return===f)return!0;m=m.return}m.sibling.return=m.return,m=m.sibling}}return!0}function jo(f,m){for(m&=~b0,m&=~cp,f.suspendedLanes|=m,f.pingedLanes&=~m,f=f.expirationTimes;0<m;){var _=31-yr(m),M=1<<_;f[_]=-1,m&=~M}}function wb(f){if((Ut&6)!==0)throw Error(o(327));Ja();var m=Pf(f,0);if((m&1)===0)return rr(f,mi()),null;var _=gp(f,m);if(f.tag!==0&&_===2){var M=kv(f);M!==0&&(m=M,_=C0(f,M))}if(_===1)throw _=Eh,Za(f,0),jo(f,m),rr(f,mi()),_;if(_===6)throw Error(o(345));return f.finishedWork=f.current.alternate,f.finishedLanes=m,Ka(f,ir),rr(f,mi()),null}function _b(f){Go!==null&&Go.tag===0&&(Ut&6)===0&&Ja();var m=Ut;Ut|=1;var _=Yn.transition,M=tn;try{if(Yn.transition=null,tn=1,f)return f()}finally{tn=M,Yn.transition=_,Ut=m,(Ut&6)===0&&Fs()}}function R0(){Sr=hc.current,Nt(hc)}function Za(f,m){f.finishedWork=null,f.finishedLanes=0;var _=f.timeoutHandle;if(_!==de&&(f.timeoutHandle=de,Se(_)),ri!==null)for(_=ri.return;_!==null;){var M=_;switch(qv(M),M.tag){case 1:M=M.type.childContextTypes,M!=null&&At();break;case 3:cc(),Nt(an),Nt(on),e0();break;case 5:Kv(M);break;case 4:cc();break;case 13:Nt(Dn);break;case 19:Nt(Dn);break;case 10:Hv(M.type._context);break;case 22:case 23:R0()}_=_.return}if(ii=f,ri=f=Xo(f.current,null),Pi=Sr=m,ci=0,Eh=null,b0=cp=dc=0,ir=Th=null,Ds!==null){for(m=0;m<Ds.length;m++)if(_=Ds[m],M=_.interleaved,M!==null){_.interleaved=null;var A=M.next,D=_.pending;if(D!==null){var se=D.next;D.next=A,M.next=se}_.pending=M}Ds=null}return f}function Sb(f,m){do{var _=ri;try{if(Uv(),Vf.current=Yf,Gf){for(var M=Vn.memoizedState;M!==null;){var A=M.queue;A!==null&&(A.pending=null),M=M.next}Gf=!1}if(uc=0,gi=Di=Vn=null,gh=!1,vh=0,S0.current=null,_===null||_.return===null){ci=1,Eh=m,ri=null;break}e:{var D=f,se=_.return,ve=_,De=m;if(m=Pi,ve.flags|=32768,De!==null&&typeof De=="object"&&typeof De.then=="function"){var rt=De,gt=ve,It=gt.tag;if((gt.mode&1)===0&&(It===0||It===11||It===15)){var bt=gt.alternate;bt?(gt.updateQueue=bt.updateQueue,gt.memoizedState=bt.memoizedState,gt.lanes=bt.lanes):(gt.updateQueue=null,gt.memoizedState=null)}var pn=GS(se);if(pn!==null){pn.flags&=-257,WS(pn,se,ve,D,m),pn.mode&1&&VS(D,rt,m),m=pn,De=rt;var _t=m.updateQueue;if(_t===null){var Oi=new Set;Oi.add(De),m.updateQueue=Oi}else _t.add(De);break e}else{if((m&1)===0){VS(D,rt,m),L0();break e}De=Error(o(426))}}else if(Rn&&ve.mode&1){var Xr=GS(se);if(Xr!==null){(Xr.flags&65536)===0&&(Xr.flags|=256),WS(Xr,se,ve,D,m),Qv(De);break e}}D=De,ci!==4&&(ci=2),Th===null?Th=[D]:Th.push(D),De=a0(De,ve),ve=se;do{switch(ve.tag){case 3:ve.flags|=65536,m&=-m,ve.lanes|=m;var Pe=US(ve,De,m);lS(ve,Pe);break e;case 1:D=De;var xe=ve.type,ke=ve.stateNode;if((ve.flags&128)===0&&(typeof xe.getDerivedStateFromError=="function"||ke!==null&&typeof ke.componentDidCatch=="function"&&(Vo===null||!Vo.has(ke)))){ve.flags|=65536,m&=-m,ve.lanes|=m;var ht=HS(ve,D,m);lS(ve,ht);break e}}ve=ve.return}while(ve!==null)}Eb(_)}catch(wt){m=wt,ri===_&&_!==null&&(ri=_=_.return);continue}break}while(1)}function bb(){var f=lp.current;return lp.current=Yf,f===null?Yf:f}function L0(){(ci===0||ci===3||ci===2)&&(ci=4),ii===null||(dc&268435455)===0&&(cp&268435455)===0||jo(ii,Pi)}function gp(f,m){var _=Ut;Ut|=2;var M=bb();ii===f&&Pi===m||Za(f,m);do try{vL();break}catch(A){Sb(f,A)}while(1);if(Uv(),Ut=_,lp.current=M,ri!==null)throw Error(o(261));return ii=null,Pi=0,ci}function vL(){for(;ri!==null;)Mb(ri)}function yL(){for(;ri!==null&&!WR();)Mb(ri)}function Mb(f){var m=Cb(f.alternate,f,Sr);f.memoizedProps=f.pendingProps,m===null?Eb(f):ri=m,S0.current=null}function Eb(f){var m=f;do{var _=m.alternate;if(f=m.return,(m.flags&32768)===0){if(_=aL(_,m,Sr),_!==null){ri=_;return}}else{if(_=uL(_,m),_!==null){_.flags&=32767,ri=_;return}if(f!==null)f.flags|=32768,f.subtreeFlags=0,f.deletions=null;else{ci=6,ri=null;return}}if(m=m.sibling,m!==null){ri=m;return}ri=m=f}while(m!==null);ci===0&&(ci=5)}function Ka(f,m){var _=tn,M=Yn.transition;try{Yn.transition=null,tn=1,xL(f,m,_)}finally{Yn.transition=M,tn=_}return null}function xL(f,m,_){do Ja();while(Go!==null);if((Ut&6)!==0)throw Error(o(327));var M=f.finishedWork,A=f.finishedLanes;if(M===null)return null;if(f.finishedWork=null,f.finishedLanes=0,M===f.current)throw Error(o(177));f.callbackNode=null,f.callbackPriority=0;var D=M.lanes|M.childLanes;if(GR(f,D),f===ii&&(ri=ii=null,Pi=0),(M.subtreeFlags&2064)===0&&(M.flags&2064)===0||hp||(hp=!0,Pb(zv,function(){return Ja(),null})),D=(M.flags&15990)!==0,(M.subtreeFlags&15990)!==0||D){D=Yn.transition,Yn.transition=null;var se=tn;tn=1;var ve=Ut;Ut|=4,S0.current=null,dL(f,M),fL(f,M),Y(f.containerInfo),f.current=M,pL(M),jR(),Ut=ve,tn=se,Yn.transition=D}else f.current=M;if(hp&&(hp=!1,Go=f,dp=A),D=f.pendingLanes,D===0&&(Vo=null),YR(M.stateNode),rr(f,mi()),m!==null)for(_=f.onRecoverableError,M=0;M<m.length;M++)_(m[M]);if(up)throw up=!1,f=T0,T0=null,f;return(dp&1)!==0&&f.tag!==0&&Ja(),D=f.pendingLanes,(D&1)!==0?f===A0?Ah++:(Ah=0,A0=f):Ah=0,Fs(),null}function Ja(){if(Go!==null){var f=iS(dp),m=Yn.transition,_=tn;try{if(Yn.transition=null,tn=16>f?16:f,Go===null)var M=!1;else{if(f=Go,Go=null,dp=0,(Ut&6)!==0)throw Error(o(331));var A=Ut;for(Ut|=4,ut=f.current;ut!==null;){var D=ut,se=D.child;if((ut.flags&16)!==0){var ve=D.deletions;if(ve!==null){for(var De=0;De<ve.length;De++){var rt=ve[De];for(ut=rt;ut!==null;){var gt=ut;switch(gt.tag){case 0:case 11:case 15:Qa(8,gt,D)}var It=gt.child;if(It!==null)It.return=gt,ut=It;else for(;ut!==null;){gt=ut;var bt=gt.sibling,pn=gt.return;if(cb(gt),gt===rt){ut=null;break}if(bt!==null){bt.return=pn,ut=bt;break}ut=pn}}}var _t=D.alternate;if(_t!==null){var Oi=_t.child;if(Oi!==null){_t.child=null;do{var Xr=Oi.sibling;Oi.sibling=null,Oi=Xr}while(Oi!==null)}}ut=D}}if((D.subtreeFlags&2064)!==0&&se!==null)se.return=D,ut=se;else e:for(;ut!==null;){if(D=ut,(D.flags&2048)!==0)switch(D.tag){case 0:case 11:case 15:Qa(9,D,D.return)}var Pe=D.sibling;if(Pe!==null){Pe.return=D.return,ut=Pe;break e}ut=D.return}}var xe=f.current;for(ut=xe;ut!==null;){se=ut;var ke=se.child;if((se.subtreeFlags&2064)!==0&&ke!==null)ke.return=se,ut=ke;else e:for(se=xe;ut!==null;){if(ve=ut,(ve.flags&2048)!==0)try{switch(ve.tag){case 0:case 11:case 15:bh(9,ve)}}catch(wt){sr(ve,ve.return,wt)}if(ve===se){ut=null;break e}var ht=ve.sibling;if(ht!==null){ht.return=ve.return,ut=ht;break e}ut=ve.return}}if(Ut=A,Fs(),ks&&typeof ks.onPostCommitFiberRoot=="function")try{ks.onPostCommitFiberRoot(Rf,f)}catch{}M=!0}return M}finally{tn=_,Yn.transition=m}}return!1}function Tb(f,m,_){m=a0(_,m),m=US(f,m,1),Ho(f,m),m=qi(),f=mp(f,1),f!==null&&(uh(f,1,m),rr(f,m))}function sr(f,m,_){if(f.tag===3)Tb(f,f,_);else for(;m!==null;){if(m.tag===3){Tb(m,f,_);break}else if(m.tag===1){var M=m.stateNode;if(typeof m.type.getDerivedStateFromError=="function"||typeof M.componentDidCatch=="function"&&(Vo===null||!Vo.has(M))){f=a0(_,f),f=HS(m,f,1),Ho(m,f),f=qi(),m=mp(m,1),m!==null&&(uh(m,1,f),rr(m,f));break}}m=m.return}}function wL(f,m,_){var M=f.pingCache;M!==null&&M.delete(m),m=qi(),f.pingedLanes|=f.suspendedLanes&_,ii===f&&(Pi&_)===_&&(ci===4||ci===3&&(Pi&130023424)===Pi&&500>mi()-M0?Za(f,0):b0|=_),rr(f,m)}function Ab(f,m){m===0&&((f.mode&1)===0?m=1:(m=Cf,Cf<<=1,(Cf&130023424)===0&&(Cf=4194304)));var _=qi();f=mp(f,m),f!==null&&(uh(f,m,_),rr(f,_))}function _L(f){var m=f.memoizedState,_=0;m!==null&&(_=m.retryLane),Ab(f,_)}function SL(f,m){var _=0;switch(f.tag){case 13:var M=f.stateNode,A=f.memoizedState;A!==null&&(_=A.retryLane);break;case 19:M=f.stateNode;break;default:throw Error(o(314))}M!==null&&M.delete(m),Ab(f,_)}var Cb;Cb=function(f,m,_){if(f!==null)if(f.memoizedProps!==m.pendingProps||an.current)_r=!0;else{if((f.lanes&_)===0&&(m.flags&128)===0)return _r=!1,cL(f,m,_);_r=(f.flags&131072)!==0}else _r=!1,Rn&&(m.flags&1048576)!==0&&pS(m,Nf,m.index);switch(m.lanes=0,m.tag){case 2:var M=m.type;f!==null&&(f.alternate=null,m.alternate=null,m.flags|=2),f=m.pendingProps;var A=li(m,on.current);ic(m,_),A=n0(null,m,M,f,A,_);var D=i0();return m.flags|=1,typeof A=="object"&&A!==null&&typeof A.render=="function"&&A.$$typeof===void 0?(m.tag=1,m.memoizedState=null,m.updateQueue=null,Pn(M)?(D=!0,Or(m)):D=!1,m.memoizedState=A.state!==null&&A.state!==void 0?A.state:null,Gv(m),A.updater=zf,m.stateNode=A,A._reactInternals=m,jv(m,M,f,_),m=u0(null,m,M,!0,D,_)):(m.tag=0,Rn&&D&&Xv(m),Xi(null,m,A,_),m=m.child),m;case 16:M=m.elementType;e:{switch(f!==null&&(f.alternate=null,m.alternate=null,m.flags|=2),f=m.pendingProps,A=M._init,M=A(M._payload),m.type=M,A=m.tag=ML(M),f=os(M,f),A){case 0:m=c0(null,m,M,f,_);break e;case 1:m=KS(null,m,M,f,_);break e;case 11:m=qS(null,m,M,f,_);break e;case 14:m=YS(null,m,M,os(M.type,f),_);break e}throw Error(o(306,M,""))}return m;case 0:return M=m.type,A=m.pendingProps,A=m.elementType===M?A:os(M,A),c0(f,m,M,A,_);case 1:return M=m.type,A=m.pendingProps,A=m.elementType===M?A:os(M,A),KS(f,m,M,A,_);case 3:e:{if(JS(m),f===null)throw Error(o(387));M=m.pendingProps,D=m.memoizedState,A=D.element,aS(f,m),Bf(m,M,null,_);var se=m.memoizedState;if(M=se.element,fe&&D.isDehydrated)if(D={element:M,isDehydrated:!1,cache:se.cache,transitions:se.transitions},m.updateQueue.baseState=D,m.memoizedState=D,m.flags&256){A=Error(o(423)),m=eb(f,m,M,_,A);break e}else if(M!==A){A=Error(o(424)),m=eb(f,m,M,_,A);break e}else for(fe&&(wr=Ie(m.stateNode.containerInfo),xr=m,Rn=!0,as=null,hh=!1),_=wS(m,null,M,_),m.child=_;_;)_.flags=_.flags&-3|4096,_=_.sibling;else{if(oc(),M===A){m=ao(f,m,_);break e}Xi(f,m,M,_)}m=m.child}return m;case 5:return _S(m),f===null&&$v(m),M=m.type,A=m.pendingProps,D=f!==null?f.memoizedProps:null,se=A.children,$(M,A)?se=null:D!==null&&$(M,D)&&(m.flags|=32),ZS(f,m),Xi(f,m,se,_),m.child;case 6:return f===null&&$v(m),null;case 13:return tb(f,m,_);case 4:return Zv(m,m.stateNode.containerInfo),M=m.pendingProps,f===null?m.child=ac(m,null,M,_):Xi(f,m,M,_),m.child;case 11:return M=m.type,A=m.pendingProps,A=m.elementType===M?A:os(M,A),qS(f,m,M,A,_);case 7:return Xi(f,m,m.pendingProps,_),m.child;case 8:return Xi(f,m,m.pendingProps.children,_),m.child;case 12:return Xi(f,m,m.pendingProps.children,_),m.child;case 10:e:{if(M=m.type._context,A=m.pendingProps,D=m.memoizedProps,se=A.value,oS(m,M,se),D!==null)if(Is(D.value,se)){if(D.children===A.children&&!an.current){m=ao(f,m,_);break e}}else for(D=m.child,D!==null&&(D.return=m);D!==null;){var ve=D.dependencies;if(ve!==null){se=D.child;for(var De=ve.firstContext;De!==null;){if(De.context===M){if(D.tag===1){De=io(-1,_&-_),De.tag=2;var rt=D.updateQueue;if(rt!==null){rt=rt.shared;var gt=rt.pending;gt===null?De.next=De:(De.next=gt.next,gt.next=De),rt.pending=De}}D.lanes|=_,De=D.alternate,De!==null&&(De.lanes|=_),Vv(D.return,_,m),ve.lanes|=_;break}De=De.next}}else if(D.tag===10)se=D.type===m.type?null:D.child;else if(D.tag===18){if(se=D.return,se===null)throw Error(o(341));se.lanes|=_,ve=se.alternate,ve!==null&&(ve.lanes|=_),Vv(se,_,m),se=D.sibling}else se=D.child;if(se!==null)se.return=D;else for(se=D;se!==null;){if(se===m){se=null;break}if(D=se.sibling,D!==null){D.return=se.return,se=D;break}se=se.return}D=se}Xi(f,m,A.children,_),m=m.child}return m;case 9:return A=m.type,M=m.pendingProps.children,ic(m,_),A=Nr(A),M=M(A),m.flags|=1,Xi(f,m,M,_),m.child;case 14:return M=m.type,A=os(M,m.pendingProps),A=os(M.type,A),YS(f,m,M,A,_);case 15:return $S(f,m,m.type,m.pendingProps,_);case 17:return M=m.type,A=m.pendingProps,A=m.elementType===M?A:os(M,A),f!==null&&(f.alternate=null,m.alternate=null,m.flags|=2),m.tag=1,Pn(M)?(f=!0,Or(m)):f=!1,ic(m,_),dS(m,M,A),jv(m,M,A,_),u0(null,m,M,!0,f,_);case 19:return sb(f,m,_);case 22:return QS(f,m,_)}throw Error(o(156,m.tag))};function Pb(f,m){return Dv(f,m)}function bL(f,m,_,M){this.tag=f,this.key=_,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=m,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=M,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function jr(f,m,_,M){return new bL(f,m,_,M)}function k0(f){return f=f.prototype,!(!f||!f.isReactComponent)}function ML(f){if(typeof f=="function")return k0(f)?1:0;if(f!=null){if(f=f.$$typeof,f===y)return 11;if(f===w)return 14}return 2}function Xo(f,m){var _=f.alternate;return _===null?(_=jr(f.tag,m,f.key,f.mode),_.elementType=f.elementType,_.type=f.type,_.stateNode=f.stateNode,_.alternate=f,f.alternate=_):(_.pendingProps=m,_.type=f.type,_.flags=0,_.subtreeFlags=0,_.deletions=null),_.flags=f.flags&14680064,_.childLanes=f.childLanes,_.lanes=f.lanes,_.child=f.child,_.memoizedProps=f.memoizedProps,_.memoizedState=f.memoizedState,_.updateQueue=f.updateQueue,m=f.dependencies,_.dependencies=m===null?null:{lanes:m.lanes,firstContext:m.firstContext},_.sibling=f.sibling,_.index=f.index,_.ref=f.ref,_}function vp(f,m,_,M,A,D){var se=2;if(M=f,typeof f=="function")k0(f)&&(se=1);else if(typeof f=="string")se=5;else e:switch(f){case d:return el(_.children,A,D,m);case l:se=8,A|=8;break;case u:return f=jr(12,_,m,A|2),f.elementType=u,f.lanes=D,f;case x:return f=jr(13,_,m,A),f.elementType=x,f.lanes=D,f;case v:return f=jr(19,_,m,A),f.elementType=v,f.lanes=D,f;case b:return yp(_,A,D,m);default:if(typeof f=="object"&&f!==null)switch(f.$$typeof){case p:se=10;break e;case g:se=9;break e;case y:se=11;break e;case w:se=14;break e;case S:se=16,M=null;break e}throw Error(o(130,f==null?f:typeof f,""))}return m=jr(se,_,m,A),m.elementType=f,m.type=M,m.lanes=D,m}function el(f,m,_,M){return f=jr(7,f,M,m),f.lanes=_,f}function yp(f,m,_,M){return f=jr(22,f,M,m),f.elementType=b,f.lanes=_,f.stateNode={},f}function I0(f,m,_){return f=jr(6,f,null,m),f.lanes=_,f}function F0(f,m,_){return m=jr(4,f.children!==null?f.children:[],f.key,m),m.lanes=_,m.stateNode={containerInfo:f.containerInfo,pendingChildren:null,implementation:f.implementation},m}function EL(f,m,_,M,A){this.tag=m,this.containerInfo=f,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=de,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Iv(0),this.expirationTimes=Iv(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Iv(0),this.identifierPrefix=M,this.onRecoverableError=A,fe&&(this.mutableSourceEagerHydrationData=null)}function Rb(f,m,_,M,A,D,se,ve,De){return f=new EL(f,m,_,ve,De),m===1?(m=1,D===!0&&(m|=8)):m=0,D=jr(3,null,null,m),f.current=D,D.stateNode=f,D.memoizedState={element:M,isDehydrated:_,cache:null,transitions:null},Gv(D),f}function Lb(f){if(!f)return pi;f=f._reactInternals;e:{if(N(f)!==f||f.tag!==1)throw Error(o(170));var m=f;do{switch(m.tag){case 3:m=m.stateNode.context;break e;case 1:if(Pn(m.type)){m=m.stateNode.__reactInternalMemoizedMergedChildContext;break e}}m=m.return}while(m!==null);throw Error(o(171))}if(f.tag===1){var _=f.type;if(Pn(_))return qn(f,_,m)}return m}function kb(f){var m=f._reactInternals;if(m===void 0)throw typeof f.render=="function"?Error(o(188)):(f=Object.keys(f).join(","),Error(o(268,f)));return f=O(m),f===null?null:f.stateNode}function Ib(f,m){if(f=f.memoizedState,f!==null&&f.dehydrated!==null){var _=f.retryLane;f.retryLane=_!==0&&_<m?_:m}}function D0(f,m){Ib(f,m),(f=f.alternate)&&Ib(f,m)}function TL(f){return f=O(f),f===null?null:f.stateNode}function AL(){return null}return t.attemptContinuousHydration=function(f){if(f.tag===13){var m=qi();Wr(f,134217728,m),D0(f,134217728)}},t.attemptHydrationAtCurrentPriority=function(f){if(f.tag===13){var m=qi(),_=Wo(f);Wr(f,_,m),D0(f,_)}},t.attemptSynchronousHydration=function(f){switch(f.tag){case 3:var m=f.stateNode;if(m.current.memoizedState.isDehydrated){var _=ch(m.pendingLanes);_!==0&&(Fv(m,_|1),rr(m,mi()),(Ut&6)===0&&(fc(),Fs()))}break;case 13:var M=qi();_b(function(){return Wr(f,1,M)}),D0(f,1)}},t.batchedUpdates=function(f,m){var _=Ut;Ut|=1;try{return f(m)}finally{Ut=_,Ut===0&&(fc(),Lf&&Fs())}},t.createComponentSelector=function(f){return{$$typeof:ip,value:f}},t.createContainer=function(f,m,_,M,A,D,se){return Rb(f,m,!1,null,_,M,A,D,se)},t.createHasPseudoClassSelector=function(f){return{$$typeof:rp,value:f}},t.createHydrationContainer=function(f,m,_,M,A,D,se,ve,De){return f=Rb(_,M,!0,f,A,D,se,ve,De),f.context=Lb(null),_=f.current,M=qi(),A=Wo(_),D=io(M,A),D.callback=m!=null?m:null,Ho(_,D),f.current.lanes=A,uh(f,A,M),rr(f,M),f},t.createPortal=function(f,m,_){var M=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:h,key:M==null?null:""+M,children:f,containerInfo:m,implementation:_}},t.createRoleSelector=function(f){return{$$typeof:sp,value:f}},t.createTestNameSelector=function(f){return{$$typeof:op,value:f}},t.createTextSelector=function(f){return{$$typeof:ap,value:f}},t.deferredUpdates=function(f){var m=tn,_=Yn.transition;try{return Yn.transition=null,tn=16,f()}finally{tn=m,Yn.transition=_}},t.discreteUpdates=function(f,m,_,M,A){var D=tn,se=Yn.transition;try{return Yn.transition=null,tn=1,f(m,_,M,A)}finally{tn=D,Yn.transition=se,Ut===0&&fc()}},t.findAllNodes=_0,t.findBoundingRects=function(f,m){if(!L)throw Error(o(363));m=_0(f,m),f=[];for(var _=0;_<m.length;_++)f.push(P(m[_]));for(m=f.length-1;0<m;m--){_=f[m];for(var M=_.x,A=M+_.width,D=_.y,se=D+_.height,ve=m-1;0<=ve;ve--)if(m!==ve){var De=f[ve],rt=De.x,gt=rt+De.width,It=De.y,bt=It+De.height;if(M>=rt&&D>=It&&A<=gt&&se<=bt){f.splice(m,1);break}else if(M!==rt||_.width!==De.width||bt<D||It>se){if(!(D!==It||_.height!==De.height||gt<M||rt>A)){rt>M&&(De.width+=rt-M,De.x=M),gt<A&&(De.width=A-rt),f.splice(m,1);break}}else{It>D&&(De.height+=It-D,De.y=D),bt<se&&(De.height=se-It),f.splice(m,1);break}}}return f},t.findHostInstance=kb,t.findHostInstanceWithNoPortals=function(f){return f=C(f),f=f!==null?U(f):null,f===null?null:f.stateNode},t.findHostInstanceWithWarning=function(f){return kb(f)},t.flushControlled=function(f){var m=Ut;Ut|=1;var _=Yn.transition,M=tn;try{Yn.transition=null,tn=1,f()}finally{tn=M,Yn.transition=_,Ut=m,Ut===0&&(fc(),Fs())}},t.flushPassiveEffects=Ja,t.flushSync=_b,t.focusWithin=function(f,m){if(!L)throw Error(o(363));for(f=y0(f),m=yb(f,m),m=Array.from(m),f=0;f<m.length;){var _=m[f++];if(!q(_)){if(_.tag===5&&pe(_.stateNode))return!0;for(_=_.child;_!==null;)m.push(_),_=_.sibling}}return!1},t.getCurrentUpdatePriority=function(){return tn},t.getFindAllNodesFailureDescription=function(f,m){if(!L)throw Error(o(363));var _=0,M=[];f=[y0(f),0];for(var A=0;A<f.length;){var D=f[A++],se=f[A++],ve=m[se];if((D.tag!==5||!q(D))&&(x0(D,ve)&&(M.push(w0(ve)),se++,se>_&&(_=se)),se<m.length))for(D=D.child;D!==null;)f.push(D,se),D=D.sibling}if(_<m.length){for(f=[];_<m.length;_++)f.push(w0(m[_]));return`findAllNodes was able to match part of the selector:
  `+(M.join(" > ")+`

No matching component was found for:
  `)+f.join(" > ")}return null},t.getPublicRootInstance=function(f){if(f=f.current,!f.child)return null;switch(f.child.tag){case 5:return ne(f.child.stateNode);default:return f.child.stateNode}},t.injectIntoDevTools=function(f){if(f={bundleType:f.bundleType,version:f.version,rendererPackageName:f.rendererPackageName,rendererConfig:f.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:a.ReactCurrentDispatcher,findHostInstanceByFiber:TL,findFiberByHostInstance:f.findFiberByHostInstance||AL,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__=="undefined")f=!1;else{var m=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(m.isDisabled||!m.supportsFiber)f=!0;else{try{Rf=m.inject(f),ks=m}catch{}f=!!m.checkDCE}}return f},t.isAlreadyRendering=function(){return!1},t.observeVisibleRects=function(f,m,_,M){if(!L)throw Error(o(363));f=_0(f,m);var A=ge(f,_,M).disconnect;return{disconnect:function(){A()}}},t.registerMutableSourceForHydration=function(f,m){var _=m._getVersion;_=_(m._source),f.mutableSourceEagerHydrationData==null?f.mutableSourceEagerHydrationData=[m,_]:f.mutableSourceEagerHydrationData.push(m,_)},t.runWithPriority=function(f,m){var _=tn;try{return tn=f,m()}finally{tn=_}},t.shouldError=function(){return null},t.shouldSuspend=function(){return!1},t.updateContainer=function(f,m,_,M){var A=m.current,D=qi(),se=Wo(A);return _=Lb(_),m.context===null?m.context=_:m.pendingContext=_,m=io(D,se),m.payload={element:f},M=M===void 0?null:M,M!==null&&(m.callback=M),Ho(A,m),f=Wr(A,se,D),f!==null&&Df(f,A,se),se},t};CP.exports=S4;var b4=CP.exports,pT,mT;const RP=i=>i&&i.isOrthographicCamera,Sf=typeof window!="undefined"&&((pT=window.document)!=null&&pT.createElement||((mT=window.navigator)==null?void 0:mT.product)==="ReactNative")?St.exports.useLayoutEffect:St.exports.useEffect;function LP(i){const e=St.exports.useRef(i);return Sf(()=>void(e.current=i),[i]),e}function M4({set:i}){return Sf(()=>(i(new Promise(()=>null)),()=>i(!1)),[i]),null}class kP extends St.exports.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}kP.getDerivedStateFromError=()=>({error:!0});const IP="__default",E4=i=>i&&!!i.memoized&&!!i.changes;function FP(i){return Array.isArray(i)?Math.min(Math.max(i[0],window.devicePixelRatio),i[1]):i}const Mm=i=>{var e;return(e=i.__r3f)==null?void 0:e.root.getState()},Zn={obj:i=>i===Object(i)&&!Zn.arr(i)&&typeof i!="function",fun:i=>typeof i=="function",str:i=>typeof i=="string",num:i=>typeof i=="number",boo:i=>typeof i=="boolean",und:i=>i===void 0,arr:i=>Array.isArray(i),equ(i,e,{arrays:t="shallow",objects:n="reference",strict:r=!0}={}){if(typeof i!=typeof e||!!i!=!!e)return!1;if(Zn.str(i)||Zn.num(i))return i===e;const s=Zn.obj(i);if(s&&n==="reference")return i===e;const o=Zn.arr(i);if(o&&t==="reference")return i===e;if((o||s)&&i===e)return!0;let a;for(a in i)if(!(a in e))return!1;for(a in r?e:i)if(i[a]!==e[a])return!1;if(Zn.und(a)){if(o&&i.length===0&&e.length===0||s&&Object.keys(i).length===0&&Object.keys(e).length===0)return!0;if(i!==e)return!1}return!0}};function T4(i){i.dispose&&i.type!=="Scene"&&i.dispose();for(const e in i)e.dispose==null||e.dispose(),delete i[e]}function Dc(i,e){const t=i;return(e!=null&&e.primitive||!t.__r3f)&&(t.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...e}),i}function Fw(i,e){let t=i;if(e.includes("-")){const n=e.split("-"),r=n.pop();return t=n.reduce((s,o)=>s[o],i),{target:t,key:r}}else return{target:t,key:e}}const gT=/-\d+$/;function Gy(i,e,t){if(Zn.str(t)){if(gT.test(t)){const s=t.replace(gT,""),{target:o,key:a}=Fw(i,s);Array.isArray(o[a])||(o[a]=[])}const{target:n,key:r}=Fw(i,t);e.__r3f.previousAttach=n[r],n[r]=e}else e.__r3f.previousAttach=t(i,e)}function vT(i,e,t){var n,r;if(Zn.str(t)){const{target:s,key:o}=Fw(i,t),a=e.__r3f.previousAttach;a===void 0?delete s[o]:s[o]=a}else(n=e.__r3f)==null||n.previousAttach==null||n.previousAttach(i,e);(r=e.__r3f)==null||delete r.previousAttach}function DP(i,{children:e,key:t,ref:n,...r},{children:s,key:o,ref:a,...c}={},h=!1){var d;const l=(d=i==null?void 0:i.__r3f)!=null?d:{},u=Object.entries(r),p=[];if(h){const y=Object.keys(c);for(let x=0;x<y.length;x++)r.hasOwnProperty(y[x])||u.unshift([y[x],IP+"remove"])}u.forEach(([y,x])=>{var v;if((v=i.__r3f)!=null&&v.primitive&&y==="object"||Zn.equ(x,c[y]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(y))return p.push([y,x,!0,[]]);let w=[];y.includes("-")&&(w=y.split("-")),p.push([y,x,!1,w])});const g={...r};return l.memoizedProps&&l.memoizedProps.args&&(g.args=l.memoizedProps.args),l.memoizedProps&&l.memoizedProps.attach&&(g.attach=l.memoizedProps.attach),{memoized:g,changes:p}}function Wy(i,e){var t,n;const r=(t=i.__r3f)!=null?t:{},s=r.root,o=(n=s==null||s.getState==null?void 0:s.getState())!=null?n:{},{memoized:a,changes:c}=E4(e)?e:DP(i,e),h=r.eventCount;if(i.__r3f&&(i.__r3f.memoizedProps=a),c.forEach(([d,l,u,p])=>{let g=i,y=g[d];if(p.length&&(y=p.reduce((w,S)=>w[S],i),!(y&&y.set))){const[w,...S]=p.reverse();g=S.reverse().reduce((b,E)=>b[E],i),d=w}if(l===IP+"remove")if(y&&y.constructor){var x;l=new y.constructor(...(x=a.args)!=null?x:[])}else if(g.constructor){var v;const w=new g.constructor(...(v=g.__r3f.memoizedProps.args)!=null?v:[]);l=w[y],w.dispose&&w.dispose()}else l=0;if(u)l?r.handlers[d]=l:delete r.handlers[d],r.eventCount=Object.keys(r.handlers).length;else if(y&&y.set&&(y.copy||y instanceof Rl)){if(Array.isArray(l))y.fromArray?y.fromArray(l):y.set(...l);else if(y.copy&&l&&l.constructor&&y.constructor.name===l.constructor.name)y.copy(l);else if(l!==void 0){const w=y instanceof qe;!w&&y.setScalar?y.setScalar(l):y instanceof Rl&&l instanceof Rl?y.mask=l.mask:y.set(l),!("ColorManagement"in Ig)&&!o.linear&&w&&y.convertSRGBToLinear()}}else g[d]=l,!o.linear&&g[d]instanceof hn&&(g[d].encoding=Ht);Bc(i)}),r.parent&&o.internal&&i.raycast&&h!==r.eventCount){const d=o.internal.interaction.indexOf(i);d>-1&&o.internal.interaction.splice(d,1),r.eventCount&&o.internal.interaction.push(i)}return c.length&&i.parent&&Dw(i),i}function Bc(i){var e,t;const n=(e=i.__r3f)==null||(t=e.root)==null||t.getState==null?void 0:t.getState();n&&n.internal.frames===0&&n.invalidate()}function Dw(i){i.onUpdate==null||i.onUpdate(i)}function A4(i,e){i.manual||(RP(i)?(i.left=e.width/-2,i.right=e.width/2,i.top=e.height/2,i.bottom=e.height/-2):i.aspect=e.width/e.height,i.updateProjectionMatrix(),i.updateMatrixWorld())}function C4(i,e,t){const n=t.pop(),r=t.reduce((s,o)=>s[o],i);return r[n]=e}function jy(i){return(i.eventObject||i.object).uuid+"/"+i.index+i.instanceId}function P4(){var i,e;switch((i=window)==null||(e=i.event)==null?void 0:e.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return hu.exports.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return hu.exports.ContinuousEventPriority;default:return hu.exports.DefaultEventPriority}}function BP(i,e,t,n){const r=t.get(e);r&&(t.delete(e),t.size===0&&(i.delete(n),r.target.releasePointerCapture(n)))}function R4(i,e){const{internal:t}=i.getState();t.interaction=t.interaction.filter(n=>n!==e),t.initialHits=t.initialHits.filter(n=>n!==e),t.hovered.forEach((n,r)=>{(n.eventObject===e||n.object===e)&&t.hovered.delete(r)}),t.capturedMap.forEach((n,r)=>{BP(t.capturedMap,e,n,r)})}function L4(i){const e=new B;function t(h){const{internal:d}=i.getState(),l=h.offsetX-d.initialClick[0],u=h.offsetY-d.initialClick[1];return Math.round(Math.sqrt(l*l+u*u))}function n(h){return h.filter(d=>["Move","Over","Enter","Out","Leave"].some(l=>{var u;return(u=d.__r3f)==null?void 0:u.handlers["onPointer"+l]}))}function r(h,d){const l=i.getState(),u=new Set,p=[],g=d?d(l.internal.interaction):l.internal.interaction;g.forEach(v=>{const w=Mm(v);w&&(w.raycaster.camera=void 0)}),l.previousRoot||l.events.compute==null||l.events.compute(h,l);let y=g.flatMap(v=>{const w=Mm(v);if(!w||!w.events.enabled||w.raycaster.camera===null)return[];if(w.raycaster.camera===void 0){var S;w.events.compute==null||w.events.compute(h,w,(S=w.previousRoot)==null?void 0:S.getState()),w.raycaster.camera===void 0&&(w.raycaster.camera=null)}return w.raycaster.camera?w.raycaster.intersectObject(v,!0):[]}).sort((v,w)=>{const S=Mm(v.object),b=Mm(w.object);return!S||!b?0:b.events.priority-S.events.priority||v.distance-w.distance}).filter(v=>{const w=jy(v);return u.has(w)?!1:(u.add(w),!0)});l.events.filter&&(y=l.events.filter(y,l));for(const v of y){let w=v.object;for(;w;){var x;(x=w.__r3f)!=null&&x.eventCount&&p.push({...v,eventObject:w}),w=w.parent}}if("pointerId"in h&&l.internal.capturedMap.has(h.pointerId))for(let v of l.internal.capturedMap.get(h.pointerId).values())p.push(v.intersection);return p}function s(h,d,l,u){const{raycaster:p,pointer:g,camera:y,internal:x}=i.getState();if(h.length){const v=e.set(g.x,g.y,0).unproject(y),w={stopped:!1};for(const S of h){const b=N=>{var F,C;return(F=(C=x.capturedMap.get(N))==null?void 0:C.has(S.eventObject))!=null?F:!1},E=N=>{const F={intersection:S,target:d.target};x.capturedMap.has(N)?x.capturedMap.get(N).set(S.eventObject,F):x.capturedMap.set(N,new Map([[S.eventObject,F]])),d.target.setPointerCapture(N)},R=N=>{const F=x.capturedMap.get(N);F&&BP(x.capturedMap,S.eventObject,F,N)};let z={};for(let N in d){let F=d[N];typeof F!="function"&&(z[N]=F)}let I={...S,...z,pointer:g,intersections:h,stopped:w.stopped,delta:l,unprojectedPoint:v,ray:p.ray,camera:y,stopPropagation:()=>{const N="pointerId"in d&&x.capturedMap.get(d.pointerId);if((!N||N.has(S.eventObject))&&(I.stopped=w.stopped=!0,x.hovered.size&&Array.from(x.hovered.values()).find(F=>F.eventObject===S.eventObject))){const F=h.slice(0,h.indexOf(S));o([...F,S])}},target:{hasPointerCapture:b,setPointerCapture:E,releasePointerCapture:R},currentTarget:{hasPointerCapture:b,setPointerCapture:E,releasePointerCapture:R},nativeEvent:d};if(u(I),w.stopped===!0)break}}return h}function o(h){const{internal:d}=i.getState();Array.from(d.hovered.values()).forEach(l=>{if(!h.length||!h.find(u=>u.object===l.object&&u.index===l.index&&u.instanceId===l.instanceId)){const p=l.eventObject.__r3f,g=p==null?void 0:p.handlers;if(d.hovered.delete(jy(l)),p!=null&&p.eventCount){const y={...l,intersections:h};g.onPointerOut==null||g.onPointerOut(y),g.onPointerLeave==null||g.onPointerLeave(y)}}})}const a=h=>{switch(h){case"onPointerLeave":case"onPointerCancel":return()=>o([]);case"onLostPointerCapture":return d=>{const{internal:l}=i.getState();"pointerId"in d&&!l.capturedMap.has(d.pointerId)&&(l.capturedMap.delete(d.pointerId),o([]))}}return d=>{const{onPointerMissed:l,internal:u}=i.getState();u.lastEvent.current=d;const p=h==="onPointerMove",g=h==="onClick"||h==="onContextMenu"||h==="onDoubleClick",x=r(d,p?n:void 0),v=g?t(d):0;h==="onPointerDown"&&(u.initialClick=[d.offsetX,d.offsetY],u.initialHits=x.map(w=>w.eventObject)),g&&!x.length&&v<=2&&(c(d,u.interaction),l&&l(d)),p&&o(x),s(x,d,v,w=>{const S=w.eventObject,b=S.__r3f,E=b==null?void 0:b.handlers;if(!!(b!=null&&b.eventCount))if(p){if(E.onPointerOver||E.onPointerEnter||E.onPointerOut||E.onPointerLeave){const R=jy(w),z=u.hovered.get(R);z?z.stopped&&w.stopPropagation():(u.hovered.set(R,w),E.onPointerOver==null||E.onPointerOver(w),E.onPointerEnter==null||E.onPointerEnter(w))}E.onPointerMove==null||E.onPointerMove(w)}else{const R=E[h];R?(!g||u.initialHits.includes(S))&&(c(d,u.interaction.filter(z=>!u.initialHits.includes(z))),R(w)):g&&u.initialHits.includes(S)&&c(d,u.interaction.filter(z=>!u.initialHits.includes(z)))}})}};function c(h,d){d.forEach(l=>{var u;return(u=l.__r3f)==null||u.handlers.onPointerMissed==null?void 0:u.handlers.onPointerMissed(h)})}return{handlePointer:a}}let Bw={},k4=i=>void(Bw={...Bw,...i});function I4(i,e){function t(d,{args:l=[],attach:u,...p},g){let y=`${d[0].toUpperCase()}${d.slice(1)}`,x;if(d==="primitive"){if(p.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const v=p.object;x=Dc(v,{type:d,root:g,attach:u,primitive:!0})}else{const v=Bw[y];if(!v)throw new Error(`R3F: ${y} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(l))throw new Error("R3F: The args prop must be an array!");x=Dc(new v(...l),{type:d,root:g,attach:u,memoizedProps:{args:l}})}return x.__r3f.attach===void 0&&(x instanceof vt?x.__r3f.attach="geometry":x instanceof An&&(x.__r3f.attach="material")),y!=="inject"&&Wy(x,p),x}function n(d,l){let u=!1;if(l){var p,g;(p=l.__r3f)!=null&&p.attach?Gy(d,l,l.__r3f.attach):l.isObject3D&&d.isObject3D&&(d.add(l),u=!0),u||(g=d.__r3f)==null||g.objects.push(l),l.__r3f||Dc(l,{}),l.__r3f.parent=d,Dw(l),Bc(l)}}function r(d,l,u){let p=!1;if(l){var g,y;if((g=l.__r3f)!=null&&g.attach)Gy(d,l,l.__r3f.attach);else if(l.isObject3D&&d.isObject3D){l.parent=d,l.dispatchEvent({type:"added"});const x=d.children.filter(w=>w!==l),v=x.indexOf(u);d.children=[...x.slice(0,v),l,...x.slice(v)],p=!0}p||(y=d.__r3f)==null||y.objects.push(l),l.__r3f||Dc(l,{}),l.__r3f.parent=d,Dw(l),Bc(l)}}function s(d,l,u=!1){d&&[...d].forEach(p=>o(l,p,u))}function o(d,l,u){if(l){var p,g,y;if(l.__r3f&&(l.__r3f.parent=null),(p=d.__r3f)!=null&&p.objects&&(d.__r3f.objects=d.__r3f.objects.filter(b=>b!==l)),(g=l.__r3f)!=null&&g.attach)vT(d,l,l.__r3f.attach);else if(l.isObject3D&&d.isObject3D){var x;d.remove(l),(x=l.__r3f)!=null&&x.root&&R4(l.__r3f.root,l)}const w=(y=l.__r3f)==null?void 0:y.primitive,S=u===void 0?l.dispose!==null&&!w:u;if(!w){var v;s((v=l.__r3f)==null?void 0:v.objects,l,S),s(l.children,l,S)}l.__r3f&&(delete l.__r3f.root,delete l.__r3f.objects,delete l.__r3f.handlers,delete l.__r3f.memoizedProps,w||delete l.__r3f),S&&l.dispose&&l.type!=="Scene"&&Fg.exports.unstable_scheduleCallback(Fg.exports.unstable_IdlePriority,()=>{try{l.dispose()}catch{}}),Bc(d)}}function a(d,l,u,p){var g;const y=(g=d.__r3f)==null?void 0:g.parent;if(!y)return;const x=t(l,u,d.__r3f.root);if(d.children){for(const v of d.children)v.__r3f&&n(x,v);d.children=d.children.filter(v=>!v.__r3f)}d.__r3f.objects.forEach(v=>n(x,v)),d.__r3f.objects=[],o(y,d),n(y,x),x.raycast&&x.__r3f.eventCount&&x.__r3f.root.getState().internal.interaction.push(x),[p,p.alternate].forEach(v=>{v!==null&&(v.stateNode=x,v.ref&&(typeof v.ref=="function"?v.ref(x):v.ref.current=x))})}const c=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:b4({createInstance:t,removeChild:o,appendChild:n,appendInitialChild:n,insertBefore:r,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(d,l)=>{if(!l)return;const u=d.getState().scene;u.__r3f.root=d,n(u,l)},removeChildFromContainer:(d,l)=>{!l||o(d.getState().scene,l)},insertInContainerBefore:(d,l,u)=>{!l||!u||r(d.getState().scene,l,u)},getRootHostContext:()=>null,getChildHostContext:d=>d,finalizeInitialChildren(d){var l;const u=(l=d==null?void 0:d.__r3f)!=null?l:{};return Boolean(u.handlers)},prepareUpdate(d,l,u,p){if(d.__r3f.primitive&&p.object&&p.object!==d)return[!0];{const{args:g=[],children:y,...x}=p,{args:v=[],children:w,...S}=u;if(!Array.isArray(g))throw new Error("R3F: the args prop must be an array!");if(g.some((E,R)=>E!==v[R]))return[!0];const b=DP(d,x,S,!0);return b.changes.length?[!1,b]:null}},commitUpdate(d,[l,u],p,g,y,x){l?a(d,p,y,x):Wy(d,u)},commitMount(d,l,u,p){var g;const y=(g=d.__r3f)!=null?g:{};d.raycast&&y.handlers&&y.eventCount&&d.__r3f.root.getState().internal.interaction.push(d)},getPublicInstance:d=>d,prepareForCommit:()=>null,preparePortalMount:d=>Dc(d.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(d){var l;const{attach:u,parent:p}=(l=d.__r3f)!=null?l:{};u&&p&&vT(p,d,u),d.isObject3D&&(d.visible=!1),Bc(d)},unhideInstance(d,l){var u;const{attach:p,parent:g}=(u=d.__r3f)!=null?u:{};p&&g&&Gy(g,d,p),(d.isObject3D&&l.visible==null||l.visible)&&(d.visible=!0),Bc(d)},createTextInstance:c,hideTextInstance:c,unhideTextInstance:c,getCurrentEventPriority:()=>e?e():hu.exports.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance!="undefined"&&Zn.fun(performance.now)?performance.now:Zn.fun(Date.now)?Date.now:()=>0,scheduleTimeout:Zn.fun(setTimeout)?setTimeout:void 0,cancelTimeout:Zn.fun(clearTimeout)?clearTimeout:void 0}),applyProps:Wy}}const zP=i=>!!(i!=null&&i.render),OP=St.exports.createContext(null),F4=(i,e)=>{const t=_4((a,c)=>{const h=new B,d=new B,l=new B;function u(v=c().camera,w=d,S=c().size){const{width:b,height:E,top:R,left:z}=S,I=b/E;w instanceof B?l.copy(w):l.set(...w);const N=v.getWorldPosition(h).distanceTo(l);if(RP(v))return{width:b/v.zoom,height:E/v.zoom,top:R,left:z,factor:1,distance:N,aspect:I};{const F=v.fov*Math.PI/180,C=2*Math.tan(F/2)*N,O=C*(b/E);return{width:O,height:C,top:R,left:z,factor:b/O,distance:N,aspect:I}}}let p;const g=v=>a(w=>({performance:{...w.performance,current:v}})),y=new Me;return{set:a,get:c,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,invalidate:(v=1)=>i(c(),v),advance:(v,w)=>e(v,w,c()),legacy:!1,linear:!1,flat:!1,scene:Dc(new $u),controls:null,clock:new Av,pointer:y,mouse:y,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const v=c();p&&clearTimeout(p),v.performance.current!==v.performance.min&&g(v.performance.min),p=setTimeout(()=>g(c().performance.max),v.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:u},setEvents:v=>a(w=>({...w,events:{...w.events,...v}})),setSize:(v,w,S,b,E)=>{const R=c().camera,z={width:v,height:w,top:b||0,left:E||0,updateStyle:S};a(I=>({size:z,viewport:{...I.viewport,...u(R,d,z)}}))},setDpr:v=>a(w=>{const S=FP(v);return{viewport:{...w.viewport,dpr:S,initialDpr:w.viewport.initialDpr||S}}}),setFrameloop:(v="always")=>{const w=c().clock;w.stop(),w.elapsedTime=0,v!=="never"&&(w.start(),w.elapsedTime=0),a(()=>({frameloop:v}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:St.exports.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(v,w,S)=>{const b=c().internal;return b.priority=b.priority+(w>0?1:0),b.subscribers.push({ref:v,priority:w,store:S}),b.subscribers=b.subscribers.sort((E,R)=>E.priority-R.priority),()=>{const E=c().internal;E!=null&&E.subscribers&&(E.priority=E.priority-(w>0?1:0),E.subscribers=E.subscribers.filter(R=>R.ref!==v))}}}}}),n=t.getState();let r=n.size,s=n.viewport.dpr,o=n.camera;return t.subscribe(()=>{const{camera:a,size:c,viewport:h,gl:d,set:l}=t.getState();(c!==r||h.dpr!==s)&&(r=c,s=h.dpr,A4(a,c),d.setPixelRatio(h.dpr),d.setSize(c.width,c.height,c.updateStyle)),a!==o&&(o=a,l(u=>({viewport:{...u.viewport,...u.viewport.getCurrentViewport(a)}})))}),t.subscribe(a=>i(a)),t};let Em,Xy=new Set,qy=new Set,yT=new Set;function jh(i,e){i.forEach(({callback:t})=>t(e))}let Yy,$y;function Qy(i,e,t){let n=e.clock.getDelta();for(e.frameloop==="never"&&typeof i=="number"&&(n=i-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=i),Yy=e.internal.subscribers,Em=0;Em<Yy.length;Em++)$y=Yy[Em],$y.ref.current($y.store.getState(),n,t);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}function D4(i){let e=!1,t,n,r;function s(c){if(n=requestAnimationFrame(s),e=!0,t=0,Xy.size&&jh(Xy,c),i.forEach(h=>{var d;r=h.store.getState(),r.internal.active&&(r.frameloop==="always"||r.internal.frames>0)&&!((d=r.gl.xr)!=null&&d.isPresenting)&&(t+=Qy(c,r))}),qy.size&&jh(qy,c),t===0)return yT.size&&jh(yT,c),e=!1,cancelAnimationFrame(n)}function o(c,h=1){var d;if(!c)return i.forEach(l=>o(l.store.getState()),h);(d=c.gl.xr)!=null&&d.isPresenting||!c.internal.active||c.frameloop==="never"||(c.internal.frames=Math.min(60,c.internal.frames+h),e||(e=!0,requestAnimationFrame(s)))}function a(c,h=!0,d,l){h&&jh(Xy,c),d?Qy(c,d,l):i.forEach(u=>Qy(c,u.store.getState())),h&&jh(qy,c)}return{loop:s,invalidate:o,advance:a}}function NP(){const i=St.exports.useContext(OP);if(!i)throw new Error("R3F: Hooks can only be used within the Canvas component!");return i}function ia(i=t=>t,e){return NP()(i,e)}function B4(i,e=0){const t=NP(),n=t.getState().internal.subscribe,r=LP(i);return Sf(()=>n(r,e,t),[e,n,t]),null}const Ou=new Map,{invalidate:xT,advance:wT}=D4(Ou),{reconciler:Dg,applyProps:Tm}=I4(Ou,P4),Ic={objects:"shallow",strict:!1},z4=(i,e)=>{const t=typeof i=="function"?i(e):i;return zP(t)?t:new ln({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...i})};function O4(i){return i instanceof HTMLCanvasElement}function N4(i,e){if(e)return e;if(O4(i)&&i.parentElement){const{width:t,height:n,top:r,left:s}=i.parentElement.getBoundingClientRect();return{width:t,height:n,top:r,left:s}}return{width:0,height:0,top:0,left:0}}function U4(i){const e=Ou.get(i),t=e==null?void 0:e.fiber,n=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const r=typeof reportError=="function"?reportError:console.error,s=n||F4(xT,wT),o=t||Dg.createContainer(s,hu.exports.ConcurrentRoot,null,!1,null,"",r,null);e||Ou.set(i,{fiber:o,store:s});let a,c=!1;return{configure(h={}){let{gl:d,size:l,events:u,onCreated:p,shadows:g=!1,linear:y=!1,flat:x=!1,legacy:v=!1,orthographic:w=!1,frameloop:S="always",dpr:b=[1,2],performance:E,raycaster:R,camera:z,onPointerMissed:I}=h,N=s.getState(),F=N.gl;N.gl||N.set({gl:F=z4(d,i)});let C=N.raycaster;C||N.set({raycaster:C=new _f});const{params:O,...X}=R||{};if(Zn.equ(X,C,Ic)||Tm(C,{...X}),Zn.equ(O,C.params,Ic)||Tm(C,{params:{...C.params,...O}}),!N.camera){const j=z instanceof Xu,k=j?z:w?new Fr(0,0,0,0,.1,1e3):new Mn(75,0,.1,1e3);j||(k.position.z=5,z&&Tm(k,z),z!=null&&z.rotation||k.lookAt(0,0,0)),N.set({camera:k})}if(!N.xr){const j=(Y,H)=>{const J=s.getState();J.frameloop!=="never"&&wT(Y,!0,J,H)},k=()=>{const Y=s.getState();Y.gl.xr.enabled=Y.gl.xr.isPresenting,Y.gl.xr.setAnimationLoop(Y.gl.xr.isPresenting?j:null),Y.gl.xr.isPresenting||xT(Y)},W={connect(){const Y=s.getState().gl;Y.xr.addEventListener("sessionstart",k),Y.xr.addEventListener("sessionend",k)},disconnect(){const Y=s.getState().gl;Y.xr.removeEventListener("sessionstart",k),Y.xr.removeEventListener("sessionend",k)}};F.xr&&W.connect(),N.set({xr:W})}if(F.shadowMap){const j=Zn.boo(g);if(j&&F.shadowMap.enabled!==g||!Zn.equ(g,F.shadowMap,Ic)){const k=F.shadowMap.enabled;F.shadowMap.enabled=!!g,j?F.shadowMap.type=Q_:Object.assign(F.shadowMap,g),k!==F.shadowMap.enabled&&(F.shadowMap.needsUpdate=!0)}}"ColorManagement"in Ig&&C4(Ig,v,["ColorManagement","legacyMode"]);const U=y?Ts:Ht,te=x?bs:e1;F.outputEncoding!==U&&(F.outputEncoding=U),F.toneMapping!==te&&(F.toneMapping=te),N.legacy!==v&&N.set(()=>({legacy:v})),N.linear!==y&&N.set(()=>({linear:y})),N.flat!==x&&N.set(()=>({flat:x})),d&&!Zn.fun(d)&&!zP(d)&&!Zn.equ(d,F,Ic)&&Tm(F,d),u&&!N.events.handlers&&N.set({events:u(s)}),b&&N.viewport.dpr!==FP(b)&&N.setDpr(b);const ne=N4(i,l);return Zn.equ(ne,N.size,Ic)||N.setSize(ne.width,ne.height,ne.updateStyle,ne.top,ne.left),N.frameloop!==S&&N.setFrameloop(S),N.onPointerMissed||N.set({onPointerMissed:I}),E&&!Zn.equ(E,N.performance,Ic)&&N.set(j=>({performance:{...j.performance,...E}})),a=p,c=!0,this},render(h){return c||this.configure(),Dg.updateContainer(St.exports.createElement(H4,{store:s,children:h,onCreated:a,rootElement:i}),o,null,()=>{}),s},unmount(){UP(i)}}}function H4({store:i,children:e,onCreated:t,rootElement:n}){return Sf(()=>{const r=i.getState();r.set(s=>({internal:{...s.internal,active:!0}})),t&&t(r),i.getState().events.connected||r.events.connect==null||r.events.connect(n)},[]),St.exports.createElement(OP.Provider,{value:i},e)}function UP(i,e){const t=Ou.get(i),n=t==null?void 0:t.fiber;if(n){const r=t==null?void 0:t.store.getState();r&&(r.internal.active=!1),Dg.updateContainer(null,n,null,()=>{r&&setTimeout(()=>{try{var s,o,a,c;r.events.disconnect==null||r.events.disconnect(),(s=r.gl)==null||(o=s.renderLists)==null||o.dispose==null||o.dispose(),(a=r.gl)==null||a.forceContextLoss==null||a.forceContextLoss(),(c=r.gl)!=null&&c.xr&&r.xr.disconnect(),T4(r),Ou.delete(i),e&&e(i)}catch{}},500)})}}Dg.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:St.exports.version});function zw(i,e,t){var n,r,s,o,a;e==null&&(e=100);function c(){var d=Date.now()-o;d<e&&d>=0?n=setTimeout(c,e-d):(n=null,t||(a=i.apply(s,r),s=r=null))}var h=function(){s=this,r=arguments,o=Date.now();var d=t&&!n;return n||(n=setTimeout(c,e)),d&&(a=i.apply(s,r),s=r=null),a};return h.clear=function(){n&&(clearTimeout(n),n=null)},h.flush=function(){n&&(a=i.apply(s,r),s=r=null,clearTimeout(n),n=null)},h}zw.debounce=zw;var _T=zw;function V4(i){let{debounce:e,scroll:t,polyfill:n,offsetSize:r}=i===void 0?{debounce:0,scroll:!1,offsetSize:!1}:i;const s=n||(typeof window=="undefined"?class{}:window.ResizeObserver);if(!s)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[o,a]=St.exports.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),c=St.exports.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:o}),h=e?typeof e=="number"?e:e.scroll:null,d=e?typeof e=="number"?e:e.resize:null,l=St.exports.useRef(!1);St.exports.useEffect(()=>(l.current=!0,()=>void(l.current=!1)));const[u,p,g]=St.exports.useMemo(()=>{const w=()=>{if(!c.current.element)return;const{left:S,top:b,width:E,height:R,bottom:z,right:I,x:N,y:F}=c.current.element.getBoundingClientRect(),C={left:S,top:b,width:E,height:R,bottom:z,right:I,x:N,y:F};c.current.element instanceof HTMLElement&&r&&(C.height=c.current.element.offsetHeight,C.width=c.current.element.offsetWidth),Object.freeze(C),l.current&&!X4(c.current.lastBounds,C)&&a(c.current.lastBounds=C)};return[w,d?_T(w,d):w,h?_T(w,h):w]},[a,r,h,d]);function y(){c.current.scrollContainers&&(c.current.scrollContainers.forEach(w=>w.removeEventListener("scroll",g,!0)),c.current.scrollContainers=null),c.current.resizeObserver&&(c.current.resizeObserver.disconnect(),c.current.resizeObserver=null)}function x(){!c.current.element||(c.current.resizeObserver=new s(g),c.current.resizeObserver.observe(c.current.element),t&&c.current.scrollContainers&&c.current.scrollContainers.forEach(w=>w.addEventListener("scroll",g,{capture:!0,passive:!0})))}const v=w=>{!w||w===c.current.element||(y(),c.current.element=w,c.current.scrollContainers=HP(w),x())};return W4(g,Boolean(t)),G4(p),St.exports.useEffect(()=>{y(),x()},[t,g,p]),St.exports.useEffect(()=>y,[]),[v,o,u]}function G4(i){St.exports.useEffect(()=>{const e=i;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[i])}function W4(i,e){St.exports.useEffect(()=>{if(e){const t=i;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",t,!0)}},[i,e])}function HP(i){const e=[];if(!i||i===document.body)return e;const{overflow:t,overflowX:n,overflowY:r}=window.getComputedStyle(i);return[t,n,r].some(s=>s==="auto"||s==="scroll")&&e.push(i),[...e,...HP(i.parentElement)]}const j4=["x","y","top","bottom","left","right","width","height"],X4=(i,e)=>j4.every(t=>i[t]===e[t]),Zy={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function q4(i){const{handlePointer:e}=L4(i);return{priority:1,enabled:!0,compute(t,n,r){n.pointer.set(t.offsetX/n.size.width*2-1,-(t.offsetY/n.size.height)*2+1),n.raycaster.setFromCamera(n.pointer,n.camera)},connected:void 0,handlers:Object.keys(Zy).reduce((t,n)=>({...t,[n]:e(n)}),{}),connect:t=>{var n;const{set:r,events:s}=i.getState();s.disconnect==null||s.disconnect(),r(o=>({events:{...o.events,connected:t}})),Object.entries((n=s.handlers)!=null?n:[]).forEach(([o,a])=>{const[c,h]=Zy[o];t.addEventListener(c,a,{passive:h})})},disconnect:()=>{const{set:t,events:n}=i.getState();if(n.connected){var r;Object.entries((r=n.handlers)!=null?r:[]).forEach(([s,o])=>{if(n&&n.connected instanceof HTMLElement){const[a]=Zy[s];n.connected.removeEventListener(a,o)}}),t(s=>({events:{...s.events,connected:void 0}}))}}}}const Y4=St.exports.forwardRef(function({children:e,fallback:t,resize:n,style:r,gl:s,events:o=q4,eventSource:a,eventPrefix:c,shadows:h,linear:d,flat:l,legacy:u,orthographic:p,frameloop:g,dpr:y,performance:x,raycaster:v,camera:w,onPointerMissed:S,onCreated:b,...E},R){St.exports.useMemo(()=>k4(Ig),[]);const[z,I]=V4({scroll:!0,debounce:{scroll:50,resize:0},...n}),N=St.exports.useRef(null),F=St.exports.useRef(null),[C,O]=St.exports.useState(null);St.exports.useImperativeHandle(R,()=>N.current);const X=LP(S),[U,te]=St.exports.useState(!1),[ne,j]=St.exports.useState(!1);if(U)throw U;if(ne)throw ne;const k=St.exports.useRef(null);return I.width>0&&I.height>0&&C&&(k.current||(k.current=U4(C)),k.current.configure({gl:s,events:o,shadows:h,linear:d,flat:l,legacy:u,orthographic:p,frameloop:g,dpr:y,performance:x,raycaster:v,camera:w,size:I,onPointerMissed:(...W)=>X.current==null?void 0:X.current(...W),onCreated:W=>{W.events.connect==null||W.events.connect(a||F.current),c&&W.setEvents({compute:(Y,H)=>{const J=Y[c+"X"],K=Y[c+"Y"];H.pointer.set(J/H.size.width*2-1,-(K/H.size.height)*2+1),H.raycaster.setFromCamera(H.pointer,H.camera)}}),b==null||b(W)}}),k.current.render(St.exports.createElement(kP,{set:j},St.exports.createElement(St.exports.Suspense,{fallback:St.exports.createElement(M4,{set:te})},e)))),Sf(()=>{O(N.current)},[]),St.exports.useEffect(()=>{if(C)return()=>UP(C)},[C]),St.exports.createElement("div",Pg({ref:F,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",...r}},E),St.exports.createElement("div",{ref:z,style:{width:"100%",height:"100%"}},St.exports.createElement("canvas",{ref:N,style:{display:"block"}},t)))});var $4=Object.defineProperty,Q4=(i,e,t)=>e in i?$4(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Z4=(i,e,t)=>(Q4(i,typeof e!="symbol"?e+"":e,t),t);class K4{constructor(){Z4(this,"_listeners")}addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const n=this._listeners[e.type];if(n!==void 0){e.target=this;const r=n.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}var J4=Object.defineProperty,eU=(i,e,t)=>e in i?J4(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Mt=(i,e,t)=>(eU(i,typeof e!="symbol"?e+"":e,t),t);const Am=new Oo,ST=new vs,tU=Math.cos(70*(Math.PI/180)),bT=(i,e)=>(i%e+e)%e;class nU extends K4{constructor(e,t){super(),Mt(this,"object"),Mt(this,"domElement"),Mt(this,"enabled",!0),Mt(this,"target",new B),Mt(this,"minDistance",0),Mt(this,"maxDistance",1/0),Mt(this,"minZoom",0),Mt(this,"maxZoom",1/0),Mt(this,"minPolarAngle",0),Mt(this,"maxPolarAngle",Math.PI),Mt(this,"minAzimuthAngle",-1/0),Mt(this,"maxAzimuthAngle",1/0),Mt(this,"enableDamping",!1),Mt(this,"dampingFactor",.05),Mt(this,"enableZoom",!0),Mt(this,"zoomSpeed",1),Mt(this,"enableRotate",!0),Mt(this,"rotateSpeed",1),Mt(this,"enablePan",!0),Mt(this,"panSpeed",1),Mt(this,"screenSpacePanning",!0),Mt(this,"keyPanSpeed",7),Mt(this,"zoomToCursor",!1),Mt(this,"autoRotate",!1),Mt(this,"autoRotateSpeed",2),Mt(this,"reverseOrbit",!1),Mt(this,"reverseHorizontalOrbit",!1),Mt(this,"reverseVerticalOrbit",!1),Mt(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),Mt(this,"mouseButtons",{LEFT:Ar.ROTATE,MIDDLE:Ar.DOLLY,RIGHT:Ar.PAN}),Mt(this,"touches",{ONE:Cr.ROTATE,TWO:Cr.DOLLY_PAN}),Mt(this,"target0"),Mt(this,"position0"),Mt(this,"zoom0"),Mt(this,"_domElementKeyEvents",null),Mt(this,"getPolarAngle"),Mt(this,"getAzimuthalAngle"),Mt(this,"setPolarAngle"),Mt(this,"setAzimuthalAngle"),Mt(this,"getDistance"),Mt(this,"getZoomScale"),Mt(this,"listenToKeyEvents"),Mt(this,"stopListenToKeyEvents"),Mt(this,"saveState"),Mt(this,"reset"),Mt(this,"update"),Mt(this,"connect"),Mt(this,"dispose"),Mt(this,"dollyIn"),Mt(this,"dollyOut"),Mt(this,"getScale"),Mt(this,"setScale"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>d.phi,this.getAzimuthalAngle=()=>d.theta,this.setPolarAngle=ae=>{let Te=bT(ae,2*Math.PI),Ge=d.phi;Ge<0&&(Ge+=2*Math.PI),Te<0&&(Te+=2*Math.PI);let ze=Math.abs(Te-Ge);2*Math.PI-ze<ze&&(Te<Ge?Te+=2*Math.PI:Ge+=2*Math.PI),l.phi=Te-Ge,n.update()},this.setAzimuthalAngle=ae=>{let Te=bT(ae,2*Math.PI),Ge=d.theta;Ge<0&&(Ge+=2*Math.PI),Te<0&&(Te+=2*Math.PI);let ze=Math.abs(Te-Ge);2*Math.PI-ze<ze&&(Te<Ge?Te+=2*Math.PI:Ge+=2*Math.PI),l.theta=Te-Ge,n.update()},this.getDistance=()=>n.object.position.distanceTo(n.target),this.listenToKeyEvents=ae=>{ae.addEventListener("keydown",be),this._domElementKeyEvents=ae},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",be),this._domElementKeyEvents=null},this.saveState=()=>{n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=()=>{n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(r),n.update(),c=a.NONE},this.update=(()=>{const ae=new B,Te=new B(0,1,0),Ge=new qt().setFromUnitVectors(e.up,Te),ze=Ge.clone().invert(),ct=new B,Pt=new qt,xt=2*Math.PI;return function(){const Cn=n.object.position;Ge.setFromUnitVectors(e.up,Te),ze.copy(Ge).invert(),ae.copy(Cn).sub(n.target),ae.applyQuaternion(Ge),d.setFromVector3(ae),n.autoRotate&&c===a.NONE&&U(O()),n.enableDamping?(d.theta+=l.theta*n.dampingFactor,d.phi+=l.phi*n.dampingFactor):(d.theta+=l.theta,d.phi+=l.phi);let Un=n.minAzimuthAngle,Fn=n.maxAzimuthAngle;isFinite(Un)&&isFinite(Fn)&&(Un<-Math.PI?Un+=xt:Un>Math.PI&&(Un-=xt),Fn<-Math.PI?Fn+=xt:Fn>Math.PI&&(Fn-=xt),Un<=Fn?d.theta=Math.max(Un,Math.min(Fn,d.theta)):d.theta=d.theta>(Un+Fn)/2?Math.max(Un,d.theta):Math.min(Fn,d.theta)),d.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,d.phi)),d.makeSafe(),n.enableDamping===!0?n.target.addScaledVector(p,n.dampingFactor):n.target.add(p),n.zoomToCursor&&N||n.object.isOrthographicCamera?d.radius=K(d.radius):d.radius=K(d.radius*u),ae.setFromSpherical(d),ae.applyQuaternion(ze),Cn.copy(n.target).add(ae),n.object.matrixAutoUpdate||n.object.updateMatrix(),n.object.lookAt(n.target),n.enableDamping===!0?(l.theta*=1-n.dampingFactor,l.phi*=1-n.dampingFactor,p.multiplyScalar(1-n.dampingFactor)):(l.set(0,0,0),p.set(0,0,0));let Ai=!1;if(n.zoomToCursor&&N){let sn=null;if(n.object instanceof Mn&&n.object.isPerspectiveCamera){const Le=ae.length();sn=K(Le*u);const Be=Le-sn;n.object.position.addScaledVector(z,Be),n.object.updateMatrixWorld()}else if(n.object.isOrthographicCamera){const Le=new B(I.x,I.y,0);Le.unproject(n.object),n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/u)),n.object.updateProjectionMatrix(),Ai=!0;const Be=new B(I.x,I.y,0);Be.unproject(n.object),n.object.position.sub(Be).add(Le),n.object.updateMatrixWorld(),sn=ae.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),n.zoomToCursor=!1;sn!==null&&(n.screenSpacePanning?n.target.set(0,0,-1).transformDirection(n.object.matrix).multiplyScalar(sn).add(n.object.position):(Am.origin.copy(n.object.position),Am.direction.set(0,0,-1).transformDirection(n.object.matrix),Math.abs(n.object.up.dot(Am.direction))<tU?e.lookAt(n.target):(ST.setFromNormalAndCoplanarPoint(n.object.up,n.target),Am.intersectPlane(ST,n.target))))}else n.object instanceof Fr&&n.object.isOrthographicCamera&&(Ai=u!==1,Ai&&(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/u)),n.object.updateProjectionMatrix()));return u=1,N=!1,Ai||ct.distanceToSquared(n.object.position)>h||8*(1-Pt.dot(n.object.quaternion))>h?(n.dispatchEvent(r),ct.copy(n.object.position),Pt.copy(n.object.quaternion),Ai=!1,!0):!1}})(),this.connect=ae=>{n.domElement=ae,n.domElement.style.touchAction="none",n.domElement.addEventListener("contextmenu",Fe),n.domElement.addEventListener("pointerdown",P),n.domElement.addEventListener("pointercancel",q),n.domElement.addEventListener("wheel",ge)},this.dispose=()=>{var ae,Te,Ge,ze,ct,Pt;n.domElement&&(n.domElement.style.touchAction="auto"),(ae=n.domElement)==null||ae.removeEventListener("contextmenu",Fe),(Te=n.domElement)==null||Te.removeEventListener("pointerdown",P),(Ge=n.domElement)==null||Ge.removeEventListener("pointercancel",q),(ze=n.domElement)==null||ze.removeEventListener("wheel",ge),(ct=n.domElement)==null||ct.ownerDocument.removeEventListener("pointermove",T),(Pt=n.domElement)==null||Pt.ownerDocument.removeEventListener("pointerup",q),n._domElementKeyEvents!==null&&n._domElementKeyEvents.removeEventListener("keydown",be)};const n=this,r={type:"change"},s={type:"start"},o={type:"end"},a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let c=a.NONE;const h=1e-6,d=new Zd,l=new Zd;let u=1;const p=new B,g=new Me,y=new Me,x=new Me,v=new Me,w=new Me,S=new Me,b=new Me,E=new Me,R=new Me,z=new B,I=new Me;let N=!1;const F=[],C={};function O(){return 2*Math.PI/60/60*n.autoRotateSpeed}function X(){return Math.pow(.95,n.zoomSpeed)}function U(ae){n.reverseOrbit||n.reverseHorizontalOrbit?l.theta+=ae:l.theta-=ae}function te(ae){n.reverseOrbit||n.reverseVerticalOrbit?l.phi+=ae:l.phi-=ae}const ne=(()=>{const ae=new B;return function(Ge,ze){ae.setFromMatrixColumn(ze,0),ae.multiplyScalar(-Ge),p.add(ae)}})(),j=(()=>{const ae=new B;return function(Ge,ze){n.screenSpacePanning===!0?ae.setFromMatrixColumn(ze,1):(ae.setFromMatrixColumn(ze,0),ae.crossVectors(n.object.up,ae)),ae.multiplyScalar(Ge),p.add(ae)}})(),k=(()=>{const ae=new B;return function(Ge,ze){const ct=n.domElement;if(ct&&n.object instanceof Mn&&n.object.isPerspectiveCamera){const Pt=n.object.position;ae.copy(Pt).sub(n.target);let xt=ae.length();xt*=Math.tan(n.object.fov/2*Math.PI/180),ne(2*Ge*xt/ct.clientHeight,n.object.matrix),j(2*ze*xt/ct.clientHeight,n.object.matrix)}else ct&&n.object instanceof Fr&&n.object.isOrthographicCamera?(ne(Ge*(n.object.right-n.object.left)/n.object.zoom/ct.clientWidth,n.object.matrix),j(ze*(n.object.top-n.object.bottom)/n.object.zoom/ct.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}})();function W(ae){n.object instanceof Mn&&n.object.isPerspectiveCamera||n.object instanceof Fr&&n.object.isOrthographicCamera?u=ae:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function Y(ae){W(u/ae)}function H(ae){W(u*ae)}function J(ae){if(!n.zoomToCursor||!n.domElement)return;N=!0;const Te=n.domElement.getBoundingClientRect(),Ge=ae.clientX-Te.left,ze=ae.clientY-Te.top,ct=Te.width,Pt=Te.height;I.x=Ge/ct*2-1,I.y=-(ze/Pt)*2+1,z.set(I.x,I.y,1).unproject(n.object).sub(n.object.position).normalize()}function K(ae){return Math.max(n.minDistance,Math.min(n.maxDistance,ae))}function ee(ae){g.set(ae.clientX,ae.clientY)}function $(ae){J(ae),b.set(ae.clientX,ae.clientY)}function Z(ae){v.set(ae.clientX,ae.clientY)}function Ee(ae){y.set(ae.clientX,ae.clientY),x.subVectors(y,g).multiplyScalar(n.rotateSpeed);const Te=n.domElement;Te&&(U(2*Math.PI*x.x/Te.clientHeight),te(2*Math.PI*x.y/Te.clientHeight)),g.copy(y),n.update()}function Se(ae){E.set(ae.clientX,ae.clientY),R.subVectors(E,b),R.y>0?Y(X()):R.y<0&&H(X()),b.copy(E),n.update()}function de(ae){w.set(ae.clientX,ae.clientY),S.subVectors(w,v).multiplyScalar(n.panSpeed),k(S.x,S.y),v.copy(w),n.update()}function he(ae){J(ae),ae.deltaY<0?H(X()):ae.deltaY>0&&Y(X()),n.update()}function Ce(ae){let Te=!1;switch(ae.code){case n.keys.UP:k(0,n.keyPanSpeed),Te=!0;break;case n.keys.BOTTOM:k(0,-n.keyPanSpeed),Te=!0;break;case n.keys.LEFT:k(n.keyPanSpeed,0),Te=!0;break;case n.keys.RIGHT:k(-n.keyPanSpeed,0),Te=!0;break}Te&&(ae.preventDefault(),n.update())}function me(){if(F.length==1)g.set(F[0].pageX,F[0].pageY);else{const ae=.5*(F[0].pageX+F[1].pageX),Te=.5*(F[0].pageY+F[1].pageY);g.set(ae,Te)}}function fe(){if(F.length==1)v.set(F[0].pageX,F[0].pageY);else{const ae=.5*(F[0].pageX+F[1].pageX),Te=.5*(F[0].pageY+F[1].pageY);v.set(ae,Te)}}function we(){const ae=F[0].pageX-F[1].pageX,Te=F[0].pageY-F[1].pageY,Ge=Math.sqrt(ae*ae+Te*Te);b.set(0,Ge)}function ye(){n.enableZoom&&we(),n.enablePan&&fe()}function _e(){n.enableZoom&&we(),n.enableRotate&&me()}function it(ae){if(F.length==1)y.set(ae.pageX,ae.pageY);else{const Ge=Je(ae),ze=.5*(ae.pageX+Ge.x),ct=.5*(ae.pageY+Ge.y);y.set(ze,ct)}x.subVectors(y,g).multiplyScalar(n.rotateSpeed);const Te=n.domElement;Te&&(U(2*Math.PI*x.x/Te.clientHeight),te(2*Math.PI*x.y/Te.clientHeight)),g.copy(y)}function $e(ae){if(F.length==1)w.set(ae.pageX,ae.pageY);else{const Te=Je(ae),Ge=.5*(ae.pageX+Te.x),ze=.5*(ae.pageY+Te.y);w.set(Ge,ze)}S.subVectors(w,v).multiplyScalar(n.panSpeed),k(S.x,S.y),v.copy(w)}function et(ae){const Te=Je(ae),Ge=ae.pageX-Te.x,ze=ae.pageY-Te.y,ct=Math.sqrt(Ge*Ge+ze*ze);E.set(0,ct),R.set(0,Math.pow(E.y/b.y,n.zoomSpeed)),Y(R.y),b.copy(E)}function L(ae){n.enableZoom&&et(ae),n.enablePan&&$e(ae)}function V(ae){n.enableZoom&&et(ae),n.enableRotate&&it(ae)}function P(ae){var Te,Ge;n.enabled!==!1&&(F.length===0&&((Te=n.domElement)==null||Te.ownerDocument.addEventListener("pointermove",T),(Ge=n.domElement)==null||Ge.ownerDocument.addEventListener("pointerup",q)),Ve(ae),ae.pointerType==="touch"?G(ae):re(ae))}function T(ae){n.enabled!==!1&&(ae.pointerType==="touch"?Ae(ae):pe(ae))}function q(ae){var Te,Ge,ze;oe(ae),F.length===0&&((Te=n.domElement)==null||Te.releasePointerCapture(ae.pointerId),(Ge=n.domElement)==null||Ge.ownerDocument.removeEventListener("pointermove",T),(ze=n.domElement)==null||ze.ownerDocument.removeEventListener("pointerup",q)),n.dispatchEvent(o),c=a.NONE}function re(ae){let Te;switch(ae.button){case 0:Te=n.mouseButtons.LEFT;break;case 1:Te=n.mouseButtons.MIDDLE;break;case 2:Te=n.mouseButtons.RIGHT;break;default:Te=-1}switch(Te){case Ar.DOLLY:if(n.enableZoom===!1)return;$(ae),c=a.DOLLY;break;case Ar.ROTATE:if(ae.ctrlKey||ae.metaKey||ae.shiftKey){if(n.enablePan===!1)return;Z(ae),c=a.PAN}else{if(n.enableRotate===!1)return;ee(ae),c=a.ROTATE}break;case Ar.PAN:if(ae.ctrlKey||ae.metaKey||ae.shiftKey){if(n.enableRotate===!1)return;ee(ae),c=a.ROTATE}else{if(n.enablePan===!1)return;Z(ae),c=a.PAN}break;default:c=a.NONE}c!==a.NONE&&n.dispatchEvent(s)}function pe(ae){if(n.enabled!==!1)switch(c){case a.ROTATE:if(n.enableRotate===!1)return;Ee(ae);break;case a.DOLLY:if(n.enableZoom===!1)return;Se(ae);break;case a.PAN:if(n.enablePan===!1)return;de(ae);break}}function ge(ae){n.enabled===!1||n.enableZoom===!1||c!==a.NONE&&c!==a.ROTATE||(ae.preventDefault(),n.dispatchEvent(s),he(ae),n.dispatchEvent(o))}function be(ae){n.enabled===!1||n.enablePan===!1||Ce(ae)}function G(ae){switch(Ne(ae),F.length){case 1:switch(n.touches.ONE){case Cr.ROTATE:if(n.enableRotate===!1)return;me(),c=a.TOUCH_ROTATE;break;case Cr.PAN:if(n.enablePan===!1)return;fe(),c=a.TOUCH_PAN;break;default:c=a.NONE}break;case 2:switch(n.touches.TWO){case Cr.DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;ye(),c=a.TOUCH_DOLLY_PAN;break;case Cr.DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;_e(),c=a.TOUCH_DOLLY_ROTATE;break;default:c=a.NONE}break;default:c=a.NONE}c!==a.NONE&&n.dispatchEvent(s)}function Ae(ae){switch(Ne(ae),c){case a.TOUCH_ROTATE:if(n.enableRotate===!1)return;it(ae),n.update();break;case a.TOUCH_PAN:if(n.enablePan===!1)return;$e(ae),n.update();break;case a.TOUCH_DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;L(ae),n.update();break;case a.TOUCH_DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;V(ae),n.update();break;default:c=a.NONE}}function Fe(ae){n.enabled!==!1&&ae.preventDefault()}function Ve(ae){F.push(ae)}function oe(ae){delete C[ae.pointerId];for(let Te=0;Te<F.length;Te++)if(F[Te].pointerId==ae.pointerId){F.splice(Te,1);return}}function Ne(ae){let Te=C[ae.pointerId];Te===void 0&&(Te=new Me,C[ae.pointerId]=Te),Te.set(ae.pageX,ae.pageY)}function Je(ae){const Te=ae.pointerId===F[0].pointerId?F[1]:F[0];return C[Te.pointerId]}this.dollyIn=(ae=X())=>{H(ae),n.update()},this.dollyOut=(ae=X())=>{Y(ae),n.update()},this.getScale=()=>u,this.setScale=ae=>{W(ae),n.update()},this.getZoomScale=()=>X(),t!==void 0&&this.connect(t),this.update()}}const iU=St.exports.forwardRef(({makeDefault:i,camera:e,regress:t,domElement:n,enableDamping:r=!0,keyEvents:s=!1,onChange:o,onStart:a,onEnd:c,...h},d)=>{const l=ia(R=>R.invalidate),u=ia(R=>R.camera),p=ia(R=>R.gl),g=ia(R=>R.events),y=ia(R=>R.setEvents),x=ia(R=>R.set),v=ia(R=>R.get),w=ia(R=>R.performance),S=e||u,b=n||g.connected||p.domElement,E=St.exports.useMemo(()=>new nU(S),[S]);return B4(()=>{E.enabled&&E.update()},-1),St.exports.useEffect(()=>(s&&E.connect(s===!0?b:s),E.connect(b),()=>void E.dispose()),[s,b,t,E,l]),St.exports.useEffect(()=>{const R=N=>{l(),t&&w.regress(),o&&o(N)},z=N=>{a&&a(N)},I=N=>{c&&c(N)};return E.addEventListener("change",R),E.addEventListener("start",z),E.addEventListener("end",I),()=>{E.removeEventListener("start",z),E.removeEventListener("end",I),E.removeEventListener("change",R)}},[o,a,c,E,l,y]),St.exports.useEffect(()=>{if(i){const R=v().controls;return x({controls:E}),()=>x({controls:R})}},[i,E]),St.exports.createElement("primitive",Pg({ref:d,object:E,enableDamping:r},h))});function rU(i){if(!!i&&typeof window!="undefined"){var e=document.createElement("style");return e.setAttribute("type","text/css"),e.innerHTML=i,document.head.appendChild(e),i}}function iu(i,e){var t=i.__state.conversionName.toString(),n=Math.round(i.r),r=Math.round(i.g),s=Math.round(i.b),o=i.a,a=Math.round(i.h),c=i.s.toFixed(1),h=i.v.toFixed(1);if(e||t==="THREE_CHAR_HEX"||t==="SIX_CHAR_HEX"){for(var d=i.hex.toString(16);d.length<6;)d="0"+d;return"#"+d}else{if(t==="CSS_RGB")return"rgb("+n+","+r+","+s+")";if(t==="CSS_RGBA")return"rgba("+n+","+r+","+s+","+o+")";if(t==="HEX")return"0x"+i.hex.toString(16);if(t==="RGB_ARRAY")return"["+n+","+r+","+s+"]";if(t==="RGBA_ARRAY")return"["+n+","+r+","+s+","+o+"]";if(t==="RGB_OBJ")return"{r:"+n+",g:"+r+",b:"+s+"}";if(t==="RGBA_OBJ")return"{r:"+n+",g:"+r+",b:"+s+",a:"+o+"}";if(t==="HSV_OBJ")return"{h:"+a+",s:"+c+",v:"+h+"}";if(t==="HSVA_OBJ")return"{h:"+a+",s:"+c+",v:"+h+",a:"+o+"}"}return"unknown format"}var MT=Array.prototype.forEach,Xh=Array.prototype.slice,Xe={BREAK:{},extend:function(e){return this.each(Xh.call(arguments,1),function(t){var n=this.isObject(t)?Object.keys(t):[];n.forEach(function(r){this.isUndefined(t[r])||(e[r]=t[r])}.bind(this))},this),e},defaults:function(e){return this.each(Xh.call(arguments,1),function(t){var n=this.isObject(t)?Object.keys(t):[];n.forEach(function(r){this.isUndefined(e[r])&&(e[r]=t[r])}.bind(this))},this),e},compose:function(){var e=Xh.call(arguments);return function(){for(var t=Xh.call(arguments),n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},each:function(e,t,n){if(!!e){if(MT&&e.forEach&&e.forEach===MT)e.forEach(t,n);else if(e.length===e.length+0){var r=void 0,s=void 0;for(r=0,s=e.length;r<s;r++)if(r in e&&t.call(n,e[r],r)===this.BREAK)return}else for(var o in e)if(t.call(n,e[o],o)===this.BREAK)return}},defer:function(e){setTimeout(e,0)},debounce:function(e,t,n){var r=void 0;return function(){var s=this,o=arguments;function a(){r=null,n||e.apply(s,o)}var c=n||!r;clearTimeout(r),r=setTimeout(a,t),c&&e.apply(s,o)}},toArray:function(e){return e.toArray?e.toArray():Xh.call(e)},isUndefined:function(e){return e===void 0},isNull:function(e){return e===null},isNaN:function(i){function e(t){return i.apply(this,arguments)}return e.toString=function(){return i.toString()},e}(function(i){return isNaN(i)}),isArray:Array.isArray||function(i){return i.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return e===!1||e===!0},isFunction:function(e){return e instanceof Function}},sU=[{litmus:Xe.isString,conversions:{THREE_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return t===null?!1:{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString(),0)}},write:iu},SIX_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9]{6})$/i);return t===null?!1:{space:"HEX",hex:parseInt("0x"+t[1].toString(),0)}},write:iu},CSS_RGB:{read:function(e){var t=e.match(/^rgb\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return t===null?!1:{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:iu},CSS_RGBA:{read:function(e){var t=e.match(/^rgba\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return t===null?!1:{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:iu}}},{litmus:Xe.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:Xe.isArray,conversions:{RGB_ARRAY:{read:function(e){return e.length!==3?!1:{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return e.length!==4?!1:{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:Xe.isObject,conversions:{RGBA_OBJ:{read:function(e){return Xe.isNumber(e.r)&&Xe.isNumber(e.g)&&Xe.isNumber(e.b)&&Xe.isNumber(e.a)?{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}:!1},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return Xe.isNumber(e.r)&&Xe.isNumber(e.g)&&Xe.isNumber(e.b)?{space:"RGB",r:e.r,g:e.g,b:e.b}:!1},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return Xe.isNumber(e.h)&&Xe.isNumber(e.s)&&Xe.isNumber(e.v)&&Xe.isNumber(e.a)?{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}:!1},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return Xe.isNumber(e.h)&&Xe.isNumber(e.s)&&Xe.isNumber(e.v)?{space:"HSV",h:e.h,s:e.s,v:e.v}:!1},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}],qh=void 0,Cm=void 0,Ow=function(){Cm=!1;var e=arguments.length>1?Xe.toArray(arguments):arguments[0];return Xe.each(sU,function(t){if(t.litmus(e))return Xe.each(t.conversions,function(n,r){if(qh=n.read(e),Cm===!1&&qh!==!1)return Cm=qh,qh.conversionName=r,qh.conversion=n,Xe.BREAK}),Xe.BREAK}),Cm},ET=void 0,Bg={hsv_to_rgb:function(e,t,n){var r=Math.floor(e/60)%6,s=e/60-Math.floor(e/60),o=n*(1-t),a=n*(1-s*t),c=n*(1-(1-s)*t),h=[[n,c,o],[a,n,o],[o,n,c],[o,a,n],[c,o,n],[n,o,a]][r];return{r:h[0]*255,g:h[1]*255,b:h[2]*255}},rgb_to_hsv:function(e,t,n){var r=Math.min(e,t,n),s=Math.max(e,t,n),o=s-r,a=void 0,c=void 0;if(s!==0)c=o/s;else return{h:NaN,s:0,v:0};return e===s?a=(t-n)/o:t===s?a=2+(n-e)/o:a=4+(e-t)/o,a/=6,a<0&&(a+=1),{h:a*360,s:c,v:s/255}},rgb_to_hex:function(e,t,n){var r=this.hex_with_component(0,2,e);return r=this.hex_with_component(r,1,t),r=this.hex_with_component(r,0,n),r},component_from_hex:function(e,t){return e>>t*8&255},hex_with_component:function(e,t,n){return n<<(ET=t*8)|e&~(255<<ET)}},oU=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},Ps=function(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")},Rs=function(){function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}(),Fa=function i(e,t,n){e===null&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(r===void 0){var s=Object.getPrototypeOf(e);return s===null?void 0:i(s,t,n)}else{if("value"in r)return r.value;var o=r.get;return o===void 0?void 0:o.call(n)}},Ga=function(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(i,e):i.__proto__=e)},Wa=function(i,e){if(!i)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:i},Mi=function(){function i(){if(Ps(this,i),this.__state=Ow.apply(this,arguments),this.__state===!1)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return Rs(i,[{key:"toString",value:function(){return iu(this)}},{key:"toHexString",value:function(){return iu(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),i}();function z1(i,e,t){Object.defineProperty(i,e,{get:function(){return this.__state.space==="RGB"?this.__state[e]:(Mi.recalculateRGB(this,e,t),this.__state[e])},set:function(r){this.__state.space!=="RGB"&&(Mi.recalculateRGB(this,e,t),this.__state.space="RGB"),this.__state[e]=r}})}function O1(i,e){Object.defineProperty(i,e,{get:function(){return this.__state.space==="HSV"?this.__state[e]:(Mi.recalculateHSV(this),this.__state[e])},set:function(n){this.__state.space!=="HSV"&&(Mi.recalculateHSV(this),this.__state.space="HSV"),this.__state[e]=n}})}Mi.recalculateRGB=function(i,e,t){if(i.__state.space==="HEX")i.__state[e]=Bg.component_from_hex(i.__state.hex,t);else if(i.__state.space==="HSV")Xe.extend(i.__state,Bg.hsv_to_rgb(i.__state.h,i.__state.s,i.__state.v));else throw new Error("Corrupted color state")};Mi.recalculateHSV=function(i){var e=Bg.rgb_to_hsv(i.r,i.g,i.b);Xe.extend(i.__state,{s:e.s,v:e.v}),Xe.isNaN(e.h)?Xe.isUndefined(i.__state.h)&&(i.__state.h=0):i.__state.h=e.h};Mi.COMPONENTS=["r","g","b","h","s","v","hex","a"];z1(Mi.prototype,"r",2);z1(Mi.prototype,"g",1);z1(Mi.prototype,"b",0);O1(Mi.prototype,"h");O1(Mi.prototype,"s");O1(Mi.prototype,"v");Object.defineProperty(Mi.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}});Object.defineProperty(Mi.prototype,"hex",{get:function(){return this.__state.space!=="HEX"&&(this.__state.hex=Bg.rgb_to_hex(this.r,this.g,this.b),this.__state.space="HEX"),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}});var Jl=function(){function i(e,t){Ps(this,i),this.initialValue=e[t],this.domElement=document.createElement("div"),this.object=e,this.property=t,this.__onChange=void 0,this.__onFinishChange=void 0}return Rs(i,[{key:"onChange",value:function(t){return this.__onChange=t,this}},{key:"onFinishChange",value:function(t){return this.__onFinishChange=t,this}},{key:"setValue",value:function(t){return this.object[this.property]=t,this.__onChange&&this.__onChange.call(this,t),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),i}(),aU={HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},VP={};Xe.each(aU,function(i,e){Xe.each(i,function(t){VP[t]=e})});var lU=/(\d+(\.\d+)?)px/;function Us(i){if(i==="0"||Xe.isUndefined(i))return 0;var e=i.match(lU);return Xe.isNull(e)?0:parseFloat(e[1])}var Re={makeSelectable:function(e,t){e===void 0||e.style===void 0||(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(e,t,n){var r=n,s=t;Xe.isUndefined(s)&&(s=!0),Xe.isUndefined(r)&&(r=!0),e.style.position="absolute",s&&(e.style.left=0,e.style.right=0),r&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,t,n,r){var s=n||{},o=VP[t];if(!o)throw new Error("Event type "+t+" not supported.");var a=document.createEvent(o);switch(o){case"MouseEvents":{var c=s.x||s.clientX||0,h=s.y||s.clientY||0;a.initMouseEvent(t,s.bubbles||!1,s.cancelable||!0,window,s.clickCount||1,0,0,c,h,!1,!1,!1,!1,0,null);break}case"KeyboardEvents":{var d=a.initKeyboardEvent||a.initKeyEvent;Xe.defaults(s,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),d(t,s.bubbles||!1,s.cancelable,window,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.keyCode,s.charCode);break}default:{a.initEvent(t,s.bubbles||!1,s.cancelable||!0);break}}Xe.defaults(a,r),e.dispatchEvent(a)},bind:function(e,t,n,r){var s=r||!1;return e.addEventListener?e.addEventListener(t,n,s):e.attachEvent&&e.attachEvent("on"+t,n),Re},unbind:function(e,t,n,r){var s=r||!1;return e.removeEventListener?e.removeEventListener(t,n,s):e.detachEvent&&e.detachEvent("on"+t,n),Re},addClass:function(e,t){if(e.className===void 0)e.className=t;else if(e.className!==t){var n=e.className.split(/ +/);n.indexOf(t)===-1&&(n.push(t),e.className=n.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return Re},removeClass:function(e,t){if(t)if(e.className===t)e.removeAttribute("class");else{var n=e.className.split(/ +/),r=n.indexOf(t);r!==-1&&(n.splice(r,1),e.className=n.join(" "))}else e.className=void 0;return Re},hasClass:function(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){var t=getComputedStyle(e);return Us(t["border-left-width"])+Us(t["border-right-width"])+Us(t["padding-left"])+Us(t["padding-right"])+Us(t.width)},getHeight:function(e){var t=getComputedStyle(e);return Us(t["border-top-width"])+Us(t["border-bottom-width"])+Us(t["padding-top"])+Us(t["padding-bottom"])+Us(t.height)},getOffset:function(e){var t=e,n={left:0,top:0};if(t.offsetParent)do n.left+=t.offsetLeft,n.top+=t.offsetTop,t=t.offsetParent;while(t);return n},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}},GP=function(i){Ga(e,i);function e(t,n){Ps(this,e);var r=Wa(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n)),s=r;r.__prev=r.getValue(),r.__checkbox=document.createElement("input"),r.__checkbox.setAttribute("type","checkbox");function o(){s.setValue(!s.__prev)}return Re.bind(r.__checkbox,"change",o,!1),r.domElement.appendChild(r.__checkbox),r.updateDisplay(),r}return Rs(e,[{key:"setValue",value:function(n){var r=Fa(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,n);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),r}},{key:"updateDisplay",value:function(){return this.getValue()===!0?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),Fa(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(Jl),cU=function(i){Ga(e,i);function e(t,n,r){Ps(this,e);var s=Wa(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n)),o=r,a=s;if(s.__select=document.createElement("select"),Xe.isArray(o)){var c={};Xe.each(o,function(h){c[h]=h}),o=c}return Xe.each(o,function(h,d){var l=document.createElement("option");l.innerHTML=d,l.setAttribute("value",h),a.__select.appendChild(l)}),s.updateDisplay(),Re.bind(s.__select,"change",function(){var h=this.options[this.selectedIndex].value;a.setValue(h)}),s.domElement.appendChild(s.__select),s}return Rs(e,[{key:"setValue",value:function(n){var r=Fa(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,n);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),r}},{key:"updateDisplay",value:function(){return Re.isActive(this.__select)?this:(this.__select.value=this.getValue(),Fa(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this))}}]),e}(Jl),uU=function(i){Ga(e,i);function e(t,n){Ps(this,e);var r=Wa(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n)),s=r;function o(){s.setValue(s.__input.value)}function a(){s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}return r.__input=document.createElement("input"),r.__input.setAttribute("type","text"),Re.bind(r.__input,"keyup",o),Re.bind(r.__input,"change",o),Re.bind(r.__input,"blur",a),Re.bind(r.__input,"keydown",function(c){c.keyCode===13&&this.blur()}),r.updateDisplay(),r.domElement.appendChild(r.__input),r}return Rs(e,[{key:"updateDisplay",value:function(){return Re.isActive(this.__input)||(this.__input.value=this.getValue()),Fa(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(Jl);function TT(i){var e=i.toString();return e.indexOf(".")>-1?e.length-e.indexOf(".")-1:0}var WP=function(i){Ga(e,i);function e(t,n,r){Ps(this,e);var s=Wa(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n)),o=r||{};return s.__min=o.min,s.__max=o.max,s.__step=o.step,Xe.isUndefined(s.__step)?s.initialValue===0?s.__impliedStep=1:s.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(s.initialValue))/Math.LN10))/10:s.__impliedStep=s.__step,s.__precision=TT(s.__impliedStep),s}return Rs(e,[{key:"setValue",value:function(n){var r=n;return this.__min!==void 0&&r<this.__min?r=this.__min:this.__max!==void 0&&r>this.__max&&(r=this.__max),this.__step!==void 0&&r%this.__step!==0&&(r=Math.round(r/this.__step)*this.__step),Fa(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,r)}},{key:"min",value:function(n){return this.__min=n,this}},{key:"max",value:function(n){return this.__max=n,this}},{key:"step",value:function(n){return this.__step=n,this.__impliedStep=n,this.__precision=TT(n),this}}]),e}(Jl);function hU(i,e){var t=Math.pow(10,e);return Math.round(i*t)/t}var zg=function(i){Ga(e,i);function e(t,n,r){Ps(this,e);var s=Wa(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,r));s.__truncationSuspended=!1;var o=s,a=void 0;function c(){var g=parseFloat(o.__input.value);Xe.isNaN(g)||o.setValue(g)}function h(){o.__onFinishChange&&o.__onFinishChange.call(o,o.getValue())}function d(){h()}function l(g){var y=a-g.clientY;o.setValue(o.getValue()+y*o.__impliedStep),a=g.clientY}function u(){Re.unbind(window,"mousemove",l),Re.unbind(window,"mouseup",u),h()}function p(g){Re.bind(window,"mousemove",l),Re.bind(window,"mouseup",u),a=g.clientY}return s.__input=document.createElement("input"),s.__input.setAttribute("type","text"),Re.bind(s.__input,"change",c),Re.bind(s.__input,"blur",d),Re.bind(s.__input,"mousedown",p),Re.bind(s.__input,"keydown",function(g){g.keyCode===13&&(o.__truncationSuspended=!0,this.blur(),o.__truncationSuspended=!1,h())}),s.updateDisplay(),s.domElement.appendChild(s.__input),s}return Rs(e,[{key:"updateDisplay",value:function(){return this.__input.value=this.__truncationSuspended?this.getValue():hU(this.getValue(),this.__precision),Fa(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(WP);function AT(i,e,t,n,r){return n+(r-n)*((i-e)/(t-e))}var Nw=function(i){Ga(e,i);function e(t,n,r,s,o){Ps(this,e);var a=Wa(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,{min:r,max:s,step:o})),c=a;a.__background=document.createElement("div"),a.__foreground=document.createElement("div"),Re.bind(a.__background,"mousedown",h),Re.bind(a.__background,"touchstart",u),Re.addClass(a.__background,"slider"),Re.addClass(a.__foreground,"slider-fg");function h(y){document.activeElement.blur(),Re.bind(window,"mousemove",d),Re.bind(window,"mouseup",l),d(y)}function d(y){y.preventDefault();var x=c.__background.getBoundingClientRect();return c.setValue(AT(y.clientX,x.left,x.right,c.__min,c.__max)),!1}function l(){Re.unbind(window,"mousemove",d),Re.unbind(window,"mouseup",l),c.__onFinishChange&&c.__onFinishChange.call(c,c.getValue())}function u(y){y.touches.length===1&&(Re.bind(window,"touchmove",p),Re.bind(window,"touchend",g),p(y))}function p(y){var x=y.touches[0].clientX,v=c.__background.getBoundingClientRect();c.setValue(AT(x,v.left,v.right,c.__min,c.__max))}function g(){Re.unbind(window,"touchmove",p),Re.unbind(window,"touchend",g),c.__onFinishChange&&c.__onFinishChange.call(c,c.getValue())}return a.updateDisplay(),a.__background.appendChild(a.__foreground),a.domElement.appendChild(a.__background),a}return Rs(e,[{key:"updateDisplay",value:function(){var n=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=n*100+"%",Fa(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(WP),jP=function(i){Ga(e,i);function e(t,n,r){Ps(this,e);var s=Wa(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n)),o=s;return s.__button=document.createElement("div"),s.__button.innerHTML=r===void 0?"Fire":r,Re.bind(s.__button,"click",function(a){return a.preventDefault(),o.fire(),!1}),Re.addClass(s.__button,"button"),s.domElement.appendChild(s.__button),s}return Rs(e,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),e}(Jl),Uw=function(i){Ga(e,i);function e(t,n){Ps(this,e);var r=Wa(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));r.__color=new Mi(r.getValue()),r.__temp=new Mi(0);var s=r;r.domElement=document.createElement("div"),Re.makeSelectable(r.domElement,!1),r.__selector=document.createElement("div"),r.__selector.className="selector",r.__saturation_field=document.createElement("div"),r.__saturation_field.className="saturation-field",r.__field_knob=document.createElement("div"),r.__field_knob.className="field-knob",r.__field_knob_border="2px solid ",r.__hue_knob=document.createElement("div"),r.__hue_knob.className="hue-knob",r.__hue_field=document.createElement("div"),r.__hue_field.className="hue-field",r.__input=document.createElement("input"),r.__input.type="text",r.__input_textShadow="0 1px 1px ",Re.bind(r.__input,"keydown",function(y){y.keyCode===13&&l.call(this)}),Re.bind(r.__input,"blur",l),Re.bind(r.__selector,"mousedown",function(){Re.addClass(this,"drag").bind(window,"mouseup",function(){Re.removeClass(s.__selector,"drag")})}),Re.bind(r.__selector,"touchstart",function(){Re.addClass(this,"drag").bind(window,"touchend",function(){Re.removeClass(s.__selector,"drag")})});var o=document.createElement("div");Xe.extend(r.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),Xe.extend(r.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:r.__field_knob_border+(r.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),Xe.extend(r.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),Xe.extend(r.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),Xe.extend(o.style,{width:"100%",height:"100%",background:"none"}),CT(o,"top","rgba(0,0,0,0)","#000"),Xe.extend(r.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),fU(r.__hue_field),Xe.extend(r.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:r.__input_textShadow+"rgba(0,0,0,0.7)"}),Re.bind(r.__saturation_field,"mousedown",a),Re.bind(r.__saturation_field,"touchstart",a),Re.bind(r.__field_knob,"mousedown",a),Re.bind(r.__field_knob,"touchstart",a),Re.bind(r.__hue_field,"mousedown",c),Re.bind(r.__hue_field,"touchstart",c);function a(y){p(y),Re.bind(window,"mousemove",p),Re.bind(window,"touchmove",p),Re.bind(window,"mouseup",h),Re.bind(window,"touchend",h)}function c(y){g(y),Re.bind(window,"mousemove",g),Re.bind(window,"touchmove",g),Re.bind(window,"mouseup",d),Re.bind(window,"touchend",d)}function h(){Re.unbind(window,"mousemove",p),Re.unbind(window,"touchmove",p),Re.unbind(window,"mouseup",h),Re.unbind(window,"touchend",h),u()}function d(){Re.unbind(window,"mousemove",g),Re.unbind(window,"touchmove",g),Re.unbind(window,"mouseup",d),Re.unbind(window,"touchend",d),u()}function l(){var y=Ow(this.value);y!==!1?(s.__color.__state=y,s.setValue(s.__color.toOriginal())):this.value=s.__color.toString()}function u(){s.__onFinishChange&&s.__onFinishChange.call(s,s.__color.toOriginal())}r.__saturation_field.appendChild(o),r.__selector.appendChild(r.__field_knob),r.__selector.appendChild(r.__saturation_field),r.__selector.appendChild(r.__hue_field),r.__hue_field.appendChild(r.__hue_knob),r.domElement.appendChild(r.__input),r.domElement.appendChild(r.__selector),r.updateDisplay();function p(y){y.type.indexOf("touch")===-1&&y.preventDefault();var x=s.__saturation_field.getBoundingClientRect(),v=y.touches&&y.touches[0]||y,w=v.clientX,S=v.clientY,b=(w-x.left)/(x.right-x.left),E=1-(S-x.top)/(x.bottom-x.top);return E>1?E=1:E<0&&(E=0),b>1?b=1:b<0&&(b=0),s.__color.v=E,s.__color.s=b,s.setValue(s.__color.toOriginal()),!1}function g(y){y.type.indexOf("touch")===-1&&y.preventDefault();var x=s.__hue_field.getBoundingClientRect(),v=y.touches&&y.touches[0]||y,w=v.clientY,S=1-(w-x.top)/(x.bottom-x.top);return S>1?S=1:S<0&&(S=0),s.__color.h=S*360,s.setValue(s.__color.toOriginal()),!1}return r}return Rs(e,[{key:"updateDisplay",value:function(){var n=Ow(this.getValue());if(n!==!1){var r=!1;Xe.each(Mi.COMPONENTS,function(a){if(!Xe.isUndefined(n[a])&&!Xe.isUndefined(this.__color.__state[a])&&n[a]!==this.__color.__state[a])return r=!0,{}},this),r&&Xe.extend(this.__color.__state,n)}Xe.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var s=this.__color.v<.5||this.__color.s>.5?255:0,o=255-s;Xe.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+s+","+s+","+s+")"}),this.__hue_knob.style.marginTop=(1-this.__color.h/360)*100+"px",this.__temp.s=1,this.__temp.v=1,CT(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),Xe.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+s+","+s+","+s+")",textShadow:this.__input_textShadow+"rgba("+o+","+o+","+o+",.7)"})}}]),e}(Jl),dU=["-moz-","-o-","-webkit-","-ms-",""];function CT(i,e,t,n){i.style.background="",Xe.each(dU,function(r){i.style.cssText+="background: "+r+"linear-gradient("+e+", "+t+" 0%, "+n+" 100%); "})}function fU(i){i.style.background="",i.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",i.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",i.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",i.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",i.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}var pU={load:function(e,t){var n=t||document,r=n.createElement("link");r.type="text/css",r.rel="stylesheet",r.href=e,n.getElementsByTagName("head")[0].appendChild(r)},inject:function(e,t){var n=t||document,r=document.createElement("style");r.type="text/css",r.innerHTML=e;var s=n.getElementsByTagName("head")[0];try{s.appendChild(r)}catch{}}},mU=`<div id="dg-save" class="dg dialogue">

  Here's the new load parameter for your <code>GUI</code>'s constructor:

  <textarea id="dg-new-constructor"></textarea>

  <div id="dg-save-locally">

    <input id="dg-local-storage" type="checkbox"/> Automatically save
    values to <code>localStorage</code> on exit.

    <div id="dg-local-explain">The values saved to <code>localStorage</code> will
      override those passed to <code>dat.GUI</code>'s constructor. This makes it
      easier to work incrementally, but <code>localStorage</code> is fragile,
      and your friends may not see the same values you do.

    </div>

  </div>

</div>`,gU=function(e,t){var n=e[t];return Xe.isArray(arguments[2])||Xe.isObject(arguments[2])?new cU(e,t,arguments[2]):Xe.isNumber(n)?Xe.isNumber(arguments[2])&&Xe.isNumber(arguments[3])?Xe.isNumber(arguments[4])?new Nw(e,t,arguments[2],arguments[3],arguments[4]):new Nw(e,t,arguments[2],arguments[3]):Xe.isNumber(arguments[4])?new zg(e,t,{min:arguments[2],max:arguments[3],step:arguments[4]}):new zg(e,t,{min:arguments[2],max:arguments[3]}):Xe.isString(n)?new uU(e,t):Xe.isFunction(n)?new jP(e,t,""):Xe.isBoolean(n)?new GP(e,t):null};function vU(i){setTimeout(i,1e3/60)}var yU=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||vU,xU=function(){function i(){Ps(this,i),this.backgroundElement=document.createElement("div"),Xe.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),Re.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),Xe.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var e=this;Re.bind(this.backgroundElement,"click",function(){e.hide()})}return Rs(i,[{key:"show",value:function(){var t=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),Xe.defer(function(){t.backgroundElement.style.opacity=1,t.domElement.style.opacity=1,t.domElement.style.webkitTransform="scale(1)"})}},{key:"hide",value:function(){var t=this,n=function r(){t.domElement.style.display="none",t.backgroundElement.style.display="none",Re.unbind(t.domElement,"webkitTransitionEnd",r),Re.unbind(t.domElement,"transitionend",r),Re.unbind(t.domElement,"oTransitionEnd",r)};Re.bind(this.domElement,"webkitTransitionEnd",n),Re.bind(this.domElement,"transitionend",n),Re.bind(this.domElement,"oTransitionEnd",n),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-Re.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-Re.getHeight(this.domElement)/2+"px"}}]),i}(),wU=rU(`.dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .cr.function .property-name{width:100%}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}
`);pU.inject(wU);var PT="dg",RT=72,LT=20,Kd="Default",id=function(){try{return!!window.localStorage}catch{return!1}}(),xd=void 0,kT=!0,zc=void 0,Ky=!1,XP=[],yn=function i(e){var t=this,n=e||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),Re.addClass(this.domElement,PT),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],n=Xe.defaults(n,{closeOnTop:!1,autoPlace:!0,width:i.DEFAULT_WIDTH}),n=Xe.defaults(n,{resizable:n.autoPlace,hideable:n.autoPlace}),Xe.isUndefined(n.load)?n.load={preset:Kd}:n.preset&&(n.load.preset=n.preset),Xe.isUndefined(n.parent)&&n.hideable&&XP.push(this),n.resizable=Xe.isUndefined(n.parent)&&n.resizable,n.autoPlace&&Xe.isUndefined(n.scrollable)&&(n.scrollable=!0);var r=id&&localStorage.getItem(Oc(this,"isLocal"))==="true",s=void 0,o=void 0;if(Object.defineProperties(this,{parent:{get:function(){return n.parent}},scrollable:{get:function(){return n.scrollable}},autoPlace:{get:function(){return n.autoPlace}},closeOnTop:{get:function(){return n.closeOnTop}},preset:{get:function(){return t.parent?t.getRoot().preset:n.load.preset},set:function(u){t.parent?t.getRoot().preset=u:n.load.preset=u,MU(this),t.revert()}},width:{get:function(){return n.width},set:function(u){n.width=u,Gw(t,u)}},name:{get:function(){return n.name},set:function(u){n.name=u,o&&(o.innerHTML=n.name)}},closed:{get:function(){return n.closed},set:function(u){n.closed=u,n.closed?Re.addClass(t.__ul,i.CLASS_CLOSED):Re.removeClass(t.__ul,i.CLASS_CLOSED),this.onResize(),t.__closeButton&&(t.__closeButton.innerHTML=u?i.TEXT_OPEN:i.TEXT_CLOSED)}},load:{get:function(){return n.load}},useLocalStorage:{get:function(){return r},set:function(u){id&&(r=u,u?Re.bind(window,"unload",s):Re.unbind(window,"unload",s),localStorage.setItem(Oc(t,"isLocal"),u))}}}),Xe.isUndefined(n.parent)){if(this.closed=n.closed||!1,Re.addClass(this.domElement,i.CLASS_MAIN),Re.makeSelectable(this.domElement,!1),id&&r){t.useLocalStorage=!0;var a=localStorage.getItem(Oc(this,"gui"));a&&(n.load=JSON.parse(a))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=i.TEXT_CLOSED,Re.addClass(this.__closeButton,i.CLASS_CLOSE_BUTTON),n.closeOnTop?(Re.addClass(this.__closeButton,i.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(Re.addClass(this.__closeButton,i.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),Re.bind(this.__closeButton,"click",function(){t.closed=!t.closed})}else{n.closed===void 0&&(n.closed=!0);var c=document.createTextNode(n.name);Re.addClass(c,"controller-name"),o=N1(t,c);var h=function(u){return u.preventDefault(),t.closed=!t.closed,!1};Re.addClass(this.__ul,i.CLASS_CLOSED),Re.addClass(o,"title"),Re.bind(o,"click",h),n.closed||(this.closed=!1)}n.autoPlace&&(Xe.isUndefined(n.parent)&&(kT&&(zc=document.createElement("div"),Re.addClass(zc,PT),Re.addClass(zc,i.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(zc),kT=!1),zc.appendChild(this.domElement),Re.addClass(this.domElement,i.CLASS_AUTO_PLACE)),this.parent||Gw(t,n.width)),this.__resizeHandler=function(){t.onResizeDebounced()},Re.bind(window,"resize",this.__resizeHandler),Re.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),Re.bind(this.__ul,"transitionend",this.__resizeHandler),Re.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),n.resizable&&bU(this),s=function(){id&&localStorage.getItem(Oc(t,"isLocal"))==="true"&&localStorage.setItem(Oc(t,"gui"),JSON.stringify(t.getSaveObject()))},this.saveToLocalStorageIfPossible=s;function d(){var l=t.getRoot();l.width+=1,Xe.defer(function(){l.width-=1})}n.parent||d()};yn.toggleHide=function(){Ky=!Ky,Xe.each(XP,function(i){i.domElement.style.display=Ky?"none":""})};yn.CLASS_AUTO_PLACE="a";yn.CLASS_AUTO_PLACE_CONTAINER="ac";yn.CLASS_MAIN="main";yn.CLASS_CONTROLLER_ROW="cr";yn.CLASS_TOO_TALL="taller-than-window";yn.CLASS_CLOSED="closed";yn.CLASS_CLOSE_BUTTON="close-button";yn.CLASS_CLOSE_TOP="close-top";yn.CLASS_CLOSE_BOTTOM="close-bottom";yn.CLASS_DRAG="drag";yn.DEFAULT_WIDTH=245;yn.TEXT_CLOSED="Close Controls";yn.TEXT_OPEN="Open Controls";yn._keydownHandler=function(i){document.activeElement.type!=="text"&&(i.which===RT||i.keyCode===RT)&&yn.toggleHide()};Re.bind(window,"keydown",yn._keydownHandler,!1);Xe.extend(yn.prototype,{add:function(e,t){return wd(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return wd(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.splice(this.__controllers.indexOf(e),1);var t=this;Xe.defer(function(){t.onResize()})},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&zc.removeChild(this.domElement);var e=this;Xe.each(this.__folders,function(t){e.removeFolder(t)}),Re.unbind(window,"keydown",yn._keydownHandler,!1),IT(this)},addFolder:function(e){if(this.__folders[e]!==void 0)throw new Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]);var n=new yn(t);this.__folders[e]=n;var r=N1(this,n.domElement);return Re.addClass(r,"folder"),n},removeFolder:function(e){this.__ul.removeChild(e.domElement.parentElement),delete this.__folders[e.name],this.load&&this.load.folders&&this.load.folders[e.name]&&delete this.load.folders[e.name],IT(e);var t=this;Xe.each(e.__folders,function(n){e.removeFolder(n)}),Xe.defer(function(){t.onResize()})},open:function(){this.closed=!1},close:function(){this.closed=!0},hide:function(){this.domElement.style.display="none"},show:function(){this.domElement.style.display=""},onResize:function(){var e=this.getRoot();if(e.scrollable){var t=Re.getOffset(e.__ul).top,n=0;Xe.each(e.__ul.childNodes,function(r){e.autoPlace&&r===e.__save_row||(n+=Re.getHeight(r))}),window.innerHeight-t-LT<n?(Re.addClass(e.domElement,yn.CLASS_TOO_TALL),e.__ul.style.height=window.innerHeight-t-LT+"px"):(Re.removeClass(e.domElement,yn.CLASS_TOO_TALL),e.__ul.style.height="auto")}e.__resize_handle&&Xe.defer(function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"}),e.__closeButton&&(e.__closeButton.style.width=e.width+"px")},onResizeDebounced:Xe.debounce(function(){this.onResize()},50),remember:function(){if(Xe.isUndefined(xd)&&(xd=new xU,xd.domElement.innerHTML=mU),this.parent)throw new Error("You can only call remember on a top level GUI.");var e=this;Xe.each(Array.prototype.slice.call(arguments),function(t){e.__rememberedObjects.length===0&&SU(e),e.__rememberedObjects.indexOf(t)===-1&&e.__rememberedObjects.push(t)}),this.autoPlace&&Gw(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var e=this.load;return e.closed=this.closed,this.__rememberedObjects.length>0&&(e.preset=this.preset,e.remembered||(e.remembered={}),e.remembered[this.preset]=Pm(this)),e.folders={},Xe.each(this.__folders,function(t,n){e.folders[n]=t.getSaveObject()}),e},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=Pm(this),Hw(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered[Kd]=Pm(this,!0)),this.load.remembered[e]=Pm(this),this.preset=e,Vw(this,e,!0),this.saveToLocalStorageIfPossible()},revert:function(e){Xe.each(this.__controllers,function(t){this.getRoot().load.remembered?qP(e||this.getRoot(),t):t.setValue(t.initialValue),t.__onFinishChange&&t.__onFinishChange.call(t,t.getValue())},this),Xe.each(this.__folders,function(t){t.revert(t)}),e||Hw(this.getRoot(),!1)},listen:function(e){var t=this.__listening.length===0;this.__listening.push(e),t&&YP(this.__listening)},updateDisplay:function(){Xe.each(this.__controllers,function(e){e.updateDisplay()}),Xe.each(this.__folders,function(e){e.updateDisplay()})}});function N1(i,e,t){var n=document.createElement("li");return e&&n.appendChild(e),t?i.__ul.insertBefore(n,t):i.__ul.appendChild(n),i.onResize(),n}function IT(i){Re.unbind(window,"resize",i.__resizeHandler),i.saveToLocalStorageIfPossible&&Re.unbind(window,"unload",i.saveToLocalStorageIfPossible)}function Hw(i,e){var t=i.__preset_select[i.__preset_select.selectedIndex];e?t.innerHTML=t.value+"*":t.innerHTML=t.value}function _U(i,e,t){if(t.__li=e,t.__gui=i,Xe.extend(t,{options:function(o){if(arguments.length>1){var a=t.__li.nextElementSibling;return t.remove(),wd(i,t.object,t.property,{before:a,factoryArgs:[Xe.toArray(arguments)]})}if(Xe.isArray(o)||Xe.isObject(o)){var c=t.__li.nextElementSibling;return t.remove(),wd(i,t.object,t.property,{before:c,factoryArgs:[o]})}},name:function(o){return t.__li.firstElementChild.firstElementChild.innerHTML=o,t},listen:function(){return t.__gui.listen(t),t},remove:function(){return t.__gui.remove(t),t}}),t instanceof Nw){var n=new zg(t.object,t.property,{min:t.__min,max:t.__max,step:t.__step});Xe.each(["updateDisplay","onChange","onFinishChange","step","min","max"],function(s){var o=t[s],a=n[s];t[s]=n[s]=function(){var c=Array.prototype.slice.call(arguments);return a.apply(n,c),o.apply(t,c)}}),Re.addClass(e,"has-slider"),t.domElement.insertBefore(n.domElement,t.domElement.firstElementChild)}else if(t instanceof zg){var r=function(o){if(Xe.isNumber(t.__min)&&Xe.isNumber(t.__max)){var a=t.__li.firstElementChild.firstElementChild.innerHTML,c=t.__gui.__listening.indexOf(t)>-1;t.remove();var h=wd(i,t.object,t.property,{before:t.__li.nextElementSibling,factoryArgs:[t.__min,t.__max,t.__step]});return h.name(a),c&&h.listen(),h}return o};t.min=Xe.compose(r,t.min),t.max=Xe.compose(r,t.max)}else t instanceof GP?(Re.bind(e,"click",function(){Re.fakeEvent(t.__checkbox,"click")}),Re.bind(t.__checkbox,"click",function(s){s.stopPropagation()})):t instanceof jP?(Re.bind(e,"click",function(){Re.fakeEvent(t.__button,"click")}),Re.bind(e,"mouseover",function(){Re.addClass(t.__button,"hover")}),Re.bind(e,"mouseout",function(){Re.removeClass(t.__button,"hover")})):t instanceof Uw&&(Re.addClass(e,"color"),t.updateDisplay=Xe.compose(function(s){return e.style.borderLeftColor=t.__color.toString(),s},t.updateDisplay),t.updateDisplay());t.setValue=Xe.compose(function(s){return i.getRoot().__preset_select&&t.isModified()&&Hw(i.getRoot(),!0),s},t.setValue)}function qP(i,e){var t=i.getRoot(),n=t.__rememberedObjects.indexOf(e.object);if(n!==-1){var r=t.__rememberedObjectIndecesToControllers[n];if(r===void 0&&(r={},t.__rememberedObjectIndecesToControllers[n]=r),r[e.property]=e,t.load&&t.load.remembered){var s=t.load.remembered,o=void 0;if(s[i.preset])o=s[i.preset];else if(s[Kd])o=s[Kd];else return;if(o[n]&&o[n][e.property]!==void 0){var a=o[n][e.property];e.initialValue=a,e.setValue(a)}}}}function wd(i,e,t,n){if(e[t]===void 0)throw new Error('Object "'+e+'" has no property "'+t+'"');var r=void 0;if(n.color)r=new Uw(e,t);else{var s=[e,t].concat(n.factoryArgs);r=gU.apply(i,s)}n.before instanceof Jl&&(n.before=n.before.__li),qP(i,r),Re.addClass(r.domElement,"c");var o=document.createElement("span");Re.addClass(o,"property-name"),o.innerHTML=r.property;var a=document.createElement("div");a.appendChild(o),a.appendChild(r.domElement);var c=N1(i,a,n.before);return Re.addClass(c,yn.CLASS_CONTROLLER_ROW),r instanceof Uw?Re.addClass(c,"color"):Re.addClass(c,oU(r.getValue())),_U(i,c,r),i.__controllers.push(r),r}function Oc(i,e){return document.location.href+"."+e}function Vw(i,e,t){var n=document.createElement("option");n.innerHTML=e,n.value=e,i.__preset_select.appendChild(n),t&&(i.__preset_select.selectedIndex=i.__preset_select.length-1)}function FT(i,e){e.style.display=i.useLocalStorage?"block":"none"}function SU(i){var e=i.__save_row=document.createElement("li");Re.addClass(i.domElement,"has-save"),i.__ul.insertBefore(e,i.__ul.firstChild),Re.addClass(e,"save-row");var t=document.createElement("span");t.innerHTML="&nbsp;",Re.addClass(t,"button gears");var n=document.createElement("span");n.innerHTML="Save",Re.addClass(n,"button"),Re.addClass(n,"save");var r=document.createElement("span");r.innerHTML="New",Re.addClass(r,"button"),Re.addClass(r,"save-as");var s=document.createElement("span");s.innerHTML="Revert",Re.addClass(s,"button"),Re.addClass(s,"revert");var o=i.__preset_select=document.createElement("select");if(i.load&&i.load.remembered?Xe.each(i.load.remembered,function(l,u){Vw(i,u,u===i.preset)}):Vw(i,Kd,!1),Re.bind(o,"change",function(){for(var l=0;l<i.__preset_select.length;l++)i.__preset_select[l].innerHTML=i.__preset_select[l].value;i.preset=this.value}),e.appendChild(o),e.appendChild(t),e.appendChild(n),e.appendChild(r),e.appendChild(s),id){var a=document.getElementById("dg-local-explain"),c=document.getElementById("dg-local-storage"),h=document.getElementById("dg-save-locally");h.style.display="block",localStorage.getItem(Oc(i,"isLocal"))==="true"&&c.setAttribute("checked","checked"),FT(i,a),Re.bind(c,"change",function(){i.useLocalStorage=!i.useLocalStorage,FT(i,a)})}var d=document.getElementById("dg-new-constructor");Re.bind(d,"keydown",function(l){l.metaKey&&(l.which===67||l.keyCode===67)&&xd.hide()}),Re.bind(t,"click",function(){d.innerHTML=JSON.stringify(i.getSaveObject(),void 0,2),xd.show(),d.focus(),d.select()}),Re.bind(n,"click",function(){i.save()}),Re.bind(r,"click",function(){var l=prompt("Enter a new preset name.");l&&i.saveAs(l)}),Re.bind(s,"click",function(){i.revert()})}function bU(i){var e=void 0;i.__resize_handle=document.createElement("div"),Xe.extend(i.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"});function t(s){return s.preventDefault(),i.width+=e-s.clientX,i.onResize(),e=s.clientX,!1}function n(){Re.removeClass(i.__closeButton,yn.CLASS_DRAG),Re.unbind(window,"mousemove",t),Re.unbind(window,"mouseup",n)}function r(s){return s.preventDefault(),e=s.clientX,Re.addClass(i.__closeButton,yn.CLASS_DRAG),Re.bind(window,"mousemove",t),Re.bind(window,"mouseup",n),!1}Re.bind(i.__resize_handle,"mousedown",r),Re.bind(i.__closeButton,"mousedown",r),i.domElement.insertBefore(i.__resize_handle,i.domElement.firstElementChild)}function Gw(i,e){i.domElement.style.width=e+"px",i.__save_row&&i.autoPlace&&(i.__save_row.style.width=e+"px"),i.__closeButton&&(i.__closeButton.style.width=e+"px")}function Pm(i,e){var t={};return Xe.each(i.__rememberedObjects,function(n,r){var s={},o=i.__rememberedObjectIndecesToControllers[r];Xe.each(o,function(a,c){s[c]=e?a.initialValue:a.getValue()}),t[r]=s}),t}function MU(i){for(var e=0;e<i.__preset_select.length;e++)i.__preset_select[e].value===i.preset&&(i.__preset_select.selectedIndex=e)}function YP(i){i.length!==0&&yU.call(window,function(){YP(i)}),Xe.each(i,function(e){e.updateDisplay()})}var EU=yn;class ec{constructor(){this.callbacks={},this.callbacks.base={}}on(e,t){const n=this;return typeof e=="undefined"||e===""?(console.warn("wrong names"),!1):typeof t=="undefined"?(console.warn("wrong callback"),!1):(this.resolveNames(e).forEach(function(s){const o=n.resolveName(s);n.callbacks[o.namespace]instanceof Object||(n.callbacks[o.namespace]={}),n.callbacks[o.namespace][o.value]instanceof Array||(n.callbacks[o.namespace][o.value]=[]),n.callbacks[o.namespace][o.value].push(t)}),this)}off(e){const t=this;return typeof e=="undefined"||e===""?(console.warn("wrong name"),!1):(this.resolveNames(e).forEach(function(r){const s=t.resolveName(r);if(s.namespace!=="base"&&s.value==="")delete t.callbacks[s.namespace];else if(s.namespace==="base")for(const o in t.callbacks)t.callbacks[o]instanceof Object&&t.callbacks[o][s.value]instanceof Array&&(delete t.callbacks[o][s.value],Object.keys(t.callbacks[o]).length===0&&delete t.callbacks[o]);else t.callbacks[s.namespace]instanceof Object&&t.callbacks[s.namespace][s.value]instanceof Array&&(delete t.callbacks[s.namespace][s.value],Object.keys(t.callbacks[s.namespace]).length===0&&delete t.callbacks[s.namespace])}),this)}trigger(e,t){if(typeof e=="undefined"||e==="")return console.warn("wrong name"),!1;const n=this;let r=null;const s=t instanceof Array?t:[];let o=this.resolveNames(e);if(o=this.resolveName(o[0]),o.namespace==="base")for(const a in n.callbacks)n.callbacks[a]instanceof Object&&n.callbacks[a][o.value]instanceof Array&&n.callbacks[a][o.value].forEach(function(c){c.apply(n,s)});else if(this.callbacks[o.namespace]instanceof Object){if(o.value==="")return console.warn("wrong name"),this;n.callbacks[o.namespace][o.value].forEach(function(a){a.apply(n,s)})}return r}resolveNames(e){let t=e;return t=t.replace(/[^a-zA-Z0-9 ,/.]/g,""),t=t.replace(/[,/]+/g," "),t=t.split(" "),t}resolveName(e){const t={},n=e.split(".");return t.original=e,t.value=n[0],t.namespace="base",n.length>1&&n[1]!==""&&(t.namespace=n[1]),t}}class TU extends ec{constructor(){super(),this.viewport={},this.$sizeViewport=document.createElement("div"),this.$sizeViewport.style.width="100vw",this.$sizeViewport.style.height="100vh",this.$sizeViewport.style.position="absolute",this.$sizeViewport.style.top=0,this.$sizeViewport.style.left=0,this.$sizeViewport.style.pointerEvents="none",this.resize=this.resize.bind(this),window.addEventListener("resize",this.resize),this.resize()}resize(){document.body.appendChild(this.$sizeViewport),this.viewport.width=this.$sizeViewport.offsetWidth,this.viewport.height=this.$sizeViewport.offsetHeight,document.body.removeChild(this.$sizeViewport),this.width=window.innerWidth,this.height=window.innerHeight,this.trigger("resize")}}class AU extends ec{constructor(){super(),this.start=Date.now(),this.current=this.start,this.elapsed=0,this.delta=16,this.tick=this.tick.bind(this),this.tick()}tick(){this.ticker=window.requestAnimationFrame(this.tick);const e=Date.now();this.delta=e-this.current,this.elapsed=e-this.start,this.current=e,this.delta>60&&(this.delta=60),this.trigger("tick")}stop(){window.cancelAnimationFrame(this.ticker)}}var CU=`#define GLSLIFY 1
uniform sampler2D tShadow;
uniform vec3 uShadowColor;
uniform float uAlpha;

varying vec2 vUv;

void main()
{
    float shadowAlpha = 1.0 - texture2D(tShadow, vUv).r;
    shadowAlpha *= uAlpha;

    gl_FragColor = vec4(uShadowColor, shadowAlpha);
}
`,PU=`#define GLSLIFY 1
varying vec2 vUv;

void main()
{
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`;function RU(){const i={tShadow:{value:null},uShadowColor:{value:null},uAlpha:{value:null}};return new jn({wireframe:!1,transparent:!0,uniforms:i,vertexShader:PU,fragmentShader:CU})}var LU=`#define GLSLIFY 1
#define TOTO
#define MATCAP
#define USE_MATCAP

uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;

varying vec3 vViewPosition;

// Custom start
uniform mat3 normalMatrix;
uniform float uIndirectDistanceAmplitude;
uniform float uIndirectDistanceStrength;
uniform float uIndirectDistancePower;
uniform float uIndirectAngleStrength;
uniform float uIndirectAngleOffset;
uniform float uIndirectAnglePower;
uniform vec3 uIndirectColor;

varying vec3 vWorldPosition;
// Custom end

#ifndef FLAT_SHADED

    varying vec3 vNormal;

#endif

#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>

#include <fog_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

    if(vWorldPosition.z < 0.0)
    {
        discard;
    }

    #include <clipping_planes_fragment>

    vec4 diffuseColor = vec4( diffuse, opacity );

    #include <logdepthbuf_fragment>
    #include <map_fragment>
    #include <alphamap_fragment>
    #include <alphatest_fragment>
    #include <normal_fragment_begin>
    #include <normal_fragment_maps>

    vec3 viewDir = normalize( vViewPosition );
    vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
    vec3 y = cross( viewDir, x );
    vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5; // 0.495 to remove artifacts caused by undersized matcap disks

    #ifdef USE_MATCAP

        vec4 matcapColor = texture2D( matcap, uv );
        // matcapColor = matcapTexelToLinear( matcapColor );

    #else

        vec4 matcapColor = vec4( 1.0 );

    #endif

    vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;

    // Custom start
    float indirectDistanceStrength = clamp(1.0 - vWorldPosition.z / uIndirectDistanceAmplitude, 0.0, 1.0) * uIndirectDistanceStrength;
    indirectDistanceStrength = pow(indirectDistanceStrength, uIndirectDistancePower);
    indirectDistanceStrength = clamp(indirectDistanceStrength, 0.0, 1.0);

    vec3 worldNormal = inverseTransformDirection(vNormal, viewMatrix);

    float indirectAngleStrength = dot(normalize(worldNormal), vec3(0.0, 0.0, - 1.0)) + uIndirectAngleOffset;
    indirectAngleStrength = clamp(indirectAngleStrength * uIndirectAngleStrength, 0.0, 1.0);
    indirectAngleStrength = pow(indirectAngleStrength, uIndirectAnglePower);

    // vec3 uIndirectColor = vec3(208.0 / 255.0, 69.0 / 255.0, 0.0 / 255.0);
    float indirectStrength = indirectDistanceStrength * indirectAngleStrength;
    // float indirectStrength = indirectAngleStrength;

    // gl_FragColor = vec4(vec3(worldNormal), 1.0);
    // gl_FragColor = vec4(outgoingLight, diffuseColor.a);
    // gl_FragColor = vec4(vec3(indirectStrength), diffuseColor.a);
    gl_FragColor = vec4(mix(outgoingLight, uIndirectColor, indirectStrength), diffuseColor.a);
    // Custom end

    #include <premultiplied_alpha_fragment>
    #include <tonemapping_fragment>
    #include <encodings_fragment>
    #include <fog_fragment>

}
`,kU=`#define GLSLIFY 1
#define TOTO
#define MATCAP
#define USE_MATCAP

varying vec3 vViewPosition;

#ifndef FLAT_SHADED

    varying vec3 vNormal;

#endif

#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>

#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

// Custom start
uniform float uRevealProgress;

varying vec3 vWorldPosition;

#define M_PI 3.1415926535897932384626433832795

float easeSin(float _value)
{
    return sin((_value - 0.5) * M_PI) * 0.5 + 0.5;
}

// Custom end

void main() {

    #include <uv_vertex>

    #include <beginnormal_vertex>
    #include <morphnormal_vertex>
    #include <skinbase_vertex>
    #include <skinnormal_vertex>
    #include <defaultnormal_vertex>

    #ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED

        vNormal = normalize( transformedNormal );

    #endif

    #include <begin_vertex>
    #include <morphtarget_vertex>
    #include <skinning_vertex>
    #include <displacementmap_vertex>

    // Custom start
    vec4 worldNormal = modelMatrix * vec4(normal, 1.0);

    vec4 worldPosition = modelMatrix * vec4(transformed, 1.0);

    // Reveal
    float distanceToCenter = length(worldPosition);
    float zAmplitude = 3.2;
    float revealProgress = (uRevealProgress - distanceToCenter / 30.0) * 5.0;
    revealProgress = 1.0 - clamp(revealProgress, - 0.1, 1.0);
    revealProgress = pow(revealProgress, 2.0);
    if(uRevealProgress > 0.9)
    {
        revealProgress = 0.0;
    }
    worldPosition.z -= revealProgress * zAmplitude;

    // Update varying
    vWorldPosition = worldPosition.xyz;

    vec4 mvPosition = viewMatrix * worldPosition;
    gl_Position = projectionMatrix * mvPosition;
    // Custom end

    // #include <project_vertex>

    #include <logdepthbuf_vertex>
    #include <clipping_planes_vertex>
    #include <fog_vertex>

    vViewPosition = - mvPosition.xyz;

}
`;function Er(){const i={...ot.common,...ot.bumpmap,...ot.normalmap,...ot.displacementmap,...ot.fog,matcap:{value:null},uRevealProgress:{value:null},uIndirectDistanceAmplitude:{value:null},uIndirectDistanceStrength:{value:null},uIndirectDistancePower:{value:null},uIndirectAngleStrength:{value:null},uIndirectAngleOffset:{value:null},uIndirectAnglePower:{value:null},uIndirectColor:{value:null}},e={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},t={MATCAP:""};return new jn({wireframe:!1,transparent:!1,uniforms:i,extensions:e,defines:t,lights:!1,vertexShader:kU,fragmentShader:LU})}class IU{constructor(e){this.resources=e.resources,this.debug=e.debug,this.debug&&(this.debugFolder=this.debug.addFolder("materials"),this.debugFolder.open()),this.items={},this.setPures(),this.setShades(),this.setFloorShadow()}setPures(){this.pures={},this.pures.items={},this.pures.items.red=new Bt({color:16711680}),this.pures.items.red.name="pureRed",this.pures.items.white=new Bt({color:16777215}),this.pures.items.white.name="pureWhite",this.pures.items.yellow=new Bt({color:16771209}),this.pures.items.yellow.name="pureYellow"}setShades(){if(this.shades={},this.shades.items={},this.shades.indirectColor="#d04500",this.shades.uniforms={uRevealProgress:0,uIndirectDistanceAmplitude:1.75,uIndirectDistanceStrength:.5,uIndirectDistancePower:2,uIndirectAngleStrength:1.5,uIndirectAngleOffset:.6,uIndirectAnglePower:1,uIndirectColor:null},this.shades.items.white=new Er,this.shades.items.white.name="shadeWhite",this.shades.items.white.uniforms.matcap.value=this.resources.items.matcapWhiteTexture,this.items.white=this.shades.items.white,this.shades.items.orange=new Er,this.shades.items.orange.name="shadeOrange",this.shades.items.orange.uniforms.matcap.value=this.resources.items.matcapOrangeTexture,this.items.orange=this.shades.items.orange,this.shades.items.green=new Er,this.shades.items.green.name="shadeGreen",this.shades.items.green.uniforms.matcap.value=this.resources.items.matcapGreenTexture,this.items.green=this.shades.items.green,this.shades.items.brown=new Er,this.shades.items.brown.name="shadeBrown",this.shades.items.brown.uniforms.matcap.value=this.resources.items.matcapBrownTexture,this.items.brown=this.shades.items.brown,this.shades.items.gray=new Er,this.shades.items.gray.name="shadeGray",this.shades.items.gray.uniforms.matcap.value=this.resources.items.matcapGrayTexture,this.items.gray=this.shades.items.gray,this.shades.items.beige=new Er,this.shades.items.beige.name="shadeBeige",this.shades.items.beige.uniforms.matcap.value=this.resources.items.matcapBeigeTexture,this.items.beige=this.shades.items.beige,this.shades.items.red=new Er,this.shades.items.red.name="shadeRed",this.shades.items.red.uniforms.matcap.value=this.resources.items.matcapRedTexture,this.items.red=this.shades.items.red,this.shades.items.black=new Er,this.shades.items.black.name="shadeBlack",this.shades.items.black.uniforms.matcap.value=this.resources.items.matcapBlackTexture,this.items.black=this.shades.items.black,this.shades.items.emeraldGreen=new Er,this.shades.items.emeraldGreen.name="shadeEmeraldGreen",this.shades.items.emeraldGreen.uniforms.matcap.value=this.resources.items.matcapEmeraldGreenTexture,this.items.emeraldGreen=this.shades.items.emeraldGreen,this.shades.items.purple=new Er,this.shades.items.purple.name="shadePurple",this.shades.items.purple.uniforms.matcap.value=this.resources.items.matcapPurpleTexture,this.items.purple=this.shades.items.purple,this.shades.items.blue=new Er,this.shades.items.blue.name="shadeBlue",this.shades.items.blue.uniforms.matcap.value=this.resources.items.matcapBlueTexture,this.items.blue=this.shades.items.blue,this.shades.items.yellow=new Er,this.shades.items.yellow.name="shadeYellow",this.shades.items.yellow.uniforms.matcap.value=this.resources.items.matcapYellowTexture,this.items.yellow=this.shades.items.yellow,this.shades.items.metal=new Er,this.shades.items.metal.name="shadeMetal",this.shades.items.metal.uniforms.matcap.value=this.resources.items.matcapMetalTexture,this.items.metal=this.shades.items.metal,this.shades.updateMaterials=()=>{this.shades.uniforms.uIndirectColor=new qe(this.shades.indirectColor);for(const e in this.shades.uniforms){const t=this.shades.uniforms[e];for(const n in this.shades.items){const r=this.shades.items[n];r.uniforms[e].value=t}}},this.shades.updateMaterials(),this.debug){const e=this.debugFolder.addFolder("shades");e.open(),e.add(this.shades.uniforms,"uIndirectDistanceAmplitude").step(.001).min(0).max(3).onChange(this.shades.updateMaterials),e.add(this.shades.uniforms,"uIndirectDistanceStrength").step(.001).min(0).max(2).onChange(this.shades.updateMaterials),e.add(this.shades.uniforms,"uIndirectDistancePower").step(.001).min(0).max(5).onChange(this.shades.updateMaterials),e.add(this.shades.uniforms,"uIndirectAngleStrength").step(.001).min(0).max(2).onChange(this.shades.updateMaterials),e.add(this.shades.uniforms,"uIndirectAngleOffset").step(.001).min(-2).max(2).onChange(this.shades.updateMaterials),e.add(this.shades.uniforms,"uIndirectAnglePower").step(.001).min(0).max(5).onChange(this.shades.updateMaterials),e.addColor(this.shades,"indirectColor").onChange(this.shades.updateMaterials)}}setFloorShadow(){if(this.items.floorShadow=new RU,this.items.floorShadow.depthWrite=!1,this.items.floorShadow.shadowColor="#d04500",this.items.floorShadow.uniforms.uShadowColor.value=new qe(this.items.floorShadow.shadowColor),this.items.floorShadow.uniforms.uAlpha.value=0,this.items.floorShadow.updateMaterials=()=>{this.items.floorShadow.uniforms.uShadowColor.value=new qe(this.items.floorShadow.shadowColor);for(const e of this.objects.items)for(const t of e.container.children)t.material instanceof jn&&t.material.uniforms.uShadowColor&&(t.material.uniforms.uShadowColor.value=new qe(this.items.floorShadow.shadowColor))},this.debug){const e=this.debugFolder.addFolder("floorShadow");e.open(),e.addColor(this.items.floorShadow,"shadowColor").onChange(this.items.floorShadow.updateMaterials)}}}var FU=`#define GLSLIFY 1
uniform sampler2D tBackground;

varying vec2 vUv;

void main()
{
    vec4 backgroundColor = texture2D(tBackground, vUv);

    gl_FragColor = backgroundColor;
}
`,DU=`#define GLSLIFY 1
varying vec2 vUv;

void main()
{
    vUv = uv;

    vec3 newPosition = position;
    newPosition.z = 1.0;
    gl_Position = vec4(newPosition, 1.0);
}
`;function BU(){const i={tBackground:{value:null}};return new jn({wireframe:!1,transparent:!1,uniforms:i,vertexShader:DU,fragmentShader:FU})}class zU{constructor(e){if(this.debug=e.debug,this.container=new ft,this.container.matrixAutoUpdate=!1,this.geometry=new xn(2,2,10,10),this.colors={},this.colors.topLeft="#f5883c",this.colors.topRight="#ff9043",this.colors.bottomRight="#fccf92",this.colors.bottomLeft="#f5aa58",this.material=new BU,this.updateMaterial=()=>{const t=new qe(this.colors.topLeft),n=new qe(this.colors.topRight),r=new qe(this.colors.bottomRight),s=new qe(this.colors.bottomLeft),o=new Uint8Array([Math.round(s.r*255),Math.round(s.g*255),Math.round(s.b*255),255,Math.round(r.r*255),Math.round(r.g*255),Math.round(r.b*255),255,Math.round(t.r*255),Math.round(t.g*255),Math.round(t.b*255),255,Math.round(n.r*255),Math.round(n.g*255),Math.round(n.b*255),255]);this.backgroundTexture=new Ea(o,2,2,ur),this.backgroundTexture.magFilter=jt,this.backgroundTexture.needsUpdate=!0,this.material.uniforms.tBackground.value=this.backgroundTexture},this.updateMaterial(),this.mesh=new je(this.geometry,this.material),this.mesh.frustumCulled=!1,this.mesh.matrixAutoUpdate=!1,this.mesh.updateMatrix(),this.container.add(this.mesh),this.debug){const t=this.debug.addFolder("floor");t.addColor(this.colors,"topLeft").onChange(this.updateMaterial),t.addColor(this.colors,"topRight").onChange(this.updateMaterial),t.addColor(this.colors,"bottomRight").onChange(this.updateMaterial),t.addColor(this.colors,"bottomLeft").onChange(this.updateMaterial)}}}var OU=`#define GLSLIFY 1
#define PI 3.141592653589793

uniform vec3 uColor;
uniform float uAlpha;
uniform float uFadeRadius;

varying vec2 vUv;

float sineInOut(float t)
{
    return - 0.5 * (cos(PI * t) - 1.0);
}

void main()
{
    float strength = 0.0;

    if(vUv.x < uFadeRadius && vUv.y < uFadeRadius)
    {
        strength = clamp(1.0 - distance(vUv, vec2(uFadeRadius)) / uFadeRadius, 0.0, 1.0);
    }

    else if(vUv.x > 1.0 - uFadeRadius && vUv.y < uFadeRadius)
    {
        strength = clamp(1.0 - distance(vUv, vec2(1.0 - uFadeRadius, uFadeRadius)) / uFadeRadius, 0.0, 1.0);
    }

    else if(vUv.x > 1.0 - uFadeRadius && vUv.y > 1.0 - uFadeRadius)
    {
        strength = clamp(1.0 - distance(vUv, vec2(1.0 - uFadeRadius, 1.0 - uFadeRadius)) / uFadeRadius, 0.0, 1.0);
    }

    else if(vUv.x < uFadeRadius && vUv.y > 1.0 - uFadeRadius)
    {
        strength = clamp(1.0 - distance(vUv, vec2(uFadeRadius, 1.0 - uFadeRadius)) / uFadeRadius, 0.0, 1.0);
    }

    else
    {
        float xNeg = clamp(vUv.x / uFadeRadius, 0.0, 1.0);
        float xPos = clamp((1.0 - vUv.x) / uFadeRadius, 0.0, 1.0);
        float yNeg = clamp(vUv.y / uFadeRadius, 0.0, 1.0);
        float yPos = clamp((1.0 - vUv.y) / uFadeRadius, 0.0, 1.0);

        strength = xNeg * xPos * yNeg * yPos;
    }

    strength = sineInOut(strength);
    strength *= uAlpha;

    gl_FragColor = vec4(uColor, strength);
}
`,NU=`#define GLSLIFY 1
varying vec2 vUv;

void main()
{
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`;function UU(){const i={uColor:{value:null},uAlpha:{value:null},uFadeRadius:{value:null}};return new jn({wireframe:!1,transparent:!0,uniforms:i,vertexShader:NU,fragmentShader:OU})}const cl=new _f,ar=new B,ra=new B,Ln=new qt,DT={X:new B(1,0,0),Y:new B(0,1,0),Z:new B(0,0,1)},Jy={type:"change"},BT={type:"mouseDown"},zT={type:"mouseUp",mode:null},OT={type:"objectChange"};class U1 extends ft{constructor(e,t){super(),t===void 0&&(console.warn('THREE.TransformControls: The second parameter "domElement" is now mandatory.'),t=document),this.visible=!1,this.domElement=t,this.domElement.style.touchAction="none";const n=new $P;this._gizmo=n,this.add(n);const r=new QP;this._plane=r,this.add(r);const s=this;function o(w,S){let b=S;Object.defineProperty(s,w,{get:function(){return b!==void 0?b:S},set:function(E){b!==E&&(b=E,r[w]=E,n[w]=E,s.dispatchEvent({type:w+"-changed",value:E}),s.dispatchEvent(Jy))}}),s[w]=S,r[w]=S,n[w]=S}o("camera",e),o("object",void 0),o("enabled",!0),o("axis",null),o("mode","translate"),o("translationSnap",null),o("rotationSnap",null),o("scaleSnap",null),o("space","world"),o("size",1),o("dragging",!1),o("showX",!0),o("showY",!0),o("showZ",!0);const a=new B,c=new B,h=new qt,d=new qt,l=new B,u=new qt,p=new B,g=new B,y=new B,x=0,v=new B;o("worldPosition",a),o("worldPositionStart",c),o("worldQuaternion",h),o("worldQuaternionStart",d),o("cameraPosition",l),o("cameraQuaternion",u),o("pointStart",p),o("pointEnd",g),o("rotationAxis",y),o("rotationAngle",x),o("eye",v),this._offset=new B,this._startNorm=new B,this._endNorm=new B,this._cameraScale=new B,this._parentPosition=new B,this._parentQuaternion=new qt,this._parentQuaternionInv=new qt,this._parentScale=new B,this._worldScaleStart=new B,this._worldQuaternionInv=new qt,this._worldScale=new B,this._positionStart=new B,this._quaternionStart=new qt,this._scaleStart=new B,this._getPointer=HU.bind(this),this._onPointerDown=GU.bind(this),this._onPointerHover=VU.bind(this),this._onPointerMove=WU.bind(this),this._onPointerUp=jU.bind(this),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointermove",this._onPointerHover),this.domElement.addEventListener("pointerup",this._onPointerUp)}updateMatrixWorld(){this.object!==void 0&&(this.object.updateMatrixWorld(),this.object.parent===null?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(this._parentPosition,this._parentQuaternion,this._parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this._worldScale),this._parentQuaternionInv.copy(this._parentQuaternion).invert(),this._worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this._cameraScale),this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),super.updateMatrixWorld(this)}pointerHover(e){if(this.object===void 0||this.dragging===!0)return;cl.setFromCamera(e,this.camera);const t=ex(this._gizmo.picker[this.mode],cl);t?this.axis=t.object.name:this.axis=null}pointerDown(e){if(!(this.object===void 0||this.dragging===!0||e.button!==0)&&this.axis!==null){cl.setFromCamera(e,this.camera);const t=ex(this._plane,cl,!0);t&&(this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(t.point).sub(this.worldPositionStart)),this.dragging=!0,BT.mode=this.mode,this.dispatchEvent(BT)}}pointerMove(e){const t=this.axis,n=this.mode,r=this.object;let s=this.space;if(n==="scale"?s="local":(t==="E"||t==="XYZE"||t==="XYZ")&&(s="world"),r===void 0||t===null||this.dragging===!1||e.button!==-1)return;cl.setFromCamera(e,this.camera);const o=ex(this._plane,cl,!0);if(!!o){if(this.pointEnd.copy(o.point).sub(this.worldPositionStart),n==="translate")this._offset.copy(this.pointEnd).sub(this.pointStart),s==="local"&&t!=="XYZ"&&this._offset.applyQuaternion(this._worldQuaternionInv),t.indexOf("X")===-1&&(this._offset.x=0),t.indexOf("Y")===-1&&(this._offset.y=0),t.indexOf("Z")===-1&&(this._offset.z=0),s==="local"&&t!=="XYZ"?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),r.position.copy(this._offset).add(this._positionStart),this.translationSnap&&(s==="local"&&(r.position.applyQuaternion(Ln.copy(this._quaternionStart).invert()),t.search("X")!==-1&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),t.search("Y")!==-1&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),t.search("Z")!==-1&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.position.applyQuaternion(this._quaternionStart)),s==="world"&&(r.parent&&r.position.add(ar.setFromMatrixPosition(r.parent.matrixWorld)),t.search("X")!==-1&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),t.search("Y")!==-1&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),t.search("Z")!==-1&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.parent&&r.position.sub(ar.setFromMatrixPosition(r.parent.matrixWorld))));else if(n==="scale"){if(t.search("XYZ")!==-1){let a=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(a*=-1),ra.set(a,a,a)}else ar.copy(this.pointStart),ra.copy(this.pointEnd),ar.applyQuaternion(this._worldQuaternionInv),ra.applyQuaternion(this._worldQuaternionInv),ra.divide(ar),t.search("X")===-1&&(ra.x=1),t.search("Y")===-1&&(ra.y=1),t.search("Z")===-1&&(ra.z=1);r.scale.copy(this._scaleStart).multiply(ra),this.scaleSnap&&(t.search("X")!==-1&&(r.scale.x=Math.round(r.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),t.search("Y")!==-1&&(r.scale.y=Math.round(r.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),t.search("Z")!==-1&&(r.scale.z=Math.round(r.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if(n==="rotate"){this._offset.copy(this.pointEnd).sub(this.pointStart);const a=20/this.worldPosition.distanceTo(ar.setFromMatrixPosition(this.camera.matrixWorld));t==="E"?(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this._endNorm.cross(this._startNorm).dot(this.eye)<0?1:-1):t==="XYZE"?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(ar.copy(this.rotationAxis).cross(this.eye))*a):(t==="X"||t==="Y"||t==="Z")&&(this.rotationAxis.copy(DT[t]),ar.copy(DT[t]),s==="local"&&ar.applyQuaternion(this.worldQuaternion),this.rotationAngle=this._offset.dot(ar.cross(this.eye).normalize())*a),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),s==="local"&&t!=="E"&&t!=="XYZE"?(r.quaternion.copy(this._quaternionStart),r.quaternion.multiply(Ln.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),r.quaternion.copy(Ln.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),r.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent(Jy),this.dispatchEvent(OT)}}pointerUp(e){e.button===0&&(this.dragging&&this.axis!==null&&(zT.mode=this.mode,this.dispatchEvent(zT)),this.dragging=!1,this.axis=null)}dispose(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.traverse(function(e){e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()})}attach(e){return this.object=e,this.visible=!0,this}detach(){return this.object=void 0,this.visible=!1,this.axis=null,this}reset(){!this.enabled||this.dragging&&(this.object.position.copy(this._positionStart),this.object.quaternion.copy(this._quaternionStart),this.object.scale.copy(this._scaleStart),this.dispatchEvent(Jy),this.dispatchEvent(OT),this.pointStart.copy(this.pointEnd))}getRaycaster(){return cl}getMode(){return this.mode}setMode(e){this.mode=e}setTranslationSnap(e){this.translationSnap=e}setRotationSnap(e){this.rotationSnap=e}setScaleSnap(e){this.scaleSnap=e}setSize(e){this.size=e}setSpace(e){this.space=e}update(){console.warn("THREE.TransformControls: update function has no more functionality and therefore has been deprecated.")}}U1.prototype.isTransformControls=!0;function HU(i){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:i.button};{const e=this.domElement.getBoundingClientRect();return{x:(i.clientX-e.left)/e.width*2-1,y:-(i.clientY-e.top)/e.height*2+1,button:i.button}}}function VU(i){if(!!this.enabled)switch(i.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(i));break}}function GU(i){!this.enabled||(document.pointerLockElement||this.domElement.setPointerCapture(i.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(i)),this.pointerDown(this._getPointer(i)))}function WU(i){!this.enabled||this.pointerMove(this._getPointer(i))}function jU(i){!this.enabled||(this.domElement.releasePointerCapture(i.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(i)))}function ex(i,e,t){const n=e.intersectObject(i,!0);for(let r=0;r<n.length;r++)if(n[r].object.visible||t)return n[r];return!1}const Rm=new Et,mn=new B(0,1,0),NT=new B(0,0,0),UT=new st,Lm=new qt,tg=new qt,Hs=new B,HT=new st,rd=new B(1,0,0),fl=new B(0,1,0),sd=new B(0,0,1),km=new B,Yh=new B,$h=new B;class $P extends ft{constructor(){super(),this.type="TransformControlsGizmo";const e=new Bt({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),t=new ni({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),n=e.clone();n.opacity=.15;const r=t.clone();r.opacity=.5;const s=e.clone();s.color.setHex(16711680);const o=e.clone();o.color.setHex(65280);const a=e.clone();a.color.setHex(255);const c=e.clone();c.color.setHex(16711680),c.opacity=.5;const h=e.clone();h.color.setHex(65280),h.opacity=.5;const d=e.clone();d.color.setHex(255),d.opacity=.5;const l=e.clone();l.opacity=.25;const u=e.clone();u.color.setHex(16776960),u.opacity=.25,e.clone().color.setHex(16776960);const g=e.clone();g.color.setHex(7895160);const y=new kn(0,.04,.1,12);y.translate(0,.05,0);const x=new dn(.08,.08,.08);x.translate(0,.04,0);const v=new vt;v.setAttribute("position",new lt([0,0,0,1,0,0],3));const w=new kn(.0075,.0075,.5,3);w.translate(0,.25,0);function S(te,ne){const j=new xs(te,.0075,3,64,ne*Math.PI*2);return j.rotateY(Math.PI/2),j.rotateX(Math.PI/2),j}function b(){const te=new vt;return te.setAttribute("position",new lt([0,0,0,1,1,1],3)),te}const E={X:[[new je(y,s),[.5,0,0],[0,0,-Math.PI/2]],[new je(y,s),[-.5,0,0],[0,0,Math.PI/2]],[new je(w,s),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new je(y,o),[0,.5,0]],[new je(y,o),[0,-.5,0],[Math.PI,0,0]],[new je(w,o)]],Z:[[new je(y,a),[0,0,.5],[Math.PI/2,0,0]],[new je(y,a),[0,0,-.5],[-Math.PI/2,0,0]],[new je(w,a),null,[Math.PI/2,0,0]]],XYZ:[[new je(new ws(.1,0),l.clone()),[0,0,0]]],XY:[[new je(new dn(.15,.15,.01),d.clone()),[.15,.15,0]]],YZ:[[new je(new dn(.15,.15,.01),c.clone()),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new je(new dn(.15,.15,.01),h.clone()),[.15,0,.15],[-Math.PI/2,0,0]]]},R={X:[[new je(new kn(.2,0,.6,4),n),[.3,0,0],[0,0,-Math.PI/2]],[new je(new kn(.2,0,.6,4),n),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new je(new kn(.2,0,.6,4),n),[0,.3,0]],[new je(new kn(.2,0,.6,4),n),[0,-.3,0],[0,0,Math.PI]]],Z:[[new je(new kn(.2,0,.6,4),n),[0,0,.3],[Math.PI/2,0,0]],[new je(new kn(.2,0,.6,4),n),[0,0,-.3],[-Math.PI/2,0,0]]],XYZ:[[new je(new ws(.2,0),n)]],XY:[[new je(new dn(.2,.2,.01),n),[.15,.15,0]]],YZ:[[new je(new dn(.2,.2,.01),n),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new je(new dn(.2,.2,.01),n),[.15,0,.15],[-Math.PI/2,0,0]]]},z={START:[[new je(new ws(.01,2),r),null,null,null,"helper"]],END:[[new je(new ws(.01,2),r),null,null,null,"helper"]],DELTA:[[new di(b(),r),null,null,null,"helper"]],X:[[new di(v,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new di(v,r.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new di(v,r.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},I={XYZE:[[new je(S(.5,1),g),null,[0,Math.PI/2,0]]],X:[[new je(S(.5,.5),s)]],Y:[[new je(S(.5,.5),o),null,[0,0,-Math.PI/2]]],Z:[[new je(S(.5,.5),a),null,[0,Math.PI/2,0]]],E:[[new je(S(.75,1),u),null,[0,Math.PI/2,0]]]},N={AXIS:[[new di(v,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},F={XYZE:[[new je(new Ro(.25,10,8),n)]],X:[[new je(new xs(.5,.1,4,24),n),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new je(new xs(.5,.1,4,24),n),[0,0,0],[Math.PI/2,0,0]]],Z:[[new je(new xs(.5,.1,4,24),n),[0,0,0],[0,0,-Math.PI/2]]],E:[[new je(new xs(.75,.1,2,24),n)]]},C={X:[[new je(x,s),[.5,0,0],[0,0,-Math.PI/2]],[new je(w,s),[0,0,0],[0,0,-Math.PI/2]],[new je(x,s),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new je(x,o),[0,.5,0]],[new je(w,o)],[new je(x,o),[0,-.5,0],[0,0,Math.PI]]],Z:[[new je(x,a),[0,0,.5],[Math.PI/2,0,0]],[new je(w,a),[0,0,0],[Math.PI/2,0,0]],[new je(x,a),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new je(new dn(.15,.15,.01),d),[.15,.15,0]]],YZ:[[new je(new dn(.15,.15,.01),c),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new je(new dn(.15,.15,.01),h),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new je(new dn(.1,.1,.1),l.clone())]]},O={X:[[new je(new kn(.2,0,.6,4),n),[.3,0,0],[0,0,-Math.PI/2]],[new je(new kn(.2,0,.6,4),n),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new je(new kn(.2,0,.6,4),n),[0,.3,0]],[new je(new kn(.2,0,.6,4),n),[0,-.3,0],[0,0,Math.PI]]],Z:[[new je(new kn(.2,0,.6,4),n),[0,0,.3],[Math.PI/2,0,0]],[new je(new kn(.2,0,.6,4),n),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new je(new dn(.2,.2,.01),n),[.15,.15,0]]],YZ:[[new je(new dn(.2,.2,.01),n),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new je(new dn(.2,.2,.01),n),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new je(new dn(.2,.2,.2),n),[0,0,0]]]},X={X:[[new di(v,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new di(v,r.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new di(v,r.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function U(te){const ne=new ft;for(const j in te)for(let k=te[j].length;k--;){const W=te[j][k][0].clone(),Y=te[j][k][1],H=te[j][k][2],J=te[j][k][3],K=te[j][k][4];W.name=j,W.tag=K,Y&&W.position.set(Y[0],Y[1],Y[2]),H&&W.rotation.set(H[0],H[1],H[2]),J&&W.scale.set(J[0],J[1],J[2]),W.updateMatrix();const ee=W.geometry.clone();ee.applyMatrix4(W.matrix),W.geometry=ee,W.renderOrder=1/0,W.position.set(0,0,0),W.rotation.set(0,0,0),W.scale.set(1,1,1),ne.add(W)}return ne}this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=U(E)),this.add(this.gizmo.rotate=U(I)),this.add(this.gizmo.scale=U(C)),this.add(this.picker.translate=U(R)),this.add(this.picker.rotate=U(F)),this.add(this.picker.scale=U(O)),this.add(this.helper.translate=U(z)),this.add(this.helper.rotate=U(N)),this.add(this.helper.scale=U(X)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}updateMatrixWorld(e){const n=(this.mode==="scale"?"local":this.space)==="local"?this.worldQuaternion:tg;this.gizmo.translate.visible=this.mode==="translate",this.gizmo.rotate.visible=this.mode==="rotate",this.gizmo.scale.visible=this.mode==="scale",this.helper.translate.visible=this.mode==="translate",this.helper.rotate.visible=this.mode==="rotate",this.helper.scale.visible=this.mode==="scale";let r=[];r=r.concat(this.picker[this.mode].children),r=r.concat(this.gizmo[this.mode].children),r=r.concat(this.helper[this.mode].children);for(let s=0;s<r.length;s++){const o=r[s];o.visible=!0,o.rotation.set(0,0,0),o.position.copy(this.worldPosition);let a;if(this.camera.isOrthographicCamera?a=(this.camera.top-this.camera.bottom)/this.camera.zoom:a=this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),o.scale.set(1,1,1).multiplyScalar(a*this.size/4),o.tag==="helper"){o.visible=!1,o.name==="AXIS"?(o.position.copy(this.worldPositionStart),o.visible=!!this.axis,this.axis==="X"&&(Ln.setFromEuler(Rm.set(0,0,0)),o.quaternion.copy(n).multiply(Ln),Math.abs(mn.copy(rd).applyQuaternion(n).dot(this.eye))>.9&&(o.visible=!1)),this.axis==="Y"&&(Ln.setFromEuler(Rm.set(0,0,Math.PI/2)),o.quaternion.copy(n).multiply(Ln),Math.abs(mn.copy(fl).applyQuaternion(n).dot(this.eye))>.9&&(o.visible=!1)),this.axis==="Z"&&(Ln.setFromEuler(Rm.set(0,Math.PI/2,0)),o.quaternion.copy(n).multiply(Ln),Math.abs(mn.copy(sd).applyQuaternion(n).dot(this.eye))>.9&&(o.visible=!1)),this.axis==="XYZE"&&(Ln.setFromEuler(Rm.set(0,Math.PI/2,0)),mn.copy(this.rotationAxis),o.quaternion.setFromRotationMatrix(UT.lookAt(NT,mn,fl)),o.quaternion.multiply(Ln),o.visible=this.dragging),this.axis==="E"&&(o.visible=!1)):o.name==="START"?(o.position.copy(this.worldPositionStart),o.visible=this.dragging):o.name==="END"?(o.position.copy(this.worldPosition),o.visible=this.dragging):o.name==="DELTA"?(o.position.copy(this.worldPositionStart),o.quaternion.copy(this.worldQuaternionStart),ar.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),ar.applyQuaternion(this.worldQuaternionStart.clone().invert()),o.scale.copy(ar),o.visible=this.dragging):(o.quaternion.copy(n),this.dragging?o.position.copy(this.worldPositionStart):o.position.copy(this.worldPosition),this.axis&&(o.visible=this.axis.search(o.name)!==-1));continue}o.quaternion.copy(n),this.mode==="translate"||this.mode==="scale"?(o.name==="X"&&Math.abs(mn.copy(rd).applyQuaternion(n).dot(this.eye))>.99&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),o.name==="Y"&&Math.abs(mn.copy(fl).applyQuaternion(n).dot(this.eye))>.99&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),o.name==="Z"&&Math.abs(mn.copy(sd).applyQuaternion(n).dot(this.eye))>.99&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),o.name==="XY"&&Math.abs(mn.copy(sd).applyQuaternion(n).dot(this.eye))<.2&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),o.name==="YZ"&&Math.abs(mn.copy(rd).applyQuaternion(n).dot(this.eye))<.2&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),o.name==="XZ"&&Math.abs(mn.copy(fl).applyQuaternion(n).dot(this.eye))<.2&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1)):this.mode==="rotate"&&(Lm.copy(n),mn.copy(this.eye).applyQuaternion(Ln.copy(n).invert()),o.name.search("E")!==-1&&o.quaternion.setFromRotationMatrix(UT.lookAt(this.eye,NT,fl)),o.name==="X"&&(Ln.setFromAxisAngle(rd,Math.atan2(-mn.y,mn.z)),Ln.multiplyQuaternions(Lm,Ln),o.quaternion.copy(Ln)),o.name==="Y"&&(Ln.setFromAxisAngle(fl,Math.atan2(mn.x,mn.z)),Ln.multiplyQuaternions(Lm,Ln),o.quaternion.copy(Ln)),o.name==="Z"&&(Ln.setFromAxisAngle(sd,Math.atan2(mn.y,mn.x)),Ln.multiplyQuaternions(Lm,Ln),o.quaternion.copy(Ln))),o.visible=o.visible&&(o.name.indexOf("X")===-1||this.showX),o.visible=o.visible&&(o.name.indexOf("Y")===-1||this.showY),o.visible=o.visible&&(o.name.indexOf("Z")===-1||this.showZ),o.visible=o.visible&&(o.name.indexOf("E")===-1||this.showX&&this.showY&&this.showZ),o.material._color=o.material._color||o.material.color.clone(),o.material._opacity=o.material._opacity||o.material.opacity,o.material.color.copy(o.material._color),o.material.opacity=o.material._opacity,this.enabled&&this.axis&&(o.name===this.axis||this.axis.split("").some(function(c){return o.name===c}))&&(o.material.color.setHex(16776960),o.material.opacity=1)}super.updateMatrixWorld(e)}}$P.prototype.isTransformControlsGizmo=!0;class QP extends je{constructor(){super(new xn(1e5,1e5,2,2),new Bt({visible:!1,wireframe:!0,side:Es,transparent:!0,opacity:.1,toneMapped:!1})),this.type="TransformControlsPlane"}updateMatrixWorld(e){let t=this.space;switch(this.position.copy(this.worldPosition),this.mode==="scale"&&(t="local"),km.copy(rd).applyQuaternion(t==="local"?this.worldQuaternion:tg),Yh.copy(fl).applyQuaternion(t==="local"?this.worldQuaternion:tg),$h.copy(sd).applyQuaternion(t==="local"?this.worldQuaternion:tg),mn.copy(Yh),this.mode){case"translate":case"scale":switch(this.axis){case"X":mn.copy(this.eye).cross(km),Hs.copy(km).cross(mn);break;case"Y":mn.copy(this.eye).cross(Yh),Hs.copy(Yh).cross(mn);break;case"Z":mn.copy(this.eye).cross($h),Hs.copy($h).cross(mn);break;case"XY":Hs.copy($h);break;case"YZ":Hs.copy(km);break;case"XZ":mn.copy($h),Hs.copy(Yh);break;case"XYZ":case"E":Hs.set(0,0,0);break}break;case"rotate":default:Hs.set(0,0,0)}Hs.length()===0?this.quaternion.copy(this.cameraQuaternion):(HT.lookAt(ar.set(0,0,0),Hs,mn),this.quaternion.setFromRotationMatrix(HT)),super.updateMatrixWorld(e)}}QP.prototype.isTransformControlsPlane=!0;class XU{constructor(e){this.time=e.time,this.debug=e.debug,this.renderer=e.renderer,this.camera=e.camera,this.alpha=0,this.maxDistance=3,this.distancePower=2,this.zFightingDistance=.001,this.color="#d04500",this.wireframeVisible=!1,this.items=[],this.container=new ft,this.container.matrixAutoUpdate=!1,this.container.updateMatrix(),this.debug&&(this.debugFolder=this.debug.addFolder("shadows"),this.debugFolder.add(this,"alpha").step(.01).min(0).max(1),this.debugFolder.add(this,"maxDistance").step(.01).min(0).max(10),this.debugFolder.add(this,"distancePower").step(.01).min(1).max(5),this.debugFolder.add(this,"wireframeVisible").name("wireframeVisible").onChange(()=>{for(const t of this.items)t.mesh.material=this.wireframeVisible?this.materials.wireframe:t.material}),this.debugFolder.addColor(this,"color").onChange(()=>{this.materials.base.uniforms.uColor.value=new qe(this.color);for(const t of this.items)t.material.uniforms.uColor.value=new qe(this.color)})),this.setSun(),this.setMaterials(),this.setGeometry(),this.setHelper(),this.time.on("tick",()=>{for(const t of this.items){const n=Math.max(t.reference.position.z+t.offsetZ,0),r=this.sun.vector.clone().multiplyScalar(n);t.mesh.position.x=t.reference.position.x+r.x,t.mesh.position.y=t.reference.position.y+r.y;const s=new B(1,0,0);s.applyQuaternion(t.reference.quaternion);const o=s.clone().projectOnPlane(new B(0,0,1));let a=Math.abs(s.angleTo(new B(0,0,1))-Math.PI*.5)/(Math.PI*.5);a/=.5,a-=1/.5,a=Math.abs(a),a=Math.min(Math.max(a,0),1);const c=Math.atan2(o.y,o.x);t.mesh.rotation.z=c;let h=(this.maxDistance-n)/this.maxDistance;h=Math.min(Math.max(h,0),1),h=Math.pow(h,this.distancePower),t.material.uniforms.uAlpha.value=this.alpha*t.alpha*a*h}})}setSun(){if(this.sun={},this.sun.position=new B(-2.5,-2.65,3.75),this.sun.vector=new B,this.sun.helper=new EP(new B(0,0,1),new B(0,0,0),1,16777215,.1,.4),this.sun.helper.visible=!1,this.container.add(this.sun.helper),this.sun.update=()=>{this.sun.vector.copy(this.sun.position).multiplyScalar(1/this.sun.position.z).negate(),this.sun.helper.position.copy(this.sun.position);const e=this.sun.position.clone().negate().normalize();this.sun.helper.setDirection(e),this.sun.helper.setLength(this.sun.helper.position.length())},this.sun.update(),this.debug){const e=this.debugFolder.addFolder("sun");e.open(),e.add(this.sun.position,"x").step(.01).min(-10).max(10).name("sunX").onChange(this.sun.update),e.add(this.sun.position,"y").step(.01).min(-10).max(10).name("sunY").onChange(this.sun.update),e.add(this.sun.position,"z").step(.01).min(0).max(10).name("sunZ").onChange(this.sun.update),e.add(this.sun.helper,"visible").name("sunHelperVisible")}}setMaterials(){this.materials={},this.materials.wireframe=new Bt({color:16777215,wireframe:!0}),this.materials.base=new UU,this.materials.base.depthWrite=!1,this.materials.base.uniforms.uColor.value=new qe(this.color),this.materials.base.uniforms.uAlpha.value=0,this.materials.base.uniforms.uFadeRadius.value=.35}setGeometry(){this.geometry=new xn(1,1,1,1)}setHelper(){if(!!this.debug&&(this.helper={},this.helper.active=!1,this.helper.mesh=new je(new dn(3,1,1,1),new Bu),this.helper.mesh.position.z=1.5,this.helper.mesh.position.y=-3,this.helper.mesh.visible=this.helper.active,this.container.add(this.helper.mesh),this.helper.transformControls=new U1(this.camera.instance,this.renderer.domElement),this.helper.transformControls.size=.5,this.helper.transformControls.attach(this.helper.mesh),this.helper.transformControls.visible=this.helper.active,this.helper.transformControls.enabled=this.helper.active,this.helper.shadow=this.add(this.helper.mesh,{sizeX:6,sizeY:2,offsetZ:-.35,alpha:.99}),this.helper.shadow.mesh.visible=this.helper.active,document.addEventListener("keydown",e=>{e.key==="r"?this.helper.transformControls.setMode("rotate"):e.key==="g"&&this.helper.transformControls.setMode("translate")}),this.helper.transformControls.addEventListener("dragging-changed",e=>{this.camera.orbitControls.enabled=!e.value}),this.container.add(this.helper.transformControls),this.debug)){const e=this.debugFolder.addFolder("helper");e.open(),e.add(this.helper,"active").name("visible").onChange(()=>{this.helper.mesh.visible=this.helper.active,this.helper.transformControls.visible=this.helper.active,this.helper.transformControls.enabled=this.helper.active,this.helper.shadow.mesh.visible=this.helper.active})}}add(e,t={}){const n={};return n.offsetZ=typeof t.offsetZ=="undefined"?0:t.offsetZ,n.alpha=typeof t.alpha=="undefined"?1:t.alpha,n.reference=e,n.material=this.materials.base.clone(),n.mesh=new je(this.geometry,this.wireframeVisible?this.materials.wireframe:n.material),n.mesh.position.z=this.zFightingDistance,n.mesh.scale.set(t.sizeX,t.sizeY,2.4),this.container.add(n.mesh),this.items.push(n),n}}var ZP={exports:{}};(function(i,e){(function(t){i.exports=t()})(function(){return function t(n,r,s){function o(h,d){if(!r[h]){if(!n[h]){var l=typeof xp=="function"&&xp;if(!d&&l)return l(h,!0);if(a)return a(h,!0);throw new Error("Cannot find module '"+h+"'")}var u=r[h]={exports:{}};n[h][0].call(u.exports,function(p){var g=n[h][1][p];return o(g||p)},u,u.exports,t,n,r,s)}return r[h].exports}for(var a=typeof xp=="function"&&xp,c=0;c<s.length;c++)o(s[c]);return o}({1:[function(t,n,r){n.exports={name:"cannon",version:"0.6.2",description:"A lightweight 3D physics engine written in JavaScript.",homepage:"https://github.com/schteppe/cannon.js",author:"Stefan Hedman <schteppe@gmail.com> (http://steffe.se)",keywords:["cannon.js","cannon","physics","engine","3d"],main:"./build/cannon.js",engines:{node:"*"},repository:{type:"git",url:"https://github.com/schteppe/cannon.js.git"},bugs:{url:"https://github.com/schteppe/cannon.js/issues"},licenses:[{type:"MIT"}],devDependencies:{jshint:"latest","uglify-js":"latest",nodeunit:"^0.9.0",grunt:"~0.4.0","grunt-contrib-jshint":"~0.1.1","grunt-contrib-nodeunit":"^0.4.1","grunt-contrib-concat":"~0.1.3","grunt-contrib-uglify":"^0.5.1","grunt-browserify":"^2.1.4","grunt-contrib-yuidoc":"^0.5.2",browserify:"*"},dependencies:{}}},{}],2:[function(t,n,r){n.exports={version:t("../package.json").version,AABB:t("./collision/AABB"),ArrayCollisionMatrix:t("./collision/ArrayCollisionMatrix"),Body:t("./objects/Body"),Box:t("./shapes/Box"),Broadphase:t("./collision/Broadphase"),Constraint:t("./constraints/Constraint"),ContactEquation:t("./equations/ContactEquation"),Narrowphase:t("./world/Narrowphase"),ConeTwistConstraint:t("./constraints/ConeTwistConstraint"),ContactMaterial:t("./material/ContactMaterial"),ConvexPolyhedron:t("./shapes/ConvexPolyhedron"),Cylinder:t("./shapes/Cylinder"),DistanceConstraint:t("./constraints/DistanceConstraint"),Equation:t("./equations/Equation"),EventTarget:t("./utils/EventTarget"),FrictionEquation:t("./equations/FrictionEquation"),GSSolver:t("./solver/GSSolver"),GridBroadphase:t("./collision/GridBroadphase"),Heightfield:t("./shapes/Heightfield"),HingeConstraint:t("./constraints/HingeConstraint"),LockConstraint:t("./constraints/LockConstraint"),Mat3:t("./math/Mat3"),Material:t("./material/Material"),NaiveBroadphase:t("./collision/NaiveBroadphase"),ObjectCollisionMatrix:t("./collision/ObjectCollisionMatrix"),Pool:t("./utils/Pool"),Particle:t("./shapes/Particle"),Plane:t("./shapes/Plane"),PointToPointConstraint:t("./constraints/PointToPointConstraint"),Quaternion:t("./math/Quaternion"),Ray:t("./collision/Ray"),RaycastVehicle:t("./objects/RaycastVehicle"),RaycastResult:t("./collision/RaycastResult"),RigidVehicle:t("./objects/RigidVehicle"),RotationalEquation:t("./equations/RotationalEquation"),RotationalMotorEquation:t("./equations/RotationalMotorEquation"),SAPBroadphase:t("./collision/SAPBroadphase"),SPHSystem:t("./objects/SPHSystem"),Shape:t("./shapes/Shape"),Solver:t("./solver/Solver"),Sphere:t("./shapes/Sphere"),SplitSolver:t("./solver/SplitSolver"),Spring:t("./objects/Spring"),Trimesh:t("./shapes/Trimesh"),Vec3:t("./math/Vec3"),Vec3Pool:t("./utils/Vec3Pool"),World:t("./world/World")}},{"../package.json":1,"./collision/AABB":3,"./collision/ArrayCollisionMatrix":4,"./collision/Broadphase":5,"./collision/GridBroadphase":6,"./collision/NaiveBroadphase":7,"./collision/ObjectCollisionMatrix":8,"./collision/Ray":9,"./collision/RaycastResult":10,"./collision/SAPBroadphase":11,"./constraints/ConeTwistConstraint":12,"./constraints/Constraint":13,"./constraints/DistanceConstraint":14,"./constraints/HingeConstraint":15,"./constraints/LockConstraint":16,"./constraints/PointToPointConstraint":17,"./equations/ContactEquation":19,"./equations/Equation":20,"./equations/FrictionEquation":21,"./equations/RotationalEquation":22,"./equations/RotationalMotorEquation":23,"./material/ContactMaterial":24,"./material/Material":25,"./math/Mat3":27,"./math/Quaternion":28,"./math/Vec3":30,"./objects/Body":31,"./objects/RaycastVehicle":32,"./objects/RigidVehicle":33,"./objects/SPHSystem":34,"./objects/Spring":35,"./shapes/Box":37,"./shapes/ConvexPolyhedron":38,"./shapes/Cylinder":39,"./shapes/Heightfield":40,"./shapes/Particle":41,"./shapes/Plane":42,"./shapes/Shape":43,"./shapes/Sphere":44,"./shapes/Trimesh":45,"./solver/GSSolver":46,"./solver/Solver":47,"./solver/SplitSolver":48,"./utils/EventTarget":49,"./utils/Pool":51,"./utils/Vec3Pool":54,"./world/Narrowphase":55,"./world/World":56}],3:[function(t,n,r){var s=t("../math/Vec3");t("../utils/Utils"),n.exports=o;function o(h){h=h||{},this.lowerBound=new s,h.lowerBound&&this.lowerBound.copy(h.lowerBound),this.upperBound=new s,h.upperBound&&this.upperBound.copy(h.upperBound)}var a=new s;o.prototype.setFromPoints=function(h,d,l,u){var p=this.lowerBound,g=this.upperBound,y=l;p.copy(h[0]),y&&y.vmult(p,p),g.copy(p);for(var x=1;x<h.length;x++){var v=h[x];y&&(y.vmult(v,a),v=a),v.x>g.x&&(g.x=v.x),v.x<p.x&&(p.x=v.x),v.y>g.y&&(g.y=v.y),v.y<p.y&&(p.y=v.y),v.z>g.z&&(g.z=v.z),v.z<p.z&&(p.z=v.z)}return d&&(d.vadd(p,p),d.vadd(g,g)),u&&(p.x-=u,p.y-=u,p.z-=u,g.x+=u,g.y+=u,g.z+=u),this},o.prototype.copy=function(h){return this.lowerBound.copy(h.lowerBound),this.upperBound.copy(h.upperBound),this},o.prototype.clone=function(){return new o().copy(this)},o.prototype.extend=function(h){var d=h.lowerBound.x;this.lowerBound.x>d&&(this.lowerBound.x=d);var l=h.upperBound.x;this.upperBound.x<l&&(this.upperBound.x=l);var d=h.lowerBound.y;this.lowerBound.y>d&&(this.lowerBound.y=d);var l=h.upperBound.y;this.upperBound.y<l&&(this.upperBound.y=l);var d=h.lowerBound.z;this.lowerBound.z>d&&(this.lowerBound.z=d);var l=h.upperBound.z;this.upperBound.z<l&&(this.upperBound.z=l)},o.prototype.overlaps=function(h){var d=this.lowerBound,l=this.upperBound,u=h.lowerBound,p=h.upperBound;return(u.x<=l.x&&l.x<=p.x||d.x<=p.x&&p.x<=l.x)&&(u.y<=l.y&&l.y<=p.y||d.y<=p.y&&p.y<=l.y)&&(u.z<=l.z&&l.z<=p.z||d.z<=p.z&&p.z<=l.z)},o.prototype.contains=function(h){var d=this.lowerBound,l=this.upperBound,u=h.lowerBound,p=h.upperBound;return d.x<=u.x&&l.x>=p.x&&d.y<=u.y&&l.y>=p.y&&d.z<=u.z&&l.z>=p.z},o.prototype.getCorners=function(h,d,l,u,p,g,y,x){var v=this.lowerBound,w=this.upperBound;h.copy(v),d.set(w.x,v.y,v.z),l.set(w.x,w.y,v.z),u.set(v.x,w.y,w.z),p.set(w.x,v.y,v.z),g.set(v.x,w.y,v.z),y.set(v.x,v.y,w.z),x.copy(w)};var c=[new s,new s,new s,new s,new s,new s,new s,new s];o.prototype.toLocalFrame=function(h,d){var l=c,u=l[0],p=l[1],g=l[2],y=l[3],x=l[4],v=l[5],w=l[6],S=l[7];this.getCorners(u,p,g,y,x,v,w,S);for(var b=0;b!==8;b++){var E=l[b];h.pointToLocal(E,E)}return d.setFromPoints(l)},o.prototype.toWorldFrame=function(h,d){var l=c,u=l[0],p=l[1],g=l[2],y=l[3],x=l[4],v=l[5],w=l[6],S=l[7];this.getCorners(u,p,g,y,x,v,w,S);for(var b=0;b!==8;b++){var E=l[b];h.pointToWorld(E,E)}return d.setFromPoints(l)}},{"../math/Vec3":30,"../utils/Utils":53}],4:[function(t,n,r){n.exports=s;function s(){this.matrix=[]}s.prototype.get=function(o,a){if(o=o.index,a=a.index,a>o){var c=a;a=o,o=c}return this.matrix[(o*(o+1)>>1)+a-1]},s.prototype.set=function(o,a,c){if(o=o.index,a=a.index,a>o){var h=a;a=o,o=h}this.matrix[(o*(o+1)>>1)+a-1]=c?1:0},s.prototype.reset=function(){for(var o=0,a=this.matrix.length;o!==a;o++)this.matrix[o]=0},s.prototype.setNumObjects=function(o){this.matrix.length=o*(o-1)>>1}},{}],5:[function(t,n,r){var s=t("../objects/Body"),o=t("../math/Vec3"),a=t("../math/Quaternion");t("../shapes/Shape"),t("../shapes/Plane"),n.exports=c;function c(){this.world=null,this.useBoundingBoxes=!1,this.dirty=!0}c.prototype.collisionPairs=function(y,x,v){throw new Error("collisionPairs not implemented for this BroadPhase class!")};var h=s.STATIC|s.KINEMATIC;c.prototype.needBroadphaseCollision=function(y,x){return!((y.collisionFilterGroup&x.collisionFilterMask)===0||(x.collisionFilterGroup&y.collisionFilterMask)===0||((y.type&h)!==0||y.sleepState===s.SLEEPING)&&((x.type&h)!==0||x.sleepState===s.SLEEPING))},c.prototype.intersectionTest=function(y,x,v,w){this.useBoundingBoxes?this.doBoundingBoxBroadphase(y,x,v,w):this.doBoundingSphereBroadphase(y,x,v,w)};var d=new o;new o,new a,new o,c.prototype.doBoundingSphereBroadphase=function(y,x,v,w){var S=d;x.position.vsub(y.position,S);var b=Math.pow(y.boundingRadius+x.boundingRadius,2),E=S.norm2();E<b&&(v.push(y),w.push(x))},c.prototype.doBoundingBoxBroadphase=function(y,x,v,w){y.aabbNeedsUpdate&&y.computeAABB(),x.aabbNeedsUpdate&&x.computeAABB(),y.aabb.overlaps(x.aabb)&&(v.push(y),w.push(x))};var l={keys:[]},u=[],p=[];c.prototype.makePairsUnique=function(y,x){for(var v=l,w=u,S=p,b=y.length,E=0;E!==b;E++)w[E]=y[E],S[E]=x[E];y.length=0,x.length=0;for(var E=0;E!==b;E++){var R=w[E].id,z=S[E].id,I=R<z?R+","+z:z+","+R;v[I]=E,v.keys.push(I)}for(var E=0;E!==v.keys.length;E++){var I=v.keys.pop(),N=v[I];y.push(w[N]),x.push(S[N]),delete v[I]}},c.prototype.setWorld=function(y){};var g=new o;c.boundingSphereCheck=function(y,x){var v=g;return y.position.vsub(x.position,v),Math.pow(y.shape.boundingSphereRadius+x.shape.boundingSphereRadius,2)>v.norm2()},c.prototype.aabbQuery=function(y,x,v){return console.warn(".aabbQuery is not implemented in this Broadphase subclass."),[]}},{"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"../shapes/Plane":42,"../shapes/Shape":43}],6:[function(t,n,r){n.exports=c;var s=t("./Broadphase"),o=t("../math/Vec3"),a=t("../shapes/Shape");function c(d,l,u,p,g){s.apply(this),this.nx=u||10,this.ny=p||10,this.nz=g||10,this.aabbMin=d||new o(100,100,100),this.aabbMax=l||new o(-100,-100,-100);var y=this.nx*this.ny*this.nz;if(y<=0)throw"GridBroadphase: Each dimension's n must be >0";this.bins=[],this.binLengths=[],this.bins.length=y,this.binLengths.length=y;for(var x=0;x<y;x++)this.bins[x]=[],this.binLengths[x]=0}c.prototype=new s,c.prototype.constructor=c;var h=new o;new o,c.prototype.collisionPairs=function(d,l,u){var p=d.numObjects(),g=d.bodies,Ee=this.aabbMax,Z=this.aabbMin,y=this.nx,x=this.ny,v=this.nz,w=x*v,S=v,b=1,E=Ee.x,R=Ee.y,z=Ee.z,I=Z.x,N=Z.y,F=Z.z,C=y/(E-I),O=x/(R-N),X=v/(z-F),U=(E-I)/y,te=(R-N)/x,ne=(z-F)/v,j=Math.sqrt(U*U+te*te+ne*ne)*.5,k=a.types,W=k.SPHERE,Y=k.PLANE;k.BOX,k.COMPOUND,k.CONVEXPOLYHEDRON;for(var H=this.bins,J=this.binLengths,K=this.bins.length,ee=0;ee!==K;ee++)J[ee]=0;var $=Math.ceil,Z=Math.min,Ee=Math.max;function Se(Ae,Fe,Ve,oe,Ne,Je,ae){var Te=(Ae-I)*C|0,Ge=(Fe-N)*O|0,ze=(Ve-F)*X|0,ct=$((oe-I)*C),Pt=$((Ne-N)*O),xt=$((Je-F)*X);Te<0?Te=0:Te>=y&&(Te=y-1),Ge<0?Ge=0:Ge>=x&&(Ge=x-1),ze<0?ze=0:ze>=v&&(ze=v-1),ct<0?ct=0:ct>=y&&(ct=y-1),Pt<0?Pt=0:Pt>=x&&(Pt=x-1),xt<0?xt=0:xt>=v&&(xt=v-1),Te*=w,Ge*=S,ze*=b,ct*=w,Pt*=S,xt*=b;for(var Xn=Te;Xn<=ct;Xn+=w)for(var Cn=Ge;Cn<=Pt;Cn+=S)for(var Un=ze;Un<=xt;Un+=b){var Fn=Xn+Cn+Un;H[Fn][J[Fn]++]=ae}}for(var ee=0;ee!==p;ee++){var de=g[ee],he=de.shape;switch(he.type){case W:var Ce=de.position.x,me=de.position.y,fe=de.position.z,we=he.radius;Se(Ce-we,me-we,fe-we,Ce+we,me+we,fe+we,de);break;case Y:he.worldNormalNeedsUpdate&&he.computeWorldNormal(de.quaternion);var ye=he.worldNormal,_e=I+U*.5-de.position.x,it=N+te*.5-de.position.y,$e=F+ne*.5-de.position.z,et=h;et.set(_e,it,$e);for(var L=0,V=0;L!==y;L++,V+=w,et.y=it,et.x+=U)for(var P=0,T=0;P!==x;P++,T+=S,et.z=$e,et.y+=te)for(var q=0,re=0;q!==v;q++,re+=b,et.z+=ne)if(et.dot(ye)<j){var pe=V+T+re;H[pe][J[pe]++]=de}break;default:de.aabbNeedsUpdate&&de.computeAABB(),Se(de.aabb.lowerBound.x,de.aabb.lowerBound.y,de.aabb.lowerBound.z,de.aabb.upperBound.x,de.aabb.upperBound.y,de.aabb.upperBound.z,de);break}}for(var ee=0;ee!==K;ee++){var ge=J[ee];if(ge>1)for(var be=H[ee],L=0;L!==ge;L++)for(var de=be[L],P=0;P!==L;P++){var G=be[P];this.needBroadphaseCollision(de,G)&&this.intersectionTest(de,G,l,u)}}this.makePairsUnique(l,u)}},{"../math/Vec3":30,"../shapes/Shape":43,"./Broadphase":5}],7:[function(t,n,r){n.exports=a;var s=t("./Broadphase"),o=t("./AABB");function a(){s.apply(this)}a.prototype=new s,a.prototype.constructor=a,a.prototype.collisionPairs=function(c,h,d){var l=c.bodies,u=l.length,p,g,y,x;for(p=0;p!==u;p++)for(g=0;g!==p;g++)y=l[p],x=l[g],this.needBroadphaseCollision(y,x)&&this.intersectionTest(y,x,h,d)},new o,a.prototype.aabbQuery=function(c,h,d){d=d||[];for(var l=0;l<c.bodies.length;l++){var u=c.bodies[l];u.aabbNeedsUpdate&&u.computeAABB(),u.aabb.overlaps(h)&&d.push(u)}return d}},{"./AABB":3,"./Broadphase":5}],8:[function(t,n,r){n.exports=s;function s(){this.matrix={}}s.prototype.get=function(o,a){if(o=o.id,a=a.id,a>o){var c=a;a=o,o=c}return o+"-"+a in this.matrix},s.prototype.set=function(o,a,c){if(o=o.id,a=a.id,a>o){var h=a;a=o,o=h}c?this.matrix[o+"-"+a]=!0:delete this.matrix[o+"-"+a]},s.prototype.reset=function(){this.matrix={}},s.prototype.setNumObjects=function(o){}},{}],9:[function(t,n,r){n.exports=l;var s=t("../math/Vec3"),o=t("../math/Quaternion"),a=t("../math/Transform");t("../shapes/ConvexPolyhedron"),t("../shapes/Box");var c=t("../collision/RaycastResult"),h=t("../shapes/Shape"),d=t("../collision/AABB");function l(K,ee){this.from=K?K.clone():new s,this.to=ee?ee.clone():new s,this._direction=new s,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=l.ANY,this.result=new c,this.hasHit=!1,this.callback=function($){}}l.prototype.constructor=l,l.CLOSEST=1,l.ANY=2,l.ALL=4;var u=new d,p=[];l.prototype.intersectWorld=function(K,ee){return this.mode=ee.mode||l.ANY,this.result=ee.result||new c,this.skipBackfaces=!!ee.skipBackfaces,this.collisionFilterMask=typeof ee.collisionFilterMask!="undefined"?ee.collisionFilterMask:-1,this.collisionFilterGroup=typeof ee.collisionFilterGroup!="undefined"?ee.collisionFilterGroup:-1,ee.from&&this.from.copy(ee.from),ee.to&&this.to.copy(ee.to),this.callback=ee.callback||function(){},this.hasHit=!1,this.result.reset(),this._updateDirection(),this.getAABB(u),p.length=0,K.broadphase.aabbQuery(K,u,p),this.intersectBodies(p),this.hasHit};var g=new s,y=new s;l.pointInTriangle=x;function x(K,ee,$,Z){Z.vsub(ee,Y),$.vsub(ee,g),K.vsub(ee,y);var Ee=Y.dot(Y),Se=Y.dot(g),de=Y.dot(y),he=g.dot(g),Ce=g.dot(y),me,fe;return(me=he*de-Se*Ce)>=0&&(fe=Ee*Ce-Se*de)>=0&&me+fe<Ee*he-Se*Se}var v=new s,w=new o;l.prototype.intersectBody=function(K,ee){ee&&(this.result=ee,this._updateDirection());var $=this.checkCollisionResponse;if(!($&&!K.collisionResponse)&&!((this.collisionFilterGroup&K.collisionFilterMask)===0||(K.collisionFilterGroup&this.collisionFilterMask)===0))for(var Z=v,Ee=w,Se=0,de=K.shapes.length;Se<de;Se++){var he=K.shapes[Se];if(!($&&!he.collisionResponse)&&(K.quaternion.mult(K.shapeOrientations[Se],Ee),K.quaternion.vmult(K.shapeOffsets[Se],Z),Z.vadd(K.position,Z),this.intersectShape(he,Ee,Z,K),this.result._shouldStop))break}},l.prototype.intersectBodies=function(K,ee){ee&&(this.result=ee,this._updateDirection());for(var $=0,Z=K.length;!this.result._shouldStop&&$<Z;$++)this.intersectBody(K[$])},l.prototype._updateDirection=function(){this.to.vsub(this.from,this._direction),this._direction.normalize()},l.prototype.intersectShape=function(K,ee,$,Z){var Ee=this.from,Se=J(Ee,this._direction,$);if(!(Se>K.boundingSphereRadius)){var de=this[K.type];de&&de.call(this,K,ee,$,Z)}},new s,new s;var S=new s,b=new s,E=new s,R=new s;new s,new c,l.prototype.intersectBox=function(K,ee,$,Z){return this.intersectConvex(K.convexPolyhedronRepresentation,ee,$,Z)},l.prototype[h.types.BOX]=l.prototype.intersectBox,l.prototype.intersectPlane=function(K,ee,$,Z){var Ee=this.from,Se=this.to,de=this._direction,he=new s(0,0,1);ee.vmult(he,he);var Ce=new s;Ee.vsub($,Ce);var me=Ce.dot(he);Se.vsub($,Ce);var fe=Ce.dot(he);if(!(me*fe>0)&&!(Ee.distanceTo(Se)<me)){var we=he.dot(de);if(!(Math.abs(we)<this.precision)){var ye=new s,_e=new s,it=new s;Ee.vsub($,ye);var $e=-he.dot(ye)/we;de.scale($e,_e),Ee.vadd(_e,it),this.reportIntersection(he,it,K,Z,-1)}}},l.prototype[h.types.PLANE]=l.prototype.intersectPlane,l.prototype.getAABB=function(K){var ee=this.to,$=this.from;K.lowerBound.x=Math.min(ee.x,$.x),K.lowerBound.y=Math.min(ee.y,$.y),K.lowerBound.z=Math.min(ee.z,$.z),K.upperBound.x=Math.max(ee.x,$.x),K.upperBound.y=Math.max(ee.y,$.y),K.upperBound.z=Math.max(ee.z,$.z)};var z={faceList:[0]};l.prototype.intersectHeightfield=function(K,ee,$,Z){K.data,K.elementSize;var Ee=new s,Se=new l(this.from,this.to);a.pointToLocalFrame($,ee,Se.from,Se.from),a.pointToLocalFrame($,ee,Se.to,Se.to);var de=[],he=null,Ce=null,me=null,fe=null,we=K.getIndexOfPosition(Se.from.x,Se.from.y,de,!1);if(we&&(he=de[0],Ce=de[1],me=de[0],fe=de[1]),we=K.getIndexOfPosition(Se.to.x,Se.to.y,de,!1),we&&((he===null||de[0]<he)&&(he=de[0]),(me===null||de[0]>me)&&(me=de[0]),(Ce===null||de[1]<Ce)&&(Ce=de[1]),(fe===null||de[1]>fe)&&(fe=de[1])),he!==null){var ye=[];K.getRectMinMax(he,Ce,me,fe,ye),ye[0],ye[1];for(var _e=he;_e<=me;_e++)for(var it=Ce;it<=fe;it++){if(this.result._shouldStop||(K.getConvexTrianglePillar(_e,it,!1),a.pointToWorldFrame($,ee,K.pillarOffset,Ee),this.intersectConvex(K.pillarConvex,ee,Ee,Z,z),this.result._shouldStop))return;K.getConvexTrianglePillar(_e,it,!0),a.pointToWorldFrame($,ee,K.pillarOffset,Ee),this.intersectConvex(K.pillarConvex,ee,Ee,Z,z)}}},l.prototype[h.types.HEIGHTFIELD]=l.prototype.intersectHeightfield;var I=new s,N=new s;l.prototype.intersectSphere=function(K,ee,$,Z){var Ee=this.from,Se=this.to,de=K.radius,he=Math.pow(Se.x-Ee.x,2)+Math.pow(Se.y-Ee.y,2)+Math.pow(Se.z-Ee.z,2),Ce=2*((Se.x-Ee.x)*(Ee.x-$.x)+(Se.y-Ee.y)*(Ee.y-$.y)+(Se.z-Ee.z)*(Ee.z-$.z)),me=Math.pow(Ee.x-$.x,2)+Math.pow(Ee.y-$.y,2)+Math.pow(Ee.z-$.z,2)-Math.pow(de,2),fe=Math.pow(Ce,2)-4*he*me,we=I,ye=N;if(!(fe<0))if(fe===0)Ee.lerp(Se,fe,we),we.vsub($,ye),ye.normalize(),this.reportIntersection(ye,we,K,Z,-1);else{var _e=(-Ce-Math.sqrt(fe))/(2*he),it=(-Ce+Math.sqrt(fe))/(2*he);if(_e>=0&&_e<=1&&(Ee.lerp(Se,_e,we),we.vsub($,ye),ye.normalize(),this.reportIntersection(ye,we,K,Z,-1)),this.result._shouldStop)return;it>=0&&it<=1&&(Ee.lerp(Se,it,we),we.vsub($,ye),ye.normalize(),this.reportIntersection(ye,we,K,Z,-1))}},l.prototype[h.types.SPHERE]=l.prototype.intersectSphere;var F=new s;new s,new s;var C=new s;l.prototype.intersectConvex=function(ee,$,Z,Ee,Se){for(var de=F,he=C,Ce=Se&&Se.faceList||null,me=ee.faces,fe=ee.vertices,we=ee.faceNormals,ye=this._direction,_e=this.from,it=this.to,$e=_e.distanceTo(it),et=Ce?Ce.length:me.length,L=this.result,V=0;!L._shouldStop&&V<et;V++){var P=Ce?Ce[V]:V,T=me[P],q=we[P],re=$,pe=Z;he.copy(fe[T[0]]),re.vmult(he,he),he.vadd(pe,he),he.vsub(_e,he),re.vmult(q,de);var ge=ye.dot(de);if(!(Math.abs(ge)<this.precision)){var be=de.dot(he)/ge;if(!(be<0)){ye.mult(be,S),S.vadd(_e,S),b.copy(fe[T[0]]),re.vmult(b,b),pe.vadd(b,b);for(var G=1;!L._shouldStop&&G<T.length-1;G++){E.copy(fe[T[G]]),R.copy(fe[T[G+1]]),re.vmult(E,E),re.vmult(R,R),pe.vadd(E,E),pe.vadd(R,R);var Ae=S.distanceTo(_e);!(x(S,b,E,R)||x(S,E,b,R))||Ae>$e||this.reportIntersection(de,S,ee,Ee,P)}}}}},l.prototype[h.types.CONVEXPOLYHEDRON]=l.prototype.intersectConvex;var O=new s,X=new s,U=new s,te=new s,ne=new s,j=new s;new d;var k=[],W=new a;l.prototype.intersectTrimesh=function(ee,$,Z,Ee,Se){var de=O,he=k,Ce=W,me=C,fe=X,we=U,ye=te,_e=j,it=ne;Se&&Se.faceList;var $e=ee.indices;ee.vertices,ee.faceNormals;var et=this.from,L=this.to,V=this._direction;Ce.position.copy(Z),Ce.quaternion.copy($),a.vectorToLocalFrame(Z,$,V,fe),a.pointToLocalFrame(Z,$,et,we),a.pointToLocalFrame(Z,$,L,ye);var P=we.distanceSquared(ye);ee.tree.rayQuery(this,Ce,he);for(var T=0,q=he.length;!this.result._shouldStop&&T!==q;T++){var re=he[T];ee.getNormal(re,de),ee.getVertex($e[re*3],b),b.vsub(we,me);var pe=fe.dot(de),ge=de.dot(me)/pe;if(!(ge<0)){fe.scale(ge,S),S.vadd(we,S),ee.getVertex($e[re*3+1],E),ee.getVertex($e[re*3+2],R);var be=S.distanceSquared(we);!(x(S,E,b,R)||x(S,b,E,R))||be>P||(a.vectorToWorldFrame($,de,it),a.pointToWorldFrame(Z,$,S,_e),this.reportIntersection(it,_e,ee,Ee,re))}}he.length=0},l.prototype[h.types.TRIMESH]=l.prototype.intersectTrimesh,l.prototype.reportIntersection=function(K,ee,$,Z,Ee){var Se=this.from,de=this.to,he=Se.distanceTo(ee),Ce=this.result;if(!(this.skipBackfaces&&K.dot(this._direction)>0))switch(Ce.hitFaceIndex=typeof Ee!="undefined"?Ee:-1,this.mode){case l.ALL:this.hasHit=!0,Ce.set(Se,de,K,ee,$,Z,he),Ce.hasHit=!0,this.callback(Ce);break;case l.CLOSEST:(he<Ce.distance||!Ce.hasHit)&&(this.hasHit=!0,Ce.hasHit=!0,Ce.set(Se,de,K,ee,$,Z,he));break;case l.ANY:this.hasHit=!0,Ce.hasHit=!0,Ce.set(Se,de,K,ee,$,Z,he),Ce._shouldStop=!0;break}};var Y=new s,H=new s;function J(K,ee,$){$.vsub(K,Y);var Z=Y.dot(ee);ee.mult(Z,H),H.vadd(K,H);var Ee=$.distanceTo(H);return Ee}},{"../collision/AABB":3,"../collision/RaycastResult":10,"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"../shapes/Box":37,"../shapes/ConvexPolyhedron":38,"../shapes/Shape":43}],10:[function(t,n,r){var s=t("../math/Vec3");n.exports=o;function o(){this.rayFromWorld=new s,this.rayToWorld=new s,this.hitNormalWorld=new s,this.hitPointWorld=new s,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this._shouldStop=!1}o.prototype.reset=function(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this._shouldStop=!1},o.prototype.abort=function(){this._shouldStop=!0},o.prototype.set=function(a,c,h,d,l,u,p){this.rayFromWorld.copy(a),this.rayToWorld.copy(c),this.hitNormalWorld.copy(h),this.hitPointWorld.copy(d),this.shape=l,this.body=u,this.distance=p}},{"../math/Vec3":30}],11:[function(t,n,r){t("../shapes/Shape");var s=t("../collision/Broadphase");n.exports=o;function o(a){s.apply(this),this.axisList=[],this.world=null,this.axisIndex=0;var c=this.axisList;this._addBodyHandler=function(h){c.push(h.body)},this._removeBodyHandler=function(h){var d=c.indexOf(h.body);d!==-1&&c.splice(d,1)},a&&this.setWorld(a)}o.prototype=new s,o.prototype.setWorld=function(a){this.axisList.length=0;for(var c=0;c<a.bodies.length;c++)this.axisList.push(a.bodies[c]);a.removeEventListener("addBody",this._addBodyHandler),a.removeEventListener("removeBody",this._removeBodyHandler),a.addEventListener("addBody",this._addBodyHandler),a.addEventListener("removeBody",this._removeBodyHandler),this.world=a,this.dirty=!0},o.insertionSortX=function(a){for(var c=1,h=a.length;c<h;c++){for(var d=a[c],l=c-1;l>=0&&!(a[l].aabb.lowerBound.x<=d.aabb.lowerBound.x);l--)a[l+1]=a[l];a[l+1]=d}return a},o.insertionSortY=function(a){for(var c=1,h=a.length;c<h;c++){for(var d=a[c],l=c-1;l>=0&&!(a[l].aabb.lowerBound.y<=d.aabb.lowerBound.y);l--)a[l+1]=a[l];a[l+1]=d}return a},o.insertionSortZ=function(a){for(var c=1,h=a.length;c<h;c++){for(var d=a[c],l=c-1;l>=0&&!(a[l].aabb.lowerBound.z<=d.aabb.lowerBound.z);l--)a[l+1]=a[l];a[l+1]=d}return a},o.prototype.collisionPairs=function(a,c,h){var d=this.axisList,l=d.length,u=this.axisIndex,p,g;for(this.dirty&&(this.sortList(),this.dirty=!1),p=0;p!==l;p++){var y=d[p];for(g=p+1;g<l;g++){var x=d[g];if(!!this.needBroadphaseCollision(y,x)){if(!o.checkBounds(y,x,u))break;this.intersectionTest(y,x,c,h)}}}},o.prototype.sortList=function(){for(var a=this.axisList,c=this.axisIndex,h=a.length,d=0;d!==h;d++){var l=a[d];l.aabbNeedsUpdate&&l.computeAABB()}c===0?o.insertionSortX(a):c===1?o.insertionSortY(a):c===2&&o.insertionSortZ(a)},o.checkBounds=function(a,c,h){var d,l;h===0?(d=a.position.x,l=c.position.x):h===1?(d=a.position.y,l=c.position.y):h===2&&(d=a.position.z,l=c.position.z);var u=a.boundingRadius,p=c.boundingRadius,g=d+u,y=l-p;return y<g},o.prototype.autoDetectAxis=function(){for(var a=0,c=0,h=0,d=0,l=0,u=0,p=this.axisList,g=p.length,y=1/g,x=0;x!==g;x++){var v=p[x],w=v.position.x;a+=w,c+=w*w;var S=v.position.y;h+=S,d+=S*S;var b=v.position.z;l+=b,u+=b*b}var E=c-a*a*y,R=d-h*h*y,z=u-l*l*y;E>R?E>z?this.axisIndex=0:this.axisIndex=2:R>z?this.axisIndex=1:this.axisIndex=2},o.prototype.aabbQuery=function(a,c,h){h=h||[],this.dirty&&(this.sortList(),this.dirty=!1);var d=this.axisIndex,l="x";d===1&&(l="y"),d===2&&(l="z");var u=this.axisList;c.lowerBound[l],c.upperBound[l];for(var p=0;p<u.length;p++){var g=u[p];g.aabbNeedsUpdate&&g.computeAABB(),g.aabb.overlaps(c)&&h.push(g)}return h}},{"../collision/Broadphase":5,"../shapes/Shape":43}],12:[function(t,n,r){n.exports=h,t("./Constraint");var s=t("./PointToPointConstraint"),o=t("../equations/ConeEquation"),a=t("../equations/RotationalEquation");t("../equations/ContactEquation");var c=t("../math/Vec3");function h(d,l,u){u=u||{};var p=typeof u.maxForce!="undefined"?u.maxForce:1e6,g=u.pivotA?u.pivotA.clone():new c,y=u.pivotB?u.pivotB.clone():new c;this.axisA=u.axisA?u.axisA.clone():new c,this.axisB=u.axisB?u.axisB.clone():new c,s.call(this,d,g,l,y,p),this.collideConnected=!!u.collideConnected,this.angle=typeof u.angle!="undefined"?u.angle:0;var x=this.coneEquation=new o(d,l,u),v=this.twistEquation=new a(d,l,u);this.twistAngle=typeof u.twistAngle!="undefined"?u.twistAngle:0,x.maxForce=0,x.minForce=-p,v.maxForce=0,v.minForce=-p,this.equations.push(x,v)}h.prototype=new s,h.constructor=h,new c,new c,h.prototype.update=function(){var d=this.bodyA,l=this.bodyB,u=this.coneEquation,p=this.twistEquation;s.prototype.update.call(this),d.vectorToWorldFrame(this.axisA,u.axisA),l.vectorToWorldFrame(this.axisB,u.axisB),this.axisA.tangents(p.axisA,p.axisA),d.vectorToWorldFrame(p.axisA,p.axisA),this.axisB.tangents(p.axisB,p.axisB),l.vectorToWorldFrame(p.axisB,p.axisB),u.angle=this.angle,p.maxAngle=this.twistAngle}},{"../equations/ConeEquation":18,"../equations/ContactEquation":19,"../equations/RotationalEquation":22,"../math/Vec3":30,"./Constraint":13,"./PointToPointConstraint":17}],13:[function(t,n,r){n.exports=o;var s=t("../utils/Utils");function o(a,c,h){h=s.defaults(h,{collideConnected:!0,wakeUpBodies:!0}),this.equations=[],this.bodyA=a,this.bodyB=c,this.id=o.idCounter++,this.collideConnected=h.collideConnected,h.wakeUpBodies&&(a&&a.wakeUp(),c&&c.wakeUp())}o.prototype.update=function(){throw new Error("method update() not implmemented in this Constraint subclass!")},o.prototype.enable=function(){for(var a=this.equations,c=0;c<a.length;c++)a[c].enabled=!0},o.prototype.disable=function(){for(var a=this.equations,c=0;c<a.length;c++)a[c].enabled=!1},o.idCounter=0},{"../utils/Utils":53}],14:[function(t,n,r){n.exports=a;var s=t("./Constraint"),o=t("../equations/ContactEquation");function a(c,h,d,l){s.call(this,c,h),typeof d=="undefined"&&(d=c.position.distanceTo(h.position)),typeof l=="undefined"&&(l=1e6),this.distance=d;var u=this.distanceEquation=new o(c,h);this.equations.push(u),u.minForce=-l,u.maxForce=l}a.prototype=new s,a.prototype.update=function(){var c=this.bodyA,h=this.bodyB,d=this.distanceEquation,l=this.distance*.5,u=d.ni;h.position.vsub(c.position,u),u.normalize(),u.mult(l,d.ri),u.mult(-l,d.rj)}},{"../equations/ContactEquation":19,"./Constraint":13}],15:[function(t,n,r){n.exports=h,t("./Constraint");var s=t("./PointToPointConstraint"),o=t("../equations/RotationalEquation"),a=t("../equations/RotationalMotorEquation");t("../equations/ContactEquation");var c=t("../math/Vec3");function h(u,p,g){g=g||{};var y=typeof g.maxForce!="undefined"?g.maxForce:1e6,x=g.pivotA?g.pivotA.clone():new c,v=g.pivotB?g.pivotB.clone():new c;s.call(this,u,x,p,v,y);var w=this.axisA=g.axisA?g.axisA.clone():new c(1,0,0);w.normalize();var S=this.axisB=g.axisB?g.axisB.clone():new c(1,0,0);S.normalize();var b=this.rotationalEquation1=new o(u,p,g),E=this.rotationalEquation2=new o(u,p,g),R=this.motorEquation=new a(u,p,y);R.enabled=!1,this.equations.push(b,E,R)}h.prototype=new s,h.constructor=h,h.prototype.enableMotor=function(){this.motorEquation.enabled=!0},h.prototype.disableMotor=function(){this.motorEquation.enabled=!1},h.prototype.setMotorSpeed=function(u){this.motorEquation.targetVelocity=u},h.prototype.setMotorMaxForce=function(u){this.motorEquation.maxForce=u,this.motorEquation.minForce=-u};var d=new c,l=new c;h.prototype.update=function(){var u=this.bodyA,p=this.bodyB,g=this.motorEquation,y=this.rotationalEquation1,x=this.rotationalEquation2,v=d,w=l,S=this.axisA,b=this.axisB;s.prototype.update.call(this),u.quaternion.vmult(S,v),p.quaternion.vmult(b,w),v.tangents(y.axisA,x.axisA),y.axisB.copy(w),x.axisB.copy(w),this.motorEquation.enabled&&(u.quaternion.vmult(this.axisA,g.axisA),p.quaternion.vmult(this.axisB,g.axisB))}},{"../equations/ContactEquation":19,"../equations/RotationalEquation":22,"../equations/RotationalMotorEquation":23,"../math/Vec3":30,"./Constraint":13,"./PointToPointConstraint":17}],16:[function(t,n,r){n.exports=c,t("./Constraint");var s=t("./PointToPointConstraint"),o=t("../equations/RotationalEquation");t("../equations/RotationalMotorEquation"),t("../equations/ContactEquation");var a=t("../math/Vec3");function c(h,d,l){l=l||{};var u=typeof l.maxForce!="undefined"?l.maxForce:1e6,p=new a,g=new a,y=new a;h.position.vadd(d.position,y),y.scale(.5,y),d.pointToLocalFrame(y,g),h.pointToLocalFrame(y,p),s.call(this,h,p,d,g,u);var x=this.rotationalEquation1=new o(h,d,l),v=this.rotationalEquation2=new o(h,d,l),w=this.rotationalEquation3=new o(h,d,l);this.equations.push(x,v,w)}c.prototype=new s,c.constructor=c,new a,new a,c.prototype.update=function(){var h=this.bodyA,d=this.bodyB;this.motorEquation;var l=this.rotationalEquation1,u=this.rotationalEquation2,p=this.rotationalEquation3;s.prototype.update.call(this),h.vectorToWorldFrame(a.UNIT_X,l.axisA),d.vectorToWorldFrame(a.UNIT_Y,l.axisB),h.vectorToWorldFrame(a.UNIT_Y,u.axisA),d.vectorToWorldFrame(a.UNIT_Z,u.axisB),h.vectorToWorldFrame(a.UNIT_Z,p.axisA),d.vectorToWorldFrame(a.UNIT_X,p.axisB)}},{"../equations/ContactEquation":19,"../equations/RotationalEquation":22,"../equations/RotationalMotorEquation":23,"../math/Vec3":30,"./Constraint":13,"./PointToPointConstraint":17}],17:[function(t,n,r){n.exports=c;var s=t("./Constraint"),o=t("../equations/ContactEquation"),a=t("../math/Vec3");function c(h,d,l,u,p){s.call(this,h,l),p=typeof p!="undefined"?p:1e6,this.pivotA=d?d.clone():new a,this.pivotB=u?u.clone():new a;var g=this.equationX=new o(h,l),y=this.equationY=new o(h,l),x=this.equationZ=new o(h,l);this.equations.push(g,y,x),g.minForce=y.minForce=x.minForce=-p,g.maxForce=y.maxForce=x.maxForce=p,g.ni.set(1,0,0),y.ni.set(0,1,0),x.ni.set(0,0,1)}c.prototype=new s,c.prototype.update=function(){var h=this.bodyA,d=this.bodyB,l=this.equationX,u=this.equationY,p=this.equationZ;h.quaternion.vmult(this.pivotA,l.ri),d.quaternion.vmult(this.pivotB,l.rj),u.ri.copy(l.ri),u.rj.copy(l.rj),p.ri.copy(l.ri),p.rj.copy(l.rj)}},{"../equations/ContactEquation":19,"../math/Vec3":30,"./Constraint":13}],18:[function(t,n,r){n.exports=a;var s=t("../math/Vec3");t("../math/Mat3");var o=t("./Equation");function a(d,l,u){u=u||{};var p=typeof u.maxForce!="undefined"?u.maxForce:1e6;o.call(this,d,l,-p,p),this.axisA=u.axisA?u.axisA.clone():new s(1,0,0),this.axisB=u.axisB?u.axisB.clone():new s(0,1,0),this.angle=typeof u.angle!="undefined"?u.angle:0}a.prototype=new o,a.prototype.constructor=a;var c=new s,h=new s;a.prototype.computeB=function(d){var l=this.a,u=this.b,p=this.axisA,g=this.axisB,y=c,x=h,v=this.jacobianElementA,w=this.jacobianElementB;p.cross(g,y),g.cross(p,x),v.rotational.copy(x),w.rotational.copy(y);var S=Math.cos(this.angle)-p.dot(g),b=this.computeGW(),E=this.computeGiMf(),R=-S*l-b*u-d*E;return R}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],19:[function(t,n,r){n.exports=a;var s=t("./Equation"),o=t("../math/Vec3");t("../math/Mat3");function a(x,v,w){w=typeof w!="undefined"?w:1e6,s.call(this,x,v,0,w),this.restitution=0,this.ri=new o,this.rj=new o,this.ni=new o}a.prototype=new s,a.prototype.constructor=a;var c=new o,h=new o,d=new o;a.prototype.computeB=function(x){var v=this.a,w=this.b,S=this.bi,b=this.bj,E=this.ri,R=this.rj,z=c,I=h,N=S.velocity,F=S.angularVelocity;S.force,S.torque;var C=b.velocity,O=b.angularVelocity;b.force,b.torque;var X=d,U=this.jacobianElementA,te=this.jacobianElementB,ne=this.ni;E.cross(ne,z),R.cross(ne,I),ne.negate(U.spatial),z.negate(U.rotational),te.spatial.copy(ne),te.rotational.copy(I),X.copy(b.position),X.vadd(R,X),X.vsub(S.position,X),X.vsub(E,X);var j=ne.dot(X),k=this.restitution+1,W=k*C.dot(ne)-k*N.dot(ne)+O.dot(I)-F.dot(z),Y=this.computeGiMf(),H=-j*v-W*w-x*Y;return H};var l=new o,u=new o,p=new o,g=new o,y=new o;a.prototype.getImpactVelocityAlongNormal=function(){var x=l,v=u,w=p,S=g,b=y;return this.bi.position.vadd(this.ri,w),this.bj.position.vadd(this.rj,S),this.bi.getVelocityAtWorldPoint(w,x),this.bj.getVelocityAtWorldPoint(S,v),x.vsub(v,b),this.ni.dot(b)}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],20:[function(t,n,r){n.exports=a;var s=t("../math/JacobianElement"),o=t("../math/Vec3");function a(y,x,v,w){this.id=a.id++,this.minForce=typeof v=="undefined"?-1e6:v,this.maxForce=typeof w=="undefined"?1e6:w,this.bi=y,this.bj=x,this.a=0,this.b=0,this.eps=0,this.jacobianElementA=new s,this.jacobianElementB=new s,this.enabled=!0,this.setSpookParams(1e7,4,1/60)}a.prototype.constructor=a,a.id=0,a.prototype.setSpookParams=function(y,x,v){var w=x,S=y,b=v;this.a=4/(b*(1+4*w)),this.b=4*w/(1+4*w),this.eps=4/(b*b*S*(1+4*w))},a.prototype.computeB=function(y,x,v){var w=this.computeGW(),S=this.computeGq(),b=this.computeGiMf();return-S*y-w*x-b*v},a.prototype.computeGq=function(){var y=this.jacobianElementA,x=this.jacobianElementB,v=this.bi,w=this.bj,S=v.position,b=w.position;return y.spatial.dot(S)+x.spatial.dot(b)};var c=new o;a.prototype.computeGW=function(){var y=this.jacobianElementA,x=this.jacobianElementB,v=this.bi,w=this.bj,S=v.velocity,b=w.velocity,E=v.angularVelocity||c,R=w.angularVelocity||c;return y.multiplyVectors(S,E)+x.multiplyVectors(b,R)},a.prototype.computeGWlambda=function(){var y=this.jacobianElementA,x=this.jacobianElementB,v=this.bi,w=this.bj,S=v.vlambda,b=w.vlambda,E=v.wlambda||c,R=w.wlambda||c;return y.multiplyVectors(S,E)+x.multiplyVectors(b,R)};var h=new o,d=new o,l=new o,u=new o;a.prototype.computeGiMf=function(){var y=this.jacobianElementA,x=this.jacobianElementB,v=this.bi,w=this.bj,S=v.force,b=v.torque,E=w.force,R=w.torque,z=v.invMassSolve,I=w.invMassSolve;return v.invInertiaWorldSolve?v.invInertiaWorldSolve.vmult(b,l):l.set(0,0,0),w.invInertiaWorldSolve?w.invInertiaWorldSolve.vmult(R,u):u.set(0,0,0),S.mult(z,h),E.mult(I,d),y.multiplyVectors(h,l)+x.multiplyVectors(d,u)};var p=new o;a.prototype.computeGiMGt=function(){var y=this.jacobianElementA,x=this.jacobianElementB,v=this.bi,w=this.bj,S=v.invMassSolve,b=w.invMassSolve,E=v.invInertiaWorldSolve,R=w.invInertiaWorldSolve,z=S+b;return E&&(E.vmult(y.rotational,p),z+=p.dot(y.rotational)),R&&(R.vmult(x.rotational,p),z+=p.dot(x.rotational)),z};var g=new o;new o,new o,new o,new o,new o,a.prototype.addToWlambda=function(y){var x=this.jacobianElementA,v=this.jacobianElementB,w=this.bi,S=this.bj,b=g;x.spatial.mult(w.invMassSolve*y,b),w.vlambda.vadd(b,w.vlambda),v.spatial.mult(S.invMassSolve*y,b),S.vlambda.vadd(b,S.vlambda),w.invInertiaWorldSolve&&(w.invInertiaWorldSolve.vmult(x.rotational,b),b.mult(y,b),w.wlambda.vadd(b,w.wlambda)),S.invInertiaWorldSolve&&(S.invInertiaWorldSolve.vmult(v.rotational,b),b.mult(y,b),S.wlambda.vadd(b,S.wlambda))},a.prototype.computeC=function(){return this.computeGiMGt()+this.eps}},{"../math/JacobianElement":26,"../math/Vec3":30}],21:[function(t,n,r){n.exports=a;var s=t("./Equation"),o=t("../math/Vec3");t("../math/Mat3");function a(d,l,u){s.call(this,d,l,-u,u),this.ri=new o,this.rj=new o,this.t=new o}a.prototype=new s,a.prototype.constructor=a;var c=new o,h=new o;a.prototype.computeB=function(d){this.a;var l=this.b;this.bi,this.bj;var u=this.ri,p=this.rj,g=c,y=h,x=this.t;u.cross(x,g),p.cross(x,y);var v=this.jacobianElementA,w=this.jacobianElementB;x.negate(v.spatial),g.negate(v.rotational),w.spatial.copy(x),w.rotational.copy(y);var S=this.computeGW(),b=this.computeGiMf(),E=-S*l-d*b;return E}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],22:[function(t,n,r){n.exports=a;var s=t("../math/Vec3");t("../math/Mat3");var o=t("./Equation");function a(d,l,u){u=u||{};var p=typeof u.maxForce!="undefined"?u.maxForce:1e6;o.call(this,d,l,-p,p),this.axisA=u.axisA?u.axisA.clone():new s(1,0,0),this.axisB=u.axisB?u.axisB.clone():new s(0,1,0),this.maxAngle=Math.PI/2}a.prototype=new o,a.prototype.constructor=a;var c=new s,h=new s;a.prototype.computeB=function(d){var l=this.a,u=this.b,p=this.axisA,g=this.axisB,y=c,x=h,v=this.jacobianElementA,w=this.jacobianElementB;p.cross(g,y),g.cross(p,x),v.rotational.copy(x),w.rotational.copy(y);var S=Math.cos(this.maxAngle)-p.dot(g),b=this.computeGW(),E=this.computeGiMf(),R=-S*l-b*u-d*E;return R}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],23:[function(t,n,r){n.exports=a;var s=t("../math/Vec3");t("../math/Mat3");var o=t("./Equation");function a(c,h,d){d=typeof d!="undefined"?d:1e6,o.call(this,c,h,-d,d),this.axisA=new s,this.axisB=new s,this.targetVelocity=0}a.prototype=new o,a.prototype.constructor=a,a.prototype.computeB=function(c){this.a;var h=this.b;this.bi,this.bj;var d=this.axisA,l=this.axisB,u=this.jacobianElementA,p=this.jacobianElementB;u.rotational.copy(d),l.negate(p.rotational);var g=this.computeGW()-this.targetVelocity,y=this.computeGiMf(),x=-g*h-c*y;return x}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],24:[function(t,n,r){var s=t("../utils/Utils");n.exports=o;function o(a,c,h){h=s.defaults(h,{friction:.3,restitution:.3,contactEquationStiffness:1e7,contactEquationRelaxation:3,frictionEquationStiffness:1e7,frictionEquationRelaxation:3}),this.id=o.idCounter++,this.materials=[a,c],this.friction=h.friction,this.restitution=h.restitution,this.contactEquationStiffness=h.contactEquationStiffness,this.contactEquationRelaxation=h.contactEquationRelaxation,this.frictionEquationStiffness=h.frictionEquationStiffness,this.frictionEquationRelaxation=h.frictionEquationRelaxation}o.idCounter=0},{"../utils/Utils":53}],25:[function(t,n,r){n.exports=s;function s(o){var a="";o=o||{},typeof o=="string"?(a=o,o={}):typeof o=="object"&&(a=""),this.name=a,this.id=s.idCounter++,this.friction=typeof o.friction!="undefined"?o.friction:-1,this.restitution=typeof o.restitution!="undefined"?o.restitution:-1}s.idCounter=0},{}],26:[function(t,n,r){n.exports=o;var s=t("./Vec3");function o(){this.spatial=new s,this.rotational=new s}o.prototype.multiplyElement=function(a){return a.spatial.dot(this.spatial)+a.rotational.dot(this.rotational)},o.prototype.multiplyVectors=function(a,c){return a.dot(this.spatial)+c.dot(this.rotational)}},{"./Vec3":30}],27:[function(t,n,r){n.exports=o;var s=t("./Vec3");function o(a){a?this.elements=a:this.elements=[0,0,0,0,0,0,0,0,0]}o.prototype.identity=function(){var a=this.elements;a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=0,a[7]=0,a[8]=1},o.prototype.setZero=function(){var a=this.elements;a[0]=0,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=0,a[6]=0,a[7]=0,a[8]=0},o.prototype.setTrace=function(a){var c=this.elements;c[0]=a.x,c[4]=a.y,c[8]=a.z},o.prototype.getTrace=function(c){var c=c||new s,h=this.elements;c.x=h[0],c.y=h[4],c.z=h[8]},o.prototype.vmult=function(a,c){c=c||new s;var h=this.elements,d=a.x,l=a.y,u=a.z;return c.x=h[0]*d+h[1]*l+h[2]*u,c.y=h[3]*d+h[4]*l+h[5]*u,c.z=h[6]*d+h[7]*l+h[8]*u,c},o.prototype.smult=function(a){for(var c=0;c<this.elements.length;c++)this.elements[c]*=a},o.prototype.mmult=function(a,c){for(var h=c||new o,d=0;d<3;d++)for(var l=0;l<3;l++){for(var u=0,p=0;p<3;p++)u+=a.elements[d+p*3]*this.elements[p+l*3];h.elements[d+l*3]=u}return h},o.prototype.scale=function(a,c){c=c||new o;for(var h=this.elements,d=c.elements,l=0;l!==3;l++)d[3*l+0]=a.x*h[3*l+0],d[3*l+1]=a.y*h[3*l+1],d[3*l+2]=a.z*h[3*l+2];return c},o.prototype.solve=function(a,c){c=c||new s;for(var h=3,d=4,l=[],u=0;u<h*d;u++)l.push(0);var u,p;for(u=0;u<3;u++)for(p=0;p<3;p++)l[u+d*p]=this.elements[u+3*p];l[3+4*0]=a.x,l[3+4*1]=a.y,l[3+4*2]=a.z;var g=3,y=g,x,v=4,w;do{if(u=y-g,l[u+d*u]===0){for(p=u+1;p<y;p++)if(l[u+d*p]!==0){x=v;do w=v-x,l[w+d*u]+=l[w+d*p];while(--x);break}}if(l[u+d*u]!==0)for(p=u+1;p<y;p++){var S=l[u+d*p]/l[u+d*u];x=v;do w=v-x,l[w+d*p]=w<=u?0:l[w+d*p]-l[w+d*u]*S;while(--x)}}while(--g);if(c.z=l[2*d+3]/l[2*d+2],c.y=(l[1*d+3]-l[1*d+2]*c.z)/l[1*d+1],c.x=(l[0*d+3]-l[0*d+2]*c.z-l[0*d+1]*c.y)/l[0*d+0],isNaN(c.x)||isNaN(c.y)||isNaN(c.z)||c.x===1/0||c.y===1/0||c.z===1/0)throw"Could not solve equation! Got x=["+c.toString()+"], b=["+a.toString()+"], A=["+this.toString()+"]";return c},o.prototype.e=function(a,c,h){if(h===void 0)return this.elements[c+3*a];this.elements[c+3*a]=h},o.prototype.copy=function(a){for(var c=0;c<a.elements.length;c++)this.elements[c]=a.elements[c];return this},o.prototype.toString=function(){for(var a="",c=",",h=0;h<9;h++)a+=this.elements[h]+c;return a},o.prototype.reverse=function(a){a=a||new o;for(var c=3,h=6,d=[],l=0;l<c*h;l++)d.push(0);var l,u;for(l=0;l<3;l++)for(u=0;u<3;u++)d[l+h*u]=this.elements[l+3*u];d[3+6*0]=1,d[3+6*1]=0,d[3+6*2]=0,d[4+6*0]=0,d[4+6*1]=1,d[4+6*2]=0,d[5+6*0]=0,d[5+6*1]=0,d[5+6*2]=1;var p=3,g=p,y,x=h,v;do{if(l=g-p,d[l+h*l]===0){for(u=l+1;u<g;u++)if(d[l+h*u]!==0){y=x;do v=x-y,d[v+h*l]+=d[v+h*u];while(--y);break}}if(d[l+h*l]!==0)for(u=l+1;u<g;u++){var w=d[l+h*u]/d[l+h*l];y=x;do v=x-y,d[v+h*u]=v<=l?0:d[v+h*u]-d[v+h*l]*w;while(--y)}}while(--p);l=2;do{u=l-1;do{var w=d[l+h*u]/d[l+h*l];y=h;do v=h-y,d[v+h*u]=d[v+h*u]-d[v+h*l]*w;while(--y)}while(u--)}while(--l);l=2;do{var w=1/d[l+h*l];y=h;do v=h-y,d[v+h*l]=d[v+h*l]*w;while(--y)}while(l--);l=2;do{u=2;do{if(v=d[c+u+h*l],isNaN(v)||v===1/0)throw"Could not reverse! A=["+this.toString()+"]";a.e(l,u,v)}while(u--)}while(l--);return a},o.prototype.setRotationFromQuaternion=function(a){var c=a.x,h=a.y,d=a.z,l=a.w,u=c+c,p=h+h,g=d+d,y=c*u,x=c*p,v=c*g,w=h*p,S=h*g,b=d*g,E=l*u,R=l*p,z=l*g,I=this.elements;return I[3*0+0]=1-(w+b),I[3*0+1]=x-z,I[3*0+2]=v+R,I[3*1+0]=x+z,I[3*1+1]=1-(y+b),I[3*1+2]=S-E,I[3*2+0]=v-R,I[3*2+1]=S+E,I[3*2+2]=1-(y+w),this},o.prototype.transpose=function(a){a=a||new o;for(var c=a.elements,h=this.elements,d=0;d!==3;d++)for(var l=0;l!==3;l++)c[3*d+l]=h[3*l+d];return a}},{"./Vec3":30}],28:[function(t,n,r){n.exports=o;var s=t("./Vec3");function o(u,p,g,y){this.x=u!==void 0?u:0,this.y=p!==void 0?p:0,this.z=g!==void 0?g:0,this.w=y!==void 0?y:1}o.prototype.set=function(u,p,g,y){this.x=u,this.y=p,this.z=g,this.w=y},o.prototype.toString=function(){return this.x+","+this.y+","+this.z+","+this.w},o.prototype.toArray=function(){return[this.x,this.y,this.z,this.w]},o.prototype.setFromAxisAngle=function(u,p){var g=Math.sin(p*.5);this.x=u.x*g,this.y=u.y*g,this.z=u.z*g,this.w=Math.cos(p*.5)},o.prototype.toAxisAngle=function(u){u=u||new s,this.normalize();var p=2*Math.acos(this.w),g=Math.sqrt(1-this.w*this.w);return g<.001?(u.x=this.x,u.y=this.y,u.z=this.z):(u.x=this.x/g,u.y=this.y/g,u.z=this.z/g),[u,p]};var a=new s,c=new s;o.prototype.setFromVectors=function(u,p){if(u.isAntiparallelTo(p)){var g=a,y=c;u.tangents(g,y),this.setFromAxisAngle(g,Math.PI)}else{var x=u.cross(p);this.x=x.x,this.y=x.y,this.z=x.z,this.w=Math.sqrt(Math.pow(u.norm(),2)*Math.pow(p.norm(),2))+u.dot(p),this.normalize()}};var h=new s,d=new s,l=new s;o.prototype.mult=function(u,p){p=p||new o;var g=this.w,y=h,x=d,v=l;return y.set(this.x,this.y,this.z),x.set(u.x,u.y,u.z),p.w=g*u.w-y.dot(x),y.cross(x,v),p.x=g*x.x+u.w*y.x+v.x,p.y=g*x.y+u.w*y.y+v.y,p.z=g*x.z+u.w*y.z+v.z,p},o.prototype.inverse=function(u){var p=this.x,g=this.y,y=this.z,x=this.w;u=u||new o,this.conjugate(u);var v=1/(p*p+g*g+y*y+x*x);return u.x*=v,u.y*=v,u.z*=v,u.w*=v,u},o.prototype.conjugate=function(u){return u=u||new o,u.x=-this.x,u.y=-this.y,u.z=-this.z,u.w=this.w,u},o.prototype.normalize=function(){var u=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);u===0?(this.x=0,this.y=0,this.z=0,this.w=0):(u=1/u,this.x*=u,this.y*=u,this.z*=u,this.w*=u)},o.prototype.normalizeFast=function(){var u=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;u===0?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=u,this.y*=u,this.z*=u,this.w*=u)},o.prototype.vmult=function(u,p){p=p||new s;var g=u.x,y=u.y,x=u.z,v=this.x,w=this.y,S=this.z,b=this.w,E=b*g+w*x-S*y,R=b*y+S*g-v*x,z=b*x+v*y-w*g,I=-v*g-w*y-S*x;return p.x=E*b+I*-v+R*-S-z*-w,p.y=R*b+I*-w+z*-v-E*-S,p.z=z*b+I*-S+E*-w-R*-v,p},o.prototype.copy=function(u){return this.x=u.x,this.y=u.y,this.z=u.z,this.w=u.w,this},o.prototype.toEuler=function(u,p){p=p||"YZX";var g,y,x,v=this.x,w=this.y,S=this.z,b=this.w;switch(p){case"YZX":var E=v*w+S*b;if(E>.499&&(g=2*Math.atan2(v,b),y=Math.PI/2,x=0),E<-.499&&(g=-2*Math.atan2(v,b),y=-Math.PI/2,x=0),isNaN(g)){var R=v*v,z=w*w,I=S*S;g=Math.atan2(2*w*b-2*v*S,1-2*z-2*I),y=Math.asin(2*E),x=Math.atan2(2*v*b-2*w*S,1-2*R-2*I)}break;default:throw new Error("Euler order "+p+" not supported yet.")}u.y=g,u.z=y,u.x=x},o.prototype.setFromEuler=function(u,p,g,y){y=y||"XYZ";var x=Math.cos(u/2),v=Math.cos(p/2),w=Math.cos(g/2),S=Math.sin(u/2),b=Math.sin(p/2),E=Math.sin(g/2);return y==="XYZ"?(this.x=S*v*w+x*b*E,this.y=x*b*w-S*v*E,this.z=x*v*E+S*b*w,this.w=x*v*w-S*b*E):y==="YXZ"?(this.x=S*v*w+x*b*E,this.y=x*b*w-S*v*E,this.z=x*v*E-S*b*w,this.w=x*v*w+S*b*E):y==="ZXY"?(this.x=S*v*w-x*b*E,this.y=x*b*w+S*v*E,this.z=x*v*E+S*b*w,this.w=x*v*w-S*b*E):y==="ZYX"?(this.x=S*v*w-x*b*E,this.y=x*b*w+S*v*E,this.z=x*v*E-S*b*w,this.w=x*v*w+S*b*E):y==="YZX"?(this.x=S*v*w+x*b*E,this.y=x*b*w+S*v*E,this.z=x*v*E-S*b*w,this.w=x*v*w-S*b*E):y==="XZY"&&(this.x=S*v*w-x*b*E,this.y=x*b*w-S*v*E,this.z=x*v*E+S*b*w,this.w=x*v*w+S*b*E),this},o.prototype.clone=function(){return new o(this.x,this.y,this.z,this.w)}},{"./Vec3":30}],29:[function(t,n,r){var s=t("./Vec3"),o=t("./Quaternion");n.exports=a;function a(h){h=h||{},this.position=new s,h.position&&this.position.copy(h.position),this.quaternion=new o,h.quaternion&&this.quaternion.copy(h.quaternion)}var c=new o;a.pointToLocalFrame=function(h,d,l,p){var p=p||new s;return l.vsub(h,p),d.conjugate(c),c.vmult(p,p),p},a.prototype.pointToLocal=function(h,d){return a.pointToLocalFrame(this.position,this.quaternion,h,d)},a.pointToWorldFrame=function(h,d,l,p){var p=p||new s;return d.vmult(l,p),p.vadd(h,p),p},a.prototype.pointToWorld=function(h,d){return a.pointToWorldFrame(this.position,this.quaternion,h,d)},a.prototype.vectorToWorldFrame=function(h,l){var l=l||new s;return this.quaternion.vmult(h,l),l},a.vectorToWorldFrame=function(h,d,l){return h.vmult(d,l),l},a.vectorToLocalFrame=function(h,d,l,p){var p=p||new s;return d.w*=-1,d.vmult(l,p),d.w*=-1,p}},{"./Quaternion":28,"./Vec3":30}],30:[function(t,n,r){n.exports=o;var s=t("./Mat3");function o(d,l,u){this.x=d||0,this.y=l||0,this.z=u||0}o.ZERO=new o(0,0,0),o.UNIT_X=new o(1,0,0),o.UNIT_Y=new o(0,1,0),o.UNIT_Z=new o(0,0,1),o.prototype.cross=function(d,l){var u=d.x,p=d.y,g=d.z,y=this.x,x=this.y,v=this.z;return l=l||new o,l.x=x*g-v*p,l.y=v*u-y*g,l.z=y*p-x*u,l},o.prototype.set=function(d,l,u){return this.x=d,this.y=l,this.z=u,this},o.prototype.setZero=function(){this.x=this.y=this.z=0},o.prototype.vadd=function(d,l){if(l)l.x=d.x+this.x,l.y=d.y+this.y,l.z=d.z+this.z;else return new o(this.x+d.x,this.y+d.y,this.z+d.z)},o.prototype.vsub=function(d,l){if(l)l.x=this.x-d.x,l.y=this.y-d.y,l.z=this.z-d.z;else return new o(this.x-d.x,this.y-d.y,this.z-d.z)},o.prototype.crossmat=function(){return new s([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])},o.prototype.normalize=function(){var d=this.x,l=this.y,u=this.z,p=Math.sqrt(d*d+l*l+u*u);if(p>0){var g=1/p;this.x*=g,this.y*=g,this.z*=g}else this.x=0,this.y=0,this.z=0;return p},o.prototype.unit=function(d){d=d||new o;var l=this.x,u=this.y,p=this.z,g=Math.sqrt(l*l+u*u+p*p);return g>0?(g=1/g,d.x=l*g,d.y=u*g,d.z=p*g):(d.x=1,d.y=0,d.z=0),d},o.prototype.norm=function(){var d=this.x,l=this.y,u=this.z;return Math.sqrt(d*d+l*l+u*u)},o.prototype.length=o.prototype.norm,o.prototype.norm2=function(){return this.dot(this)},o.prototype.lengthSquared=o.prototype.norm2,o.prototype.distanceTo=function(d){var l=this.x,u=this.y,p=this.z,g=d.x,y=d.y,x=d.z;return Math.sqrt((g-l)*(g-l)+(y-u)*(y-u)+(x-p)*(x-p))},o.prototype.distanceSquared=function(d){var l=this.x,u=this.y,p=this.z,g=d.x,y=d.y,x=d.z;return(g-l)*(g-l)+(y-u)*(y-u)+(x-p)*(x-p)},o.prototype.mult=function(d,l){l=l||new o;var u=this.x,p=this.y,g=this.z;return l.x=d*u,l.y=d*p,l.z=d*g,l},o.prototype.scale=o.prototype.mult,o.prototype.dot=function(d){return this.x*d.x+this.y*d.y+this.z*d.z},o.prototype.isZero=function(){return this.x===0&&this.y===0&&this.z===0},o.prototype.negate=function(d){return d=d||new o,d.x=-this.x,d.y=-this.y,d.z=-this.z,d};var a=new o,c=new o;o.prototype.tangents=function(d,l){var u=this.norm();if(u>0){var p=a,g=1/u;p.set(this.x*g,this.y*g,this.z*g);var y=c;Math.abs(p.x)<.9?(y.set(1,0,0),p.cross(y,d)):(y.set(0,1,0),p.cross(y,d)),p.cross(d,l)}else d.set(1,0,0),l.set(0,1,0)},o.prototype.toString=function(){return this.x+","+this.y+","+this.z},o.prototype.toArray=function(){return[this.x,this.y,this.z]},o.prototype.copy=function(d){return this.x=d.x,this.y=d.y,this.z=d.z,this},o.prototype.lerp=function(d,l,u){var p=this.x,g=this.y,y=this.z;u.x=p+(d.x-p)*l,u.y=g+(d.y-g)*l,u.z=y+(d.z-y)*l},o.prototype.almostEquals=function(d,l){return l===void 0&&(l=1e-6),!(Math.abs(this.x-d.x)>l||Math.abs(this.y-d.y)>l||Math.abs(this.z-d.z)>l)},o.prototype.almostZero=function(d){return d===void 0&&(d=1e-6),!(Math.abs(this.x)>d||Math.abs(this.y)>d||Math.abs(this.z)>d)};var h=new o;o.prototype.isAntiparallelTo=function(d,l){return this.negate(h),h.almostEquals(d,l)},o.prototype.clone=function(){return new o(this.x,this.y,this.z)}},{"./Mat3":27}],31:[function(t,n,r){n.exports=l;var s=t("../utils/EventTarget");t("../shapes/Shape");var o=t("../math/Vec3"),a=t("../math/Mat3"),c=t("../math/Quaternion");t("../material/Material");var h=t("../collision/AABB"),d=t("../shapes/Box");function l(C){C=C||{},s.apply(this),this.id=l.idCounter++,this.world=null,this.preStep=null,this.postStep=null,this.vlambda=new o,this.collisionFilterGroup=typeof C.collisionFilterGroup=="number"?C.collisionFilterGroup:1,this.collisionFilterMask=typeof C.collisionFilterMask=="number"?C.collisionFilterMask:1,this.collisionResponse=!0,this.position=new o,C.position&&this.position.copy(C.position),this.previousPosition=new o,this.initPosition=new o,this.velocity=new o,C.velocity&&this.velocity.copy(C.velocity),this.initVelocity=new o,this.force=new o;var O=typeof C.mass=="number"?C.mass:0;this.mass=O,this.invMass=O>0?1/O:0,this.material=C.material||null,this.linearDamping=typeof C.linearDamping=="number"?C.linearDamping:.01,this.type=O<=0?l.STATIC:l.DYNAMIC,typeof C.type==typeof l.STATIC&&(this.type=C.type),this.allowSleep=typeof C.allowSleep!="undefined"?C.allowSleep:!0,this.sleepState=0,this.sleepSpeedLimit=typeof C.sleepSpeedLimit!="undefined"?C.sleepSpeedLimit:.1,this.sleepTimeLimit=typeof C.sleepTimeLimit!="undefined"?C.sleepTimeLimit:1,this.timeLastSleepy=0,this._wakeUpAfterNarrowphase=!1,this.torque=new o,this.quaternion=new c,C.quaternion&&this.quaternion.copy(C.quaternion),this.initQuaternion=new c,this.angularVelocity=new o,C.angularVelocity&&this.angularVelocity.copy(C.angularVelocity),this.initAngularVelocity=new o,this.interpolatedPosition=new o,this.interpolatedQuaternion=new c,this.shapes=[],this.shapeOffsets=[],this.shapeOrientations=[],this.inertia=new o,this.invInertia=new o,this.invInertiaWorld=new a,this.invMassSolve=0,this.invInertiaSolve=new o,this.invInertiaWorldSolve=new a,this.fixedRotation=typeof C.fixedRotation!="undefined"?C.fixedRotation:!1,this.angularDamping=typeof C.angularDamping!="undefined"?C.angularDamping:.01,this.aabb=new h,this.aabbNeedsUpdate=!0,this.wlambda=new o,C.shape&&this.addShape(C.shape),this.updateMassProperties()}l.prototype=new s,l.prototype.constructor=l,l.DYNAMIC=1,l.STATIC=2,l.KINEMATIC=4,l.AWAKE=0,l.SLEEPY=1,l.SLEEPING=2,l.idCounter=0,l.prototype.wakeUp=function(){var C=this.sleepState;this.sleepState=0,C===l.SLEEPING&&this.dispatchEvent({type:"wakeup"})},l.prototype.sleep=function(){this.sleepState=l.SLEEPING,this.velocity.set(0,0,0),this.angularVelocity.set(0,0,0)},l.sleepyEvent={type:"sleepy"},l.sleepEvent={type:"sleep"},l.prototype.sleepTick=function(C){if(this.allowSleep){var O=this.sleepState,X=this.velocity.norm2()+this.angularVelocity.norm2(),U=Math.pow(this.sleepSpeedLimit,2);O===l.AWAKE&&X<U?(this.sleepState=l.SLEEPY,this.timeLastSleepy=C,this.dispatchEvent(l.sleepyEvent)):O===l.SLEEPY&&X>U?this.wakeUp():O===l.SLEEPY&&C-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(l.sleepEvent))}},l.prototype.updateSolveMassProperties=function(){this.sleepState===l.SLEEPING||this.type===l.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))},l.prototype.pointToLocalFrame=function(C,X){var X=X||new o;return C.vsub(this.position,X),this.quaternion.conjugate().vmult(X,X),X},l.prototype.vectorToLocalFrame=function(C,X){var X=X||new o;return this.quaternion.conjugate().vmult(C,X),X},l.prototype.pointToWorldFrame=function(C,X){var X=X||new o;return this.quaternion.vmult(C,X),X.vadd(this.position,X),X},l.prototype.vectorToWorldFrame=function(C,X){var X=X||new o;return this.quaternion.vmult(C,X),X};var u=new o,p=new c;l.prototype.addShape=function(C,O,X){var U=new o,te=new c;return O&&U.copy(O),X&&te.copy(X),this.shapes.push(C),this.shapeOffsets.push(U),this.shapeOrientations.push(te),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,this},l.prototype.updateBoundingRadius=function(){for(var C=this.shapes,O=this.shapeOffsets,X=C.length,U=0,te=0;te!==X;te++){var ne=C[te];ne.updateBoundingSphereRadius();var j=O[te].norm(),k=ne.boundingSphereRadius;j+k>U&&(U=j+k)}this.boundingRadius=U};var g=new h;l.prototype.computeAABB=function(){for(var C=this.shapes,O=this.shapeOffsets,X=this.shapeOrientations,U=C.length,te=u,ne=p,j=this.quaternion,k=this.aabb,W=g,Y=0;Y!==U;Y++){var H=C[Y];X[Y].mult(j,ne),ne.vmult(O[Y],te),te.vadd(this.position,te),H.calculateWorldAABB(te,ne,W.lowerBound,W.upperBound),Y===0?k.copy(W):k.extend(W)}this.aabbNeedsUpdate=!1};var y=new a,x=new a;new a,l.prototype.updateInertiaWorld=function(C){var O=this.invInertia;if(!(O.x===O.y&&O.y===O.z&&!C)){var X=y,U=x;X.setRotationFromQuaternion(this.quaternion),X.transpose(U),X.scale(O,X),X.mmult(U,this.invInertiaWorld)}};var v=new o,w=new o;l.prototype.applyForce=function(C,O){if(this.type===l.DYNAMIC){var X=v;O.vsub(this.position,X);var U=w;X.cross(C,U),this.force.vadd(C,this.force),this.torque.vadd(U,this.torque)}};var S=new o,b=new o;l.prototype.applyLocalForce=function(C,O){if(this.type===l.DYNAMIC){var X=S,U=b;this.vectorToWorldFrame(C,X),this.pointToWorldFrame(O,U),this.applyForce(X,U)}};var E=new o,R=new o,z=new o;l.prototype.applyImpulse=function(C,O){if(this.type===l.DYNAMIC){var X=E;O.vsub(this.position,X);var U=R;U.copy(C),U.mult(this.invMass,U),this.velocity.vadd(U,this.velocity);var te=z;X.cross(C,te),this.invInertiaWorld.vmult(te,te),this.angularVelocity.vadd(te,this.angularVelocity)}};var I=new o,N=new o;l.prototype.applyLocalImpulse=function(C,O){if(this.type===l.DYNAMIC){var X=I,U=N;this.vectorToWorldFrame(C,X),this.pointToWorldFrame(O,U),this.applyImpulse(X,U)}};var F=new o;l.prototype.updateMassProperties=function(){var C=F;this.invMass=this.mass>0?1/this.mass:0;var O=this.inertia,X=this.fixedRotation;this.computeAABB(),C.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2),d.calculateInertia(C,this.mass,O),this.invInertia.set(O.x>0&&!X?1/O.x:0,O.y>0&&!X?1/O.y:0,O.z>0&&!X?1/O.z:0),this.updateInertiaWorld(!0)},l.prototype.getVelocityAtWorldPoint=function(C,O){var X=new o;return C.vsub(this.position,X),this.angularVelocity.cross(X,O),this.velocity.vadd(O,O),O}},{"../collision/AABB":3,"../material/Material":25,"../math/Mat3":27,"../math/Quaternion":28,"../math/Vec3":30,"../shapes/Box":37,"../shapes/Shape":43,"../utils/EventTarget":49}],32:[function(t,n,r){t("./Body");var s=t("../math/Vec3"),o=t("../math/Quaternion");t("../collision/RaycastResult");var a=t("../collision/Ray"),c=t("../objects/WheelInfo");n.exports=h;function h(j){this.chassisBody=j.chassisBody,this.wheelInfos=[],this.sliding=!1,this.world=null,this.indexRightAxis=typeof j.indexRightAxis!="undefined"?j.indexRightAxis:1,this.indexForwardAxis=typeof j.indexForwardAxis!="undefined"?j.indexForwardAxis:0,this.indexUpAxis=typeof j.indexUpAxis!="undefined"?j.indexUpAxis:2}new s,new s,new s;var d=new s,l=new s,u=new s;new a,h.prototype.addWheel=function(j){j=j||{};var k=new c(j),W=this.wheelInfos.length;return this.wheelInfos.push(k),W},h.prototype.setSteeringValue=function(j,k){var W=this.wheelInfos[k];W.steering=j},new s,h.prototype.applyEngineForce=function(j,k){this.wheelInfos[k].engineForce=j},h.prototype.setBrake=function(j,k){this.wheelInfos[k].brake=j},h.prototype.addToWorld=function(j){this.constraints,j.add(this.chassisBody);var k=this;this.preStepCallback=function(){k.updateVehicle(j.dt)},j.addEventListener("preStep",this.preStepCallback),this.world=j},h.prototype.getVehicleAxisWorld=function(j,k){k.set(j===0?1:0,j===1?1:0,j===2?1:0),this.chassisBody.vectorToWorldFrame(k,k)},h.prototype.updateVehicle=function(j){for(var k=this.wheelInfos,W=k.length,Y=this.chassisBody,H=0;H<W;H++)this.updateWheelTransform(H);this.currentVehicleSpeedKmHour=3.6*Y.velocity.norm();var J=new s;this.getVehicleAxisWorld(this.indexForwardAxis,J),J.dot(Y.velocity)<0&&(this.currentVehicleSpeedKmHour*=-1);for(var H=0;H<W;H++)this.castRay(k[H]);this.updateSuspension(j);for(var K=new s,ee=new s,H=0;H<W;H++){var $=k[H],Z=$.suspensionForce;Z>$.maxSuspensionForce&&(Z=$.maxSuspensionForce),$.raycastResult.hitNormalWorld.scale(Z*j,K),$.raycastResult.hitPointWorld.vsub(Y.position,ee),Y.applyImpulse(K,$.raycastResult.hitPointWorld)}this.updateFriction(j);var Ee=new s,Se=new s,de=new s;for(H=0;H<W;H++){var $=k[H];Y.getVelocityAtWorldPoint($.chassisConnectionPointWorld,de);var he=1;switch(this.indexUpAxis){case 1:he=-1;break}if($.isInContact){this.getVehicleAxisWorld(this.indexForwardAxis,Se);var Ce=Se.dot($.raycastResult.hitNormalWorld);$.raycastResult.hitNormalWorld.scale(Ce,Ee),Se.vsub(Ee,Se);var me=Se.dot(de);$.deltaRotation=he*me*j/$.radius}($.sliding||!$.isInContact)&&$.engineForce!==0&&$.useCustomSlidingRotationalSpeed&&($.deltaRotation=($.engineForce>0?1:-1)*$.customSlidingRotationalSpeed*j),Math.abs($.brake)>Math.abs($.engineForce)&&($.deltaRotation=0),$.rotation+=$.deltaRotation,$.deltaRotation*=.99}},h.prototype.updateSuspension=function(j){for(var k=this.chassisBody,W=k.mass,Y=this.wheelInfos,H=Y.length,J=0;J<H;J++){var K=Y[J];if(K.isInContact){var ee,$=K.suspensionRestLength,Z=K.suspensionLength,Ee=$-Z;ee=K.suspensionStiffness*Ee*K.clippedInvContactDotSuspension;var Se=K.suspensionRelativeVelocity,de;Se<0?de=K.dampingCompression:de=K.dampingRelaxation,ee-=de*Se,K.suspensionForce=ee*W,K.suspensionForce<0&&(K.suspensionForce=0)}else K.suspensionForce=0}},h.prototype.removeFromWorld=function(j){this.constraints,j.remove(this.chassisBody),j.removeEventListener("preStep",this.preStepCallback),this.world=null};var p=new s,g=new s;h.prototype.castRay=function(j){var k=p,W=g;this.updateWheelTransformWorld(j);var Y=this.chassisBody,H=-1,J=j.suspensionRestLength+j.radius;j.directionWorld.scale(J,k);var K=j.chassisConnectionPointWorld;K.vadd(k,W);var ee=j.raycastResult;ee.reset();var $=Y.collisionResponse;Y.collisionResponse=!1,this.world.rayTest(K,W,ee),Y.collisionResponse=$;var Z=ee.body;if(j.raycastResult.groundObject=0,Z){H=ee.distance,j.raycastResult.hitNormalWorld=ee.hitNormalWorld,j.isInContact=!0;var Ee=ee.distance;j.suspensionLength=Ee-j.radius;var Se=j.suspensionRestLength-j.maxSuspensionTravel,de=j.suspensionRestLength+j.maxSuspensionTravel;j.suspensionLength<Se&&(j.suspensionLength=Se),j.suspensionLength>de&&(j.suspensionLength=de,j.raycastResult.reset());var he=j.raycastResult.hitNormalWorld.dot(j.directionWorld),Ce=new s;Y.getVelocityAtWorldPoint(j.raycastResult.hitPointWorld,Ce);var me=j.raycastResult.hitNormalWorld.dot(Ce);if(he>=-.1)j.suspensionRelativeVelocity=0,j.clippedInvContactDotSuspension=1/.1;else{var fe=-1/he;j.suspensionRelativeVelocity=me*fe,j.clippedInvContactDotSuspension=fe}}else j.suspensionLength=j.suspensionRestLength+0*j.maxSuspensionTravel,j.suspensionRelativeVelocity=0,j.directionWorld.scale(-1,j.raycastResult.hitNormalWorld),j.clippedInvContactDotSuspension=1;return H},h.prototype.updateWheelTransformWorld=function(j){j.isInContact=!1;var k=this.chassisBody;k.pointToWorldFrame(j.chassisConnectionPointLocal,j.chassisConnectionPointWorld),k.vectorToWorldFrame(j.directionLocal,j.directionWorld),k.vectorToWorldFrame(j.axleLocal,j.axleWorld)},h.prototype.updateWheelTransform=function(j){var k=d,W=l,Y=u,H=this.wheelInfos[j];this.updateWheelTransformWorld(H),H.directionLocal.scale(-1,k),W.copy(H.axleLocal),k.cross(W,Y),Y.normalize(),W.normalize();var J=H.steering,K=new o;K.setFromAxisAngle(k,J);var ee=new o;ee.setFromAxisAngle(W,H.rotation);var $=H.worldTransform.quaternion;this.chassisBody.quaternion.mult(K,$),$.mult(ee,$),$.normalize();var Z=H.worldTransform.position;Z.copy(H.directionWorld),Z.scale(H.suspensionLength,Z),Z.vadd(H.chassisConnectionPointWorld,Z)};var y=[new s(1,0,0),new s(0,1,0),new s(0,0,1)];h.prototype.getWheelTransformWorld=function(j){return this.wheelInfos[j].worldTransform};var x=new s,v=[],w=[],S=1;h.prototype.updateFriction=function(j){for(var k=x,W=this.wheelInfos,Y=W.length,H=this.chassisBody,J=w,K=v,ee=0;ee<Y;ee++){var $=W[ee],Z=$.raycastResult.body;$.sideImpulse=0,$.forwardImpulse=0,J[ee]||(J[ee]=new s),K[ee]||(K[ee]=new s)}for(var ee=0;ee<Y;ee++){var $=W[ee],Z=$.raycastResult.body;if(Z){var Ee=K[ee],Se=this.getWheelTransformWorld(ee);Se.vectorToWorldFrame(y[this.indexRightAxis],Ee);var de=$.raycastResult.hitNormalWorld,he=Ee.dot(de);de.scale(he,k),Ee.vsub(k,Ee),Ee.normalize(),de.cross(Ee,J[ee]),J[ee].normalize(),$.sideImpulse=ne(H,$.raycastResult.hitPointWorld,Z,$.raycastResult.hitPointWorld,Ee),$.sideImpulse*=S}}var Ce=1,me=.5;this.sliding=!1;for(var ee=0;ee<Y;ee++){var $=W[ee],Z=$.raycastResult.body,fe=0;if($.slipInfo=1,Z){var we=0,ye=$.brake?$.brake:we;fe=z(H,Z,$.raycastResult.hitPointWorld,J[ee],ye),fe+=$.engineForce*j;var _e=ye/fe;$.slipInfo*=_e}if($.forwardImpulse=0,$.skidInfo=1,Z){$.skidInfo=1;var it=$.suspensionForce*j*$.frictionSlip,$e=it,et=it*$e;$.forwardImpulse=fe;var L=$.forwardImpulse*me,V=$.sideImpulse*Ce,P=L*L+V*V;if($.sliding=!1,P>et){this.sliding=!0,$.sliding=!0;var _e=it/Math.sqrt(P);$.skidInfo*=_e}}}if(this.sliding)for(var ee=0;ee<Y;ee++){var $=W[ee];$.sideImpulse!==0&&$.skidInfo<1&&($.forwardImpulse*=$.skidInfo,$.sideImpulse*=$.skidInfo)}for(var ee=0;ee<Y;ee++){var $=W[ee],T=new s;if(T.copy($.raycastResult.hitPointWorld),$.forwardImpulse!==0){var q=new s;J[ee].scale($.forwardImpulse,q),H.applyImpulse(q,T)}if($.sideImpulse!==0){var Z=$.raycastResult.body,re=new s;re.copy($.raycastResult.hitPointWorld);var pe=new s;K[ee].scale($.sideImpulse,pe),H.pointToLocalFrame(T,T),T["xyz"[this.indexUpAxis]]*=$.rollInfluence,H.pointToWorldFrame(T,T),H.applyImpulse(pe,T),pe.scale(-1,pe),Z.applyImpulse(pe,re)}}};var b=new s,E=new s,R=new s;function z(j,k,W,Y,H){var J=0,K=W,ee=b,$=E,Z=R;j.getVelocityAtWorldPoint(K,ee),k.getVelocityAtWorldPoint(K,$),ee.vsub($,Z);var Ee=Y.dot(Z),Se=O(j,W,Y),de=O(k,W,Y),he=1,Ce=he/(Se+de);return J=-Ee*Ce,H<J&&(J=H),J<-H&&(J=-H),J}var I=new s,N=new s,F=new s,C=new s;function O(j,k,W){var Y=I,H=N,J=F,K=C;return k.vsub(j.position,Y),Y.cross(W,H),j.invInertiaWorld.vmult(H,K),K.cross(Y,J),j.invMass+W.dot(J)}var X=new s,U=new s,te=new s;function ne(j,k,W,Y,H,he){var K=H.norm2();if(K>1.1)return 0;var ee=X,$=U,Z=te;j.getVelocityAtWorldPoint(k,ee),W.getVelocityAtWorldPoint(Y,$),ee.vsub($,Z);var Ee=H.dot(Z),Se=.2,de=1/(j.invMass+W.invMass),he=-Se*Ee*de;return he}},{"../collision/Ray":9,"../collision/RaycastResult":10,"../math/Quaternion":28,"../math/Vec3":30,"../objects/WheelInfo":36,"./Body":31}],33:[function(t,n,r){var s=t("./Body"),o=t("../shapes/Sphere"),a=t("../shapes/Box"),c=t("../math/Vec3"),h=t("../constraints/HingeConstraint");n.exports=d;function d(p){if(this.wheelBodies=[],this.coordinateSystem=typeof p.coordinateSystem=="undefined"?new c(1,2,3):p.coordinateSystem.clone(),this.chassisBody=p.chassisBody,!this.chassisBody){var g=new a(new c(5,2,.5));this.chassisBody=new s(1,g)}this.constraints=[],this.wheelAxes=[],this.wheelForces=[]}d.prototype.addWheel=function(p){p=p||{};var g=p.body;g||(g=new s(1,new o(1.2))),this.wheelBodies.push(g),this.wheelForces.push(0),new c;var y=typeof p.position!="undefined"?p.position.clone():new c,x=new c;this.chassisBody.pointToWorldFrame(y,x),g.position.set(x.x,x.y,x.z);var v=typeof p.axis!="undefined"?p.axis.clone():new c(0,1,0);this.wheelAxes.push(v);var w=new h(this.chassisBody,g,{pivotA:y,axisA:v,pivotB:c.ZERO,axisB:v,collideConnected:!1});return this.constraints.push(w),this.wheelBodies.length-1},d.prototype.setSteeringValue=function(p,g){var y=this.wheelAxes[g],x=Math.cos(p),v=Math.sin(p),w=y.x,S=y.y;this.constraints[g].axisA.set(x*w-v*S,v*w+x*S,0)},d.prototype.setMotorSpeed=function(p,g){var y=this.constraints[g];y.enableMotor(),y.motorTargetVelocity=p},d.prototype.disableMotor=function(p){var g=this.constraints[p];g.disableMotor()};var l=new c;d.prototype.setWheelForce=function(p,g){this.wheelForces[g]=p},d.prototype.applyWheelForce=function(p,g){var y=this.wheelAxes[g],x=this.wheelBodies[g],v=x.torque;y.scale(p,l),x.vectorToWorldFrame(l,l),v.vadd(l,v)},d.prototype.addToWorld=function(p){for(var g=this.constraints,y=this.wheelBodies.concat([this.chassisBody]),x=0;x<y.length;x++)p.add(y[x]);for(var x=0;x<g.length;x++)p.addConstraint(g[x]);p.addEventListener("preStep",this._update.bind(this))},d.prototype._update=function(){for(var p=this.wheelForces,g=0;g<p.length;g++)this.applyWheelForce(p[g],g)},d.prototype.removeFromWorld=function(p){for(var g=this.constraints,y=this.wheelBodies.concat([this.chassisBody]),x=0;x<y.length;x++)p.remove(y[x]);for(var x=0;x<g.length;x++)p.removeConstraint(g[x])};var u=new c;d.prototype.getWheelSpeed=function(p){var g=this.wheelAxes[p],y=this.wheelBodies[p],x=y.angularVelocity;return this.chassisBody.vectorToWorldFrame(g,u),x.dot(u)}},{"../constraints/HingeConstraint":15,"../math/Vec3":30,"../shapes/Box":37,"../shapes/Sphere":44,"./Body":31}],34:[function(t,n,r){n.exports=o,t("../shapes/Shape");var s=t("../math/Vec3");t("../math/Quaternion"),t("../shapes/Particle"),t("../objects/Body"),t("../material/Material");function o(){this.particles=[],this.density=1,this.smoothingRadius=1,this.speedOfSound=1,this.viscosity=.01,this.eps=1e-6,this.pressures=[],this.densities=[],this.neighbors=[]}o.prototype.add=function(g){this.particles.push(g),this.neighbors.length<this.particles.length&&this.neighbors.push([])},o.prototype.remove=function(g){var y=this.particles.indexOf(g);y!==-1&&(this.particles.splice(y,1),this.neighbors.length>this.particles.length&&this.neighbors.pop())};var a=new s;o.prototype.getNeighbors=function(g,y){for(var x=this.particles.length,v=g.id,w=this.smoothingRadius*this.smoothingRadius,S=a,b=0;b!==x;b++){var E=this.particles[b];E.position.vsub(g.position,S),v!==E.id&&S.norm2()<w&&y.push(E)}};var c=new s,h=new s,d=new s,l=new s,u=new s,p=new s;o.prototype.update=function(){for(var g=this.particles.length,y=c,x=this.speedOfSound,v=this.eps,w=0;w!==g;w++){var S=this.particles[w],b=this.neighbors[w];b.length=0,this.getNeighbors(S,b),b.push(this.particles[w]);for(var E=b.length,R=0,z=0;z!==E;z++){S.position.vsub(b[z].position,y);var I=y.norm(),N=this.w(I);R+=b[z].mass*N}this.densities[w]=R,this.pressures[w]=x*x*(this.densities[w]-this.density)}for(var F=h,C=d,O=l,X=u,U=p,w=0;w!==g;w++){var te=this.particles[w];F.set(0,0,0),C.set(0,0,0);for(var ne,j,b=this.neighbors[w],E=b.length,z=0;z!==E;z++){var k=b[z];te.position.vsub(k.position,X);var W=X.norm();ne=-k.mass*(this.pressures[w]/(this.densities[w]*this.densities[w]+v)+this.pressures[z]/(this.densities[z]*this.densities[z]+v)),this.gradw(X,O),O.mult(ne,O),F.vadd(O,F),k.velocity.vsub(te.velocity,U),U.mult(1/(1e-4+this.densities[w]*this.densities[z])*this.viscosity*k.mass,U),j=this.nablaw(W),U.mult(j,U),C.vadd(U,C)}C.mult(te.mass,C),F.mult(te.mass,F),te.force.vadd(C,te.force),te.force.vadd(F,te.force)}},o.prototype.w=function(g){var y=this.smoothingRadius;return 315/(64*Math.PI*Math.pow(y,9))*Math.pow(y*y-g*g,3)},o.prototype.gradw=function(g,y){var x=g.norm(),v=this.smoothingRadius;g.mult(945/(32*Math.PI*Math.pow(v,9))*Math.pow(v*v-x*x,2),y)},o.prototype.nablaw=function(g){var y=this.smoothingRadius,x=945/(32*Math.PI*Math.pow(y,9))*(y*y-g*g)*(7*g*g-3*y*y);return x}},{"../material/Material":25,"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"../shapes/Particle":41,"../shapes/Shape":43}],35:[function(t,n,r){var s=t("../math/Vec3");n.exports=o;function o(w,S,b){b=b||{},this.restLength=typeof b.restLength=="number"?b.restLength:1,this.stiffness=b.stiffness||100,this.damping=b.damping||1,this.bodyA=w,this.bodyB=S,this.localAnchorA=new s,this.localAnchorB=new s,b.localAnchorA&&this.localAnchorA.copy(b.localAnchorA),b.localAnchorB&&this.localAnchorB.copy(b.localAnchorB),b.worldAnchorA&&this.setWorldAnchorA(b.worldAnchorA),b.worldAnchorB&&this.setWorldAnchorB(b.worldAnchorB)}o.prototype.setWorldAnchorA=function(w){this.bodyA.pointToLocalFrame(w,this.localAnchorA)},o.prototype.setWorldAnchorB=function(w){this.bodyB.pointToLocalFrame(w,this.localAnchorB)},o.prototype.getWorldAnchorA=function(w){this.bodyA.pointToWorldFrame(this.localAnchorA,w)},o.prototype.getWorldAnchorB=function(w){this.bodyB.pointToWorldFrame(this.localAnchorB,w)};var a=new s,c=new s,h=new s,d=new s,l=new s,u=new s,p=new s,g=new s,y=new s,x=new s,v=new s;o.prototype.applyForce=function(){var w=this.stiffness,S=this.damping,b=this.restLength,E=this.bodyA,R=this.bodyB,z=a,I=c,N=h,F=d,C=v,O=l,X=u,U=p,te=g,ne=y,j=x;this.getWorldAnchorA(O),this.getWorldAnchorB(X),O.vsub(E.position,U),X.vsub(R.position,te),X.vsub(O,z);var k=z.norm();I.copy(z),I.normalize(),R.velocity.vsub(E.velocity,N),R.angularVelocity.cross(te,C),N.vadd(C,N),E.angularVelocity.cross(U,C),N.vsub(C,N),I.mult(-w*(k-b)-S*N.dot(I),F),E.force.vsub(F,E.force),R.force.vadd(F,R.force),U.cross(F,ne),te.cross(F,j),E.torque.vsub(ne,E.torque),R.torque.vadd(j,R.torque)}},{"../math/Vec3":30}],36:[function(t,n,r){var s=t("../math/Vec3"),o=t("../math/Transform"),a=t("../collision/RaycastResult"),c=t("../utils/Utils");n.exports=h;function h(u){u=c.defaults(u,{chassisConnectionPointLocal:new s,chassisConnectionPointWorld:new s,directionLocal:new s,directionWorld:new s,axleLocal:new s,axleWorld:new s,suspensionRestLength:1,suspensionMaxLength:2,radius:1,suspensionStiffness:100,dampingCompression:10,dampingRelaxation:10,frictionSlip:1e4,steering:0,rotation:0,deltaRotation:0,rollInfluence:.01,maxSuspensionForce:Number.MAX_VALUE,isFrontWheel:!0,clippedInvContactDotSuspension:1,suspensionRelativeVelocity:0,suspensionForce:0,skidInfo:0,suspensionLength:0,maxSuspensionTravel:1,useCustomSlidingRotationalSpeed:!1,customSlidingRotationalSpeed:-.1}),this.maxSuspensionTravel=u.maxSuspensionTravel,this.customSlidingRotationalSpeed=u.customSlidingRotationalSpeed,this.useCustomSlidingRotationalSpeed=u.useCustomSlidingRotationalSpeed,this.sliding=!1,this.chassisConnectionPointLocal=u.chassisConnectionPointLocal.clone(),this.chassisConnectionPointWorld=u.chassisConnectionPointWorld.clone(),this.directionLocal=u.directionLocal.clone(),this.directionWorld=u.directionWorld.clone(),this.axleLocal=u.axleLocal.clone(),this.axleWorld=u.axleWorld.clone(),this.suspensionRestLength=u.suspensionRestLength,this.suspensionMaxLength=u.suspensionMaxLength,this.radius=u.radius,this.suspensionStiffness=u.suspensionStiffness,this.dampingCompression=u.dampingCompression,this.dampingRelaxation=u.dampingRelaxation,this.frictionSlip=u.frictionSlip,this.steering=0,this.rotation=0,this.deltaRotation=0,this.rollInfluence=u.rollInfluence,this.maxSuspensionForce=u.maxSuspensionForce,this.engineForce=0,this.brake=0,this.isFrontWheel=u.isFrontWheel,this.clippedInvContactDotSuspension=1,this.suspensionRelativeVelocity=0,this.suspensionForce=0,this.skidInfo=0,this.suspensionLength=0,this.sideImpulse=0,this.forwardImpulse=0,this.raycastResult=new a,this.worldTransform=new o,this.isInContact=!1}var l=new s,d=new s,l=new s;h.prototype.updateWheel=function(u){var p=this.raycastResult;if(this.isInContact){var g=p.hitNormalWorld.dot(p.directionWorld);p.hitPointWorld.vsub(u.position,d),u.getVelocityAtWorldPoint(d,l);var y=p.hitNormalWorld.dot(l);if(g>=-.1)this.suspensionRelativeVelocity=0,this.clippedInvContactDotSuspension=1/.1;else{var x=-1/g;this.suspensionRelativeVelocity=y*x,this.clippedInvContactDotSuspension=x}}else p.suspensionLength=this.suspensionRestLength,this.suspensionRelativeVelocity=0,p.directionWorld.scale(-1,p.hitNormalWorld),this.clippedInvContactDotSuspension=1}},{"../collision/RaycastResult":10,"../math/Transform":29,"../math/Vec3":30,"../utils/Utils":53}],37:[function(t,n,r){n.exports=c;var s=t("./Shape"),o=t("../math/Vec3"),a=t("./ConvexPolyhedron");function c(l){s.call(this),this.type=s.types.BOX,this.halfExtents=l,this.convexPolyhedronRepresentation=null,this.updateConvexPolyhedronRepresentation(),this.updateBoundingSphereRadius()}c.prototype=new s,c.prototype.constructor=c,c.prototype.updateConvexPolyhedronRepresentation=function(){var l=this.halfExtents.x,u=this.halfExtents.y,p=this.halfExtents.z,g=o,y=[new g(-l,-u,-p),new g(l,-u,-p),new g(l,u,-p),new g(-l,u,-p),new g(-l,-u,p),new g(l,-u,p),new g(l,u,p),new g(-l,u,p)],x=[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,3],[1,2,6,5]];new g(0,0,1),new g(0,1,0),new g(1,0,0);var v=new a(y,x);this.convexPolyhedronRepresentation=v,v.material=this.material},c.prototype.calculateLocalInertia=function(l,u){return u=u||new o,c.calculateInertia(this.halfExtents,l,u),u},c.calculateInertia=function(l,u,p){var g=l;p.x=1/12*u*(2*g.y*2*g.y+2*g.z*2*g.z),p.y=1/12*u*(2*g.x*2*g.x+2*g.z*2*g.z),p.z=1/12*u*(2*g.y*2*g.y+2*g.x*2*g.x)},c.prototype.getSideNormals=function(l,u){var p=l,g=this.halfExtents;if(p[0].set(g.x,0,0),p[1].set(0,g.y,0),p[2].set(0,0,g.z),p[3].set(-g.x,0,0),p[4].set(0,-g.y,0),p[5].set(0,0,-g.z),u!==void 0)for(var y=0;y!==p.length;y++)u.vmult(p[y],p[y]);return p},c.prototype.volume=function(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z},c.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=this.halfExtents.norm()};var h=new o;new o,c.prototype.forEachWorldCorner=function(l,u,p){for(var g=this.halfExtents,y=[[g.x,g.y,g.z],[-g.x,g.y,g.z],[-g.x,-g.y,g.z],[-g.x,-g.y,-g.z],[g.x,-g.y,-g.z],[g.x,g.y,-g.z],[-g.x,g.y,-g.z],[g.x,-g.y,g.z]],x=0;x<y.length;x++)h.set(y[x][0],y[x][1],y[x][2]),u.vmult(h,h),l.vadd(h,h),p(h.x,h.y,h.z)};var d=[new o,new o,new o,new o,new o,new o,new o,new o];c.prototype.calculateWorldAABB=function(l,u,p,g){var y=this.halfExtents;d[0].set(y.x,y.y,y.z),d[1].set(-y.x,y.y,y.z),d[2].set(-y.x,-y.y,y.z),d[3].set(-y.x,-y.y,-y.z),d[4].set(y.x,-y.y,-y.z),d[5].set(y.x,y.y,-y.z),d[6].set(-y.x,y.y,-y.z),d[7].set(y.x,-y.y,y.z);var x=d[0];u.vmult(x,x),l.vadd(x,x),g.copy(x),p.copy(x);for(var v=1;v<8;v++){var x=d[v];u.vmult(x,x),l.vadd(x,x);var w=x.x,S=x.y,b=x.z;w>g.x&&(g.x=w),S>g.y&&(g.y=S),b>g.z&&(g.z=b),w<p.x&&(p.x=w),S<p.y&&(p.y=S),b<p.z&&(p.z=b)}}},{"../math/Vec3":30,"./ConvexPolyhedron":38,"./Shape":43}],38:[function(t,n,r){n.exports=c;var s=t("./Shape"),o=t("../math/Vec3");t("../math/Quaternion");var a=t("../math/Transform");function c(H,J,K){s.call(this),this.type=s.types.CONVEXPOLYHEDRON,this.vertices=H||[],this.worldVertices=[],this.worldVerticesNeedsUpdate=!0,this.faces=J||[],this.faceNormals=[],this.computeNormals(),this.worldFaceNormalsNeedsUpdate=!0,this.worldFaceNormals=[],this.uniqueEdges=[],this.uniqueAxes=K?K.slice():null,this.computeEdges(),this.updateBoundingSphereRadius()}c.prototype=new s,c.prototype.constructor=c;var h=new o;c.prototype.computeEdges=function(){var H=this.faces,J=this.vertices;J.length;var K=this.uniqueEdges;K.length=0;for(var ee=h,$=0;$!==H.length;$++)for(var Z=H[$],Ee=Z.length,Se=0;Se!==Ee;Se++){var de=(Se+1)%Ee;J[Z[Se]].vsub(J[Z[de]],ee),ee.normalize();for(var he=!1,Ce=0;Ce!==K.length;Ce++)if(K[Ce].almostEquals(ee)||K[Ce].almostEquals(ee)){he=!0;break}he||K.push(ee.clone())}},c.prototype.computeNormals=function(){this.faceNormals.length=this.faces.length;for(var H=0;H<this.faces.length;H++){for(var J=0;J<this.faces[H].length;J++)if(!this.vertices[this.faces[H][J]])throw new Error("Vertex "+this.faces[H][J]+" not found!");var K=this.faceNormals[H]||new o;this.getFaceNormal(H,K),K.negate(K),this.faceNormals[H]=K;var ee=this.vertices[this.faces[H][0]];if(K.dot(ee)<0){console.error(".faceNormals["+H+"] = Vec3("+K.toString()+") looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule.");for(var J=0;J<this.faces[H].length;J++)console.warn(".vertices["+this.faces[H][J]+"] = Vec3("+this.vertices[this.faces[H][J]].toString()+")")}}};var d=new o,l=new o;c.computeNormal=function(H,J,K,ee){J.vsub(H,l),K.vsub(J,d),d.cross(l,ee),ee.isZero()||ee.normalize()},c.prototype.getFaceNormal=function(H,J){var K=this.faces[H],ee=this.vertices[K[0]],$=this.vertices[K[1]],Z=this.vertices[K[2]];return c.computeNormal(ee,$,Z,J)};var u=new o;c.prototype.clipAgainstHull=function(H,J,K,ee,$,Z,Ee,Se,de){for(var he=u,Ce=-1,me=-Number.MAX_VALUE,fe=0;fe<K.faces.length;fe++){he.copy(K.faceNormals[fe]),$.vmult(he,he);var we=he.dot(Z);we>me&&(me=we,Ce=fe)}for(var ye=[],_e=K.faces[Ce],it=_e.length,$e=0;$e<it;$e++){var et=K.vertices[_e[$e]],L=new o;L.copy(et),$.vmult(L,L),ee.vadd(L,L),ye.push(L)}Ce>=0&&this.clipFaceAgainstHull(Z,H,J,ye,Ee,Se,de)};var p=new o,g=new o,y=new o,x=new o,v=new o,w=new o;c.prototype.findSeparatingAxis=function(H,J,K,ee,$,Z,Ee,Se){var de=p,he=g,Ce=y,me=x,fe=v,we=w,ye=Number.MAX_VALUE,_e=this;if(_e.uniqueAxes)for(var $e=0;$e!==_e.uniqueAxes.length;$e++){K.vmult(_e.uniqueAxes[$e],de);var L=_e.testSepAxis(de,H,J,K,ee,$);if(L===!1)return!1;L<ye&&(ye=L,Z.copy(de))}else for(var it=Ee?Ee.length:_e.faces.length,$e=0;$e<it;$e++){var et=Ee?Ee[$e]:$e;de.copy(_e.faceNormals[et]),K.vmult(de,de);var L=_e.testSepAxis(de,H,J,K,ee,$);if(L===!1)return!1;L<ye&&(ye=L,Z.copy(de))}if(H.uniqueAxes)for(var $e=0;$e!==H.uniqueAxes.length;$e++){$.vmult(H.uniqueAxes[$e],he);var L=_e.testSepAxis(he,H,J,K,ee,$);if(L===!1)return!1;L<ye&&(ye=L,Z.copy(he))}else for(var V=Se?Se.length:H.faces.length,$e=0;$e<V;$e++){var et=Se?Se[$e]:$e;he.copy(H.faceNormals[et]),$.vmult(he,he);var L=_e.testSepAxis(he,H,J,K,ee,$);if(L===!1)return!1;L<ye&&(ye=L,Z.copy(he))}for(var P=0;P!==_e.uniqueEdges.length;P++){K.vmult(_e.uniqueEdges[P],me);for(var T=0;T!==H.uniqueEdges.length;T++)if($.vmult(H.uniqueEdges[T],fe),me.cross(fe,we),!we.almostZero()){we.normalize();var q=_e.testSepAxis(we,H,J,K,ee,$);if(q===!1)return!1;q<ye&&(ye=q,Z.copy(we))}}return ee.vsub(J,Ce),Ce.dot(Z)>0&&Z.negate(Z),!0};var S=[],b=[];c.prototype.testSepAxis=function(H,J,K,ee,$,Z){var Ee=this;c.project(Ee,H,K,ee,S),c.project(J,H,$,Z,b);var Se=S[0],de=S[1],he=b[0],Ce=b[1];if(Se<Ce||he<de)return!1;var me=Se-Ce,fe=he-de,we=me<fe?me:fe;return we};var E=new o,R=new o;c.prototype.calculateLocalInertia=function(H,J){this.computeLocalAABB(E,R);var K=R.x-E.x,ee=R.y-E.y,$=R.z-E.z;J.x=1/12*H*(2*ee*2*ee+2*$*2*$),J.y=1/12*H*(2*K*2*K+2*$*2*$),J.z=1/12*H*(2*ee*2*ee+2*K*2*K)},c.prototype.getPlaneConstantOfFace=function(H){var J=this.faces[H],K=this.faceNormals[H],ee=this.vertices[J[0]],$=-K.dot(ee);return $};var z=new o,I=new o,N=new o,F=new o,C=new o,O=new o,X=new o,U=new o;c.prototype.clipFaceAgainstHull=function(H,J,K,ee,$,Z,Ee){for(var Se=z,de=I,he=N,Ce=F,me=C,fe=O,we=X,ye=U,_e=this,it=[],$e=ee,et=it,L=-1,V=Number.MAX_VALUE,P=0;P<_e.faces.length;P++){Se.copy(_e.faceNormals[P]),K.vmult(Se,Se);var T=Se.dot(H);T<V&&(V=T,L=P)}if(!(L<0)){var q=_e.faces[L];q.connectedFaces=[];for(var re=0;re<_e.faces.length;re++)for(var pe=0;pe<_e.faces[re].length;pe++)q.indexOf(_e.faces[re][pe])!==-1&&re!==L&&q.connectedFaces.indexOf(re)===-1&&q.connectedFaces.push(re);$e.length;for(var ge=q.length,be=0;be<ge;be++){var G=_e.vertices[q[be]],Ae=_e.vertices[q[(be+1)%ge]];G.vsub(Ae,de),he.copy(de),K.vmult(he,he),J.vadd(he,he),Ce.copy(this.faceNormals[L]),K.vmult(Ce,Ce),J.vadd(Ce,Ce),he.cross(Ce,me),me.negate(me),fe.copy(G),K.vmult(fe,fe),J.vadd(fe,fe),-fe.dot(me);var oe;{var Fe=q.connectedFaces[be];we.copy(this.faceNormals[Fe]);var Ve=this.getPlaneConstantOfFace(Fe);ye.copy(we),K.vmult(ye,ye);var oe=Ve-ye.dot(J)}for(this.clipFaceAgainstPlane($e,et,ye,oe);$e.length;)$e.shift();for(;et.length;)$e.push(et.shift())}we.copy(this.faceNormals[L]);var Ve=this.getPlaneConstantOfFace(L);ye.copy(we),K.vmult(ye,ye);for(var oe=Ve-ye.dot(J),re=0;re<$e.length;re++){var Ne=ye.dot($e[re])+oe;if(Ne<=$&&(console.log("clamped: depth="+Ne+" to minDist="+($+"")),Ne=$),Ne<=Z){var Je=$e[re];if(Ne<=0){var ae={point:Je,normal:ye,depth:Ne};Ee.push(ae)}}}}},c.prototype.clipFaceAgainstPlane=function(H,J,K,ee){var $,Z,Ee=H.length;if(Ee<2)return J;var Se=H[H.length-1],de=H[0];$=K.dot(Se)+ee;for(var he=0;he<Ee;he++){if(de=H[he],Z=K.dot(de)+ee,$<0)if(Z<0){var Ce=new o;Ce.copy(de),J.push(Ce)}else{var Ce=new o;Se.lerp(de,$/($-Z),Ce),J.push(Ce)}else if(Z<0){var Ce=new o;Se.lerp(de,$/($-Z),Ce),J.push(Ce),J.push(de)}Se=de,$=Z}return J},c.prototype.computeWorldVertices=function(H,J){for(var K=this.vertices.length;this.worldVertices.length<K;)this.worldVertices.push(new o);for(var ee=this.vertices,$=this.worldVertices,Z=0;Z!==K;Z++)J.vmult(ee[Z],$[Z]),H.vadd($[Z],$[Z]);this.worldVerticesNeedsUpdate=!1},new o,c.prototype.computeLocalAABB=function(H,J){var K=this.vertices.length,ee=this.vertices;H.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),J.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(var $=0;$<K;$++){var Z=ee[$];Z.x<H.x?H.x=Z.x:Z.x>J.x&&(J.x=Z.x),Z.y<H.y?H.y=Z.y:Z.y>J.y&&(J.y=Z.y),Z.z<H.z?H.z=Z.z:Z.z>J.z&&(J.z=Z.z)}},c.prototype.computeWorldFaceNormals=function(H){for(var J=this.faceNormals.length;this.worldFaceNormals.length<J;)this.worldFaceNormals.push(new o);for(var K=this.faceNormals,ee=this.worldFaceNormals,$=0;$!==J;$++)H.vmult(K[$],ee[$]);this.worldFaceNormalsNeedsUpdate=!1},c.prototype.updateBoundingSphereRadius=function(){for(var H=0,J=this.vertices,K=0,ee=J.length;K!==ee;K++){var $=J[K].norm2();$>H&&(H=$)}this.boundingSphereRadius=Math.sqrt(H)};var te=new o;c.prototype.calculateWorldAABB=function(H,J,K,ee){for(var $=this.vertices.length,Z=this.vertices,Ee,Se,de,he,Ce,me,fe=0;fe<$;fe++){te.copy(Z[fe]),J.vmult(te,te),H.vadd(te,te);var we=te;we.x<Ee||Ee===void 0?Ee=we.x:(we.x>he||he===void 0)&&(he=we.x),we.y<Se||Se===void 0?Se=we.y:(we.y>Ce||Ce===void 0)&&(Ce=we.y),we.z<de||de===void 0?de=we.z:(we.z>me||me===void 0)&&(me=we.z)}K.set(Ee,Se,de),ee.set(he,Ce,me)},c.prototype.volume=function(){return 4*Math.PI*this.boundingSphereRadius/3},c.prototype.getAveragePointLocal=function(H){H=H||new o;for(var J=this.vertices.length,K=this.vertices,ee=0;ee<J;ee++)H.vadd(K[ee],H);return H.mult(1/J,H),H},c.prototype.transformAllPoints=function(H,J){var K=this.vertices.length,ee=this.vertices;if(J){for(var $=0;$<K;$++){var Z=ee[$];J.vmult(Z,Z)}for(var $=0;$<this.faceNormals.length;$++){var Z=this.faceNormals[$];J.vmult(Z,Z)}}if(H)for(var $=0;$<K;$++){var Z=ee[$];Z.vadd(H,Z)}};var ne=new o,j=new o,k=new o;c.prototype.pointIsInside=function(H){var J=this.vertices.length,K=this.vertices,ee=this.faces,$=this.faceNormals,Z=null,Ee=this.faces.length,Se=ne;this.getAveragePointLocal(Se);for(var de=0;de<Ee;de++){this.faces[de].length;var J=$[de],he=K[ee[de][0]],Ce=j;H.vsub(he,Ce);var me=J.dot(Ce),fe=k;Se.vsub(he,fe);var we=J.dot(fe);if(me<0&&we>0||me>0&&we<0)return!1}return Z?1:-1},new o;var W=new o,Y=new o;c.project=function(H,J,K,ee,$){var Z=H.vertices.length,Ee=W,Se=0,de=0,he=Y,Ce=H.vertices;he.setZero(),a.vectorToLocalFrame(K,ee,J,Ee),a.pointToLocalFrame(K,ee,he,he);var me=he.dot(Ee);de=Se=Ce[0].dot(Ee);for(var fe=1;fe<Z;fe++){var we=Ce[fe].dot(Ee);we>Se&&(Se=we),we<de&&(de=we)}if(de-=me,Se-=me,de>Se){var ye=de;de=Se,Se=ye}$[0]=Se,$[1]=de}},{"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"./Shape":43}],39:[function(t,n,r){n.exports=c;var s=t("./Shape"),o=t("../math/Vec3");t("../math/Quaternion");var a=t("./ConvexPolyhedron");function c(h,d,l,u){var p=u,g=[],y=[],x=[],v=[],w=[],S=Math.cos,b=Math.sin;g.push(new o(d*S(0),d*b(0),-l*.5)),v.push(0),g.push(new o(h*S(0),h*b(0),l*.5)),w.push(1);for(var E=0;E<p;E++){var R=2*Math.PI/p*(E+1),z=2*Math.PI/p*(E+.5);E<p-1?(g.push(new o(d*S(R),d*b(R),-l*.5)),v.push(2*E+2),g.push(new o(h*S(R),h*b(R),l*.5)),w.push(2*E+3),x.push([2*E+2,2*E+3,2*E+1,2*E])):x.push([0,1,2*E+1,2*E]),(p%2===1||E<p/2)&&y.push(new o(S(z),b(z),0))}x.push(w),y.push(new o(0,0,1));for(var I=[],E=0;E<v.length;E++)I.push(v[v.length-E-1]);x.push(I),this.type=s.types.CONVEXPOLYHEDRON,a.call(this,g,x,y)}c.prototype=new a},{"../math/Quaternion":28,"../math/Vec3":30,"./ConvexPolyhedron":38,"./Shape":43}],40:[function(t,n,r){var s=t("./Shape"),o=t("./ConvexPolyhedron"),a=t("../math/Vec3"),c=t("../utils/Utils");n.exports=h;function h(d,l){l=c.defaults(l,{maxValue:null,minValue:null,elementSize:1}),this.data=d,this.maxValue=l.maxValue,this.minValue=l.minValue,this.elementSize=l.elementSize,l.minValue===null&&this.updateMinValue(),l.maxValue===null&&this.updateMaxValue(),this.cacheEnabled=!0,s.call(this),this.pillarConvex=new o,this.pillarOffset=new a,this.type=s.types.HEIGHTFIELD,this.updateBoundingSphereRadius(),this._cachedPillars={}}h.prototype=new s,h.prototype.update=function(){this._cachedPillars={}},h.prototype.updateMinValue=function(){for(var d=this.data,l=d[0][0],u=0;u!==d.length;u++)for(var p=0;p!==d[u].length;p++){var g=d[u][p];g<l&&(l=g)}this.minValue=l},h.prototype.updateMaxValue=function(){for(var d=this.data,l=d[0][0],u=0;u!==d.length;u++)for(var p=0;p!==d[u].length;p++){var g=d[u][p];g>l&&(l=g)}this.maxValue=l},h.prototype.setHeightValueAtIndex=function(d,l,u){var p=this.data;p[d][l]=u,this.clearCachedConvexTrianglePillar(d,l,!1),d>0&&(this.clearCachedConvexTrianglePillar(d-1,l,!0),this.clearCachedConvexTrianglePillar(d-1,l,!1)),l>0&&(this.clearCachedConvexTrianglePillar(d,l-1,!0),this.clearCachedConvexTrianglePillar(d,l-1,!1)),l>0&&d>0&&this.clearCachedConvexTrianglePillar(d-1,l-1,!0)},h.prototype.getRectMinMax=function(d,l,u,p,g){g=g||[];for(var y=this.data,x=this.minValue,v=d;v<=u;v++)for(var w=l;w<=p;w++){var S=y[v][w];S>x&&(x=S)}g[0]=this.minValue,g[1]=x},h.prototype.getIndexOfPosition=function(d,l,u,p){var g=this.elementSize,y=this.data,x=Math.floor(d/g),v=Math.floor(l/g);return u[0]=x,u[1]=v,p&&(x<0&&(x=0),v<0&&(v=0),x>=y.length-1&&(x=y.length-1),v>=y[0].length-1&&(v=y[0].length-1)),!(x<0||v<0||x>=y.length-1||v>=y[0].length-1)},h.prototype.getHeightAt=function(d,l,u){var p=[];this.getIndexOfPosition(d,l,p,u);var g=[];return this.getRectMinMax(p[0],p[1]+1,p[0],p[1]+1,g),(g[0]+g[1])/2},h.prototype.getCacheConvexTrianglePillarKey=function(d,l,u){return d+"_"+l+"_"+(u?1:0)},h.prototype.getCachedConvexTrianglePillar=function(d,l,u){return this._cachedPillars[this.getCacheConvexTrianglePillarKey(d,l,u)]},h.prototype.setCachedConvexTrianglePillar=function(d,l,u,p,g){this._cachedPillars[this.getCacheConvexTrianglePillarKey(d,l,u)]={convex:p,offset:g}},h.prototype.clearCachedConvexTrianglePillar=function(d,l,u){delete this._cachedPillars[this.getCacheConvexTrianglePillarKey(d,l,u)]},h.prototype.getConvexTrianglePillar=function(d,l,u){var p=this.pillarConvex,g=this.pillarOffset;if(this.cacheEnabled){var y=this.getCachedConvexTrianglePillar(d,l,u);if(y){this.pillarConvex=y.convex,this.pillarOffset=y.offset;return}p=new o,g=new a,this.pillarConvex=p,this.pillarOffset=g}var y=this.data,x=this.elementSize,v=p.faces;p.vertices.length=6;for(var w=0;w<6;w++)p.vertices[w]||(p.vertices[w]=new a);v.length=5;for(var w=0;w<5;w++)v[w]||(v[w]=[]);var S=p.vertices,b=(Math.min(y[d][l],y[d+1][l],y[d][l+1],y[d+1][l+1])-this.minValue)/2+this.minValue;u?(g.set((d+.75)*x,(l+.75)*x,b),S[0].set(.25*x,.25*x,y[d+1][l+1]-b),S[1].set(-.75*x,.25*x,y[d][l+1]-b),S[2].set(.25*x,-.75*x,y[d+1][l]-b),S[3].set(.25*x,.25*x,-b-1),S[4].set(-.75*x,.25*x,-b-1),S[5].set(.25*x,-.75*x,-b-1),v[0][0]=0,v[0][1]=1,v[0][2]=2,v[1][0]=5,v[1][1]=4,v[1][2]=3,v[2][0]=2,v[2][1]=5,v[2][2]=3,v[2][3]=0,v[3][0]=3,v[3][1]=4,v[3][2]=1,v[3][3]=0,v[4][0]=1,v[4][1]=4,v[4][2]=5,v[4][3]=2):(g.set((d+.25)*x,(l+.25)*x,b),S[0].set(-.25*x,-.25*x,y[d][l]-b),S[1].set(.75*x,-.25*x,y[d+1][l]-b),S[2].set(-.25*x,.75*x,y[d][l+1]-b),S[3].set(-.25*x,-.25*x,-b-1),S[4].set(.75*x,-.25*x,-b-1),S[5].set(-.25*x,.75*x,-b-1),v[0][0]=0,v[0][1]=1,v[0][2]=2,v[1][0]=5,v[1][1]=4,v[1][2]=3,v[2][0]=0,v[2][1]=2,v[2][2]=5,v[2][3]=3,v[3][0]=1,v[3][1]=0,v[3][2]=3,v[3][3]=4,v[4][0]=4,v[4][1]=5,v[4][2]=2,v[4][3]=1),p.computeNormals(),p.computeEdges(),p.updateBoundingSphereRadius(),this.setCachedConvexTrianglePillar(d,l,u,p,g)},h.prototype.calculateLocalInertia=function(d,l){return l=l||new a,l.set(0,0,0),l},h.prototype.volume=function(){return Number.MAX_VALUE},h.prototype.calculateWorldAABB=function(d,l,u,p){u.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),p.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)},h.prototype.updateBoundingSphereRadius=function(){var d=this.data,l=this.elementSize;this.boundingSphereRadius=new a(d.length*l,d[0].length*l,Math.max(Math.abs(this.maxValue),Math.abs(this.minValue))).norm()}},{"../math/Vec3":30,"../utils/Utils":53,"./ConvexPolyhedron":38,"./Shape":43}],41:[function(t,n,r){n.exports=a;var s=t("./Shape"),o=t("../math/Vec3");function a(){s.call(this),this.type=s.types.PARTICLE}a.prototype=new s,a.prototype.constructor=a,a.prototype.calculateLocalInertia=function(c,h){return h=h||new o,h.set(0,0,0),h},a.prototype.volume=function(){return 0},a.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=0},a.prototype.calculateWorldAABB=function(c,h,d,l){d.copy(c),l.copy(c)}},{"../math/Vec3":30,"./Shape":43}],42:[function(t,n,r){n.exports=a;var s=t("./Shape"),o=t("../math/Vec3");function a(){s.call(this),this.type=s.types.PLANE,this.worldNormal=new o,this.worldNormalNeedsUpdate=!0,this.boundingSphereRadius=Number.MAX_VALUE}a.prototype=new s,a.prototype.constructor=a,a.prototype.computeWorldNormal=function(h){var d=this.worldNormal;d.set(0,0,1),h.vmult(d,d),this.worldNormalNeedsUpdate=!1},a.prototype.calculateLocalInertia=function(h,d){return d=d||new o,d},a.prototype.volume=function(){return Number.MAX_VALUE};var c=new o;a.prototype.calculateWorldAABB=function(h,d,l,u){c.set(0,0,1),d.vmult(c,c);var p=Number.MAX_VALUE;l.set(-p,-p,-p),u.set(p,p,p),c.x===1&&(u.x=h.x),c.y===1&&(u.y=h.y),c.z===1&&(u.z=h.z),c.x===-1&&(l.x=h.x),c.y===-1&&(l.y=h.y),c.z===-1&&(l.z=h.z)},a.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=Number.MAX_VALUE}},{"../math/Vec3":30,"./Shape":43}],43:[function(t,n,r){n.exports=s;var s=t("./Shape");t("../math/Vec3"),t("../math/Quaternion"),t("../material/Material");function s(){this.id=s.idCounter++,this.type=0,this.boundingSphereRadius=0,this.collisionResponse=!0,this.material=null}s.prototype.constructor=s,s.prototype.updateBoundingSphereRadius=function(){throw"computeBoundingSphereRadius() not implemented for shape type "+this.type},s.prototype.volume=function(){throw"volume() not implemented for shape type "+this.type},s.prototype.calculateLocalInertia=function(o,a){throw"calculateLocalInertia() not implemented for shape type "+this.type},s.idCounter=0,s.types={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256}},{"../material/Material":25,"../math/Quaternion":28,"../math/Vec3":30,"./Shape":43}],44:[function(t,n,r){n.exports=a;var s=t("./Shape"),o=t("../math/Vec3");function a(c){if(s.call(this),this.radius=c!==void 0?Number(c):1,this.type=s.types.SPHERE,this.radius<0)throw new Error("The sphere radius cannot be negative.");this.updateBoundingSphereRadius()}a.prototype=new s,a.prototype.constructor=a,a.prototype.calculateLocalInertia=function(c,h){h=h||new o;var d=2*c*this.radius*this.radius/5;return h.x=d,h.y=d,h.z=d,h},a.prototype.volume=function(){return 4*Math.PI*this.radius/3},a.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=this.radius},a.prototype.calculateWorldAABB=function(c,h,d,l){for(var u=this.radius,p=["x","y","z"],g=0;g<p.length;g++){var y=p[g];d[y]=c[y]-u,l[y]=c[y]+u}}},{"../math/Vec3":30,"./Shape":43}],45:[function(t,n,r){n.exports=d;var s=t("./Shape"),o=t("../math/Vec3");t("../math/Quaternion");var a=t("../math/Transform"),c=t("../collision/AABB"),h=t("../utils/Octree");function d(I,N){s.call(this),this.type=s.types.TRIMESH,this.vertices=new Float32Array(I),this.indices=new Int16Array(N),this.normals=new Float32Array(N.length),this.aabb=new c,this.edges=null,this.scale=new o(1,1,1),this.tree=new h,this.updateEdges(),this.updateNormals(),this.updateAABB(),this.updateBoundingSphereRadius(),this.updateTree()}d.prototype=new s,d.prototype.constructor=d;var l=new o;d.prototype.updateTree=function(){var I=this.tree;I.reset(),I.aabb.copy(this.aabb);var N=this.scale;I.aabb.lowerBound.x*=1/N.x,I.aabb.lowerBound.y*=1/N.y,I.aabb.lowerBound.z*=1/N.z,I.aabb.upperBound.x*=1/N.x,I.aabb.upperBound.y*=1/N.y,I.aabb.upperBound.z*=1/N.z;for(var F=new c,C=new o,O=new o,X=new o,U=[C,O,X],te=0;te<this.indices.length/3;te++){var ne=te*3;this._getUnscaledVertex(this.indices[ne],C),this._getUnscaledVertex(this.indices[ne+1],O),this._getUnscaledVertex(this.indices[ne+2],X),F.setFromPoints(U),I.insert(F,te)}I.removeEmptyNodes()};var u=new c;d.prototype.getTrianglesInAABB=function(I,N){u.copy(I);var F=this.scale,C=F.x,O=F.y,X=F.z,U=u.lowerBound,te=u.upperBound;return U.x/=C,U.y/=O,U.z/=X,te.x/=C,te.y/=O,te.z/=X,this.tree.aabbQuery(u,N)},d.prototype.setScale=function(I){var N=this.scale.x===this.scale.y===this.scale.z,F=I.x===I.y===I.z;N&&F||this.updateNormals(),this.scale.copy(I),this.updateAABB(),this.updateBoundingSphereRadius()},d.prototype.updateNormals=function(){for(var I=l,N=this.normals,F=0;F<this.indices.length/3;F++){var C=F*3,O=this.indices[C],X=this.indices[C+1],U=this.indices[C+2];this.getVertex(O,v),this.getVertex(X,w),this.getVertex(U,S),d.computeNormal(w,v,S,I),N[C]=I.x,N[C+1]=I.y,N[C+2]=I.z}},d.prototype.updateEdges=function(){for(var I={},N=function(ne,j){var k=O<X?O+"_"+X:X+"_"+O;I[k]=!0},F=0;F<this.indices.length/3;F++){var C=F*3,O=this.indices[C],X=this.indices[C+1];this.indices[C+2],N(),N(),N()}var U=Object.keys(I);this.edges=new Int16Array(U.length*2);for(var F=0;F<U.length;F++){var te=U[F].split("_");this.edges[2*F]=parseInt(te[0],10),this.edges[2*F+1]=parseInt(te[1],10)}},d.prototype.getEdgeVertex=function(I,N,F){var C=this.edges[I*2+(N?1:0)];this.getVertex(C,F)};var p=new o,g=new o;d.prototype.getEdgeVector=function(I,N){var F=p,C=g;this.getEdgeVertex(I,0,F),this.getEdgeVertex(I,1,C),C.vsub(F,N)};var y=new o,x=new o;d.computeNormal=function(I,N,F,C){N.vsub(I,x),F.vsub(N,y),y.cross(x,C),C.isZero()||C.normalize()};var v=new o,w=new o,S=new o;d.prototype.getVertex=function(I,N){var F=this.scale;return this._getUnscaledVertex(I,N),N.x*=F.x,N.y*=F.y,N.z*=F.z,N},d.prototype._getUnscaledVertex=function(I,N){var F=I*3,C=this.vertices;return N.set(C[F],C[F+1],C[F+2])},d.prototype.getWorldVertex=function(I,N,F,C){return this.getVertex(I,C),a.pointToWorldFrame(N,F,C,C),C},d.prototype.getTriangleVertices=function(I,N,F,C){var O=I*3;this.getVertex(this.indices[O],N),this.getVertex(this.indices[O+1],F),this.getVertex(this.indices[O+2],C)},d.prototype.getNormal=function(I,N){var F=I*3;return N.set(this.normals[F],this.normals[F+1],this.normals[F+2])};var b=new c;d.prototype.calculateLocalInertia=function(I,N){this.computeLocalAABB(b);var F=b.upperBound.x-b.lowerBound.x,C=b.upperBound.y-b.lowerBound.y,O=b.upperBound.z-b.lowerBound.z;return N.set(1/12*I*(2*C*2*C+2*O*2*O),1/12*I*(2*F*2*F+2*O*2*O),1/12*I*(2*C*2*C+2*F*2*F))};var E=new o;d.prototype.computeLocalAABB=function(I){var N=I.lowerBound,F=I.upperBound,C=this.vertices.length;this.vertices;var O=E;this.getVertex(0,O),N.copy(O),F.copy(O);for(var X=0;X!==C;X++)this.getVertex(X,O),O.x<N.x?N.x=O.x:O.x>F.x&&(F.x=O.x),O.y<N.y?N.y=O.y:O.y>F.y&&(F.y=O.y),O.z<N.z?N.z=O.z:O.z>F.z&&(F.z=O.z)},d.prototype.updateAABB=function(){this.computeLocalAABB(this.aabb)},d.prototype.updateBoundingSphereRadius=function(){for(var I=0,N=this.vertices,F=new o,C=0,O=N.length/3;C!==O;C++){this.getVertex(C,F);var X=F.norm2();X>I&&(I=X)}this.boundingSphereRadius=Math.sqrt(I)},new o;var R=new a,z=new c;d.prototype.calculateWorldAABB=function(I,N,F,C){var O=R,X=z;O.position=I,O.quaternion=N,this.aabb.toWorldFrame(O,X),F.copy(X.lowerBound),C.copy(X.upperBound)},d.prototype.volume=function(){return 4*Math.PI*this.boundingSphereRadius/3},d.createTorus=function(I,N,F,C,O){I=I||1,N=N||.5,F=F||8,C=C||6,O=O||Math.PI*2;for(var X=[],U=[],te=0;te<=F;te++)for(var ne=0;ne<=C;ne++){var j=ne/C*O,k=te/F*Math.PI*2,W=(I+N*Math.cos(k))*Math.cos(j),Y=(I+N*Math.cos(k))*Math.sin(j),H=N*Math.sin(k);X.push(W,Y,H)}for(var te=1;te<=F;te++)for(var ne=1;ne<=C;ne++){var J=(C+1)*te+ne-1,K=(C+1)*(te-1)+ne-1,ee=(C+1)*(te-1)+ne,$=(C+1)*te+ne;U.push(J,K,$),U.push(K,ee,$)}return new d(X,U)}},{"../collision/AABB":3,"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"../utils/Octree":50,"./Shape":43}],46:[function(t,n,r){n.exports=o,t("../math/Vec3"),t("../math/Quaternion");var s=t("./Solver");function o(){s.call(this),this.iterations=10,this.tolerance=1e-7}o.prototype=new s;var a=[],c=[],h=[];o.prototype.solve=function(d,l){var u=0,p=this.iterations,g=this.tolerance*this.tolerance,y=this.equations,x=y.length,v=l.bodies,w=v.length,S=d,b,E,R,z,I,N;if(x!==0)for(var F=0;F!==w;F++)v[F].updateSolveMassProperties();var C=c,O=h,X=a;C.length=x,O.length=x,X.length=x;for(var F=0;F!==x;F++){var U=y[F];X[F]=0,O[F]=U.computeB(S),C[F]=1/U.computeC()}if(x!==0){for(var F=0;F!==w;F++){var te=v[F],ne=te.vlambda,j=te.wlambda;ne.set(0,0,0),j&&j.set(0,0,0)}for(u=0;u!==p;u++){z=0;for(var k=0;k!==x;k++){var U=y[k];b=O[k],E=C[k],N=X[k],I=U.computeGWlambda(),R=E*(b-I-U.eps*N),N+R<U.minForce?R=U.minForce-N:N+R>U.maxForce&&(R=U.maxForce-N),X[k]+=R,z+=R>0?R:-R,U.addToWlambda(R)}if(z*z<g)break}for(var F=0;F!==w;F++){var te=v[F],W=te.velocity,Y=te.angularVelocity;W.vadd(te.vlambda,W),Y&&Y.vadd(te.wlambda,Y)}}return u}},{"../math/Quaternion":28,"../math/Vec3":30,"./Solver":47}],47:[function(t,n,r){n.exports=s;function s(){this.equations=[]}s.prototype.solve=function(o,a){return 0},s.prototype.addEquation=function(o){o.enabled&&this.equations.push(o)},s.prototype.removeEquation=function(o){var a=this.equations,c=a.indexOf(o);c!==-1&&a.splice(c,1)},s.prototype.removeAllEquations=function(){this.equations.length=0}},{}],48:[function(t,n,r){n.exports=a,t("../math/Vec3"),t("../math/Quaternion");var s=t("./Solver"),o=t("../objects/Body");function a(v){for(s.call(this),this.iterations=10,this.tolerance=1e-7,this.subsolver=v,this.nodes=[],this.nodePool=[];this.nodePool.length<128;)this.nodePool.push(this.createNode())}a.prototype=new s;var c=[],h=[],d={bodies:[]},l=o.STATIC;function u(v){for(var w=v.length,S=0;S!==w;S++){var b=v[S];if(!b.visited&&!(b.body.type&l))return b}return!1}var p=[];function g(v,w,S,b){for(p.push(v),v.visited=!0,w(v,S,b);p.length;)for(var E=p.pop(),R;R=u(E.children);)R.visited=!0,w(R,S,b),p.push(R)}function y(v,w,S){w.push(v.body);for(var b=v.eqs.length,E=0;E!==b;E++){var R=v.eqs[E];S.indexOf(R)===-1&&S.push(R)}}a.prototype.createNode=function(){return{body:null,children:[],eqs:[],visited:!1}},a.prototype.solve=function(v,w){for(var S=c,b=this.nodePool,E=w.bodies,R=this.equations,z=R.length,I=E.length,N=this.subsolver;b.length<I;)b.push(this.createNode());S.length=I;for(var F=0;F<I;F++)S[F]=b[F];for(var F=0;F!==I;F++){var C=S[F];C.body=E[F],C.children.length=0,C.eqs.length=0,C.visited=!1}for(var O=0;O!==z;O++){var X=R[O],F=E.indexOf(X.bi),U=E.indexOf(X.bj),te=S[F],ne=S[U];te.children.push(ne),te.eqs.push(X),ne.children.push(te),ne.eqs.push(X)}var j,k=0,W=h;N.tolerance=this.tolerance,N.iterations=this.iterations;for(var Y=d;j=u(S);){W.length=0,Y.bodies.length=0,g(j,y,Y.bodies,W);var H=W.length;W=W.sort(x);for(var F=0;F!==H;F++)N.addEquation(W[F]);N.solve(v,Y),N.removeAllEquations(),k++}return k};function x(v,w){return w.id-v.id}},{"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"./Solver":47}],49:[function(t,n,r){var s=function(){};n.exports=s,s.prototype={constructor:s,addEventListener:function(o,a){this._listeners===void 0&&(this._listeners={});var c=this._listeners;return c[o]===void 0&&(c[o]=[]),c[o].indexOf(a)===-1&&c[o].push(a),this},hasEventListener:function(o,a){if(this._listeners===void 0)return!1;var c=this._listeners;return c[o]!==void 0&&c[o].indexOf(a)!==-1},removeEventListener:function(o,a){if(this._listeners===void 0)return this;var c=this._listeners;if(c[o]===void 0)return this;var h=c[o].indexOf(a);return h!==-1&&c[o].splice(h,1),this},dispatchEvent:function(o){if(this._listeners===void 0)return this;var a=this._listeners,c=a[o.type];if(c!==void 0){o.target=this;for(var h=0,d=c.length;h<d;h++)c[h].call(this,o)}return this}}},{}],50:[function(t,n,r){var s=t("../collision/AABB"),o=t("../math/Vec3");n.exports=c;function a(l){l=l||{},this.root=l.root||null,this.aabb=l.aabb?l.aabb.clone():new s,this.data=[],this.children=[]}function c(l,u){u=u||{},u.root=null,u.aabb=l,a.call(this,u),this.maxDepth=typeof u.maxDepth!="undefined"?u.maxDepth:8}c.prototype=new a,a.prototype.reset=function(l,u){this.children.length=this.data.length=0},a.prototype.insert=function(l,u,p){var g=this.data;if(p=p||0,!this.aabb.contains(l))return!1;var y=this.children;if(p<(this.maxDepth||this.root.maxDepth)){var x=!1;y.length||(this.subdivide(),x=!0);for(var v=0;v!==8;v++)if(y[v].insert(l,u,p+1))return!0;x&&(y.length=0)}return g.push(u),!0};var h=new o;a.prototype.subdivide=function(){var l=this.aabb,u=l.lowerBound,p=l.upperBound,g=this.children;g.push(new a({aabb:new s({lowerBound:new o(0,0,0)})}),new a({aabb:new s({lowerBound:new o(1,0,0)})}),new a({aabb:new s({lowerBound:new o(1,1,0)})}),new a({aabb:new s({lowerBound:new o(1,1,1)})}),new a({aabb:new s({lowerBound:new o(0,1,1)})}),new a({aabb:new s({lowerBound:new o(0,0,1)})}),new a({aabb:new s({lowerBound:new o(1,0,1)})}),new a({aabb:new s({lowerBound:new o(0,1,0)})})),p.vsub(u,h),h.scale(.5,h);for(var y=this.root||this,x=0;x!==8;x++){var v=g[x];v.root=y;var w=v.aabb.lowerBound;w.x*=h.x,w.y*=h.y,w.z*=h.z,w.vadd(u,w),w.vadd(h,v.aabb.upperBound)}},a.prototype.aabbQuery=function(l,u){this.data,this.children;for(var p=[this];p.length;){var g=p.pop();g.aabb.overlaps(l)&&Array.prototype.push.apply(u,g.data),Array.prototype.push.apply(p,g.children)}return u};var d=new s;a.prototype.rayQuery=function(l,u,p){return l.getAABB(d),d.toLocalFrame(u,d),this.aabbQuery(d,p),p},a.prototype.removeEmptyNodes=function(){for(var l=[this];l.length;){for(var u=l.pop(),p=u.children.length-1;p>=0;p--)u.children[p].data.length||u.children.splice(p,1);Array.prototype.push.apply(l,u.children)}}},{"../collision/AABB":3,"../math/Vec3":30}],51:[function(t,n,r){n.exports=s;function s(){this.objects=[],this.type=Object}s.prototype.release=function(){for(var o=arguments.length,a=0;a!==o;a++)this.objects.push(arguments[a])},s.prototype.get=function(){return this.objects.length===0?this.constructObject():this.objects.pop()},s.prototype.constructObject=function(){throw new Error("constructObject() not implemented in this Pool subclass yet!")}},{}],52:[function(t,n,r){n.exports=s;function s(){this.data={keys:[]}}s.prototype.get=function(o,a){if(o>a){var c=a;a=o,o=c}return this.data[o+"-"+a]},s.prototype.set=function(o,a,c){if(o>a){var h=a;a=o,o=h}var d=o+"-"+a;this.get(o,a)||this.data.keys.push(d),this.data[d]=c},s.prototype.reset=function(){for(var o=this.data,a=o.keys;a.length>0;){var c=a.pop();delete o[c]}}},{}],53:[function(t,n,r){function s(){}n.exports=s,s.defaults=function(o,a){o=o||{};for(var c in a)c in o||(o[c]=a[c]);return o}},{}],54:[function(t,n,r){n.exports=a;var s=t("../math/Vec3"),o=t("./Pool");function a(){o.call(this),this.type=s}a.prototype=new o,a.prototype.constructObject=function(){return new s}},{"../math/Vec3":30,"./Pool":51}],55:[function(t,n,r){n.exports=g;var s=t("../collision/AABB"),o=t("../shapes/Shape"),a=t("../collision/Ray"),c=t("../math/Vec3"),h=t("../math/Transform");t("../shapes/ConvexPolyhedron");var d=t("../math/Quaternion");t("../solver/Solver");var l=t("../utils/Vec3Pool"),u=t("../equations/ContactEquation"),p=t("../equations/FrictionEquation");function g(Le){this.contactPointPool=[],this.frictionEquationPool=[],this.result=[],this.frictionResult=[],this.v3pool=new l,this.world=Le,this.currentContactMaterial=null,this.enableFrictionReduction=!1}g.prototype.createContactEquation=function(Le,Be,Qe,Ke,Q,le){var ue;this.contactPointPool.length?(ue=this.contactPointPool.pop(),ue.bi=Le,ue.bj=Be):ue=new u(Le,Be),ue.enabled=Le.collisionResponse&&Be.collisionResponse&&Qe.collisionResponse&&Ke.collisionResponse;var ce=this.currentContactMaterial;ue.restitution=ce.restitution,ue.setSpookParams(ce.contactEquationStiffness,ce.contactEquationRelaxation,this.world.dt);var ie=Qe.material||Le.material,Ie=Ke.material||Be.material;return ie&&Ie&&ie.restitution>=0&&Ie.restitution>=0&&(ue.restitution=ie.restitution*Ie.restitution),ue.si=Q||Qe,ue.sj=le||Ke,ue},g.prototype.createFrictionEquationsFromContact=function(Le,Be){var Qe=Le.bi,Ke=Le.bj,Q=Le.si,le=Le.sj,ue=this.world,ce=this.currentContactMaterial,ie=ce.friction,Ie=Q.material||Qe.material,Ue=le.material||Ke.material;if(Ie&&Ue&&Ie.friction>=0&&Ue.friction>=0&&(ie=Ie.friction*Ue.friction),ie>0){var Ye=ie*ue.gravity.length(),Oe=Qe.invMass+Ke.invMass;Oe>0&&(Oe=1/Oe);var He=this.frictionEquationPool,We=He.length?He.pop():new p(Qe,Ke,Ye*Oe),nt=He.length?He.pop():new p(Qe,Ke,Ye*Oe);return We.bi=nt.bi=Qe,We.bj=nt.bj=Ke,We.minForce=nt.minForce=-Ye*Oe,We.maxForce=nt.maxForce=Ye*Oe,We.ri.copy(Le.ri),We.rj.copy(Le.rj),nt.ri.copy(Le.ri),nt.rj.copy(Le.rj),Le.ni.tangents(We.t,nt.t),We.setSpookParams(ce.frictionEquationStiffness,ce.frictionEquationRelaxation,ue.dt),nt.setSpookParams(ce.frictionEquationStiffness,ce.frictionEquationRelaxation,ue.dt),We.enabled=nt.enabled=Le.enabled,Be.push(We,nt),!0}return!1};var y=new c,x=new c,v=new c;g.prototype.createFrictionFromAverage=function(Le){var Be=this.result[this.result.length-1];if(!(!this.createFrictionEquationsFromContact(Be,this.frictionResult)||Le===1)){var Qe=this.frictionResult[this.frictionResult.length-2],Ke=this.frictionResult[this.frictionResult.length-1];y.setZero(),x.setZero(),v.setZero();var Q=Be.bi;Be.bj;for(var le=0;le!==Le;le++)Be=this.result[this.result.length-1-le],Be.bodyA!==Q?(y.vadd(Be.ni,y),x.vadd(Be.ri,x),v.vadd(Be.rj,v)):(y.vsub(Be.ni,y),x.vadd(Be.rj,x),v.vadd(Be.ri,v));var ue=1/Le;x.scale(ue,Qe.ri),v.scale(ue,Qe.rj),Ke.ri.copy(Qe.ri),Ke.rj.copy(Qe.rj),y.normalize(),y.tangents(Qe.t,Ke.t)}};var w=new c,S=new c,b=new d,E=new d;g.prototype.getContacts=function(Le,Be,Qe,Ke,Q,le,ue){this.contactPointPool=Q,this.frictionEquationPool=ue,this.result=Ke,this.frictionResult=le;for(var ce=b,ie=E,Ie=w,Ue=S,Ye=0,Oe=Le.length;Ye!==Oe;Ye++){var He=Le[Ye],We=Be[Ye],nt=null;He.material&&We.material&&(nt=Qe.getContactMaterial(He.material,We.material)||null);for(var pt=0;pt<He.shapes.length;pt++){He.quaternion.mult(He.shapeOrientations[pt],ce),He.quaternion.vmult(He.shapeOffsets[pt],Ie),Ie.vadd(He.position,Ie);for(var Ze=He.shapes[pt],Tt=0;Tt<We.shapes.length;Tt++){We.quaternion.mult(We.shapeOrientations[Tt],ie),We.quaternion.vmult(We.shapeOffsets[Tt],Ue),Ue.vadd(We.position,Ue);var Rt=We.shapes[Tt];if(!(Ie.distanceTo(Ue)>Ze.boundingSphereRadius+Rt.boundingSphereRadius)){var Qt=null;Ze.material&&Rt.material&&(Qt=Qe.getContactMaterial(Ze.material,Rt.material)||null),this.currentContactMaterial=Qt||nt||Qe.defaultContactMaterial;var dt=this[Ze.type|Rt.type];dt&&(Ze.type<Rt.type?dt.call(this,Ze,Rt,Ie,Ue,ce,ie,He,We,Ze,Rt):dt.call(this,Rt,Ze,Ue,Ie,ie,ce,We,He,Ze,Rt))}}}}},g.prototype[o.types.BOX|o.types.BOX]=g.prototype.boxBox=function(Le,Be,Qe,Ke,Q,le,ue,ce){Le.convexPolyhedronRepresentation.material=Le.material,Be.convexPolyhedronRepresentation.material=Be.material,Le.convexPolyhedronRepresentation.collisionResponse=Le.collisionResponse,Be.convexPolyhedronRepresentation.collisionResponse=Be.collisionResponse,this.convexConvex(Le.convexPolyhedronRepresentation,Be.convexPolyhedronRepresentation,Qe,Ke,Q,le,ue,ce,Le,Be)},g.prototype[o.types.BOX|o.types.CONVEXPOLYHEDRON]=g.prototype.boxConvex=function(Le,Be,Qe,Ke,Q,le,ue,ce){Le.convexPolyhedronRepresentation.material=Le.material,Le.convexPolyhedronRepresentation.collisionResponse=Le.collisionResponse,this.convexConvex(Le.convexPolyhedronRepresentation,Be,Qe,Ke,Q,le,ue,ce,Le,Be)},g.prototype[o.types.BOX|o.types.PARTICLE]=g.prototype.boxParticle=function(Le,Be,Qe,Ke,Q,le,ue,ce){Le.convexPolyhedronRepresentation.material=Le.material,Le.convexPolyhedronRepresentation.collisionResponse=Le.collisionResponse,this.convexParticle(Le.convexPolyhedronRepresentation,Be,Qe,Ke,Q,le,ue,ce,Le,Be)},g.prototype[o.types.SPHERE]=g.prototype.sphereSphere=function(Le,Be,Qe,Ke,Q,le,ue,ce){var ie=this.createContactEquation(ue,ce,Le,Be);Ke.vsub(Qe,ie.ni),ie.ni.normalize(),ie.ri.copy(ie.ni),ie.rj.copy(ie.ni),ie.ri.mult(Le.radius,ie.ri),ie.rj.mult(-Be.radius,ie.rj),ie.ri.vadd(Qe,ie.ri),ie.ri.vsub(ue.position,ie.ri),ie.rj.vadd(Ke,ie.rj),ie.rj.vsub(ce.position,ie.rj),this.result.push(ie),this.createFrictionEquationsFromContact(ie,this.frictionResult)};var R=new c,z=new c,I=new c;g.prototype[o.types.PLANE|o.types.TRIMESH]=g.prototype.planeTrimesh=function(Le,Be,Qe,Ke,Q,le,ue,ce){var ie=new c,Ie=R;Ie.set(0,0,1),Q.vmult(Ie,Ie);for(var Ue=0;Ue<Be.vertices.length/3;Ue++){Be.getVertex(Ue,ie);var Ye=new c;Ye.copy(ie),h.pointToWorldFrame(Ke,le,Ye,ie);var Oe=z;ie.vsub(Qe,Oe);var He=Ie.dot(Oe);if(He<=0){var We=this.createContactEquation(ue,ce,Le,Be);We.ni.copy(Ie);var nt=I;Ie.scale(Oe.dot(Ie),nt),ie.vsub(nt,nt),We.ri.copy(nt),We.ri.vsub(ue.position,We.ri),We.rj.copy(ie),We.rj.vsub(ce.position,We.rj),this.result.push(We),this.createFrictionEquationsFromContact(We,this.frictionResult)}}};var N=new c,F=new c;new c;var C=new c,O=new c,X=new c,U=new c,te=new c,ne=new c,j=new c,k=new c,W=new c,Y=new c,H=new c,J=new s,K=[];g.prototype[o.types.SPHERE|o.types.TRIMESH]=g.prototype.sphereTrimesh=function(Le,Be,Qe,Ke,Q,le,ue,ce){var ie=X,Ie=U,Ue=te,Ye=ne,Oe=j,He=k,We=J,nt=O,pt=F,Ze=K;h.pointToLocalFrame(Ke,le,Qe,Oe);var Tt=Le.radius;We.lowerBound.set(Oe.x-Tt,Oe.y-Tt,Oe.z-Tt),We.upperBound.set(Oe.x+Tt,Oe.y+Tt,Oe.z+Tt),Be.getTrianglesInAABB(We,Ze);for(var Rt=C,Qt=Le.radius*Le.radius,dt=0;dt<Ze.length;dt++)for(var Lt=0;Lt<3;Lt++)if(Be.getVertex(Be.indices[Ze[dt]*3+Lt],Rt),Rt.vsub(Oe,pt),pt.norm2()<=Qt){nt.copy(Rt),h.pointToWorldFrame(Ke,le,nt,Rt),Rt.vsub(Qe,pt);var at=this.createContactEquation(ue,ce,Le,Be);at.ni.copy(pt),at.ni.normalize(),at.ri.copy(at.ni),at.ri.scale(Le.radius,at.ri),at.ri.vadd(Qe,at.ri),at.ri.vsub(ue.position,at.ri),at.rj.copy(Rt),at.rj.vsub(ce.position,at.rj),this.result.push(at),this.createFrictionEquationsFromContact(at,this.frictionResult)}for(var dt=0;dt<Ze.length;dt++)for(var Lt=0;Lt<3;Lt++){Be.getVertex(Be.indices[Ze[dt]*3+Lt],ie),Be.getVertex(Be.indices[Ze[dt]*3+(Lt+1)%3],Ie),Ie.vsub(ie,Ue),Oe.vsub(Ie,He);var fn=He.dot(Ue);Oe.vsub(ie,He);var wn=He.dot(Ue);if(wn>0&&fn<0){Oe.vsub(ie,He),Ye.copy(Ue),Ye.normalize(),wn=He.dot(Ye),Ye.scale(wn,He),He.vadd(ie,He);var Hn=He.distanceTo(Oe);if(Hn<Le.radius){var at=this.createContactEquation(ue,ce,Le,Be);He.vsub(Oe,at.ni),at.ni.normalize(),at.ni.scale(Le.radius,at.ri),h.pointToWorldFrame(Ke,le,He,He),He.vsub(ce.position,at.rj),h.vectorToWorldFrame(le,at.ni,at.ni),h.vectorToWorldFrame(le,at.ri,at.ri),this.result.push(at),this.createFrictionEquationsFromContact(at,this.frictionResult)}}}for(var Ci=W,Vt=Y,Dt=H,Nt=N,dt=0,yt=Ze.length;dt!==yt;dt++){Be.getTriangleVertices(Ze[dt],Ci,Vt,Dt),Be.getNormal(Ze[dt],Nt),Oe.vsub(Ci,He);var Hn=He.dot(Nt);if(Nt.scale(Hn,He),Oe.vsub(He,He),Hn=He.distanceTo(Oe),a.pointInTriangle(He,Ci,Vt,Dt)&&Hn<Le.radius){var at=this.createContactEquation(ue,ce,Le,Be);He.vsub(Oe,at.ni),at.ni.normalize(),at.ni.scale(Le.radius,at.ri),h.pointToWorldFrame(Ke,le,He,He),He.vsub(ce.position,at.rj),h.vectorToWorldFrame(le,at.ni,at.ni),h.vectorToWorldFrame(le,at.ri,at.ri),this.result.push(at),this.createFrictionEquationsFromContact(at,this.frictionResult)}}Ze.length=0};var ee=new c,$=new c;g.prototype[o.types.SPHERE|o.types.PLANE]=g.prototype.spherePlane=function(Le,Be,Qe,Ke,Q,le,ue,ce){var ie=this.createContactEquation(ue,ce,Le,Be);if(ie.ni.set(0,0,1),le.vmult(ie.ni,ie.ni),ie.ni.negate(ie.ni),ie.ni.normalize(),ie.ni.mult(Le.radius,ie.ri),Qe.vsub(Ke,ee),ie.ni.mult(ie.ni.dot(ee),$),ee.vsub($,ie.rj),-ee.dot(ie.ni)<=Le.radius){var Ie=ie.ri,Ue=ie.rj;Ie.vadd(Qe,Ie),Ie.vsub(ue.position,Ie),Ue.vadd(Ke,Ue),Ue.vsub(ce.position,Ue),this.result.push(ie),this.createFrictionEquationsFromContact(ie,this.frictionResult)}};var Z=new c,Ee=new c,Se=new c;function de(Le,Be,Qe){for(var Ke=null,Q=Le.length,le=0;le!==Q;le++){var ue=Le[le],ce=Z;Le[(le+1)%Q].vsub(ue,ce);var ie=Ee;ce.cross(Be,ie);var Ie=Se;Qe.vsub(ue,Ie);var Ue=ie.dot(Ie);if(Ke===null||Ue>0&&Ke===!0||Ue<=0&&Ke===!1){Ke===null&&(Ke=Ue>0);continue}else return!1}return!0}var he=new c,Ce=new c,me=new c,fe=new c,we=[new c,new c,new c,new c,new c,new c],ye=new c,_e=new c,it=new c,$e=new c;g.prototype[o.types.SPHERE|o.types.BOX]=g.prototype.sphereBox=function(Le,Be,Qe,Ke,Q,le,ue,ce){var ie=this.v3pool,Ie=we;Qe.vsub(Ke,he),Be.getSideNormals(Ie,le);for(var Ue=Le.radius,Ye=!1,Oe=_e,He=it,We=$e,nt=null,pt=0,Ze=0,Tt=0,Rt=null,Qt=0,dt=Ie.length;Qt!==dt&&Ye===!1;Qt++){var Lt=Ce;Lt.copy(Ie[Qt]);var at=Lt.norm();Lt.normalize();var fn=he.dot(Lt);if(fn<at+Ue&&fn>0){var wn=me,Hn=fe;wn.copy(Ie[(Qt+1)%3]),Hn.copy(Ie[(Qt+2)%3]);var Ci=wn.norm(),Vt=Hn.norm();wn.normalize(),Hn.normalize();var Dt=he.dot(wn),Nt=he.dot(Hn);if(Dt<Ci&&Dt>-Ci&&Nt<Vt&&Nt>-Vt){var qn=Math.abs(fn-at-Ue);(Rt===null||qn<Rt)&&(Rt=qn,Ze=Dt,Tt=Nt,nt=at,Oe.copy(Lt),He.copy(wn),We.copy(Hn),pt++)}}}if(pt){Ye=!0;var At=this.createContactEquation(ue,ce,Le,Be);Oe.mult(-Ue,At.ri),At.ni.copy(Oe),At.ni.negate(At.ni),Oe.mult(nt,Oe),He.mult(Ze,He),Oe.vadd(He,Oe),We.mult(Tt,We),Oe.vadd(We,At.rj),At.ri.vadd(Qe,At.ri),At.ri.vsub(ue.position,At.ri),At.rj.vadd(Ke,At.rj),At.rj.vsub(ce.position,At.rj),this.result.push(At),this.createFrictionEquationsFromContact(At,this.frictionResult)}for(var yt=ie.get(),pi=ye,on=0;on!==2&&!Ye;on++)for(var an=0;an!==2&&!Ye;an++)for(var _n=0;_n!==2&&!Ye;_n++)if(yt.set(0,0,0),on?yt.vadd(Ie[0],yt):yt.vsub(Ie[0],yt),an?yt.vadd(Ie[1],yt):yt.vsub(Ie[1],yt),_n?yt.vadd(Ie[2],yt):yt.vsub(Ie[2],yt),Ke.vadd(yt,pi),pi.vsub(Qe,pi),pi.norm2()<Ue*Ue){Ye=!0;var At=this.createContactEquation(ue,ce,Le,Be);At.ri.copy(pi),At.ri.normalize(),At.ni.copy(At.ri),At.ri.mult(Ue,At.ri),At.rj.copy(yt),At.ri.vadd(Qe,At.ri),At.ri.vsub(ue.position,At.ri),At.rj.vadd(Ke,At.rj),At.rj.vsub(ce.position,At.rj),this.result.push(At),this.createFrictionEquationsFromContact(At,this.frictionResult)}ie.release(yt),yt=null;for(var li=ie.get(),Pn=ie.get(),At=ie.get(),Fi=ie.get(),qn=ie.get(),Or=Ie.length,on=0;on!==Or&&!Ye;on++)for(var an=0;an!==Or&&!Ye;an++)if(on%3!==an%3){Ie[an].cross(Ie[on],li),li.normalize(),Ie[on].vadd(Ie[an],Pn),At.copy(Qe),At.vsub(Pn,At),At.vsub(Ke,At);var Ls=At.dot(li);li.mult(Ls,Fi);for(var _n=0;_n===on%3||_n===an%3;)_n++;qn.copy(Qe),qn.vsub(Fi,qn),qn.vsub(Pn,qn),qn.vsub(Ke,qn);var yr=Math.abs(Ls),Lv=qn.norm();if(yr<Ie[_n].norm()&&Lv<Ue){Ye=!0;var gn=this.createContactEquation(ue,ce,Le,Be);Pn.vadd(Fi,gn.rj),gn.rj.copy(gn.rj),qn.negate(gn.ni),gn.ni.normalize(),gn.ri.copy(gn.rj),gn.ri.vadd(Ke,gn.ri),gn.ri.vsub(Qe,gn.ri),gn.ri.normalize(),gn.ri.mult(Ue,gn.ri),gn.ri.vadd(Qe,gn.ri),gn.ri.vsub(ue.position,gn.ri),gn.rj.vadd(Ke,gn.rj),gn.rj.vsub(ce.position,gn.rj),this.result.push(gn),this.createFrictionEquationsFromContact(gn,this.frictionResult)}}ie.release(li,Pn,At,Fi,qn)};var et=new c,L=new c,V=new c,P=new c,T=new c,q=new c,re=new c,pe=new c,ge=new c,be=new c;g.prototype[o.types.SPHERE|o.types.CONVEXPOLYHEDRON]=g.prototype.sphereConvex=function(Le,Be,Qe,Ke,Q,le,ue,ce){var ie=this.v3pool;Qe.vsub(Ke,et);for(var Ie=Be.faceNormals,Ue=Be.faces,Ye=Be.vertices,Oe=Le.radius,He=0;He!==Ye.length;He++){var We=Ye[He],nt=T;le.vmult(We,nt),Ke.vadd(nt,nt);var pt=P;if(nt.vsub(Qe,pt),pt.norm2()<Oe*Oe){Tt=!0;var Ze=this.createContactEquation(ue,ce,Le,Be);Ze.ri.copy(pt),Ze.ri.normalize(),Ze.ni.copy(Ze.ri),Ze.ri.mult(Oe,Ze.ri),nt.vsub(Ke,Ze.rj),Ze.ri.vadd(Qe,Ze.ri),Ze.ri.vsub(ue.position,Ze.ri),Ze.rj.vadd(Ke,Ze.rj),Ze.rj.vsub(ce.position,Ze.rj),this.result.push(Ze),this.createFrictionEquationsFromContact(Ze,this.frictionResult);return}}for(var Tt=!1,He=0,Rt=Ue.length;He!==Rt&&Tt===!1;He++){var Qt=Ie[He],dt=Ue[He],Lt=q;le.vmult(Qt,Lt);var at=re;le.vmult(Ye[dt[0]],at),at.vadd(Ke,at);var fn=pe;Lt.mult(-Oe,fn),Qe.vadd(fn,fn);var wn=ge;fn.vsub(at,wn);var Hn=wn.dot(Lt),Ci=be;if(Qe.vsub(at,Ci),Hn<0&&Ci.dot(Lt)>0){for(var Vt=[],Dt=0,Nt=dt.length;Dt!==Nt;Dt++){var yt=ie.get();le.vmult(Ye[dt[Dt]],yt),Ke.vadd(yt,yt),Vt.push(yt)}if(de(Vt,Lt,Qe)){Tt=!0;var Ze=this.createContactEquation(ue,ce,Le,Be);Lt.mult(-Oe,Ze.ri),Lt.negate(Ze.ni);var pi=ie.get();Lt.mult(-Hn,pi);var on=ie.get();Lt.mult(-Oe,on),Qe.vsub(Ke,Ze.rj),Ze.rj.vadd(on,Ze.rj),Ze.rj.vadd(pi,Ze.rj),Ze.rj.vadd(Ke,Ze.rj),Ze.rj.vsub(ce.position,Ze.rj),Ze.ri.vadd(Qe,Ze.ri),Ze.ri.vsub(ue.position,Ze.ri),ie.release(pi),ie.release(on),this.result.push(Ze),this.createFrictionEquationsFromContact(Ze,this.frictionResult);for(var Dt=0,an=Vt.length;Dt!==an;Dt++)ie.release(Vt[Dt]);return}else for(var Dt=0;Dt!==dt.length;Dt++){var _n=ie.get(),li=ie.get();le.vmult(Ye[dt[(Dt+1)%dt.length]],_n),le.vmult(Ye[dt[(Dt+2)%dt.length]],li),Ke.vadd(_n,_n),Ke.vadd(li,li);var Pn=L;li.vsub(_n,Pn);var At=V;Pn.unit(At);var Fi=ie.get(),qn=ie.get();Qe.vsub(_n,qn);var Or=qn.dot(At);At.mult(Or,Fi),Fi.vadd(_n,Fi);var Ls=ie.get();if(Fi.vsub(Qe,Ls),Or>0&&Or*Or<Pn.norm2()&&Ls.norm2()<Oe*Oe){var Ze=this.createContactEquation(ue,ce,Le,Be);Fi.vsub(Ke,Ze.rj),Fi.vsub(Qe,Ze.ni),Ze.ni.normalize(),Ze.ni.mult(Oe,Ze.ri),Ze.rj.vadd(Ke,Ze.rj),Ze.rj.vsub(ce.position,Ze.rj),Ze.ri.vadd(Qe,Ze.ri),Ze.ri.vsub(ue.position,Ze.ri),this.result.push(Ze),this.createFrictionEquationsFromContact(Ze,this.frictionResult);for(var Dt=0,an=Vt.length;Dt!==an;Dt++)ie.release(Vt[Dt]);ie.release(_n),ie.release(li),ie.release(Fi),ie.release(Ls),ie.release(qn);return}ie.release(_n),ie.release(li),ie.release(Fi),ie.release(Ls),ie.release(qn)}for(var Dt=0,an=Vt.length;Dt!==an;Dt++)ie.release(Vt[Dt])}}},new c,new c,g.prototype[o.types.PLANE|o.types.BOX]=g.prototype.planeBox=function(Le,Be,Qe,Ke,Q,le,ue,ce){Be.convexPolyhedronRepresentation.material=Be.material,Be.convexPolyhedronRepresentation.collisionResponse=Be.collisionResponse,this.planeConvex(Le,Be.convexPolyhedronRepresentation,Qe,Ke,Q,le,ue,ce)};var G=new c,Ae=new c,Fe=new c,Ve=new c;g.prototype[o.types.PLANE|o.types.CONVEXPOLYHEDRON]=g.prototype.planeConvex=function(Le,Be,Qe,Ke,Q,le,ue,ce){var ie=G,Ie=Ae;Ie.set(0,0,1),Q.vmult(Ie,Ie);for(var Ue=0,Ye=Fe,Oe=0;Oe!==Be.vertices.length;Oe++){ie.copy(Be.vertices[Oe]),le.vmult(ie,ie),Ke.vadd(ie,ie),ie.vsub(Qe,Ye);var He=Ie.dot(Ye);if(He<=0){var We=this.createContactEquation(ue,ce,Le,Be),nt=Ve;Ie.mult(Ie.dot(Ye),nt),ie.vsub(nt,nt),nt.vsub(Qe,We.ri),We.ni.copy(Ie),ie.vsub(Ke,We.rj),We.ri.vadd(Qe,We.ri),We.ri.vsub(ue.position,We.ri),We.rj.vadd(Ke,We.rj),We.rj.vsub(ce.position,We.rj),this.result.push(We),Ue++,this.enableFrictionReduction||this.createFrictionEquationsFromContact(We,this.frictionResult)}}this.enableFrictionReduction&&Ue&&this.createFrictionFromAverage(Ue)};var oe=new c,Ne=new c;g.prototype[o.types.CONVEXPOLYHEDRON]=g.prototype.convexConvex=function(Le,Be,Qe,Ke,Q,le,ue,ce,ie,Ie,Ue,Ye){var Oe=oe;if(!(Qe.distanceTo(Ke)>Le.boundingSphereRadius+Be.boundingSphereRadius)&&Le.findSeparatingAxis(Be,Qe,Q,Ke,le,Oe,Ue,Ye)){var He=[],We=Ne;Le.clipAgainstHull(Qe,Q,Be,Ke,le,Oe,-100,100,He);for(var nt=0,pt=0;pt!==He.length;pt++){var Ze=this.createContactEquation(ue,ce,Le,Be,ie,Ie),Tt=Ze.ri,Rt=Ze.rj;Oe.negate(Ze.ni),He[pt].normal.negate(We),We.mult(He[pt].depth,We),He[pt].point.vadd(We,Tt),Rt.copy(He[pt].point),Tt.vsub(Qe,Tt),Rt.vsub(Ke,Rt),Tt.vadd(Qe,Tt),Tt.vsub(ue.position,Tt),Rt.vadd(Ke,Rt),Rt.vsub(ce.position,Rt),this.result.push(Ze),nt++,this.enableFrictionReduction||this.createFrictionEquationsFromContact(Ze,this.frictionResult)}this.enableFrictionReduction&&nt&&this.createFrictionFromAverage(nt)}};var Je=new c,ae=new c,Te=new c;g.prototype[o.types.PLANE|o.types.PARTICLE]=g.prototype.planeParticle=function(Le,Be,Qe,Ke,Q,le,ue,ce){var ie=Je;ie.set(0,0,1),ue.quaternion.vmult(ie,ie);var Ie=ae;Ke.vsub(ue.position,Ie);var Ue=ie.dot(Ie);if(Ue<=0){var Ye=this.createContactEquation(ce,ue,Be,Le);Ye.ni.copy(ie),Ye.ni.negate(Ye.ni),Ye.ri.set(0,0,0);var Oe=Te;ie.mult(ie.dot(Ke),Oe),Ke.vsub(Oe,Oe),Ye.rj.copy(Oe),this.result.push(Ye),this.createFrictionEquationsFromContact(Ye,this.frictionResult)}};var Ge=new c;g.prototype[o.types.PARTICLE|o.types.SPHERE]=g.prototype.sphereParticle=function(Le,Be,Qe,Ke,Q,le,ue,ce){var ie=Ge;ie.set(0,0,1),Ke.vsub(Qe,ie);var Ie=ie.norm2();if(Ie<=Le.radius*Le.radius){var Ue=this.createContactEquation(ce,ue,Be,Le);ie.normalize(),Ue.rj.copy(ie),Ue.rj.mult(Le.radius,Ue.rj),Ue.ni.copy(ie),Ue.ni.negate(Ue.ni),Ue.ri.set(0,0,0),this.result.push(Ue),this.createFrictionEquationsFromContact(Ue,this.frictionResult)}};var ze=new d,ct=new c;new c;var Pt=new c,xt=new c,Xn=new c;g.prototype[o.types.PARTICLE|o.types.CONVEXPOLYHEDRON]=g.prototype.convexParticle=function(Le,Be,Qe,Ke,Q,le,ue,ce){var ie=-1,Ie=Pt,Ue=Xn,Ye=null,Oe=ct;if(Oe.copy(Ke),Oe.vsub(Qe,Oe),Q.conjugate(ze),ze.vmult(Oe,Oe),Le.pointIsInside(Oe)){Le.worldVerticesNeedsUpdate&&Le.computeWorldVertices(Qe,Q),Le.worldFaceNormalsNeedsUpdate&&Le.computeWorldFaceNormals(Q);for(var He=0,We=Le.faces.length;He!==We;He++){var nt=[Le.worldVertices[Le.faces[He][0]]],pt=Le.worldFaceNormals[He];Ke.vsub(nt[0],xt);var Ze=-pt.dot(xt);(Ye===null||Math.abs(Ze)<Math.abs(Ye))&&(Ye=Ze,ie=He,Ie.copy(pt))}if(ie!==-1){var Tt=this.createContactEquation(ce,ue,Be,Le);Ie.mult(Ye,Ue),Ue.vadd(Ke,Ue),Ue.vsub(Qe,Ue),Tt.rj.copy(Ue),Ie.negate(Tt.ni),Tt.ri.set(0,0,0);var Rt=Tt.ri,Qt=Tt.rj;Rt.vadd(Ke,Rt),Rt.vsub(ce.position,Rt),Qt.vadd(Qe,Qt),Qt.vsub(ue.position,Qt),this.result.push(Tt),this.createFrictionEquationsFromContact(Tt,this.frictionResult)}else console.warn("Point found inside convex, but did not find penetrating face!")}},g.prototype[o.types.BOX|o.types.HEIGHTFIELD]=g.prototype.boxHeightfield=function(Le,Be,Qe,Ke,Q,le,ue,ce){Le.convexPolyhedronRepresentation.material=Le.material,Le.convexPolyhedronRepresentation.collisionResponse=Le.collisionResponse,this.convexHeightfield(Le.convexPolyhedronRepresentation,Be,Qe,Ke,Q,le,ue,ce)};var Cn=new c,Un=new c,Fn=[0];g.prototype[o.types.CONVEXPOLYHEDRON|o.types.HEIGHTFIELD]=g.prototype.convexHeightfield=function(Le,Be,Qe,Ke,Q,le,ue,ce){var ie=Be.data,Ie=Be.elementSize,Ue=Le.boundingSphereRadius,Ye=Un,Oe=Fn,He=Cn;h.pointToLocalFrame(Ke,le,Qe,He);var We=Math.floor((He.x-Ue)/Ie)-1,nt=Math.ceil((He.x+Ue)/Ie)+1,pt=Math.floor((He.y-Ue)/Ie)-1,Ze=Math.ceil((He.y+Ue)/Ie)+1;if(!(nt<0||Ze<0||We>ie.length||pt>ie[0].length)){We<0&&(We=0),nt<0&&(nt=0),pt<0&&(pt=0),Ze<0&&(Ze=0),We>=ie.length&&(We=ie.length-1),nt>=ie.length&&(nt=ie.length-1),Ze>=ie[0].length&&(Ze=ie[0].length-1),pt>=ie[0].length&&(pt=ie[0].length-1);var Tt=[];Be.getRectMinMax(We,pt,nt,Ze,Tt);var Rt=Tt[0],Qt=Tt[1];if(!(He.z-Ue>Qt||He.z+Ue<Rt))for(var dt=We;dt<nt;dt++)for(var Lt=pt;Lt<Ze;Lt++)Be.getConvexTrianglePillar(dt,Lt,!1),h.pointToWorldFrame(Ke,le,Be.pillarOffset,Ye),Qe.distanceTo(Ye)<Be.pillarConvex.boundingSphereRadius+Le.boundingSphereRadius&&this.convexConvex(Le,Be.pillarConvex,Qe,Ye,Q,le,ue,ce,null,null,Oe,null),Be.getConvexTrianglePillar(dt,Lt,!0),h.pointToWorldFrame(Ke,le,Be.pillarOffset,Ye),Qe.distanceTo(Ye)<Be.pillarConvex.boundingSphereRadius+Le.boundingSphereRadius&&this.convexConvex(Le,Be.pillarConvex,Qe,Ye,Q,le,ue,ce,null,null,Oe,null)}};var Ai=new c,sn=new c;g.prototype[o.types.SPHERE|o.types.HEIGHTFIELD]=g.prototype.sphereHeightfield=function(Le,Be,Qe,Ke,Q,le,ue,ce){var ie=Be.data,Ie=Le.radius,Ue=Be.elementSize,Ye=sn,Oe=Ai;h.pointToLocalFrame(Ke,le,Qe,Oe);var He=Math.floor((Oe.x-Ie)/Ue)-1,We=Math.ceil((Oe.x+Ie)/Ue)+1,nt=Math.floor((Oe.y-Ie)/Ue)-1,pt=Math.ceil((Oe.y+Ie)/Ue)+1;if(!(We<0||pt<0||He>ie.length||pt>ie[0].length)){He<0&&(He=0),We<0&&(We=0),nt<0&&(nt=0),pt<0&&(pt=0),He>=ie.length&&(He=ie.length-1),We>=ie.length&&(We=ie.length-1),pt>=ie[0].length&&(pt=ie[0].length-1),nt>=ie[0].length&&(nt=ie[0].length-1);var Ze=[];Be.getRectMinMax(He,nt,We,pt,Ze);var Tt=Ze[0],Rt=Ze[1];if(!(Oe.z-Ie>Rt||Oe.z+Ie<Tt))for(var Qt=this.result,dt=He;dt<We;dt++)for(var Lt=nt;Lt<pt;Lt++){var at=Qt.length;Be.getConvexTrianglePillar(dt,Lt,!1),h.pointToWorldFrame(Ke,le,Be.pillarOffset,Ye),Qe.distanceTo(Ye)<Be.pillarConvex.boundingSphereRadius+Le.boundingSphereRadius&&this.sphereConvex(Le,Be.pillarConvex,Qe,Ye,Q,le,ue,ce),Be.getConvexTrianglePillar(dt,Lt,!0),h.pointToWorldFrame(Ke,le,Be.pillarOffset,Ye),Qe.distanceTo(Ye)<Be.pillarConvex.boundingSphereRadius+Le.boundingSphereRadius&&this.sphereConvex(Le,Be.pillarConvex,Qe,Ye,Q,le,ue,ce);var fn=Qt.length-at;if(fn>2)return}}}},{"../collision/AABB":3,"../collision/Ray":9,"../equations/ContactEquation":19,"../equations/FrictionEquation":21,"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"../shapes/ConvexPolyhedron":38,"../shapes/Shape":43,"../solver/Solver":47,"../utils/Vec3Pool":54}],56:[function(t,n,r){n.exports=b;var s=t("../shapes/Shape"),o=t("../math/Vec3"),a=t("../math/Quaternion"),c=t("../solver/GSSolver");t("../utils/Vec3Pool"),t("../equations/ContactEquation"),t("../equations/FrictionEquation");var h=t("./Narrowphase"),d=t("../utils/EventTarget"),l=t("../collision/ArrayCollisionMatrix"),u=t("../material/Material"),p=t("../material/ContactMaterial"),g=t("../objects/Body"),y=t("../utils/TupleDictionary"),x=t("../collision/RaycastResult"),v=t("../collision/AABB"),w=t("../collision/Ray"),S=t("../collision/NaiveBroadphase");function b(){d.apply(this),this.dt=-1,this.allowSleep=!1,this.contacts=[],this.frictionEquations=[],this.quatNormalizeSkip=0,this.quatNormalizeFast=!1,this.time=0,this.stepnumber=0,this.default_dt=1/60,this.nextId=0,this.gravity=new o,this.broadphase=new S,this.bodies=[],this.solver=new c,this.constraints=[],this.narrowphase=new h(this),this.collisionMatrix=new l,this.collisionMatrixPrevious=new l,this.materials=[],this.contactmaterials=[],this.contactMaterialTable=new y,this.defaultMaterial=new u("default"),this.defaultContactMaterial=new p(this.defaultMaterial,this.defaultMaterial,{friction:.3,restitution:0}),this.doProfiling=!1,this.profile={solve:0,makeContactConstraints:0,broadphase:0,integrate:0,narrowphase:0},this.subsystems=[],this.addBodyEvent={type:"addBody",body:null},this.removeBodyEvent={type:"removeBody",body:null}}b.prototype=new d,new v;var E=new w;if(b.prototype.getContactMaterial=function(k,W){return this.contactMaterialTable.get(k.id,W.id)},b.prototype.numObjects=function(){return this.bodies.length},b.prototype.collisionMatrixTick=function(){var k=this.collisionMatrixPrevious;this.collisionMatrixPrevious=this.collisionMatrix,this.collisionMatrix=k,this.collisionMatrix.reset()},b.prototype.add=b.prototype.addBody=function(k){this.bodies.indexOf(k)===-1&&(k.index=this.bodies.length,this.bodies.push(k),k.world=this,k.initPosition.copy(k.position),k.initVelocity.copy(k.velocity),k.timeLastSleepy=this.time,k instanceof g&&(k.initAngularVelocity.copy(k.angularVelocity),k.initQuaternion.copy(k.quaternion)),this.collisionMatrix.setNumObjects(this.bodies.length),this.addBodyEvent.body=k,this.dispatchEvent(this.addBodyEvent))},b.prototype.addConstraint=function(k){this.constraints.push(k)},b.prototype.removeConstraint=function(k){var W=this.constraints.indexOf(k);W!==-1&&this.constraints.splice(W,1)},b.prototype.rayTest=function(k,W,Y){Y instanceof x?this.raycastClosest(k,W,{skipBackfaces:!0},Y):this.raycastAll(k,W,{skipBackfaces:!0},Y)},b.prototype.raycastAll=function(k,W,Y,H){return Y.mode=w.ALL,Y.from=k,Y.to=W,Y.callback=H,E.intersectWorld(this,Y)},b.prototype.raycastAny=function(k,W,Y,H){return Y.mode=w.ANY,Y.from=k,Y.to=W,Y.result=H,E.intersectWorld(this,Y)},b.prototype.raycastClosest=function(k,W,Y,H){return Y.mode=w.CLOSEST,Y.from=k,Y.to=W,Y.result=H,E.intersectWorld(this,Y)},b.prototype.remove=function(k){k.world=null;var W=this.bodies.length-1,Y=this.bodies,H=Y.indexOf(k);if(H!==-1){Y.splice(H,1);for(var J=0;J!==Y.length;J++)Y[J].index=J;this.collisionMatrix.setNumObjects(W),this.removeBodyEvent.body=k,this.dispatchEvent(this.removeBodyEvent)}},b.prototype.removeBody=b.prototype.remove,b.prototype.addMaterial=function(k){this.materials.push(k)},b.prototype.addContactMaterial=function(k){this.contactmaterials.push(k),this.contactMaterialTable.set(k.materials[0].id,k.materials[1].id,k)},typeof performance=="undefined"&&(performance={}),!performance.now){var R=Date.now();performance.timing&&performance.timing.navigationStart&&(R=performance.timing.navigationStart),performance.now=function(){return Date.now()-R}}var z=new o;b.prototype.step=function(k,W,Y){if(Y=Y||10,W=W||0,W===0)this.internalStep(k),this.time+=k;else{var H=Math.floor((this.time+W)/k)-Math.floor(this.time/k);H=Math.min(H,Y);for(var J=performance.now(),K=0;K!==H&&(this.internalStep(k),!(performance.now()-J>k*1e3));K++);this.time+=W;for(var ee=this.time%k,$=ee/k,Z=z,Ee=this.bodies,Se=0;Se!==Ee.length;Se++){var de=Ee[Se];de.type!==g.STATIC&&de.sleepState!==g.SLEEPING?(de.position.vsub(de.previousPosition,Z),Z.scale($,Z),de.position.vadd(Z,de.interpolatedPosition)):(de.interpolatedPosition.copy(de.position),de.interpolatedQuaternion.copy(de.quaternion))}}};var I={type:"postStep"},N={type:"preStep"},F={type:"collide",body:null,contact:null},C=[],O=[],X=[],U=[];new o,new o,new o,new o,new o,new o,new o,new o,new o,new a;var te=new a,ne=new a,j=new o;b.prototype.internalStep=function(k){this.dt=k;var W=this.contacts,Y=X,H=U,J=this.numObjects(),K=this.bodies,ee=this.solver,$=this.gravity,Z=this.doProfiling,Ee=this.profile,Se=g.DYNAMIC,de,he=this.constraints,Ce=O;$.norm();var me=$.x,fe=$.y,we=$.z,ye=0;for(Z&&(de=performance.now()),ye=0;ye!==J;ye++){var _e=K[ye];if(_e.type&Se){var it=_e.force,$e=_e.mass;it.x+=$e*me,it.y+=$e*fe,it.z+=$e*we}}for(var ye=0,et=this.subsystems.length;ye!==et;ye++)this.subsystems[ye].update();Z&&(de=performance.now()),Y.length=0,H.length=0,this.broadphase.collisionPairs(this,Y,H),Z&&(Ee.broadphase=performance.now()-de);var oe=he.length;for(ye=0;ye!==oe;ye++){var L=he[ye];if(!L.collideConnected)for(var V=Y.length-1;V>=0;V-=1)(L.bodyA===Y[V]&&L.bodyB===H[V]||L.bodyB===Y[V]&&L.bodyA===H[V])&&(Y.splice(V,1),H.splice(V,1))}this.collisionMatrixTick(),Z&&(de=performance.now());var P=C,T=W.length;for(ye=0;ye!==T;ye++)P.push(W[ye]);W.length=0;var q=this.frictionEquations.length;for(ye=0;ye!==q;ye++)Ce.push(this.frictionEquations[ye]);this.frictionEquations.length=0,this.narrowphase.getContacts(Y,H,this,W,P,this.frictionEquations,Ce),Z&&(Ee.narrowphase=performance.now()-de),Z&&(de=performance.now());for(var ye=0;ye<this.frictionEquations.length;ye++)ee.addEquation(this.frictionEquations[ye]);for(var re=W.length,pe=0;pe!==re;pe++){var L=W[pe],_e=L.bi,ge=L.bj;L.si,L.sj;var be;if(_e.material&&ge.material?be=this.getContactMaterial(_e.material,ge.material)||this.defaultContactMaterial:be=this.defaultContactMaterial,be.friction,_e.material&&ge.material&&(_e.material.friction>=0&&ge.material.friction>=0&&_e.material.friction*ge.material.friction,_e.material.restitution>=0&&ge.material.restitution>=0&&(L.restitution=_e.material.restitution*ge.material.restitution)),ee.addEquation(L),_e.allowSleep&&_e.type===g.DYNAMIC&&_e.sleepState===g.SLEEPING&&ge.sleepState===g.AWAKE&&ge.type!==g.STATIC){var G=ge.velocity.norm2()+ge.angularVelocity.norm2(),Ae=Math.pow(ge.sleepSpeedLimit,2);G>=Ae*2&&(_e._wakeUpAfterNarrowphase=!0)}if(ge.allowSleep&&ge.type===g.DYNAMIC&&ge.sleepState===g.SLEEPING&&_e.sleepState===g.AWAKE&&_e.type!==g.STATIC){var Fe=_e.velocity.norm2()+_e.angularVelocity.norm2(),Ve=Math.pow(_e.sleepSpeedLimit,2);Fe>=Ve*2&&(ge._wakeUpAfterNarrowphase=!0)}this.collisionMatrix.set(_e,ge,!0),this.collisionMatrixPrevious.get(_e,ge)||(F.body=ge,F.contact=L,_e.dispatchEvent(F),F.body=_e,ge.dispatchEvent(F))}for(Z&&(Ee.makeContactConstraints=performance.now()-de,de=performance.now()),ye=0;ye!==J;ye++){var _e=K[ye];_e._wakeUpAfterNarrowphase&&(_e.wakeUp(),_e._wakeUpAfterNarrowphase=!1)}var oe=he.length;for(ye=0;ye!==oe;ye++){var L=he[ye];L.update();for(var V=0,Ne=L.equations.length;V!==Ne;V++){var Je=L.equations[V];ee.addEquation(Je)}}ee.solve(k,this),Z&&(Ee.solve=performance.now()-de),ee.removeAllEquations();var ae=Math.pow;for(ye=0;ye!==J;ye++){var _e=K[ye];if(_e.type&Se){var Te=ae(1-_e.linearDamping,k),Ge=_e.velocity;Ge.mult(Te,Ge);var ze=_e.angularVelocity;if(ze){var ct=ae(1-_e.angularDamping,k);ze.mult(ct,ze)}}}for(this.dispatchEvent(N),ye=0;ye!==J;ye++){var _e=K[ye];_e.preStep&&_e.preStep.call(_e)}Z&&(de=performance.now());var Pt=te,xt=ne,Xn=this.stepnumber,Cn=g.DYNAMIC|g.KINEMATIC,Un=Xn%(this.quatNormalizeSkip+1)===0,Fn=this.quatNormalizeFast,Ai=k*.5;for(s.types.PLANE,s.types.CONVEXPOLYHEDRON,ye=0;ye!==J;ye++){var sn=K[ye],Le=sn.force,Be=sn.torque;if(sn.type&Cn&&sn.sleepState!==g.SLEEPING){var Qe=sn.velocity,Ke=sn.angularVelocity,Q=sn.position,le=sn.quaternion,ue=sn.invMass,ce=sn.invInertiaWorld;Qe.x+=Le.x*ue*k,Qe.y+=Le.y*ue*k,Qe.z+=Le.z*ue*k,sn.angularVelocity&&(ce.vmult(Be,j),j.mult(k,j),j.vadd(Ke,Ke)),Q.x+=Qe.x*k,Q.y+=Qe.y*k,Q.z+=Qe.z*k,sn.angularVelocity&&(Pt.set(Ke.x,Ke.y,Ke.z,0),Pt.mult(le,xt),le.x+=Ai*xt.x,le.y+=Ai*xt.y,le.z+=Ai*xt.z,le.w+=Ai*xt.w,Un&&(Fn?le.normalizeFast():le.normalize())),sn.aabb&&(sn.aabbNeedsUpdate=!0),sn.updateInertiaWorld&&sn.updateInertiaWorld()}}for(this.clearForces(),this.broadphase.dirty=!0,Z&&(Ee.integrate=performance.now()-de),this.time+=k,this.stepnumber+=1,this.dispatchEvent(I),ye=0;ye!==J;ye++){var _e=K[ye],ie=_e.postStep;ie&&ie.call(_e)}if(this.allowSleep)for(ye=0;ye!==J;ye++)K[ye].sleepTick(this.time)},b.prototype.clearForces=function(){for(var k=this.bodies,W=k.length,Y=0;Y!==W;Y++){var H=k[Y];H.force,H.torque,H.force.set(0,0,0),H.torque.set(0,0,0)}}},{"../collision/AABB":3,"../collision/ArrayCollisionMatrix":4,"../collision/NaiveBroadphase":7,"../collision/Ray":9,"../collision/RaycastResult":10,"../equations/ContactEquation":19,"../equations/FrictionEquation":21,"../material/ContactMaterial":24,"../material/Material":25,"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"../shapes/Shape":43,"../solver/GSSolver":46,"../utils/EventTarget":49,"../utils/TupleDictionary":52,"../utils/Vec3Pool":54,"./Narrowphase":55}]},{},[2])(2)})})(ZP);var kt=ZP.exports;class qU{constructor(e){this.config=e.config,this.debug=e.debug,this.time=e.time,this.sizes=e.sizes,this.controls=e.controls,this.sounds=e.sounds,this.debug&&(this.debugFolder=this.debug.addFolder("physics")),this.setWorld(),this.setModels(),this.setMaterials(),this.setFloor(),this.setCar(),this.time.on("tick",()=>{this.world.step(1/60,this.time.delta,3)})}setWorld(){this.world=new kt.World,this.world.gravity.set(0,0,-3.25),this.world.allowSleep=!0,this.world.defaultContactMaterial.friction=0,this.world.defaultContactMaterial.restitution=.2,this.debug&&this.debugFolder.add(this.world.gravity,"z").step(.001).min(-20).max(20).name("gravity")}setModels(){this.models={},this.models.container=new ft,this.models.container.visible=!1,this.models.materials={},this.models.materials.static=new Bt({color:255,wireframe:!0}),this.models.materials.dynamic=new Bt({color:16711680,wireframe:!0}),this.models.materials.dynamicSleeping=new Bt({color:16776960,wireframe:!0}),this.debug&&this.debugFolder.add(this.models.container,"visible").name("modelsVisible")}setMaterials(){this.materials={},this.materials.items={},this.materials.items.floor=new kt.Material("floorMaterial"),this.materials.items.dummy=new kt.Material("dummyMaterial"),this.materials.items.wheel=new kt.Material("wheelMaterial"),this.materials.contacts={},this.materials.contacts.floorDummy=new kt.ContactMaterial(this.materials.items.floor,this.materials.items.dummy,{friction:.05,restitution:.3,contactEquationStiffness:1e3}),this.world.addContactMaterial(this.materials.contacts.floorDummy),this.materials.contacts.dummyDummy=new kt.ContactMaterial(this.materials.items.dummy,this.materials.items.dummy,{friction:.5,restitution:.3,contactEquationStiffness:1e3}),this.world.addContactMaterial(this.materials.contacts.dummyDummy),this.materials.contacts.floorWheel=new kt.ContactMaterial(this.materials.items.floor,this.materials.items.wheel,{friction:.3,restitution:0,contactEquationStiffness:1e3}),this.world.addContactMaterial(this.materials.contacts.floorWheel)}setFloor(){this.floor={},this.floor.body=new kt.Body({mass:0,shape:new kt.Plane,material:this.materials.items.floor}),this.world.addBody(this.floor.body)}setCar(){this.car={},this.car.steering=0,this.car.accelerating=0,this.car.speed=0,this.car.worldForward=new kt.Vec3,this.car.angle=0,this.car.forwardSpeed=0,this.car.oldPosition=new kt.Vec3,this.car.goingForward=!0,this.car.options={},this.car.options.chassisWidth=1.02,this.car.options.chassisHeight=1.16,this.car.options.chassisDepth=2.03,this.car.options.chassisOffset=new kt.Vec3(0,0,.41),this.car.options.chassisMass=20,this.car.options.wheelFrontOffsetDepth=.635,this.car.options.wheelBackOffsetDepth=-.475,this.car.options.wheelOffsetWidth=.39,this.car.options.wheelRadius=.25,this.car.options.wheelHeight=.24,this.car.options.wheelSuspensionStiffness=25,this.car.options.wheelSuspensionRestLength=.1,this.car.options.wheelFrictionSlip=5,this.car.options.wheelDampingRelaxation=1.8,this.car.options.wheelDampingCompression=1.5,this.car.options.wheelMaxSuspensionForce=1e5,this.car.options.wheelRollInfluence=.01,this.car.options.wheelMaxSuspensionTravel=.3,this.car.options.wheelCustomSlidingRotationalSpeed=-30,this.car.options.wheelMass=5,this.car.options.controlsSteeringSpeed=.005,this.car.options.controlsSteeringMax=Math.PI*.17,this.car.options.controlsSteeringQuad=!1,this.car.options.controlsAcceleratinMaxSpeed=.055,this.car.options.controlsAcceleratinMaxSpeedBoost=.11,this.car.options.controlsAcceleratingSpeed=2,this.car.options.controlsAcceleratingSpeedBoost=3.5,this.car.options.controlsAcceleratingQuad=!0,this.car.options.controlsBrakeStrength=.45,this.car.upsideDown={},this.car.upsideDown.state="watching",this.car.upsideDown.pendingTimeout=null,this.car.upsideDown.turningTimeout=null,this.car.jump=(e=!0,t=60)=>{let n=this.car.chassis.body.position;n=n.vadd(new kt.Vec3(e?.08:0,0,0)),this.car.chassis.body.applyImpulse(new kt.Vec3(0,0,t),n)},this.car.create=()=>{this.car.chassis={},this.car.chassis.shape=new kt.Box(new kt.Vec3(this.car.options.chassisDepth*.5,this.car.options.chassisWidth*.5,this.car.options.chassisHeight*.5)),this.car.chassis.body=new kt.Body({mass:this.car.options.chassisMass}),this.car.chassis.body.allowSleep=!1,this.car.chassis.body.position.set(0,0,12),this.car.chassis.body.sleep(),this.car.chassis.body.addShape(this.car.chassis.shape,this.car.options.chassisOffset),this.car.chassis.body.quaternion.setFromAxisAngle(new kt.Vec3(0,0,1),-Math.PI*.5),this.car.chassis.body.addEventListener("collide",t=>{if(t.body.mass===0){const n=t.contact.getImpactVelocityAlongNormal();this.sounds.play("carHit",n)}}),this.car.vehicle=new kt.RaycastVehicle({chassisBody:this.car.chassis.body}),this.car.wheels={},this.car.wheels.options={radius:this.car.options.wheelRadius,height:this.car.options.wheelHeight,suspensionStiffness:this.car.options.wheelSuspensionStiffness,suspensionRestLength:this.car.options.wheelSuspensionRestLength,frictionSlip:this.car.options.wheelFrictionSlip,dampingRelaxation:this.car.options.wheelDampingRelaxation,dampingCompression:this.car.options.wheelDampingCompression,maxSuspensionForce:this.car.options.wheelMaxSuspensionForce,rollInfluence:this.car.options.wheelRollInfluence,maxSuspensionTravel:this.car.options.wheelMaxSuspensionTravel,customSlidingRotationalSpeed:this.car.options.wheelCustomSlidingRotationalSpeed,useCustomSlidingRotationalSpeed:!0,directionLocal:new kt.Vec3(0,0,-1),axleLocal:new kt.Vec3(0,1,0),chassisConnectionPointLocal:new kt.Vec3(1,1,0)},this.car.wheels.options.chassisConnectionPointLocal.set(this.car.options.wheelFrontOffsetDepth,this.car.options.wheelOffsetWidth,0),this.car.vehicle.addWheel(this.car.wheels.options),this.car.wheels.options.chassisConnectionPointLocal.set(this.car.options.wheelFrontOffsetDepth,-this.car.options.wheelOffsetWidth,0),this.car.vehicle.addWheel(this.car.wheels.options),this.car.wheels.options.chassisConnectionPointLocal.set(this.car.options.wheelBackOffsetDepth,this.car.options.wheelOffsetWidth,0),this.car.vehicle.addWheel(this.car.wheels.options),this.car.wheels.options.chassisConnectionPointLocal.set(this.car.options.wheelBackOffsetDepth,-this.car.options.wheelOffsetWidth,0),this.car.vehicle.addWheel(this.car.wheels.options),this.car.vehicle.addToWorld(this.world),this.car.wheels.indexes={},this.car.wheels.indexes.frontLeft=0,this.car.wheels.indexes.frontRight=1,this.car.wheels.indexes.backLeft=2,this.car.wheels.indexes.backRight=3,this.car.wheels.bodies=[];for(const t of this.car.vehicle.wheelInfos){const n=new kt.Cylinder(t.radius,t.radius,this.car.wheels.options.height,20),r=new kt.Body({mass:this.car.options.wheelMass,material:this.materials.items.wheel}),s=new kt.Quaternion;s.setFromAxisAngle(new kt.Vec3(1,0,0),Math.PI/2),r.type=kt.Body.KINEMATIC,r.addShape(n,new kt.Vec3,s),this.car.wheels.bodies.push(r)}this.car.model={},this.car.model.container=new ft,this.models.container.add(this.car.model.container),this.car.model.material=new Bt({color:16777215,wireframe:!0}),this.car.model.chassis=new je(new dn(this.car.options.chassisDepth,this.car.options.chassisWidth,this.car.options.chassisHeight),this.car.model.material),this.car.model.container.add(this.car.model.chassis),this.car.model.wheels=[];const e=new kn(this.car.options.wheelRadius,this.car.options.wheelRadius,this.car.options.wheelHeight,8,1);for(let t=0;t<4;t++){const n=new je(e,this.car.model.material);this.car.model.container.add(n),this.car.model.wheels.push(n)}},this.car.destroy=()=>{this.car.vehicle.removeFromWorld(this.world),this.models.container.remove(this.car.model.container)},this.car.recreate=()=>{this.car.destroy(),this.car.create(),this.car.chassis.body.wakeUp()},this.car.brake=()=>{this.car.vehicle.setBrake(1,0),this.car.vehicle.setBrake(1,1),this.car.vehicle.setBrake(1,2),this.car.vehicle.setBrake(1,3)},this.car.unbrake=()=>{this.car.vehicle.setBrake(0,0),this.car.vehicle.setBrake(0,1),this.car.vehicle.setBrake(0,2),this.car.vehicle.setBrake(0,3)},this.controls.on("action",e=>{switch(e){case"reset":this.car.recreate();break}}),this.world.addEventListener("postStep",()=>{let e=new kt.Vec3;e=e.copy(this.car.chassis.body.position),e=e.vsub(this.car.oldPosition),this.car.oldPosition.copy(this.car.chassis.body.position),this.car.speed=e.length();const t=new kt.Vec3(1,0,0);this.car.chassis.body.vectorToWorldFrame(t,this.car.worldForward),this.car.angle=Math.atan2(this.car.worldForward.y,this.car.worldForward.x),this.car.forwardSpeed=this.car.worldForward.dot(e),this.car.goingForward=this.car.forwardSpeed>0;const n=new kt.Vec3(0,0,1),r=new kt.Vec3;this.car.chassis.body.vectorToWorldFrame(n,r),r.dot(n)<.5?this.car.upsideDown.state==="watching"&&(this.car.upsideDown.state="pending",this.car.upsideDown.pendingTimeout=window.setTimeout(()=>{this.car.upsideDown.state="turning",this.car.jump(!0),this.car.upsideDown.turningTimeout=window.setTimeout(()=>{this.car.upsideDown.state="watching"},1e3)},1e3)):this.car.upsideDown.state==="pending"&&(this.car.upsideDown.state="watching",window.clearTimeout(this.car.upsideDown.pendingTimeout));for(let s=0;s<this.car.vehicle.wheelInfos.length;s++){this.car.vehicle.updateWheelTransform(s);const o=this.car.vehicle.wheelInfos[s].worldTransform;if(this.car.wheels.bodies[s].position.copy(o.position),this.car.wheels.bodies[s].quaternion.copy(o.quaternion),s===1||s===3){const a=new kt.Quaternion(0,0,0,1);a.setFromAxisAngle(new kt.Vec3(0,0,1),Math.PI),this.car.wheels.bodies[s].quaternion=this.car.wheels.bodies[s].quaternion.mult(a)}}if(!this.controls.actions.up&&!this.controls.actions.down){let s=this.car.worldForward.clone();this.car.goingForward&&(s=s.negate()),s=s.scale(this.car.chassis.body.velocity.length()*.1),this.car.chassis.body.applyImpulse(s,this.car.chassis.body.position)}}),this.time.on("tick",()=>{this.car.model.chassis.position.copy(this.car.chassis.body.position).add(this.car.options.chassisOffset),this.car.model.chassis.quaternion.copy(this.car.chassis.body.quaternion);for(const r in this.car.wheels.bodies){const s=this.car.wheels.bodies[r],o=this.car.model.wheels[r];o.position.copy(s.position),o.quaternion.copy(s.quaternion)}if(this.controls.touch){let r=0;this.controls.touch.joystick.active&&(r=(this.controls.touch.joystick.angle.value-this.car.angle+Math.PI)%(Math.PI*2)-Math.PI,r=r<-Math.PI?r+Math.PI*2:r);const s=Math.abs(this.car.forwardSpeed)<.01?!0:this.car.goingForward;this.car.steering=r*(s?-1:1),Math.abs(this.car.steering)>this.car.options.controlsSteeringMax&&(this.car.steering=Math.sign(this.car.steering)*this.car.options.controlsSteeringMax)}if(!this.controls.touch||!this.controls.touch.joystick.active){const r=this.time.delta*this.car.options.controlsSteeringSpeed;this.controls.actions.right?this.car.steering+=r:this.controls.actions.left?this.car.steering-=r:Math.abs(this.car.steering)>r?this.car.steering-=r*Math.sign(this.car.steering):this.car.steering=0,Math.abs(this.car.steering)>this.car.options.controlsSteeringMax&&(this.car.steering=Math.sign(this.car.steering)*this.car.options.controlsSteeringMax)}this.car.vehicle.setSteeringValue(-this.car.steering,this.car.wheels.indexes.frontLeft),this.car.vehicle.setSteeringValue(-this.car.steering,this.car.wheels.indexes.frontRight),this.car.options.controlsSteeringQuad&&(this.car.vehicle.setSteeringValue(this.car.steering,this.car.wheels.indexes.backLeft),this.car.vehicle.setSteeringValue(this.car.steering,this.car.wheels.indexes.backRight));const e=this.controls.actions.boost?this.car.options.controlsAcceleratingSpeedBoost:this.car.options.controlsAcceleratingSpeed,t=this.time.delta*e,n=this.controls.actions.boost?this.car.options.controlsAcceleratinMaxSpeedBoost:this.car.options.controlsAcceleratinMaxSpeed;this.controls.actions.up?this.car.speed<n||!this.car.goingForward?this.car.accelerating=t:this.car.accelerating=0:this.controls.actions.down?this.car.speed<n||this.car.goingForward?this.car.accelerating=-t:this.car.accelerating=0:this.car.accelerating=0,this.car.vehicle.applyEngineForce(-this.car.accelerating,this.car.wheels.indexes.backLeft),this.car.vehicle.applyEngineForce(-this.car.accelerating,this.car.wheels.indexes.backRight),this.car.options.controlsSteeringQuad&&(this.car.vehicle.applyEngineForce(-this.car.accelerating,this.car.wheels.indexes.frontLeft),this.car.vehicle.applyEngineForce(-this.car.accelerating,this.car.wheels.indexes.frontRight)),this.controls.actions.brake?(this.car.vehicle.setBrake(this.car.options.controlsBrakeStrength,0),this.car.vehicle.setBrake(this.car.options.controlsBrakeStrength,1),this.car.vehicle.setBrake(this.car.options.controlsBrakeStrength,2),this.car.vehicle.setBrake(this.car.options.controlsBrakeStrength,3)):(this.car.vehicle.setBrake(0,0),this.car.vehicle.setBrake(0,1),this.car.vehicle.setBrake(0,2),this.car.vehicle.setBrake(0,3))}),this.car.create(),this.debug&&(this.car.debugFolder=this.debugFolder.addFolder("car"),this.car.debugFolder.open(),this.car.debugFolder.add(this.car.options,"chassisWidth").step(.001).min(0).max(5).name("chassisWidth").onFinishChange(this.car.recreate),this.car.debugFolder.add(this.car.options,"chassisHeight").step(.001).min(0).max(5).name("chassisHeight").onFinishChange(this.car.recreate),this.car.debugFolder.add(this.car.options,"chassisDepth").step(.001).min(0).max(5).name("chassisDepth").onFinishChange(this.car.recreate),this.car.debugFolder.add(this.car.options.chassisOffset,"z").step(.001).min(0).max(5).name("chassisOffset").onFinishChange(this.car.recreate),this.car.debugFolder.add(this.car.options,"chassisMass").step(.001).min(0).max(1e3).name("chassisMass").onFinishChange(this.car.recreate),this.car.debugFolder.add(this.car.options,"wheelFrontOffsetDepth").step(.001).min(0).max(5).name("wheelFrontOffsetDepth").onFinishChange(this.car.recreate),this.car.debugFolder.add(this.car.options,"wheelBackOffsetDepth").step(.001).min(-5).max(0).name("wheelBackOffsetDepth").onFinishChange(this.car.recreate),this.car.debugFolder.add(this.car.options,"wheelOffsetWidth").step(.001).min(0).max(5).name("wheelOffsetWidth").onFinishChange(this.car.recreate),this.car.debugFolder.add(this.car.options,"wheelRadius").step(.001).min(0).max(2).name("wheelRadius").onFinishChange(this.car.recreate),this.car.debugFolder.add(this.car.options,"wheelHeight").step(.001).min(0).max(2).name("wheelHeight").onFinishChange(this.car.recreate),this.car.debugFolder.add(this.car.options,"wheelSuspensionStiffness").step(.001).min(0).max(300).name("wheelSuspensionStiffness").onFinishChange(this.car.recreate),this.car.debugFolder.add(this.car.options,"wheelSuspensionRestLength").step(.001).min(0).max(5).name("wheelSuspensionRestLength").onFinishChange(this.car.recreate),this.car.debugFolder.add(this.car.options,"wheelFrictionSlip").step(.001).min(0).max(30).name("wheelFrictionSlip").onFinishChange(this.car.recreate),this.car.debugFolder.add(this.car.options,"wheelDampingRelaxation").step(.001).min(0).max(30).name("wheelDampingRelaxation").onFinishChange(this.car.recreate),this.car.debugFolder.add(this.car.options,"wheelDampingCompression").step(.001).min(0).max(30).name("wheelDampingCompression").onFinishChange(this.car.recreate),this.car.debugFolder.add(this.car.options,"wheelMaxSuspensionForce").step(.001).min(0).max(1e6).name("wheelMaxSuspensionForce").onFinishChange(this.car.recreate),this.car.debugFolder.add(this.car.options,"wheelRollInfluence").step(.001).min(0).max(1).name("wheelRollInfluence").onFinishChange(this.car.recreate),this.car.debugFolder.add(this.car.options,"wheelMaxSuspensionTravel").step(.001).min(0).max(5).name("wheelMaxSuspensionTravel").onFinishChange(this.car.recreate),this.car.debugFolder.add(this.car.options,"wheelCustomSlidingRotationalSpeed").step(.001).min(-45).max(45).name("wheelCustomSlidingRotationalSpeed").onFinishChange(this.car.recreate),this.car.debugFolder.add(this.car.options,"wheelMass").step(.001).min(0).max(1e3).name("wheelMass").onFinishChange(this.car.recreate),this.car.debugFolder.add(this.car.options,"controlsSteeringSpeed").step(.001).min(0).max(.1).name("controlsSteeringSpeed"),this.car.debugFolder.add(this.car.options,"controlsSteeringMax").step(.001).min(0).max(Math.PI*.5).name("controlsSteeringMax"),this.car.debugFolder.add(this.car.options,"controlsSteeringQuad").name("controlsSteeringQuad"),this.car.debugFolder.add(this.car.options,"controlsAcceleratingSpeed").step(.001).min(0).max(30).name("controlsAcceleratingSpeed"),this.car.debugFolder.add(this.car.options,"controlsAcceleratingSpeedBoost").step(.001).min(0).max(30).name("controlsAcceleratingSpeedBoost"),this.car.debugFolder.add(this.car.options,"controlsAcceleratingQuad").name("controlsAcceleratingQuad"),this.car.debugFolder.add(this.car.options,"controlsBrakeStrength").step(.001).min(0).max(5).name("controlsBrakeStrength"),this.car.debugFolder.add(this.car,"recreate"),this.car.debugFolder.add(this.car,"jump"))}addObjectFromThree(e){const t={};t.model={},t.model.meshes=[],t.model.container=new ft,this.models.container.add(t.model.container),t.children=[];const n=this.materials.items.dummy;if(t.body=new kt.Body({position:new kt.Vec3(e.offset.x,e.offset.y,e.offset.z),mass:e.mass,material:n}),t.body.allowSleep=!0,t.body.sleepSpeedLimit=.01,e.sleep&&t.body.sleep(),this.world.addBody(t.body),e.rotation){const s=new kt.Quaternion;s.setFromEuler(e.rotation.x,e.rotation.y,e.rotation.z,e.rotation.order),t.body.quaternion=t.body.quaternion.mult(s)}t.center=new kt.Vec3(0,0,0);const r=[];for(let s=0;s<e.meshes.length;s++){const o=e.meshes[s];let a=null;if(o.name.match(/^cube_?[0-9]{0,3}?|box[0-9]{0,3}?$/i)?a="box":o.name.match(/^cylinder_?[0-9]{0,3}?$/i)?a="cylinder":o.name.match(/^sphere_?[0-9]{0,3}?$/i)?a="sphere":o.name.match(/^center_?[0-9]{0,3}?$/i)&&(a="center"),a==="center")t.center.set(o.position.x,o.position.y,o.position.z);else if(a){let c=null;if(a==="cylinder")c=new kt.Cylinder(o.scale.x,o.scale.x,o.scale.z,8);else if(a==="box"){const p=new kt.Vec3(o.scale.x*.5,o.scale.y*.5,o.scale.z*.5);c=new kt.Box(p)}else a==="sphere"&&(c=new kt.Sphere(o.scale.x));const h=new kt.Vec3(o.position.x,o.position.y,o.position.z),d=new kt.Quaternion(o.quaternion.x,o.quaternion.y,o.quaternion.z,o.quaternion.w);r.push({shapeGeometry:c,shapePosition:h,shapeQuaternion:d});let l=null;a==="cylinder"?(l=new kn(1,1,1,8,1),l.rotateX(Math.PI*.5)):a==="box"?l=new dn(1,1,1):a==="sphere"&&(l=new Ro(1,8,8));const u=new je(l,this.models.materials[e.mass===0?"static":"dynamic"]);u.position.copy(o.position),u.scale.copy(o.scale),u.quaternion.copy(o.quaternion),t.model.meshes.push(u)}}for(const s of t.model.meshes)s.position.x-=t.center.x,s.position.y-=t.center.y,s.position.z-=t.center.z,t.model.container.add(s);for(const s of r)s.shapePosition.x-=t.center.x,s.shapePosition.y-=t.center.y,s.shapePosition.z-=t.center.z,t.body.addShape(s.shapeGeometry,s.shapePosition,s.shapeQuaternion);return t.body.position.x+=t.center.x,t.body.position.y+=t.center.y,t.body.position.z+=t.center.z,t.origin={},t.origin.position=t.body.position.clone(),t.origin.quaternion=t.body.quaternion.clone(),t.origin.sleep=e.sleep,this.time.on("tick",()=>{if(t.model.container.position.set(t.body.position.x,t.body.position.y,t.body.position.z),t.model.container.quaternion.set(t.body.quaternion.x,t.body.quaternion.y,t.body.quaternion.z,t.body.quaternion.w),this.models.container.visible&&e.mass>0)for(const s of t.model.container.children)s.material=t.body.sleepState===2?this.models.materials.dynamicSleeping:this.models.materials.dynamic}),t.reset=()=>{t.body.position.copy(t.origin.position),t.body.quaternion.copy(t.origin.quaternion),t.origin.sleep&&t.body.sleep()},t}}class YU extends ec{constructor(e){super(),this.position=e.position,this.halfExtents=e.halfExtents,this.data=e.data,this.isIn=!1,this.mesh=new je(new dn(e.halfExtents.x*2,e.halfExtents.y*2,3,1,1,1),new Bt({color:16711935,wireframe:!0})),this.mesh.position.x=e.position.x,this.mesh.position.y=e.position.y,this.mesh.position.z=1.5}}class $U{constructor(e){this.time=e.time,this.sizes=e.sizes,this.physics=e.physics,this.debug=e.debug,this.container=new ft,this.container.visible=!1,this.container.matrixAutoUpdate=!1,this.debug&&(this.debugFolder=this.debug.addFolder("zones"),this.debugFolder.open(),this.debugFolder.add(this.container,"visible").name("visible")),this.setTester(),this.setItems()}setTester(){this.tester={},this.tester.x=0,this.tester.y=0,this.time.on("tick",()=>{this.tester.x=this.physics.car.chassis.body.position.x,this.tester.y=this.physics.car.chassis.body.position.y})}setItems(){this.items=[],this.time.on("tick",()=>{for(const e of this.items){const t=this.tester.x<e.position.x+e.halfExtents.x&&this.tester.x>e.position.x-e.halfExtents.x&&this.tester.y<e.position.y+e.halfExtents.y&&this.tester.y>e.position.y-e.halfExtents.y;t&&!e.isIn?e.trigger("in",[e.data]):!t&&e.isIn&&e.trigger("out",[e.data]),e.isIn=t}})}add(e){const t=new YU(e);return this.container.add(t.mesh),this.items.push(t),t}}function QU(i,e=!1){const t=i[0].index!==null,n=new Set(Object.keys(i[0].attributes)),r=new Set(Object.keys(i[0].morphAttributes)),s={},o={},a=i[0].morphTargetsRelative,c=new vt;let h=0;for(let d=0;d<i.length;++d){const l=i[d];let u=0;if(t!==(l.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const p in l.attributes){if(!n.has(p))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+'. All geometries must have compatible attributes; make sure "'+p+'" attribute exists among all geometries, or in none of them.'),null;s[p]===void 0&&(s[p]=[]),s[p].push(l.attributes[p]),u++}if(u!==n.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+". Make sure all geometries have the same number of attributes."),null;if(a!==l.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const p in l.morphAttributes){if(!r.has(p))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+".  .morphAttributes must be consistent throughout all geometries."),null;o[p]===void 0&&(o[p]=[]),o[p].push(l.morphAttributes[p])}if(c.userData.mergedUserData=c.userData.mergedUserData||[],c.userData.mergedUserData.push(l.userData),e){let p;if(t)p=l.index.count;else if(l.attributes.position!==void 0)p=l.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+". The geometry must have either an index or a position attribute"),null;c.addGroup(h,p,d),h+=p}}if(t){let d=0;const l=[];for(let u=0;u<i.length;++u){const p=i[u].index;for(let g=0;g<p.count;++g)l.push(p.getX(g)+d);d+=i[u].attributes.position.count}c.setIndex(l)}for(const d in s){const l=VT(s[d]);if(!l)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+d+" attribute."),null;c.setAttribute(d,l)}for(const d in o){const l=o[d][0].length;if(l===0)break;c.morphAttributes=c.morphAttributes||{},c.morphAttributes[d]=[];for(let u=0;u<l;++u){const p=[];for(let y=0;y<o[d].length;++y)p.push(o[d][y][u]);const g=VT(p);if(!g)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+d+" morphAttribute."),null;c.morphAttributes[d].push(g)}}return c}function VT(i){let e,t,n,r=0;for(let a=0;a<i.length;++a){const c=i[a];if(c.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(e===void 0&&(e=c.array.constructor),e!==c.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(t===void 0&&(t=c.itemSize),t!==c.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(n===void 0&&(n=c.normalized),n!==c.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;r+=c.array.length}const s=new e(r);let o=0;for(let a=0;a<i.length;++a)s.set(i[a].array,o),o+=i[a].array.length;return new zt(s,t,n)}class ZU{constructor(e){this.time=e.time,this.resources=e.resources,this.materials=e.materials,this.physics=e.physics,this.shadows=e.shadows,this.sounds=e.sounds,this.debug=e.debug,this.container=new ft,this.container.matrixAutoUpdate=!1,this.items=[],this.floorShadows=[],this.setParsers(),this.setMerge()}setParsers(){this.parsers={},this.parsers.items=[{regex:/^shade([a-z]+)_?[0-9]{0,3}?/i,apply:(e,t)=>{const n=e.name.match(/^shade([a-z]+)_?[0-9]{0,3}?/i),r=`${n[1].substring(0,1).toLowerCase()}${n[1].substring(1)}`;let s=this.materials.shades.items[r];typeof s=="undefined"&&(s=new Bu);const o=t.duplicated?e.clone():e;if(o.material=s,o.children.length)for(const a of o.children)a instanceof je&&(a.material=s);return o}},{regex:/^pure([a-z]+)_?[0-9]{0,3}?/i,apply:(e,t)=>{const r=e.name.match(/^pure([a-z]+)_?[0-9]{0,3}?/i)[1].toLowerCase();let s=this.materials.pures.items[r];typeof s=="undefined"&&(s=new Bu);const o=t.duplicated?e.clone():e;return o.material=s,o}},{regex:/^floor_?[0-9]{0,3}?/i,apply:(e,t)=>{const n=new xn(e.scale.x,e.scale.y,10,10),r=this.materials.items.floorShadow.clone();r.uniforms.tShadow.value=t.floorShadowTexture,r.uniforms.uShadowColor.value=new qe(this.materials.items.floorShadow.shadowColor),r.uniforms.uAlpha.value=0;const s=new je(n,r);return s.matrixAutoUpdate=!1,s.updateMatrix(),this.floorShadows.push(s),s}}],this.parsers.default={},this.parsers.default.apply=e=>{const t=e.clone();return t.material=this.materials.shades.items.white,t}}setMerge(){this.merge={},this.merge.items={},this.merge.container=new ft,this.merge.container.matrixAutoUpdate=!1,this.container.add(this.merge.container),this.merge.add=(e,t)=>{let n=this.merge.items[e];n||(n={},n.geometry=new vt,n.geometriesToMerge=[],n.material=t.material,n.material.side=Es,n.mesh=new je(n.geometry,n.material),this.merge.container.add(n.mesh),this.merge.items[e]=n);const r=t.geometry;t.updateMatrixWorld(),r.applyMatrix(t.matrixWorld),n.geometriesToMerge.push(r)},this.merge.applyMerge=()=>{for(const e in this.merge.items){const t=this.merge.items[e];t.geometry=QU(t.geometriesToMerge),t.mesh.geometry=t.geometry}},this.merge.update=()=>{for(const e of this.items)if(e.shouldMerge){const t=[...e.container.children];for(const n of t){const r=n.material.name;r!==""&&(this.merge.add(r,n),e.container.remove(n))}e.shouldMerge=!1}this.merge.applyMerge()}}getConvertedMesh(e,t={}){const n=new ft,r=new B,s=[...e];for(const o of s)if(o.name.match(/^center_?[0-9]{0,3}?/i)&&r.set(o.position.x,o.position.y,o.position.z),o instanceof je){let a=this.parsers.items.find(h=>o.name.match(h.regex));typeof a=="undefined"&&(a=this.parsers.default);const c=a.apply(o,t);n.add(c)}if(r.length()>0){for(const o of n.children)o.position.sub(r);n.position.add(r)}return t.mass&&t.mass===0&&(n.matrixAutoUpdate=!1,n.updateMatrix()),n}add(e){const t={};t.merged=!1,t.shouldMerge=e.mass===0;const n=new B;e.offset&&n.copy(e.offset);const r=new Et;e.rotation&&r.copy(e.rotation);const s=typeof e.sleep=="undefined"?!0:e.sleep;if(t.container=this.getConvertedMesh(e.base.children,e),t.container.position.copy(n),t.container.rotation.copy(r),this.container.add(t.container),e.mass===0){t.container.matrixAutoUpdate=!1,t.container.updateMatrix();for(const o of t.container.children)o.matrixAutoUpdate=!1,o.updateMatrix()}t.collision=this.physics.addObjectFromThree({meshes:[...e.collision.children],offset:n,rotation:r,mass:e.mass,sleep:s});for(const o of t.container.children)o.position.sub(t.collision.center);return e.soundName&&t.collision.body.addEventListener("collide",o=>{const a=o.contact.getImpactVelocityAlongNormal();this.sounds.play(e.soundName,a)}),e.shadow&&this.shadows.add(t.container,e.shadow),e.mass>0&&this.time.on("tick",()=>{t.container.position.copy(t.collision.body.position),t.container.quaternion.copy(t.collision.body.quaternion)}),this.items.push(t),t}}class KU{constructor(e){this.time=e.time,this.resources=e.resources,this.objects=e.objects,this.physics=e.physics,this.shadows=e.shadows,this.materials=e.materials,this.controls=e.controls,this.sounds=e.sounds,this.renderer=e.renderer,this.camera=e.camera,this.debug=e.debug,this.config=e.config,this.container=new ft,this.position=new B,this.debug&&(this.debugFolder=this.debug.addFolder("car")),this.setModels(),this.setMovement(),this.setChassis(),this.setAntena(),this.setBackLights(),this.setWheels(),this.setTransformControls(),this.setShootingBall(),this.setKlaxon()}setModels(){this.models={},this.config.cyberTruck?(this.models.chassis=this.resources.items.carCyberTruckChassis,this.models.antena=this.resources.items.carCyberTruckAntena,this.models.backLightsBrake=this.resources.items.carCyberTruckBackLightsBrake,this.models.backLightsReverse=this.resources.items.carCyberTruckBackLightsReverse,this.models.wheel=this.resources.items.carCyberTruckWheel):(this.models.chassis=this.resources.items.carDefaultChassis,this.models.antena=this.resources.items.carDefaultAntena,this.models.backLightsBrake=this.resources.items.carDefaultBackLightsBrake,this.models.backLightsReverse=this.resources.items.carDefaultBackLightsReverse,this.models.wheel=this.resources.items.carDefaultWheel)}setMovement(){this.movement={},this.movement.speed=new B,this.movement.localSpeed=new B,this.movement.acceleration=new B,this.movement.localAcceleration=new B,this.time.on("tick",()=>{const e=new B;e.copy(this.chassis.object.position).sub(this.chassis.oldPosition),this.movement.acceleration=e.clone().sub(this.movement.speed),this.movement.speed.copy(e),this.movement.localSpeed=this.movement.speed.clone().applyAxisAngle(new B(0,0,1),-this.chassis.object.rotation.z),this.movement.localAcceleration=this.movement.acceleration.clone().applyAxisAngle(new B(0,0,1),-this.chassis.object.rotation.z),this.sounds.engine.speed=this.movement.localSpeed.x,this.sounds.engine.acceleration=this.controls.actions.up?this.controls.actions.boost?1:.5:0,this.movement.localAcceleration.x>.01&&this.sounds.play("screech")})}setChassis(){this.chassis={},this.chassis.offset=new B(0,0,-.28),this.chassis.object=this.objects.getConvertedMesh(this.models.chassis.scene.children),this.chassis.object.position.copy(this.physics.car.chassis.body.position),this.chassis.oldPosition=this.chassis.object.position.clone(),this.container.add(this.chassis.object),this.shadows.add(this.chassis.object,{sizeX:3,sizeY:2,offsetZ:.2}),this.time.on("tick",()=>{this.chassis.oldPosition=this.chassis.object.position.clone(),this.transformControls.enabled||(this.chassis.object.position.copy(this.physics.car.chassis.body.position).add(this.chassis.offset),this.chassis.object.quaternion.copy(this.physics.car.chassis.body.quaternion)),this.position.copy(this.chassis.object.position)})}setAntena(){if(this.antena={},this.antena.speedStrength=10,this.antena.damping=.035,this.antena.pullBackStrength=.02,this.antena.object=this.objects.getConvertedMesh(this.models.antena.scene.children),this.chassis.object.add(this.antena.object),this.antena.speed=new Me,this.antena.absolutePosition=new Me,this.antena.localPosition=new Me,this.time.on("tick",()=>{const t=Math.min(Math.max(this.movement.acceleration.x,-1),1),n=Math.min(Math.max(this.movement.acceleration.y,-1),1);this.antena.speed.x-=t*this.antena.speedStrength,this.antena.speed.y-=n*this.antena.speedStrength;const r=this.antena.absolutePosition.clone(),s=r.negate().multiplyScalar(r.length()*this.antena.pullBackStrength);this.antena.speed.add(s),this.antena.speed.x*=1-this.antena.damping,this.antena.speed.y*=1-this.antena.damping,this.antena.absolutePosition.add(this.antena.speed),this.antena.localPosition.copy(this.antena.absolutePosition),this.antena.localPosition.rotateAround(new Me,-this.chassis.object.rotation.z),this.antena.object.rotation.y=this.antena.localPosition.x*.1,this.antena.object.rotation.x=this.antena.localPosition.y*.1}),this.debug){const e=this.debugFolder.addFolder("antena");e.open(),e.add(this.antena,"speedStrength").step(.001).min(0).max(50),e.add(this.antena,"damping").step(1e-4).min(0).max(.1),e.add(this.antena,"pullBackStrength").step(1e-4).min(0).max(.1)}}setBackLights(){this.backLightsBrake={},this.backLightsBrake.material=this.materials.pures.items.red.clone(),this.backLightsBrake.material.transparent=!0,this.backLightsBrake.material.opacity=.5,this.backLightsBrake.object=this.objects.getConvertedMesh(this.models.backLightsBrake.scene.children);for(const e of this.backLightsBrake.object.children)e.material=this.backLightsBrake.material;this.chassis.object.add(this.backLightsBrake.object),this.backLightsReverse={},this.backLightsReverse.material=this.materials.pures.items.yellow.clone(),this.backLightsReverse.material.transparent=!0,this.backLightsReverse.material.opacity=.5,this.backLightsReverse.object=this.objects.getConvertedMesh(this.models.backLightsReverse.scene.children);for(const e of this.backLightsReverse.object.children)e.material=this.backLightsReverse.material;this.chassis.object.add(this.backLightsReverse.object),this.time.on("tick",()=>{this.backLightsBrake.material.opacity=this.physics.controls.actions.brake?1:.5,this.backLightsReverse.material.opacity=this.physics.controls.actions.down?1:.5})}setWheels(){this.wheels={},this.wheels.object=this.objects.getConvertedMesh(this.models.wheel.scene.children),this.wheels.items=[];for(let e=0;e<4;e++){const t=this.wheels.object.clone();this.wheels.items.push(t),this.container.add(t)}this.time.on("tick",()=>{if(!this.transformControls.enabled)for(const e in this.physics.car.wheels.bodies){const t=this.physics.car.wheels.bodies[e],n=this.wheels.items[e];n.position.copy(t.position),n.quaternion.copy(t.quaternion)}})}setTransformControls(){if(this.transformControls=new U1(this.camera.instance,this.renderer.domElement),this.transformControls.size=.5,this.transformControls.attach(this.chassis.object),this.transformControls.enabled=!1,this.transformControls.visible=this.transformControls.enabled,document.addEventListener("keydown",e=>{this.mode==="transformControls"&&(e.key==="r"?this.transformControls.setMode("rotate"):e.key==="g"&&this.transformControls.setMode("translate"))}),this.transformControls.addEventListener("dragging-changed",e=>{this.camera.orbitControls.enabled=!e.value}),this.container.add(this.transformControls),this.debug){const e=this.debugFolder.addFolder("controls");e.open(),e.add(this.transformControls,"enabled").onChange(()=>{this.transformControls.visible=this.transformControls.enabled})}}setShootingBall(){!this.config.cyberTruck||window.addEventListener("keydown",e=>{if(e.key==="b"){const t=Math.random()*Math.PI*2,n=10,r=this.position.x+Math.cos(t)*n,s=this.position.y+Math.sin(t)*n,o=2+2*Math.random(),a=this.objects.add({base:this.resources.items.bowlingBallBase.scene,collision:this.resources.items.bowlingBallCollision.scene,offset:new B(r,s,o),rotation:new Et(Math.PI*.5,0,0),duplicated:!0,shadow:{sizeX:1.5,sizeY:1.5,offsetZ:-.15,alpha:.35},mass:5,soundName:"bowlingBall",sleep:!1});let h=new kt.Vec3(this.position.x,this.position.y,this.position.z+1).vsub(a.collision.body.position);h.normalize(),h=h.scale(100),a.collision.body.applyImpulse(h,a.collision.body.position)}})}setKlaxon(){this.klaxon={},this.klaxon.waitDuration=150,this.klaxon.can=!0,window.addEventListener("keydown",e=>{if(e.key==="h"&&this.klaxon.can&&(this.klaxon.can=!1,window.setTimeout(()=>{this.klaxon.can=!0},this.klaxon.waitDuration),this.physics.car.jump(!1,20),this.sounds.play(Math.random()<.002?"carHorn2":"carHorn1")),e.key==="k"){const t=this.position.x+(Math.random()-.5)*3,n=this.position.y+(Math.random()-.5)*3,r=6+2*Math.random();this.objects.add({base:this.resources.items.hornBase.scene,collision:this.resources.items.hornCollision.scene,offset:new B(t,n,r),rotation:new Et(Math.random()*Math.PI*2,Math.random()*Math.PI*2,Math.random()*Math.PI*2),duplicated:!0,shadow:{sizeX:1.5,sizeY:1.5,offsetZ:-.15,alpha:.35},mass:5,soundName:"horn",sleep:!1})}})}}/*!
 * VERSION: 2.1.3
 * DATE: 2019-05-17
 * UPDATES AND DOCS AT: http://greensock.com
 *
 * @license Copyright (c) 2008-2019, GreenSock. All rights reserved.
 * This work is subject to the terms at http://greensock.com/standard-license or for
 * Club GreenSock members, the software agreement that was issued with your membership.
 *
 * @author: Jack Doyle, jack@greensock.com
 */var _d=typeof window!="undefined"?window:typeof e_!="undefined"&&e_.exports&&typeof global!="undefined"?global:globalThis||{},Ct=function(i){var e=i.document,t=i.GreenSockGlobals=i.GreenSockGlobals||i;if(t.TweenLite)return t.TweenLite;var n=function(L){var V=L.split("."),P=t,T;for(T=0;T<V.length;T++)P[V[T]]=P=P[V[T]]||{};return P},r=n("com.greensock"),s=1e-8,o=function(L){var V=[],P=L.length,T;for(T=0;T!==P;V.push(L[T++]));return V},a=function(){},c=function(){var L=Object.prototype.toString,V=L.call([]);return function(P){return P!=null&&(P instanceof Array||typeof P=="object"&&!!P.push&&L.call(P)===V)}}(),h,d,l,u,p,g={},y=function(L,V,P,T){this.sc=g[L]?g[L].sc:[],g[L]=this,this.gsClass=null,this.func=P;var q=[];this.check=function(re){for(var pe=V.length,ge=pe,be,G,Ae,Fe;--pe>-1;)(be=g[V[pe]]||new y(V[pe],[])).gsClass?(q[pe]=be.gsClass,ge--):re&&be.sc.push(this);if(ge===0&&P)for(G=("com.greensock."+L).split("."),Ae=G.pop(),Fe=n(G.join("."))[Ae]=this.gsClass=P.apply(P,q),T&&(t[Ae]=Fe),pe=0;pe<this.sc.length;pe++)this.sc[pe].check()},this.check(!0)},x=i._gsDefine=function(L,V,P,T){return new y(L,V,P,T)},v=r._class=function(L,V,P){return V=V||function(){},x(L,[],function(){return V},P),V};x.globals=t;var w=[0,0,1,1],S=v("easing.Ease",function(L,V,P,T){this._func=L,this._type=P||0,this._power=T||0,this._params=V?w.concat(V):w},!0),b=S.map={},E=S.register=function(L,V,P,T){for(var q=V.split(","),re=q.length,pe=(P||"easeIn,easeOut,easeInOut").split(","),ge,be,G,Ae;--re>-1;)for(be=q[re],ge=T?v("easing."+be,null,!0):r.easing[be]||{},G=pe.length;--G>-1;)Ae=pe[G],b[be+"."+Ae]=b[Ae+be]=ge[Ae]=L.getRatio?L:L[Ae]||new L};for(l=S.prototype,l._calcEnd=!1,l.getRatio=function(L){if(this._func)return this._params[0]=L,this._func.apply(null,this._params);var V=this._type,P=this._power,T=V===1?1-L:V===2?L:L<.5?L*2:(1-L)*2;return P===1?T*=T:P===2?T*=T*T:P===3?T*=T*T*T:P===4&&(T*=T*T*T*T),V===1?1-T:V===2?T:L<.5?T/2:1-T/2},h=["Linear","Quad","Cubic","Quart","Quint,Strong"],d=h.length;--d>-1;)l=h[d]+",Power"+d,E(new S(null,null,1,d),l,"easeOut",!0),E(new S(null,null,2,d),l,"easeIn"+(d===0?",easeNone":"")),E(new S(null,null,3,d),l,"easeInOut");b.linear=r.easing.Linear.easeIn,b.swing=r.easing.Quad.easeInOut;var R=v("events.EventDispatcher",function(L){this._listeners={},this._eventTarget=L||this});l=R.prototype,l.addEventListener=function(L,V,P,T,q){q=q||0;var re=this._listeners[L],pe=0,ge,be;for(this===u&&!p&&u.wake(),re==null&&(this._listeners[L]=re=[]),be=re.length;--be>-1;)ge=re[be],ge.c===V&&ge.s===P?re.splice(be,1):pe===0&&ge.pr<q&&(pe=be+1);re.splice(pe,0,{c:V,s:P,up:T,pr:q})},l.removeEventListener=function(L,V){var P=this._listeners[L],T;if(P){for(T=P.length;--T>-1;)if(P[T].c===V){P.splice(T,1);return}}},l.dispatchEvent=function(L){var V=this._listeners[L],P,T,q;if(V)for(P=V.length,P>1&&(V=V.slice(0)),T=this._eventTarget;--P>-1;)q=V[P],q&&(q.up?q.c.call(q.s||T,{type:L,target:T}):q.c.call(q.s||T))};var z=i.requestAnimationFrame,I=i.cancelAnimationFrame,N=Date.now||function(){return new Date().getTime()},F=N();for(h=["ms","moz","webkit","o"],d=h.length;--d>-1&&!z;)z=i[h[d]+"RequestAnimationFrame"],I=i[h[d]+"CancelAnimationFrame"]||i[h[d]+"CancelRequestAnimationFrame"];v("Ticker",function(L,V){var P=this,T=N(),q=V!==!1&&z?"auto":!1,re=500,pe=33,ge="tick",be,G,Ae,Fe,Ve,oe=function(Ne){var Je=N()-F,ae,Te;Je>re&&(T+=Je-pe),F+=Je,P.time=(F-T)/1e3,ae=P.time-Ve,(!be||ae>0||Ne===!0)&&(P.frame++,Ve+=ae+(ae>=Fe?.004:Fe-ae),Te=!0),Ne!==!0&&(Ae=G(oe)),Te&&P.dispatchEvent(ge)};R.call(P),P.time=P.frame=0,P.tick=function(){oe(!0)},P.lagSmoothing=function(Ne,Je){if(!arguments.length)return re<1/s;re=Ne||1/s,pe=Math.min(Je,re,0)},P.sleep=function(){Ae!=null&&(!q||!I?clearTimeout(Ae):I(Ae),G=a,Ae=null,P===u&&(p=!1))},P.wake=function(Ne){Ae!==null?P.sleep():Ne?T+=-F+(F=N()):P.frame>10&&(F=N()-re+5),G=be===0?a:!q||!z?function(Je){return setTimeout(Je,(Ve-P.time)*1e3+1|0)}:z,P===u&&(p=!0),oe(2)},P.fps=function(Ne){if(!arguments.length)return be;be=Ne,Fe=1/(be||60),Ve=this.time+Fe,P.wake()},P.useRAF=function(Ne){if(!arguments.length)return q;P.sleep(),q=Ne,P.fps(be)},P.fps(L),setTimeout(function(){q==="auto"&&P.frame<5&&(e||{}).visibilityState!=="hidden"&&P.useRAF(!1)},1500)}),l=r.Ticker.prototype=new r.events.EventDispatcher,l.constructor=r.Ticker;var C=v("core.Animation",function(L,V){if(this.vars=V=V||{},this._duration=this._totalDuration=L||0,this._delay=Number(V.delay)||0,this._timeScale=1,this._active=!!V.immediateRender,this.data=V.data,this._reversed=!!V.reversed,!!me){p||u.wake();var P=this.vars.useFrames?Ce:me;P.add(this,P._time),this.vars.paused&&this.paused(!0)}});u=C.ticker=new r.Ticker,l=C.prototype,l._dirty=l._gc=l._initted=l._paused=!1,l._totalTime=l._time=0,l._rawPrevTime=-1,l._next=l._last=l._onUpdate=l._timeline=l.timeline=null,l._paused=!1;var O=function(){p&&N()-F>2e3&&((e||{}).visibilityState!=="hidden"||!u.lagSmoothing())&&u.wake();var L=setTimeout(O,2e3);L.unref&&L.unref()};O(),l.play=function(L,V){return L!=null&&this.seek(L,V),this.reversed(!1).paused(!1)},l.pause=function(L,V){return L!=null&&this.seek(L,V),this.paused(!0)},l.resume=function(L,V){return L!=null&&this.seek(L,V),this.paused(!1)},l.seek=function(L,V){return this.totalTime(Number(L),V!==!1)},l.restart=function(L,V){return this.reversed(!1).paused(!1).totalTime(L?-this._delay:0,V!==!1,!0)},l.reverse=function(L,V){return L!=null&&this.seek(L||this.totalDuration(),V),this.reversed(!0).paused(!1)},l.render=function(L,V,P){},l.invalidate=function(){return this._time=this._totalTime=0,this._initted=this._gc=!1,this._rawPrevTime=-1,(this._gc||!this.timeline)&&this._enabled(!0),this},l.isActive=function(){var L=this._timeline,V=this._startTime,P;return!L||!this._gc&&!this._paused&&L.isActive()&&(P=L.rawTime(!0))>=V&&P<V+this.totalDuration()/this._timeScale-s},l._enabled=function(L,V){return p||u.wake(),this._gc=!L,this._active=this.isActive(),V!==!0&&(L&&!this.timeline?this._timeline.add(this,this._startTime-this._delay):!L&&this.timeline&&this._timeline._remove(this,!0)),!1},l._kill=function(L,V){return this._enabled(!1,!1)},l.kill=function(L,V){return this._kill(L,V),this},l._uncache=function(L){for(var V=L?this:this.timeline;V;)V._dirty=!0,V=V.timeline;return this},l._swapSelfInParams=function(L){for(var V=L.length,P=L.concat();--V>-1;)L[V]==="{self}"&&(P[V]=this);return P},l._callback=function(L){var V=this.vars,P=V[L],T=V[L+"Params"],q=V[L+"Scope"]||V.callbackScope||this,re=T?T.length:0;switch(re){case 0:P.call(q);break;case 1:P.call(q,T[0]);break;case 2:P.call(q,T[0],T[1]);break;default:P.apply(q,T)}},l.eventCallback=function(L,V,P,T){if((L||"").substr(0,2)==="on"){var q=this.vars;if(arguments.length===1)return q[L];V==null?delete q[L]:(q[L]=V,q[L+"Params"]=c(P)&&P.join("").indexOf("{self}")!==-1?this._swapSelfInParams(P):P,q[L+"Scope"]=T),L==="onUpdate"&&(this._onUpdate=V)}return this},l.delay=function(L){return arguments.length?(this._timeline.smoothChildTiming&&this.startTime(this._startTime+L-this._delay),this._delay=L,this):this._delay},l.duration=function(L){return arguments.length?(this._duration=this._totalDuration=L,this._uncache(!0),this._timeline.smoothChildTiming&&this._time>0&&this._time<this._duration&&L!==0&&this.totalTime(this._totalTime*(L/this._duration),!0),this):(this._dirty=!1,this._duration)},l.totalDuration=function(L){return this._dirty=!1,arguments.length?this.duration(L):this._totalDuration},l.time=function(L,V){return arguments.length?(this._dirty&&this.totalDuration(),this.totalTime(L>this._duration?this._duration:L,V)):this._time},l.totalTime=function(L,V,P){if(p||u.wake(),!arguments.length)return this._totalTime;if(this._timeline){if(L<0&&!P&&(L+=this.totalDuration()),this._timeline.smoothChildTiming){this._dirty&&this.totalDuration();var T=this._totalDuration,q=this._timeline;if(L>T&&!P&&(L=T),this._startTime=(this._paused?this._pauseTime:q._time)-(this._reversed?T-L:L)/this._timeScale,q._dirty||this._uncache(!1),q._timeline)for(;q._timeline;)q._timeline._time!==(q._startTime+q._totalTime)/q._timeScale&&q.totalTime(q._totalTime,!0),q=q._timeline}this._gc&&this._enabled(!0,!1),(this._totalTime!==L||this._duration===0)&&(j.length&&we(),this.render(L,V,!1),j.length&&we())}return this},l.progress=l.totalProgress=function(L,V){var P=this.duration();return arguments.length?this.totalTime(P*L,V):P?this._time/P:this.ratio},l.startTime=function(L){return arguments.length?(L!==this._startTime&&(this._startTime=L,this.timeline&&this.timeline._sortChildren&&this.timeline.add(this,L-this._delay)),this):this._startTime},l.endTime=function(L){return this._startTime+(L!=!1?this.totalDuration():this.duration())/this._timeScale},l.timeScale=function(L){if(!arguments.length)return this._timeScale;var V,P;for(L=L||s,this._timeline&&this._timeline.smoothChildTiming&&(V=this._pauseTime,P=V||V===0?V:this._timeline.totalTime(),this._startTime=P-(P-this._startTime)*this._timeScale/L),this._timeScale=L,P=this.timeline;P&&P.timeline;)P._dirty=!0,P.totalDuration(),P=P.timeline;return this},l.reversed=function(L){return arguments.length?(L!=this._reversed&&(this._reversed=L,this.totalTime(this._timeline&&!this._timeline.smoothChildTiming?this.totalDuration()-this._totalTime:this._totalTime,!0)),this):this._reversed},l.paused=function(L){if(!arguments.length)return this._paused;var V=this._timeline,P,T;return L!=this._paused&&V&&(!p&&!L&&u.wake(),P=V.rawTime(),T=P-this._pauseTime,!L&&V.smoothChildTiming&&(this._startTime+=T,this._uncache(!1)),this._pauseTime=L?P:null,this._paused=L,this._active=this.isActive(),!L&&T!==0&&this._initted&&this.duration()&&(P=V.smoothChildTiming?this._totalTime:(P-this._startTime)/this._timeScale,this.render(P,P===this._totalTime,!0))),this._gc&&!L&&this._enabled(!0,!1),this};var X=v("core.SimpleTimeline",function(L){C.call(this,0,L),this.autoRemoveChildren=this.smoothChildTiming=!0});l=X.prototype=new C,l.constructor=X,l.kill()._gc=!1,l._first=l._last=l._recent=null,l._sortChildren=!1,l.add=l.insert=function(L,V,P,T){var q,re;if(L._startTime=Number(V||0)+L._delay,L._paused&&this!==L._timeline&&(L._pauseTime=this.rawTime()-(L._timeline.rawTime()-L._pauseTime)),L.timeline&&L.timeline._remove(L,!0),L.timeline=L._timeline=this,L._gc&&L._enabled(!0,!0),q=this._last,this._sortChildren)for(re=L._startTime;q&&q._startTime>re;)q=q._prev;return q?(L._next=q._next,q._next=L):(L._next=this._first,this._first=L),L._next?L._next._prev=L:this._last=L,L._prev=q,this._recent=L,this._timeline&&this._uncache(!0),this},l._remove=function(L,V){return L.timeline===this&&(V||L._enabled(!1,!0),L._prev?L._prev._next=L._next:this._first===L&&(this._first=L._next),L._next?L._next._prev=L._prev:this._last===L&&(this._last=L._prev),L._next=L._prev=L.timeline=null,L===this._recent&&(this._recent=this._last),this._timeline&&this._uncache(!0)),this},l.render=function(L,V,P){var T=this._first,q;for(this._totalTime=this._time=this._rawPrevTime=L;T;)q=T._next,(T._active||L>=T._startTime&&!T._paused&&!T._gc)&&(T._reversed?T.render((T._dirty?T.totalDuration():T._totalDuration)-(L-T._startTime)*T._timeScale,V,P):T.render((L-T._startTime)*T._timeScale,V,P)),T=q},l.rawTime=function(){return p||u.wake(),this._totalTime};var U=v("TweenLite",function(L,V,P){if(C.call(this,V,P),this.render=U.prototype.render,L==null)throw"Cannot tween a null target.";this.target=L=typeof L!="string"?L:U.selector(L)||L;var T=L.jquery||L.length&&L!==i&&L[0]&&(L[0]===i||L[0].nodeType&&L[0].style&&!L.nodeType),q=this.vars.overwrite,re,pe,ge;if(this._overwrite=q=q==null?he[U.defaultOverwrite]:typeof q=="number"?q>>0:he[q],(T||L instanceof Array||L.push&&c(L))&&typeof L[0]!="number")for(this._targets=ge=o(L),this._propLookup=[],this._siblings=[],re=0;re<ge.length;re++){if(pe=ge[re],pe){if(typeof pe=="string"){pe=ge[re--]=U.selector(pe),typeof pe=="string"&&ge.splice(re+1,1);continue}else if(pe.length&&pe!==i&&pe[0]&&(pe[0]===i||pe[0].nodeType&&pe[0].style&&!pe.nodeType)){ge.splice(re--,1),this._targets=ge=ge.concat(o(pe));continue}}else{ge.splice(re--,1);continue}this._siblings[re]=ye(pe,this,!1),q===1&&this._siblings[re].length>1&&it(pe,this,null,1,this._siblings[re])}else this._propLookup={},this._siblings=ye(L,this,!1),q===1&&this._siblings.length>1&&it(L,this,null,1,this._siblings);(this.vars.immediateRender||V===0&&this._delay===0&&this.vars.immediateRender!==!1)&&(this._time=-s,this.render(Math.min(0,-this._delay)))},!0),te=function(L){return L&&L.length&&L!==i&&L[0]&&(L[0]===i||L[0].nodeType&&L[0].style&&!L.nodeType)},ne=function(L,V){var P={},T;for(T in L)!de[T]&&(!(T in V)||T==="transform"||T==="x"||T==="y"||T==="width"||T==="height"||T==="className"||T==="border")&&(!Z[T]||Z[T]&&Z[T]._autoCSS)&&(P[T]=L[T],delete L[T]);L.css=P};l=U.prototype=new C,l.constructor=U,l.kill()._gc=!1,l.ratio=0,l._firstPT=l._targets=l._overwrittenProps=l._startAt=null,l._notifyPluginsOfEnabled=l._lazy=!1,U.version="2.1.3",U.defaultEase=l._ease=new S(null,null,1,1),U.defaultOverwrite="auto",U.ticker=u,U.autoSleep=120,U.lagSmoothing=function(L,V){u.lagSmoothing(L,V)},U.selector=i.$||i.jQuery||function(L){var V=i.$||i.jQuery;return V?(U.selector=V,V(L)):(e||(e=i.document),e?e.querySelectorAll?e.querySelectorAll(L):e.getElementById(L.charAt(0)==="#"?L.substr(1):L):L)};var j=[],k={},W=/(?:(-|-=|\+=)?\d*\.?\d*(?:e[\-+]?\d+)?)[0-9]/ig,Y=/[\+-]=-?[\.\d]/,H=function(L){for(var V=this._firstPT,P=1e-6,T;V;)T=V.blob?L===1&&this.end!=null?this.end:L?this.join(""):this.start:V.c*L+V.s,V.m?T=V.m.call(this._tween,T,this._target||V.t,this._tween):T<P&&T>-P&&!V.blob&&(T=0),V.f?V.fp?V.t[V.p](V.fp,T):V.t[V.p](T):V.t[V.p]=T,V=V._next},J=function(L){return(L*1e3|0)/1e3+""},K=function(L,V,P,T){var q=[],re=0,pe="",ge=0,be,G,Ae,Fe,Ve,oe,Ne;for(q.start=L,q.end=V,L=q[0]=L+"",V=q[1]=V+"",P&&(P(q),L=q[0],V=q[1]),q.length=0,be=L.match(W)||[],G=V.match(W)||[],T&&(T._next=null,T.blob=1,q._firstPT=q._applyPT=T),Ve=G.length,Fe=0;Fe<Ve;Fe++)Ne=G[Fe],oe=V.substr(re,V.indexOf(Ne,re)-re),pe+=oe||!Fe?oe:",",re+=oe.length,ge?ge=(ge+1)%5:oe.substr(-5)==="rgba("&&(ge=1),Ne===be[Fe]||be.length<=Fe?pe+=Ne:(pe&&(q.push(pe),pe=""),Ae=parseFloat(be[Fe]),q.push(Ae),q._firstPT={_next:q._firstPT,t:q,p:q.length-1,s:Ae,c:(Ne.charAt(1)==="="?parseInt(Ne.charAt(0)+"1",10)*parseFloat(Ne.substr(2)):parseFloat(Ne)-Ae)||0,f:0,m:ge&&ge<4?Math.round:J}),re+=Ne.length;return pe+=V.substr(re),pe&&q.push(pe),q.setRatio=H,Y.test(V)&&(q.end=null),q},ee=function(L,V,P,T,q,re,pe,ge,be){typeof T=="function"&&(T=T(be||0,L));var G=typeof L[V],Ae=G!=="function"?"":V.indexOf("set")||typeof L["get"+V.substr(3)]!="function"?V:"get"+V.substr(3),Fe=P!=="get"?P:Ae?pe?L[Ae](pe):L[Ae]():L[V],Ve=typeof T=="string"&&T.charAt(1)==="=",oe={t:L,p:V,s:Fe,f:G==="function",pg:0,n:q||V,m:re?typeof re=="function"?re:Math.round:0,pr:0,c:Ve?parseInt(T.charAt(0)+"1",10)*parseFloat(T.substr(2)):parseFloat(T)-Fe||0},Ne;if((typeof Fe!="number"||typeof T!="number"&&!Ve)&&(pe||isNaN(Fe)||!Ve&&isNaN(T)||typeof Fe=="boolean"||typeof T=="boolean"?(oe.fp=pe,Ne=K(Fe,Ve?parseFloat(oe.s)+oe.c+(oe.s+"").replace(/[0-9\-\.]/g,""):T,ge||U.defaultStringFilter,oe),oe={t:Ne,p:"setRatio",s:0,c:1,f:2,pg:0,n:q||V,pr:0,m:0}):(oe.s=parseFloat(Fe),Ve||(oe.c=parseFloat(T)-oe.s||0))),oe.c)return(oe._next=this._firstPT)&&(oe._next._prev=oe),this._firstPT=oe,oe},$=U._internals={isArray:c,isSelector:te,lazyTweens:j,blobDif:K},Z=U._plugins={},Ee=$.tweenLookup={},Se=0,de=$.reservedProps={ease:1,delay:1,overwrite:1,onComplete:1,onCompleteParams:1,onCompleteScope:1,useFrames:1,runBackwards:1,startAt:1,onUpdate:1,onUpdateParams:1,onUpdateScope:1,onStart:1,onStartParams:1,onStartScope:1,onReverseComplete:1,onReverseCompleteParams:1,onReverseCompleteScope:1,onRepeat:1,onRepeatParams:1,onRepeatScope:1,easeParams:1,yoyo:1,immediateRender:1,repeat:1,repeatDelay:1,data:1,paused:1,reversed:1,autoCSS:1,lazy:1,onOverwrite:1,callbackScope:1,stringFilter:1,id:1,yoyoEase:1,stagger:1},he={none:0,all:1,auto:2,concurrent:3,allOnStart:4,preexisting:5,true:1,false:0},Ce=C._rootFramesTimeline=new X,me=C._rootTimeline=new X,fe=30,we=$.lazyRender=function(){var L=j.length,V,P;for(k={},V=0;V<L;V++)P=j[V],P&&P._lazy!==!1&&(P.render(P._lazy[0],P._lazy[1],!0),P._lazy=!1);j.length=0};me._startTime=u.time,Ce._startTime=u.frame,me._active=Ce._active=!0,setTimeout(we,1),C._updateRoot=U.render=function(){var L,V,P;if(j.length&&we(),me.render((u.time-me._startTime)*me._timeScale,!1,!1),Ce.render((u.frame-Ce._startTime)*Ce._timeScale,!1,!1),j.length&&we(),u.frame>=fe){fe=u.frame+(parseInt(U.autoSleep,10)||120);for(P in Ee){for(V=Ee[P].tweens,L=V.length;--L>-1;)V[L]._gc&&V.splice(L,1);V.length===0&&delete Ee[P]}if(P=me._first,(!P||P._paused)&&U.autoSleep&&!Ce._first&&u._listeners.tick.length===1){for(;P&&P._paused;)P=P._next;P||u.sleep()}}},u.addEventListener("tick",C._updateRoot);var ye=function(L,V,P){var T=L._gsTweenID,q,re;if(Ee[T||(L._gsTweenID=T="t"+Se++)]||(Ee[T]={target:L,tweens:[]}),V&&(q=Ee[T].tweens,q[re=q.length]=V,P))for(;--re>-1;)q[re]===V&&q.splice(re,1);return Ee[T].tweens},_e=function(L,V,P,T){var q=L.vars.onOverwrite,re,pe;return q&&(re=q(L,V,P,T)),q=U.onOverwrite,q&&(pe=q(L,V,P,T)),re!==!1&&pe!==!1},it=function(L,V,P,T,q){var re,pe,ge,be;if(T===1||T>=4){for(be=q.length,re=0;re<be;re++)if((ge=q[re])!==V)ge._gc||ge._kill(null,L,V)&&(pe=!0);else if(T===5)break;return pe}var G=V._startTime+s,Ae=[],Fe=0,Ve=V._duration===0,oe;for(re=q.length;--re>-1;)(ge=q[re])===V||ge._gc||ge._paused||(ge._timeline!==V._timeline?(oe=oe||$e(V,0,Ve),$e(ge,oe,Ve)===0&&(Ae[Fe++]=ge)):ge._startTime<=G&&ge._startTime+ge.totalDuration()/ge._timeScale>G&&((Ve||!ge._initted)&&G-ge._startTime<=s*2||(Ae[Fe++]=ge)));for(re=Fe;--re>-1;)if(ge=Ae[re],be=ge._firstPT,T===2&&ge._kill(P,L,V)&&(pe=!0),T!==2||!ge._firstPT&&ge._initted&&be){if(T!==2&&!_e(ge,V))continue;ge._enabled(!1,!1)&&(pe=!0)}return pe},$e=function(L,V,P){for(var T=L._timeline,q=T._timeScale,re=L._startTime;T._timeline;){if(re+=T._startTime,q*=T._timeScale,T._paused)return-100;T=T._timeline}return re/=q,re>V?re-V:P&&re===V||!L._initted&&re-V<2*s?s:(re+=L.totalDuration()/L._timeScale/q)>V+s?0:re-V-s};l._init=function(){var L=this.vars,V=this._overwrittenProps,P=this._duration,T=!!L.immediateRender,q=L.ease,re=this._startAt,pe,ge,be,G,Ae,Fe;if(L.startAt){re&&(re.render(-1,!0),re.kill()),Ae={};for(G in L.startAt)Ae[G]=L.startAt[G];if(Ae.data="isStart",Ae.overwrite=!1,Ae.immediateRender=!0,Ae.lazy=T&&L.lazy!==!1,Ae.startAt=Ae.delay=null,Ae.onUpdate=L.onUpdate,Ae.onUpdateParams=L.onUpdateParams,Ae.onUpdateScope=L.onUpdateScope||L.callbackScope||this,this._startAt=U.to(this.target||{},0,Ae),T){if(this._time>0)this._startAt=null;else if(P!==0)return}}else if(L.runBackwards&&P!==0)if(re)re.render(-1,!0),re.kill(),this._startAt=null;else{this._time!==0&&(T=!1),be={};for(G in L)(!de[G]||G==="autoCSS")&&(be[G]=L[G]);if(be.overwrite=0,be.data="isFromStart",be.lazy=T&&L.lazy!==!1,be.immediateRender=T,this._startAt=U.to(this.target,0,be),!T)this._startAt._init(),this._startAt._enabled(!1),this.vars.immediateRender&&(this._startAt=null);else if(this._time===0)return}if(this._ease=q=q?q instanceof S?q:typeof q=="function"?new S(q,L.easeParams):b[q]||U.defaultEase:U.defaultEase,L.easeParams instanceof Array&&q.config&&(this._ease=q.config.apply(q,L.easeParams)),this._easeType=this._ease._type,this._easePower=this._ease._power,this._firstPT=null,this._targets)for(Fe=this._targets.length,pe=0;pe<Fe;pe++)this._initProps(this._targets[pe],this._propLookup[pe]={},this._siblings[pe],V?V[pe]:null,pe)&&(ge=!0);else ge=this._initProps(this.target,this._propLookup,this._siblings,V,0);if(ge&&U._onPluginEvent("_onInitAllProps",this),V&&(this._firstPT||typeof this.target!="function"&&this._enabled(!1,!1)),L.runBackwards)for(be=this._firstPT;be;)be.s+=be.c,be.c=-be.c,be=be._next;this._onUpdate=L.onUpdate,this._initted=!0},l._initProps=function(L,V,P,T,q){var re,pe,ge,be,G,Ae;if(L==null)return!1;k[L._gsTweenID]&&we(),this.vars.css||L.style&&L!==i&&L.nodeType&&Z.css&&this.vars.autoCSS!==!1&&ne(this.vars,L);for(re in this.vars)if(Ae=this.vars[re],de[re])Ae&&(Ae instanceof Array||Ae.push&&c(Ae))&&Ae.join("").indexOf("{self}")!==-1&&(this.vars[re]=Ae=this._swapSelfInParams(Ae,this));else if(Z[re]&&(be=new Z[re])._onInitTween(L,this.vars[re],this,q)){for(this._firstPT=G={_next:this._firstPT,t:be,p:"setRatio",s:0,c:1,f:1,n:re,pg:1,pr:be._priority,m:0},pe=be._overwriteProps.length;--pe>-1;)V[be._overwriteProps[pe]]=this._firstPT;(be._priority||be._onInitAllProps)&&(ge=!0),(be._onDisable||be._onEnable)&&(this._notifyPluginsOfEnabled=!0),G._next&&(G._next._prev=G)}else V[re]=ee.call(this,L,re,"get",Ae,re,0,null,this.vars.stringFilter,q);return T&&this._kill(T,L)?this._initProps(L,V,P,T,q):this._overwrite>1&&this._firstPT&&P.length>1&&it(L,this,V,this._overwrite,P)?(this._kill(V,L),this._initProps(L,V,P,T,q)):(this._firstPT&&(this.vars.lazy!==!1&&this._duration||this.vars.lazy&&!this._duration)&&(k[L._gsTweenID]=!0),ge)},l.render=function(L,V,P){var T=this,q=T._time,re=T._duration,pe=T._rawPrevTime,ge,be,G,Ae;if(L>=re-s&&L>=0)T._totalTime=T._time=re,T.ratio=T._ease._calcEnd?T._ease.getRatio(1):1,T._reversed||(ge=!0,be="onComplete",P=P||T._timeline.autoRemoveChildren),re===0&&(T._initted||!T.vars.lazy||P)&&(T._startTime===T._timeline._duration&&(L=0),(pe<0||L<=0&&L>=-s||pe===s&&T.data!=="isPause")&&pe!==L&&(P=!0,pe>s&&(be="onReverseComplete")),T._rawPrevTime=Ae=!V||L||pe===L?L:s);else if(L<s)T._totalTime=T._time=0,T.ratio=T._ease._calcEnd?T._ease.getRatio(0):0,(q!==0||re===0&&pe>0)&&(be="onReverseComplete",ge=T._reversed),L>-s?L=0:L<0&&(T._active=!1,re===0&&(T._initted||!T.vars.lazy||P)&&(pe>=0&&!(pe===s&&T.data==="isPause")&&(P=!0),T._rawPrevTime=Ae=!V||L||pe===L?L:s)),(!T._initted||T._startAt&&T._startAt.progress())&&(P=!0);else if(T._totalTime=T._time=L,T._easeType){var Fe=L/re,Ve=T._easeType,oe=T._easePower;(Ve===1||Ve===3&&Fe>=.5)&&(Fe=1-Fe),Ve===3&&(Fe*=2),oe===1?Fe*=Fe:oe===2?Fe*=Fe*Fe:oe===3?Fe*=Fe*Fe*Fe:oe===4&&(Fe*=Fe*Fe*Fe*Fe),T.ratio=Ve===1?1-Fe:Ve===2?Fe:L/re<.5?Fe/2:1-Fe/2}else T.ratio=T._ease.getRatio(L/re);if(!(T._time===q&&!P)){if(!T._initted){if(T._init(),!T._initted||T._gc)return;if(!P&&T._firstPT&&(T.vars.lazy!==!1&&T._duration||T.vars.lazy&&!T._duration)){T._time=T._totalTime=q,T._rawPrevTime=pe,j.push(T),T._lazy=[L,V];return}T._time&&!ge?T.ratio=T._ease.getRatio(T._time/re):ge&&T._ease._calcEnd&&(T.ratio=T._ease.getRatio(T._time===0?0:1))}for(T._lazy!==!1&&(T._lazy=!1),T._active||!T._paused&&T._time!==q&&L>=0&&(T._active=!0),q===0&&(T._startAt&&(L>=0?T._startAt.render(L,!0,P):be||(be="_dummyGS")),T.vars.onStart&&(T._time!==0||re===0)&&(V||T._callback("onStart"))),G=T._firstPT;G;)G.f?G.t[G.p](G.c*T.ratio+G.s):G.t[G.p]=G.c*T.ratio+G.s,G=G._next;T._onUpdate&&(L<0&&T._startAt&&L!==-1e-4&&T._startAt.render(L,!0,P),V||(T._time!==q||ge||P)&&T._callback("onUpdate")),be&&(!T._gc||P)&&(L<0&&T._startAt&&!T._onUpdate&&L!==-1e-4&&T._startAt.render(L,!0,P),ge&&(T._timeline.autoRemoveChildren&&T._enabled(!1,!1),T._active=!1),!V&&T.vars[be]&&T._callback(be),re===0&&T._rawPrevTime===s&&Ae!==s&&(T._rawPrevTime=0))}},l._kill=function(L,V,P){if(L==="all"&&(L=null),L==null&&(V==null||V===this.target))return this._lazy=!1,this._enabled(!1,!1);V=typeof V!="string"?V||this._targets||this.target:U.selector(V)||V;var T=P&&this._time&&P._startTime===this._startTime&&this._timeline===P._timeline,q=this._firstPT,re,pe,ge,be,G,Ae,Fe,Ve,oe;if((c(V)||te(V))&&typeof V[0]!="number")for(re=V.length;--re>-1;)this._kill(L,V[re],P)&&(Ae=!0);else{if(this._targets){for(re=this._targets.length;--re>-1;)if(V===this._targets[re]){G=this._propLookup[re]||{},this._overwrittenProps=this._overwrittenProps||[],pe=this._overwrittenProps[re]=L?this._overwrittenProps[re]||{}:"all";break}}else{if(V!==this.target)return!1;G=this._propLookup,pe=this._overwrittenProps=L?this._overwrittenProps||{}:"all"}if(G){if(Fe=L||G,Ve=L!==pe&&pe!=="all"&&L!==G&&(typeof L!="object"||!L._tempKill),P&&(U.onOverwrite||this.vars.onOverwrite)){for(ge in Fe)G[ge]&&(oe||(oe=[]),oe.push(ge));if((oe||!L)&&!_e(this,P,V,oe))return!1}for(ge in Fe)(be=G[ge])&&(T&&(be.f?be.t[be.p](be.s):be.t[be.p]=be.s,Ae=!0),be.pg&&be.t._kill(Fe)&&(Ae=!0),(!be.pg||be.t._overwriteProps.length===0)&&(be._prev?be._prev._next=be._next:be===this._firstPT&&(this._firstPT=be._next),be._next&&(be._next._prev=be._prev),be._next=be._prev=null),delete G[ge]),Ve&&(pe[ge]=1);!this._firstPT&&this._initted&&q&&this._enabled(!1,!1)}}return Ae},l.invalidate=function(){this._notifyPluginsOfEnabled&&U._onPluginEvent("_onDisable",this);var L=this._time;return this._firstPT=this._overwrittenProps=this._startAt=this._onUpdate=null,this._notifyPluginsOfEnabled=this._active=this._lazy=!1,this._propLookup=this._targets?{}:[],C.prototype.invalidate.call(this),this.vars.immediateRender&&(this._time=-s,this.render(L,!1,this.vars.lazy!==!1)),this},l._enabled=function(L,V){if(p||u.wake(),L&&this._gc){var P=this._targets,T;if(P)for(T=P.length;--T>-1;)this._siblings[T]=ye(P[T],this,!0);else this._siblings=ye(this.target,this,!0)}return C.prototype._enabled.call(this,L,V),this._notifyPluginsOfEnabled&&this._firstPT?U._onPluginEvent(L?"_onEnable":"_onDisable",this):!1},U.to=function(L,V,P){return new U(L,V,P)},U.from=function(L,V,P){return P.runBackwards=!0,P.immediateRender=P.immediateRender!=!1,new U(L,V,P)},U.fromTo=function(L,V,P,T){return T.startAt=P,T.immediateRender=T.immediateRender!=!1&&P.immediateRender!=!1,new U(L,V,T)},U.delayedCall=function(L,V,P,T,q){return new U(V,0,{delay:L,onComplete:V,onCompleteParams:P,callbackScope:T,onReverseComplete:V,onReverseCompleteParams:P,immediateRender:!1,lazy:!1,useFrames:q,overwrite:0})},U.set=function(L,V){return new U(L,0,V)},U.getTweensOf=function(L,V){if(L==null)return[];L=typeof L!="string"?L:U.selector(L)||L;var P,T,q,re;if((c(L)||te(L))&&typeof L[0]!="number"){for(P=L.length,T=[];--P>-1;)T=T.concat(U.getTweensOf(L[P],V));for(P=T.length;--P>-1;)for(re=T[P],q=P;--q>-1;)re===T[q]&&T.splice(P,1)}else if(L._gsTweenID)for(T=ye(L).concat(),P=T.length;--P>-1;)(T[P]._gc||V&&!T[P].isActive())&&T.splice(P,1);return T||[]},U.killTweensOf=U.killDelayedCallsTo=function(L,V,P){typeof V=="object"&&(P=V,V=!1);for(var T=U.getTweensOf(L,V),q=T.length;--q>-1;)T[q]._kill(P,L)};var et=v("plugins.TweenPlugin",function(L,V){this._overwriteProps=(L||"").split(","),this._propName=this._overwriteProps[0],this._priority=V||0,this._super=et.prototype},!0);if(l=et.prototype,et.version="1.19.0",et.API=2,l._firstPT=null,l._addTween=ee,l.setRatio=H,l._kill=function(L){var V=this._overwriteProps,P=this._firstPT,T;if(L[this._propName]!=null)this._overwriteProps=[];else for(T=V.length;--T>-1;)L[V[T]]!=null&&V.splice(T,1);for(;P;)L[P.n]!=null&&(P._next&&(P._next._prev=P._prev),P._prev?(P._prev._next=P._next,P._prev=null):this._firstPT===P&&(this._firstPT=P._next)),P=P._next;return!1},l._mod=l._roundProps=function(L){for(var V=this._firstPT,P;V;)P=L[this._propName]||V.n!=null&&L[V.n.split(this._propName+"_").join("")],P&&typeof P=="function"&&(V.f===2?V.t._applyPT.m=P:V.m=P),V=V._next},U._onPluginEvent=function(L,V){var P=V._firstPT,T,q,re,pe,ge;if(L==="_onInitAllProps"){for(;P;){for(ge=P._next,q=re;q&&q.pr>P.pr;)q=q._next;(P._prev=q?q._prev:pe)?P._prev._next=P:re=P,(P._next=q)?q._prev=P:pe=P,P=ge}P=V._firstPT=re}for(;P;)P.pg&&typeof P.t[L]=="function"&&P.t[L]()&&(T=!0),P=P._next;return T},et.activate=function(L){for(var V=L.length;--V>-1;)L[V].API===et.API&&(Z[new L[V]()._propName]=L[V]);return!0},x.plugin=function(L){if(!L||!L.propName||!L.init||!L.API)throw"illegal plugin definition.";var V=L.propName,P=L.priority||0,T=L.overwriteProps,q={init:"_onInitTween",set:"setRatio",kill:"_kill",round:"_mod",mod:"_mod",initAll:"_onInitAllProps"},re=v("plugins."+V.charAt(0).toUpperCase()+V.substr(1)+"Plugin",function(){et.call(this,V,P),this._overwriteProps=T||[]},L.global===!0),pe=re.prototype=new et(V),ge;pe.constructor=re,re.API=L.API;for(ge in q)typeof L[ge]=="function"&&(pe[q[ge]]=L[ge]);return re.version=L.version,et.activate([re]),re},h=i._gsQueue,h){for(d=0;d<h.length;d++)h[d]();for(l in g)g[l].func||i.console.log("GSAP encountered missing dependency: "+l)}return p=!1,U}(_d),Ti=_d.GreenSockGlobals,H1=Ti.com.greensock;H1.core.SimpleTimeline;H1.core.Animation;var Vs=Ti.Ease;Ti.Linear;var JU=Ti.Power1,eH=Ti.Power2;Ti.Power3;var tH=Ti.Power4;Ti.TweenPlugin;H1.events.EventDispatcher;/*!
 * VERSION: 1.16.1
 * DATE: 2018-08-27
 * UPDATES AND DOCS AT: http://greensock.com
 *
 * @license Copyright (c) 2008-2019, GreenSock. All rights reserved.
 * This work is subject to the terms at http://greensock.com/standard-license or for
 * Club GreenSock members, the software agreement that was issued with your membership.
 * 
 * @author: Jack Doyle, jack@greensock.com
 **/_d._gsDefine("easing.Back",["easing.Ease"],function(){var i=_d.GreenSockGlobals||_d,e=i.com.greensock,t=Math.PI*2,n=Math.PI/2,r=e._class,s=function(v,w){var S=r("easing."+v,function(){},!0),b=S.prototype=new Vs;return b.constructor=S,b.getRatio=w,S},o=Vs.register||function(){},a=function(v,w,S,b,E){var R=r("easing."+v,{easeOut:new w,easeIn:new S,easeInOut:new b},!0);return o(R,v),R},c=function(v,w,S){this.t=v,this.v=w,S&&(this.next=S,S.prev=this,this.c=S.v-w,this.gap=S.t-v)},h=function(v,w){var S=r("easing."+v,function(E){this._p1=E||E===0?E:1.70158,this._p2=this._p1*1.525},!0),b=S.prototype=new Vs;return b.constructor=S,b.getRatio=w,b.config=function(E){return new S(E)},S},d=a("Back",h("BackOut",function(v){return(v=v-1)*v*((this._p1+1)*v+this._p1)+1}),h("BackIn",function(v){return v*v*((this._p1+1)*v-this._p1)}),h("BackInOut",function(v){return(v*=2)<1?.5*v*v*((this._p2+1)*v-this._p2):.5*((v-=2)*v*((this._p2+1)*v+this._p2)+2)})),l=r("easing.SlowMo",function(v,w,S){w=w||w===0?w:.7,v==null?v=.7:v>1&&(v=1),this._p=v!==1?w:0,this._p1=(1-v)/2,this._p2=v,this._p3=this._p1+this._p2,this._calcEnd=S===!0},!0),u=l.prototype=new Vs,p,g,y,x;return u.constructor=l,u.getRatio=function(v){var w=v+(.5-v)*this._p;return v<this._p1?this._calcEnd?1-(v=1-v/this._p1)*v:w-(v=1-v/this._p1)*v*v*v*w:v>this._p3?this._calcEnd?v===1?0:1-(v=(v-this._p3)/this._p1)*v:w+(v-w)*(v=(v-this._p3)/this._p1)*v*v*v:this._calcEnd?1:w},l.ease=new l(.7,.7),u.config=l.config=function(v,w,S){return new l(v,w,S)},p=r("easing.SteppedEase",function(v,w){v=v||1,this._p1=1/v,this._p2=v+(w?0:1),this._p3=w?1:0},!0),u=p.prototype=new Vs,u.constructor=p,u.getRatio=function(v){return v<0?v=0:v>=1&&(v=.999999999),((this._p2*v|0)+this._p3)*this._p1},u.config=p.config=function(v,w){return new p(v,w)},g=r("easing.ExpoScaleEase",function(v,w,S){this._p1=Math.log(w/v),this._p2=w-v,this._p3=v,this._ease=S},!0),u=g.prototype=new Vs,u.constructor=g,u.getRatio=function(v){return this._ease&&(v=this._ease.getRatio(v)),(this._p3*Math.exp(this._p1*v)-this._p3)/this._p2},u.config=g.config=function(v,w,S){return new g(v,w,S)},y=r("easing.RoughEase",function(v){v=v||{};for(var w=v.taper||"none",S=[],b=0,E=(v.points||20)|0,R=E,z=v.randomize!==!1,I=v.clamp===!0,N=v.template instanceof Vs?v.template:null,F=typeof v.strength=="number"?v.strength*.4:.4,C,O,X,U,te,ne;--R>-1;)C=z?Math.random():1/E*R,O=N?N.getRatio(C):C,w==="none"?X=F:w==="out"?(U=1-C,X=U*U*F):w==="in"?X=C*C*F:C<.5?(U=C*2,X=U*U*.5*F):(U=(1-C)*2,X=U*U*.5*F),z?O+=Math.random()*X-X*.5:R%2?O+=X*.5:O-=X*.5,I&&(O>1?O=1:O<0&&(O=0)),S[b++]={x:C,y:O};for(S.sort(function(j,k){return j.x-k.x}),ne=new c(1,1,null),R=E;--R>-1;)te=S[R],ne=new c(te.x,te.y,ne);this._prev=new c(0,0,ne.t!==0?ne:ne.next)},!0),u=y.prototype=new Vs,u.constructor=y,u.getRatio=function(v){var w=this._prev;if(v>w.t){for(;w.next&&v>=w.t;)w=w.next;w=w.prev}else for(;w.prev&&v<=w.t;)w=w.prev;return this._prev=w,w.v+(v-w.t)/w.gap*w.c},u.config=function(v){return new y(v)},y.ease=new y,a("Bounce",s("BounceOut",function(v){return v<1/2.75?7.5625*v*v:v<2/2.75?7.5625*(v-=1.5/2.75)*v+.75:v<2.5/2.75?7.5625*(v-=2.25/2.75)*v+.9375:7.5625*(v-=2.625/2.75)*v+.984375}),s("BounceIn",function(v){return(v=1-v)<1/2.75?1-7.5625*v*v:v<2/2.75?1-(7.5625*(v-=1.5/2.75)*v+.75):v<2.5/2.75?1-(7.5625*(v-=2.25/2.75)*v+.9375):1-(7.5625*(v-=2.625/2.75)*v+.984375)}),s("BounceInOut",function(v){var w=v<.5;return w?v=1-v*2:v=v*2-1,v<1/2.75?v=7.5625*v*v:v<2/2.75?v=7.5625*(v-=1.5/2.75)*v+.75:v<2.5/2.75?v=7.5625*(v-=2.25/2.75)*v+.9375:v=7.5625*(v-=2.625/2.75)*v+.984375,w?(1-v)*.5:v*.5+.5})),a("Circ",s("CircOut",function(v){return Math.sqrt(1-(v=v-1)*v)}),s("CircIn",function(v){return-(Math.sqrt(1-v*v)-1)}),s("CircInOut",function(v){return(v*=2)<1?-.5*(Math.sqrt(1-v*v)-1):.5*(Math.sqrt(1-(v-=2)*v)+1)})),x=function(v,w,S){var b=r("easing."+v,function(R,z){this._p1=R>=1?R:1,this._p2=(z||S)/(R<1?R:1),this._p3=this._p2/t*(Math.asin(1/this._p1)||0),this._p2=t/this._p2},!0),E=b.prototype=new Vs;return E.constructor=b,E.getRatio=w,E.config=function(R,z){return new b(R,z)},b},a("Elastic",x("ElasticOut",function(v){return this._p1*Math.pow(2,-10*v)*Math.sin((v-this._p3)*this._p2)+1},.3),x("ElasticIn",function(v){return-(this._p1*Math.pow(2,10*(v-=1))*Math.sin((v-this._p3)*this._p2))},.3),x("ElasticInOut",function(v){return(v*=2)<1?-.5*(this._p1*Math.pow(2,10*(v-=1))*Math.sin((v-this._p3)*this._p2)):this._p1*Math.pow(2,-10*(v-=1))*Math.sin((v-this._p3)*this._p2)*.5+1},.45)),a("Expo",s("ExpoOut",function(v){return 1-Math.pow(2,-10*v)}),s("ExpoIn",function(v){return Math.pow(2,10*(v-1))-.001}),s("ExpoInOut",function(v){return(v*=2)<1?.5*Math.pow(2,10*(v-1)):.5*(2-Math.pow(2,-10*(v-1)))})),a("Sine",s("SineOut",function(v){return Math.sin(v*n)}),s("SineIn",function(v){return-Math.cos(v*n)+1}),s("SineInOut",function(v){return-.5*(Math.cos(Math.PI*v)-1)})),r("easing.EaseLookup",{find:function(v){return Vs.map[v]}},!0),o(i.SlowMo,"SlowMo","ease,"),o(y,"RoughEase","ease,"),o(p,"SteppedEase","ease,"),d},!0);var mo=Ti.Back;Ti.Elastic;Ti.Bounce;Ti.RoughEase;Ti.SlowMo;Ti.SteppedEase;Ti.Circ;Ti.Expo;Ti.Sine;Ti.ExpoScaleEase;class nH{constructor(e,t,n){this.parameters={width:e,height:t,thickness:n},this.type="AreaFloorBufferGeometry";const r=8,s=new Float32Array(r*3),o=new Uint32Array(r*6),a=e,c=t,h=a-n,d=c-n;s[0*3+0]=h*.5,s[0*3+1]=d*.5,s[0*3+2]=0,s[1*3+0]=h*.5,s[1*3+1]=-d*.5,s[1*3+2]=0,s[2*3+0]=-h*.5,s[2*3+1]=-d*.5,s[2*3+2]=0,s[3*3+0]=-h*.5,s[3*3+1]=d*.5,s[3*3+2]=0,s[4*3+0]=a*.5,s[4*3+1]=c*.5,s[4*3+2]=0,s[5*3+0]=a*.5,s[5*3+1]=-c*.5,s[5*3+2]=0,s[6*3+0]=-a*.5,s[6*3+1]=-c*.5,s[6*3+2]=0,s[7*3+0]=-a*.5,s[7*3+1]=c*.5,s[7*3+2]=0,o[0*3+0]=4,o[0*3+1]=0,o[0*3+2]=1,o[1*3+0]=1,o[1*3+1]=5,o[1*3+2]=4,o[2*3+0]=5,o[2*3+1]=1,o[2*3+2]=2,o[3*3+0]=2,o[3*3+1]=6,o[3*3+2]=5,o[4*3+0]=6,o[4*3+1]=2,o[4*3+2]=3,o[5*3+0]=3,o[5*3+1]=7,o[5*3+2]=6,o[6*3+0]=7,o[6*3+1]=3,o[6*3+2]=0,o[7*3+0]=0,o[7*3+1]=4,o[7*3+2]=7;const l=new vt;return l.setIndex(new zt(o,1,!1)),l.setAttribute("position",new lt(s,3)),l}}class iH{constructor(e,t,n){this.parameters={width:e,height:t,depth:n},this.type="AreaFloorBufferGeometry";const r=8,s=new Float32Array(r*3),o=new Uint32Array(r*2),a=new Uint32Array(r*6);s[0*3+0]=e*.5,s[0*3+1]=t*.5,s[0*3+2]=0,s[1*3+0]=e*.5,s[1*3+1]=-t*.5,s[1*3+2]=0,s[2*3+0]=-e*.5,s[2*3+1]=-t*.5,s[2*3+2]=0,s[3*3+0]=-e*.5,s[3*3+1]=t*.5,s[3*3+2]=0,s[4*3+0]=e*.5,s[4*3+1]=t*.5,s[4*3+2]=n,s[5*3+0]=e*.5,s[5*3+1]=-t*.5,s[5*3+2]=n,s[6*3+0]=-e*.5,s[6*3+1]=-t*.5,s[6*3+2]=n,s[7*3+0]=-e*.5,s[7*3+1]=t*.5,s[7*3+2]=n,o[0*2+0]=0,o[0*2+1]=0,o[1*2+0]=1/3,o[1*2+1]=0,o[2*2+0]=1/3*2,o[2*2+1]=0,o[3*2+0]=1,o[3*2+1]=0,o[4*2+0]=0,o[4*2+1]=1,o[5*2+0]=1/3,o[5*2+1]=1,o[6*2+0]=1/3*2,o[6*2+1]=1,o[7*2+0]=1,o[7*2+1]=1,a[0*3+0]=0,a[0*3+1]=4,a[0*3+2]=1,a[1*3+0]=5,a[1*3+1]=1,a[1*3+2]=4,a[2*3+0]=1,a[2*3+1]=5,a[2*3+2]=2,a[3*3+0]=6,a[3*3+1]=2,a[3*3+2]=5,a[4*3+0]=2,a[4*3+1]=6,a[4*3+2]=3,a[5*3+0]=7,a[5*3+1]=3,a[5*3+2]=6,a[6*3+0]=3,a[6*3+1]=7,a[6*3+2]=0,a[7*3+0]=4,a[7*3+1]=0,a[7*3+2]=7;const c=new vt;return c.setIndex(new zt(a,1,!1)),c.setAttribute("position",new lt(s,3)),c.setAttribute("uv",new lt(o,2)),c}}var rH=`#define GLSLIFY 1
uniform float uTime;
uniform float uBorderAlpha;
uniform float uStrikeAlpha;

varying vec3 vPosition;
varying vec3 vModelPosition;
varying vec2 vUv;

void main()
{
    float uStrikeWidth = 0.5;
    // float uStrikeAlpha = 0.25;
    float uBorderWidth = 0.1;
    // float uBorderAlpha = 0.5;

    if(vModelPosition.z < 0.0)
    {
        discard;
    }

    float strikeStrength = mod((vPosition.x + vPosition.y - uTime * 0.00035 + vPosition.z) / uStrikeWidth * 0.5, 1.0);
    strikeStrength = step(strikeStrength, 0.5) * uStrikeAlpha;

    float borderStrength = max(step(1.0 - vUv.y, uBorderWidth), step(vUv.y, uBorderWidth)) * uBorderAlpha;

    float alpha = max(strikeStrength, borderStrength);

    gl_FragColor = vec4(vec3(1.0), alpha);

    // gl_FragColor = vec4(vUv, 1.0, 1.0);
}
`,sH=`#define GLSLIFY 1
varying vec3 vPosition;
varying vec3 vModelPosition;
varying vec2 vUv;

void main()
{
    vec4 modelPosition = modelMatrix * vec4(position, 1.0);
    gl_Position = projectionMatrix * viewMatrix * modelPosition;

    vPosition = position.xyz;
    vModelPosition = modelPosition.xyz;
    vUv = uv;
}
`;function oH(){const i={uTime:{value:null},uBorderAlpha:{value:null},uStrikeAlpha:{value:null}};return new jn({wireframe:!1,transparent:!0,side:Es,depthTest:!0,depthWrite:!1,uniforms:i,vertexShader:sH,fragmentShader:rH})}var aH=`#define GLSLIFY 1
#define M_PI 3.1415926535897932384626433832795

uniform vec3 uColor;
uniform float uAlpha;
uniform float uLoadProgress;
uniform float uProgress;

varying vec3 vPosition;

void main()
{
    float angle = atan(vPosition.x, vPosition.y);
    float loadProgress = step(abs(angle / M_PI), uLoadProgress);
    float progress = step(1.0 - abs(angle / M_PI), uProgress);

    float alpha = uAlpha;
    alpha -= uAlpha * 0.5 * (1.0 - loadProgress);
    alpha *= progress;

    gl_FragColor = vec4(uColor, alpha);
    // gl_FragColor = vec4(vec3(progress), 1.0);
}
`,lH=`#define GLSLIFY 1
varying vec3 vPosition;

void main()
{
    vec4 modelPosition = modelMatrix * vec4(position, 1.0);
    gl_Position = projectionMatrix * viewMatrix * modelPosition;

    vPosition = position;
}
`;function cH(){const i={uColor:{value:null},uAlpha:{value:null},uLoadProgress:{value:null},uProgress:{value:null}};return new jn({wireframe:!1,transparent:!0,depthTest:!0,depthWrite:!1,uniforms:i,vertexShader:lH,fragmentShader:aH})}class uH extends ec{constructor(e){super(),this.config=e.config,this.renderer=e.renderer,this.resources=e.resources,this.car=e.car,this.sounds=e.sounds,this.time=e.time,this.position=e.position,this.halfExtents=e.halfExtents,this.hasKey=e.hasKey,this.testCar=e.testCar,this.active=e.active,this.container=new ft,this.container.position.x=this.position.x,this.container.position.y=this.position.y,this.container.matrixAutoUpdate=!1,this.container.updateMatrix(),this.initialTestCar=this.testCar,this.isIn=!1,this.setFloorBorder(),this.setFence(),this.setInteractions(),this.hasKey&&this.setKey()}activate(){this.active=!0,this.isIn&&this.in()}deactivate(){this.active=!1,this.isIn&&this.out()}setFloorBorder(){this.floorBorder={},this.floorBorder.geometry=new nH(this.halfExtents.x*2,this.halfExtents.y*2,.25),this.floorBorder.material=new cH,this.floorBorder.material.uniforms.uColor.value=new qe(16777215),this.floorBorder.material.uniforms.uAlpha.value=.5,this.floorBorder.material.uniforms.uLoadProgress.value=1,this.floorBorder.material.uniforms.uProgress.value=1,this.floorBorder.mesh=new je(this.floorBorder.geometry,this.floorBorder.material),this.floorBorder.mesh.matrixAutoUpdate=!1,this.container.add(this.floorBorder.mesh)}setFence(){this.fence={},this.fence.depth=.5,this.fence.offset=.5,this.fence.geometry=new iH(this.halfExtents.x*2,this.halfExtents.y*2,this.fence.depth),this.fence.material=new oH,this.fence.material.uniforms.uBorderAlpha.value=.5,this.fence.material.uniforms.uStrikeAlpha.value=.25,this.fence.mesh=new je(this.fence.geometry,this.fence.material),this.fence.mesh.position.z=-this.fence.depth,this.container.add(this.fence.mesh),this.time.on("tick",()=>{this.fence.material.uniforms.uTime.value=this.time.elapsed})}setKey(){this.key={},this.key.hiddenZ=1.5,this.key.shownZ=2.5,this.key.container=new ft,this.key.container.position.z=this.key.hiddenZ,this.container.add(this.key.container),this.key.enter={},this.key.enter.size=1.4,this.key.enter.geometry=new xn(this.key.enter.size,this.key.enter.size/4,1,1),this.key.enter.texture=this.resources.items.areaEnterTexture,this.key.enter.texture.magFilter=Kt,this.key.enter.texture.minFilter=jt,this.key.enter.material=new Bt({color:16777215,alphaMap:this.key.enter.texture,transparent:!0,opacity:0,depthWrite:!1}),this.key.enter.mesh=new je(this.key.enter.geometry,this.key.enter.material),this.key.enter.mesh.rotation.x=Math.PI*.5,this.key.enter.mesh.position.x=this.key.enter.size*.75,this.key.enter.mesh.matrixAutoUpdate=!1,this.key.enter.mesh.updateMatrix(),this.key.container.add(this.key.enter.mesh),this.key.icon={},this.key.icon.size=.75,this.key.icon.geometry=new xn(this.key.icon.size,this.key.icon.size,1,1),this.key.icon.texture=this.resources.items.areaKeyEnterTexture,this.key.icon.texture.magFilter=Kt,this.key.icon.texture.minFilter=jt,this.key.icon.material=new Bt({color:16777215,alphaMap:this.key.icon.texture,transparent:!0,opacity:0,depthWrite:!1}),this.key.icon.mesh=new je(this.key.icon.geometry,this.key.icon.material),this.key.icon.mesh.rotation.x=Math.PI*.5,this.key.icon.mesh.position.x=-this.key.enter.size*.15,this.key.icon.mesh.matrixAutoUpdate=!1,this.key.icon.mesh.updateMatrix(),this.key.container.add(this.key.icon.mesh)}interact(e=!0){!this.active||(Ct.killTweensOf(this.fence.mesh.position),Ct.killTweensOf(this.floorBorder.material.uniforms.uAlpha),Ct.killTweensOf(this.fence.material.uniforms.uBorderAlpha),this.hasKey&&(Ct.killTweensOf(this.key.container.position),Ct.killTweensOf(this.key.icon.material),Ct.killTweensOf(this.key.enter.material)),Ct.to(this.fence.mesh.position,.05,{z:0,onComplete:()=>{Ct.to(this.fence.mesh.position,.25,{z:.5,ease:mo.easeOut.config(2)}),Ct.fromTo(this.floorBorder.material.uniforms.uAlpha,1.5,{value:1},{value:.5}),Ct.fromTo(this.fence.material.uniforms.uBorderAlpha,1.5,{value:1},{value:.5})}}),this.hasKey&&e&&(this.key.container.position.z=this.key.shownZ,Ct.fromTo(this.key.icon.material,1.5,{opacity:1},{opacity:.5}),Ct.fromTo(this.key.enter.material,1.5,{opacity:1},{opacity:.5})),this.sounds.play("uiArea"),this.trigger("interact"))}in(e=!0){this.isIn=!0,this.active&&(Ct.killTweensOf(this.fence.mesh.position),Ct.to(this.fence.mesh.position,.35,{z:this.fence.offset,ease:mo.easeOut.config(3)}),this.hasKey&&(Ct.killTweensOf(this.key.container.position),Ct.killTweensOf(this.key.icon.material),Ct.killTweensOf(this.key.enter.material),e&&(Ct.to(this.key.container.position,.35,{z:this.key.shownZ,ease:mo.easeOut.config(3),delay:.1}),Ct.to(this.key.icon.material,.35,{opacity:.5,ease:mo.easeOut.config(3),delay:.1}),Ct.to(this.key.enter.material,.35,{opacity:.5,ease:mo.easeOut.config(3),delay:.1}))),this.config.touch||this.renderer.domElement.classList.add("has-cursor-pointer"),this.trigger("in"))}out(){this.isIn=!1,Ct.killTweensOf(this.fence.mesh.position),Ct.to(this.fence.mesh.position,.35,{z:-this.fence.depth,ease:mo.easeIn.config(4)}),this.hasKey&&(Ct.killTweensOf(this.key.container.position),Ct.killTweensOf(this.key.icon.material),Ct.killTweensOf(this.key.enter.material),Ct.to(this.key.container.position,.35,{z:this.key.hiddenZ,ease:mo.easeIn.config(4),delay:.1}),Ct.to(this.key.icon.material,.35,{opacity:0,ease:mo.easeIn.config(4),delay:.1}),Ct.to(this.key.enter.material,.35,{opacity:0,ease:mo.easeIn.config(4),delay:.1})),this.config.touch||this.renderer.domElement.classList.remove("has-cursor-pointer"),this.trigger("out")}setInteractions(){this.mouseMesh=new je(new xn(this.halfExtents.x*2,this.halfExtents.y*2,1,1),new Bt({transparent:!0,opacity:0})),this.mouseMesh.position.z=-.01,this.mouseMesh.matrixAutoUpdate=!1,this.mouseMesh.updateMatrix(),this.container.add(this.mouseMesh),this.time.on("tick",()=>{if(this.testCar){const e=Math.abs(this.car.position.x-this.position.x)<Math.abs(this.halfExtents.x)&&Math.abs(this.car.position.y-this.position.y)<Math.abs(this.halfExtents.y);e!==this.isIn&&(e?this.in(!this.config.touch):this.out())}}),window.addEventListener("keydown",e=>{(e.key==="f"||e.key==="e"||e.key==="Enter")&&this.isIn&&this.interact()})}}class hH{constructor(e){this.config=e.config,this.resources=e.resources,this.car=e.car,this.sounds=e.sounds,this.renderer=e.renderer,this.camera=e.camera,this.time=e.time,this.debug=e.debug,this.items=[],this.container=new ft,this.container.matrixAutoUpdate=!1,this.setMouse()}setMouse(){this.mouse={},this.mouse.raycaster=new _f,this.mouse.coordinates=new Me,this.mouse.currentArea=null,this.mouse.needsUpdate=!1,window.addEventListener("mousemove",e=>{this.mouse.coordinates.x=e.clientX/window.innerWidth*2-1,this.mouse.coordinates.y=-(e.clientY/window.innerHeight)*2+1,this.mouse.needsUpdate=!0}),window.addEventListener("mousedown",()=>{this.mouse.currentArea&&this.mouse.currentArea.interact(!1)}),this.renderer.domElement.addEventListener("touchstart",e=>{this.mouse.coordinates.x=e.changedTouches[0].clientX/window.innerWidth*2-1,this.mouse.coordinates.y=-(e.changedTouches[0].clientY/window.innerHeight)*2+1,this.mouse.needsUpdate=!0}),this.time.on("tick",()=>{if(this.mouse.needsUpdate){this.mouse.needsUpdate=!1,this.mouse.raycaster.setFromCamera(this.mouse.coordinates,this.camera.instance);const e=this.items.map(n=>n.mouseMesh),t=this.mouse.raycaster.intersectObjects(e);if(t.length){const n=this.items.find(r=>r.mouseMesh===t[0].object);n!==this.mouse.currentArea&&(this.mouse.currentArea!==null&&(this.mouse.currentArea.out(),this.mouse.currentArea.testCar=this.mouse.currentArea.initialTestCar),this.mouse.currentArea=n,this.mouse.currentArea.in(!1),this.mouse.currentArea.testCar=!1)}else this.mouse.currentArea!==null&&(this.mouse.currentArea.out(),this.mouse.currentArea.testCar=this.mouse.currentArea.initialTestCar,this.mouse.currentArea=null)}})}add(e){const t=new uH({config:this.config,renderer:this.renderer,resources:this.resources,car:this.car,sounds:this.sounds,time:this.time,hasKey:!0,testCar:!0,active:!0,...e});return this.container.add(t.container),this.items.push(t),t}}class dH{constructor(e){this.resources=e.resources,this.objects=e.objects,this.debug=e.debug,this.items=[],this.interDistance=1.5,this.tangentDistance=.3,this.positionRandomess=.3,this.rotationRandomess=.1,this.setModels()}setModels(){this.models={},this.models.items=[{base:this.resources.items.tilesABase.scene,collision:this.resources.items.tilesACollision.scene,chances:8},{base:this.resources.items.tilesBBase.scene,collision:this.resources.items.tilesBCollision.scene,chances:1},{base:this.resources.items.tilesCBase.scene,collision:this.resources.items.tilesCCollision.scene,chances:2},{base:this.resources.items.tilesDBase.scene,collision:this.resources.items.tilesDCollision.scene,chances:4},{base:this.resources.items.tilesEBase.scene,collision:this.resources.items.tilesECollision.scene,chances:2}];const e=this.models.items.reduce((n,r)=>n+r.chances,0);let t=0;this.models.items=this.models.items.map(n=>(n.minChances=t,t+=n.chances/e,n.maxChances=t,n.rotationIndex=0,n)),this.models.pick=()=>{const n=Math.random(),r=this.models.items.find(s=>n>=s.minChances&&n<=s.maxChances);return r.rotationIndex++,r.rotationIndex>3&&(r.rotationIndex=0),r}}add(e){const t={};t.start=e.start,t.delta=e.delta,t.distance=t.delta.length(),t.count=Math.floor(t.distance/this.interDistance),t.directionVector=t.delta.clone().normalize(),t.interVector=t.directionVector.clone().multiplyScalar(this.interDistance),t.centeringVector=t.delta.clone().sub(t.interVector.clone().multiplyScalar(t.count)),t.tangentVector=t.directionVector.clone().rotateAround(new Me(0,0),Math.PI*.5).multiplyScalar(this.tangentDistance),t.angle=t.directionVector.angle();for(let n=0;n<t.count;n++){const r=this.models.pick(),s=t.start.clone().add(t.interVector.clone().multiplyScalar(n)).add(t.centeringVector);s.x+=(Math.random()-.5)*this.positionRandomess,s.y+=(Math.random()-.5)*this.positionRandomess;const o=t.tangentVector;n%1===0&&o.negate(),s.add(o);let a=t.angle;a+=(Math.random()-.5)*this.rotationRandomess,a+=r.rotationIndex/4*Math.PI*2,this.objects.add({base:r.base,collision:r.collision,offset:new B(s.x,s.y,0),rotation:new Et(0,0,a),duplicated:!0,mass:0})}}}class fH{constructor(e){this.resources=e.resources,this.objects=e.objects}add(e){const t={};t.coordinates=[],t.items=[];const n=e.shape;let r=n.widthCount,s=n.heightCount;switch(e.shape.type){case"rectangle":case"brick":for(let o=0;o<s;o++){const a=o===s-1;let c=0,h=r;for(e.shape.type==="brick"&&a&&e.shape.equilibrateLastLine&&(o%2===0?h--:c++);c<h;c++){const d=new B;d.add(n.offsetWidth.clone().multiplyScalar(c-(n.widthCount-1)*.5)),d.add(n.offsetHeight.clone().multiplyScalar(o)),d.x+=(Math.random()-.5)*n.randomOffset.x,d.y+=(Math.random()-.5)*n.randomOffset.y,d.z+=(Math.random()-.5)*n.randomOffset.z,e.shape.type==="brick"&&o%2===0&&d.add(n.offsetWidth.clone().multiplyScalar(.5));const l=new Et;l.x+=(Math.random()-.5)*n.randomRotation.x,l.y+=(Math.random()-.5)*n.randomRotation.y,l.z+=(Math.random()-.5)*n.randomRotation.z,t.coordinates.push({offset:d,rotation:l})}}break;case"triangle":s=n.widthCount;for(let o=0;o<s;o++){for(let a=0;a<r;a++){const c=new B;c.add(n.offsetWidth.clone().multiplyScalar(a-(n.widthCount-1)*.5)),c.add(n.offsetWidth.clone().multiplyScalar(o*.5)),c.add(n.offsetHeight.clone().multiplyScalar(o)),c.x+=(Math.random()-.5)*n.randomOffset.x,c.y+=(Math.random()-.5)*n.randomOffset.y,c.z+=(Math.random()-.5)*n.randomOffset.z,e.shape.type==="brick"&&o%2===0&&c.add(n.offsetWidth.clone().multiplyScalar(.5));const h=new Et;h.x+=(Math.random()-.5)*n.randomRotation.x,h.y+=(Math.random()-.5)*n.randomRotation.y,h.z+=(Math.random()-.5)*n.randomRotation.z,t.coordinates.push({offset:c,rotation:h})}r--}break}for(const o of t.coordinates){const a={...e.object};a.offset=e.object.offset.clone().add(o.offset).add(n.position),a.rotation=e.object.rotation.clone(),a.rotation.x+=o.rotation.x,a.rotation.y+=o.rotation.y,a.rotation.z+=o.rotation.z,t.items.push(this.objects.add(a))}return t}}class pH{constructor(e){this.config=e.config,this.time=e.time,this.resources=e.resources,this.objects=e.objects,this.areas=e.areas,this.walls=e.walls,this.tiles=e.tiles,this.debug=e.debug,this.x=e.x,this.y=e.y,this.container=new ft,this.container.matrixAutoUpdate=!1,this.container.updateMatrix(),this.setStatic(),this.setInstructions(),this.setOtherInstructions(),this.setTitles(),this.setTiles(),this.setDikes()}setStatic(){this.objects.add({base:this.resources.items.introStaticBase.scene,collision:this.resources.items.introStaticCollision.scene,floorShadowTexture:this.resources.items.introStaticFloorShadowTexture,offset:new B(0,0,0),mass:0})}setInstructions(){this.instructions={},this.instructions.arrows={},this.instructions.arrows.label={},this.instructions.arrows.label.texture=this.config.touch?this.resources.items.introInstructionsControlsTexture:this.resources.items.introInstructionsArrowsTexture,this.instructions.arrows.label.texture.magFilter=Kt,this.instructions.arrows.label.texture.minFilter=jt,this.instructions.arrows.label.material=new Bt({transparent:!0,alphaMap:this.instructions.arrows.label.texture,color:16777215,depthWrite:!1,opacity:0}),this.instructions.arrows.label.geometry=this.resources.items.introInstructionsLabels.scene.children.find(e=>e.name==="arrows").geometry,this.instructions.arrows.label.mesh=new je(this.instructions.arrows.label.geometry,this.instructions.arrows.label.material),this.container.add(this.instructions.arrows.label.mesh),this.config.touch||(this.instructions.arrows.up=this.objects.add({base:this.resources.items.introArrowKeyBase.scene,collision:this.resources.items.introArrowKeyCollision.scene,offset:new B(0,0,0),rotation:new Et(0,0,0),duplicated:!0,shadow:{sizeX:1,sizeY:1,offsetZ:-.2,alpha:.5},mass:1.5,soundName:"brick"}),this.instructions.arrows.down=this.objects.add({base:this.resources.items.introArrowKeyBase.scene,collision:this.resources.items.introArrowKeyCollision.scene,offset:new B(0,-.8,0),rotation:new Et(0,0,Math.PI),duplicated:!0,shadow:{sizeX:1,sizeY:1,offsetZ:-.2,alpha:.5},mass:1.5,soundName:"brick"}),this.instructions.arrows.left=this.objects.add({base:this.resources.items.introArrowKeyBase.scene,collision:this.resources.items.introArrowKeyCollision.scene,offset:new B(-.8,-.8,0),rotation:new Et(0,0,Math.PI*.5),duplicated:!0,shadow:{sizeX:1,sizeY:1,offsetZ:-.2,alpha:.5},mass:1.5,soundName:"brick"}),this.instructions.arrows.right=this.objects.add({base:this.resources.items.introArrowKeyBase.scene,collision:this.resources.items.introArrowKeyCollision.scene,offset:new B(.8,-.8,0),rotation:new Et(0,0,-Math.PI*.5),duplicated:!0,shadow:{sizeX:1,sizeY:1,offsetZ:-.2,alpha:.5},mass:1.5,soundName:"brick"}))}setOtherInstructions(){this.config.touch||(this.otherInstructions={},this.otherInstructions.x=16,this.otherInstructions.y=-2,this.otherInstructions.container=new ft,this.otherInstructions.container.position.x=this.otherInstructions.x,this.otherInstructions.container.position.y=this.otherInstructions.y,this.otherInstructions.container.matrixAutoUpdate=!1,this.otherInstructions.container.updateMatrix(),this.container.add(this.otherInstructions.container),this.otherInstructions.label={},this.otherInstructions.label.geometry=new xn(6,6,1,1),this.otherInstructions.label.texture=this.resources.items.introInstructionsOtherTexture,this.otherInstructions.label.texture.magFilter=Kt,this.otherInstructions.label.texture.minFilter=jt,this.otherInstructions.label.material=new Bt({transparent:!0,alphaMap:this.otherInstructions.label.texture,color:16777215,depthWrite:!1,opacity:0}),this.otherInstructions.label.mesh=new je(this.otherInstructions.label.geometry,this.otherInstructions.label.material),this.otherInstructions.label.mesh.matrixAutoUpdate=!1,this.otherInstructions.container.add(this.otherInstructions.label.mesh),this.otherInstructions.horn=this.objects.add({base:this.resources.items.hornBase.scene,collision:this.resources.items.hornCollision.scene,offset:new B(this.otherInstructions.x+1.25,this.otherInstructions.y-2.75,.2),rotation:new Et(0,0,.5),duplicated:!0,shadow:{sizeX:1.65,sizeY:.75,offsetZ:-.1,alpha:.4},mass:1.5,soundName:"horn",sleep:!1}))}setTitles(){this.objects.add({base:this.resources.items.introBBase.scene,collision:this.resources.items.introBCollision.scene,offset:new B(0,0,0),rotation:new Et(0,0,0),shadow:{sizeX:1.5,sizeY:1.5,offsetZ:-.6,alpha:.4},mass:1.5,soundName:"brick"}),this.objects.add({base:this.resources.items.introRBase.scene,collision:this.resources.items.introRCollision.scene,offset:new B(0,0,0),rotation:new Et(0,0,0),shadow:{sizeX:1.5,sizeY:1.5,offsetZ:-.6,alpha:.4},mass:1.5,soundName:"brick"}),this.objects.add({base:this.resources.items.introUBase.scene,collision:this.resources.items.introUCollision.scene,offset:new B(0,0,0),rotation:new Et(0,0,0),shadow:{sizeX:1.5,sizeY:1.5,offsetZ:-.6,alpha:.4},mass:1.5,soundName:"brick"}),this.objects.add({base:this.resources.items.introNBase.scene,collision:this.resources.items.introNCollision.scene,offset:new B(0,0,0),rotation:new Et(0,0,0),duplicated:!0,shadow:{sizeX:1.5,sizeY:1.5,offsetZ:-.6,alpha:.4},mass:1.5,soundName:"brick"}),this.objects.add({base:this.resources.items.introOBase.scene,collision:this.resources.items.introOCollision.scene,offset:new B(0,0,0),rotation:new Et(0,0,0),duplicated:!0,shadow:{sizeX:1.5,sizeY:1.5,offsetZ:-.6,alpha:.4},mass:1.5,soundName:"brick"}),this.objects.add({base:this.resources.items.introSBase.scene,collision:this.resources.items.introSCollision.scene,offset:new B(0,0,0),rotation:new Et(0,0,0),shadow:{sizeX:1.5,sizeY:1.5,offsetZ:-.6,alpha:.4},mass:1.5,soundName:"brick"}),this.objects.add({base:this.resources.items.introIBase.scene,collision:this.resources.items.introICollision.scene,offset:new B(0,0,0),rotation:new Et(0,0,0),shadow:{sizeX:1.5,sizeY:1.5,offsetZ:-.6,alpha:.4},mass:1.5,soundName:"brick"}),this.objects.add({base:this.resources.items.introMBase.scene,collision:this.resources.items.introMCollision.scene,offset:new B(0,0,0),rotation:new Et(0,0,0),shadow:{sizeX:1.5,sizeY:1.5,offsetZ:-.6,alpha:.4},mass:1.5,soundName:"brick"}),this.objects.add({base:this.resources.items.introOBase.scene,collision:this.resources.items.introOCollision.scene,offset:new B(3.95,0,0),rotation:new Et(0,0,0),duplicated:!0,shadow:{sizeX:1.5,sizeY:1.5,offsetZ:-.6,alpha:.4},mass:1.5,soundName:"brick"}),this.objects.add({base:this.resources.items.introNBase.scene,collision:this.resources.items.introNCollision.scene,offset:new B(5.85,0,0),rotation:new Et(0,0,0),duplicated:!0,shadow:{sizeX:1.5,sizeY:1.5,offsetZ:-.6,alpha:.4},mass:1.5,soundName:"brick"}),this.objects.add({base:this.resources.items.introCreativeBase.scene,collision:this.resources.items.introCreativeCollision.scene,offset:new B(0,0,0),rotation:new Et(0,0,.25),shadow:{sizeX:5,sizeY:1.5,offsetZ:-.6,alpha:.3},mass:1.5,sleep:!1,soundName:"brick"}),this.objects.add({base:this.resources.items.introDevBase.scene,collision:this.resources.items.introDevCollision.scene,offset:new B(0,0,0),rotation:new Et(0,0,0),shadow:{sizeX:2.5,sizeY:1.5,offsetZ:-.6,alpha:.3},mass:1.5,soundName:"brick"})}setTiles(){this.tiles.add({start:new Me(0,-4.5),delta:new Me(0,-4.5)})}setDikes(){this.dikes={},this.dikes.brickOptions={base:this.resources.items.brickBase.scene,collision:this.resources.items.brickCollision.scene,offset:new B(0,0,.1),rotation:new Et(0,0,0),duplicated:!0,shadow:{sizeX:1.2,sizeY:1.8,offsetZ:-.15,alpha:.35},mass:.5,soundName:"brick"},this.walls.add({object:this.dikes.brickOptions,shape:{type:"brick",equilibrateLastLine:!0,widthCount:5,heightCount:2,position:new B(this.x-12,this.y-13,0),offsetWidth:new B(0,1.05,0),offsetHeight:new B(0,0,.45),randomOffset:new B(0,0,0),randomRotation:new B(0,0,.2)}}),this.walls.add({object:{...this.dikes.brickOptions,rotation:new Et(0,0,Math.PI*.5)},shape:{type:"brick",equilibrateLastLine:!0,widthCount:3,heightCount:2,position:new B(this.x+8,this.y+6,0),offsetWidth:new B(1.05,0,0),offsetHeight:new B(0,0,.45),randomOffset:new B(0,0,0),randomRotation:new B(0,0,.2)}}),this.walls.add({object:this.dikes.brickOptions,shape:{type:"brick",equilibrateLastLine:!1,widthCount:3,heightCount:2,position:new B(this.x+9.9,this.y+4.7,0),offsetWidth:new B(0,-1.05,0),offsetHeight:new B(0,0,.45),randomOffset:new B(0,0,0),randomRotation:new B(0,0,.2)}}),this.walls.add({object:{...this.dikes.brickOptions,rotation:new Et(0,0,Math.PI*.5)},shape:{type:"brick",equilibrateLastLine:!0,widthCount:3,heightCount:2,position:new B(this.x-14,this.y+2,0),offsetWidth:new B(1.05,0,0),offsetHeight:new B(0,0,.45),randomOffset:new B(0,0,0),randomRotation:new B(0,0,.2)}}),this.walls.add({object:this.dikes.brickOptions,shape:{type:"brick",equilibrateLastLine:!1,widthCount:3,heightCount:2,position:new B(this.x-14.8,this.y+.7,0),offsetWidth:new B(0,-1.05,0),offsetHeight:new B(0,0,.45),randomOffset:new B(0,0,0),randomRotation:new B(0,0,.2)}}),this.walls.add({object:this.dikes.brickOptions,shape:{type:"brick",equilibrateLastLine:!0,widthCount:3,heightCount:2,position:new B(this.x-14.8,this.y-3.5,0),offsetWidth:new B(0,-1.05,0),offsetHeight:new B(0,0,.45),randomOffset:new B(0,0,0),randomRotation:new B(0,0,.2)}}),this.config.touch||(this.walls.add({object:{...this.dikes.brickOptions,rotation:new Et(0,0,Math.PI*.5)},shape:{type:"brick",equilibrateLastLine:!0,widthCount:2,heightCount:2,position:new B(this.x+18.5,this.y+3,0),offsetWidth:new B(1.05,0,0),offsetHeight:new B(0,0,.45),randomOffset:new B(0,0,0),randomRotation:new B(0,0,.2)}}),this.walls.add({object:this.dikes.brickOptions,shape:{type:"brick",equilibrateLastLine:!1,widthCount:2,heightCount:2,position:new B(this.x+19.9,this.y+2.2,0),offsetWidth:new B(0,-1.05,0),offsetHeight:new B(0,0,.45),randomOffset:new B(0,0,0),randomRotation:new B(0,0,.2)}}))}}var mH=`#define GLSLIFY 1
uniform sampler2D uTexture;
uniform vec3 uColor;
uniform float uTextureAlpha;

varying vec2 vUv;

void main()
{
    vec4 textureColor = texture2D(uTexture, vUv);

    gl_FragColor = mix(vec4(uColor, 1.0), textureColor, uTextureAlpha);
}
`,gH=`#define GLSLIFY 1
varying vec2 vUv;

void main()
{
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`;function vH(){const i={uTexture:{value:null},uTextureAlpha:{value:null},uColor:{value:null}};return new jn({wireframe:!1,transparent:!1,uniforms:i,vertexShader:gH,fragmentShader:mH})}class yH{constructor(e){this.time=e.time,this.resources=e.resources,this.objects=e.objects,this.areas=e.areas,this.name=e.name,this.geometries=e.geometries,this.meshes=e.meshes,this.debug=e.debug,this.name=e.name,this.x=e.x,this.y=e.y,this.imageSources=e.imageSources,this.floorTexture=e.floorTexture,this.link=e.link,this.distinctions=e.distinctions,this.container=new ft,this.container.matrixAutoUpdate=!1,this.setBoards(),this.setFloor()}setBoards(){this.boards={},this.boards.items=[],this.boards.xStart=-5,this.boards.xInter=5,this.boards.y=5,this.boards.color="#8e7161",this.boards.threeColor=new qe(this.boards.color),this.debug&&this.debug.addColor(this.boards,"color").name("boardColor").onChange(()=>{this.boards.threeColor.set(this.boards.color)});let e=0;for(const t of this.imageSources){const n={};n.x=this.x+this.boards.xStart+e*this.boards.xInter,n.y=this.y+this.boards.y,this.objects.add({base:this.resources.items.projectsBoardStructure.scene,collision:this.resources.items.projectsBoardCollision.scene,floorShadowTexture:this.resources.items.projectsBoardStructureFloorShadowTexture,offset:new B(n.x,n.y,0),rotation:new Et(0,0,0),duplicated:!0,mass:0});const r=new Image;r.addEventListener("load",()=>{n.texture=new hn(r),n.texture.needsUpdate=!0,n.texture.magFilter=Kt,n.texture.minFilter=jt,n.planeMesh.material.uniforms.uTexture.value=n.texture,Ct.to(n.planeMesh.material.uniforms.uTextureAlpha,1,{value:1,ease:tH.inOut})}),r.src=t,n.planeMesh=this.meshes.boardPlane.clone(),n.planeMesh.position.x=n.x,n.planeMesh.position.y=n.y,n.planeMesh.matrixAutoUpdate=!1,n.planeMesh.updateMatrix(),n.planeMesh.material=new vH,n.planeMesh.material.uniforms.uColor.value=this.boards.threeColor,n.planeMesh.material.uniforms.uTextureAlpha.value=0,this.container.add(n.planeMesh),this.boards.items.push(n),e++}}setFloor(){if(this.floor={},this.floor.x=0,this.floor.y=-2,this.floor.container=new ft,this.floor.container.position.x=this.x+this.floor.x,this.floor.container.position.y=this.y+this.floor.y,this.floor.container.matrixAutoUpdate=!1,this.floor.container.updateMatrix(),this.container.add(this.floor.container),this.floor.texture=this.floorTexture,this.floor.texture.magFilter=Kt,this.floor.texture.minFilter=jt,this.floor.geometry=this.geometries.floor,this.floor.material=new Bt({transparent:!0,depthWrite:!1,alphaMap:this.floor.texture}),this.floor.mesh=new je(this.floor.geometry,this.floor.material),this.floor.mesh.matrixAutoUpdate=!1,this.floor.container.add(this.floor.mesh),this.distinctions)for(const e of this.distinctions){let t=null,n=null,r=null,s=null;switch(e.type){case"awwwards":t=this.resources.items.projectsDistinctionsAwwwardsBase.scene,n=this.resources.items.projectsDistinctionsAwwwardsCollision.scene,r=1.5,s=1.5;break;case"fwa":t=this.resources.items.projectsDistinctionsFWABase.scene,n=this.resources.items.projectsDistinctionsFWACollision.scene,r=2,s=1;break;case"cssda":t=this.resources.items.projectsDistinctionsCSSDABase.scene,n=this.resources.items.projectsDistinctionsCSSDACollision.scene,r=1.2,s=1.2;break}this.objects.add({base:t,collision:n,offset:new B(this.x+this.floor.x+e.x,this.y+this.floor.y+e.y,0),rotation:new Et(0,0,0),duplicated:!0,shadow:{sizeX:r,sizeY:s,offsetZ:-.1,alpha:.5},mass:1.5,soundName:"woodHit"})}this.floor.area=this.areas.add({position:new Me(this.x+this.link.x,this.y+this.floor.y+this.link.y),halfExtents:new Me(this.link.halfExtents.x,this.link.halfExtents.y)}),this.floor.area.on("interact",()=>{window.open(this.link.href,"_blank")}),this.floor.areaLabel=this.meshes.areaLabel.clone(),this.floor.areaLabel.position.x=this.link.x,this.floor.areaLabel.position.y=this.link.y,this.floor.areaLabel.position.z=.001,this.floor.areaLabel.matrixAutoUpdate=!1,this.floor.areaLabel.updateMatrix(),this.floor.container.add(this.floor.areaLabel)}}var xH="./assets/slideA.27041a13.jpg",wH="./assets/slideB.91abb8f7.jpg",_H="./assets/slideC.4c952476.jpg",SH="./assets/slideD.c076a898.jpg",bH="./assets/slideA.1e26baf1.jpg",MH="./assets/slideB.aa68ba08.jpg",EH="./assets/slideC.66697dcd.jpg",TH="./assets/slideA.84642b1b.jpg",AH="./assets/slideB.68e348c1.jpg",CH="./assets/slideC.56d61ed7.jpg",PH="./assets/slideA.361e2e18.jpg",RH="./assets/slideB.a3771271.jpg",LH="./assets/slideC.9e1f20a5.jpg",kH="./assets/slideA.ceceeaa7.jpg",IH="./assets/slideB.c88600b7.jpg",FH="./assets/slideC.89d9f654.jpg",DH="./assets/slideA.5241312c.jpg",BH="./assets/slideB.847deb53.jpg",zH="./assets/slideC.f1a8963e.jpg",OH="./assets/slideA.5e49721a.jpg",NH="./assets/slideB.78724906.jpg",UH="./assets/slideC.bb4fff5d.jpg",HH="./assets/slideA.6d4d08f1.jpg",VH="./assets/slideB.8cdac5aa.jpg",GH="./assets/slideC.c78a44cd.jpg",WH="./assets/slideA.47a5cc3f.jpg",jH="./assets/slideB.df06c522.jpg",XH="./assets/slideC.3af41c93.jpg";class qH{constructor(e){this.time=e.time,this.resources=e.resources,this.camera=e.camera,this.passes=e.passes,this.objects=e.objects,this.areas=e.areas,this.zones=e.zones,this.tiles=e.tiles,this.debug=e.debug,this.x=e.x,this.y=e.y,this.debug&&(this.debugFolder=this.debug.addFolder("projects"),this.debugFolder.open()),this.items=[],this.interDistance=24,this.positionRandomess=5,this.projectHalfWidth=9,this.container=new ft,this.container.matrixAutoUpdate=!1,this.container.updateMatrix(),this.setGeometries(),this.setMeshes(),this.setList(),this.setZone();for(const t of this.list)this.add(t)}setGeometries(){this.geometries={},this.geometries.floor=new xn(16,8)}setMeshes(){this.meshes={},this.resources.items.areaOpenTexture.magFilter=Kt,this.resources.items.areaOpenTexture.minFilter=jt,this.meshes.boardPlane=this.resources.items.projectsBoardPlane.scene.children[0],this.meshes.areaLabel=new je(new xn(2,.5),new Bt({transparent:!0,depthWrite:!1,color:16777215,alphaMap:this.resources.items.areaOpenTexture})),this.meshes.areaLabel.matrixAutoUpdate=!1}setList(){this.list=[{name:"Welth",imageSources:[xH,wH,_H,SH],floorTexture:this.resources.items.projectsThreejsJourneyFloorTexture,link:{href:"https://github.com/Srivans7/Welth",x:-4.8,y:-3,halfExtents:{x:3.2,y:1.5}},distinctions:[{type:"fwa",x:3.95,y:4.15}]},{name:"eVoting-DApp",imageSources:[bH,MH,EH],floorTexture:this.resources.items.projectsMadboxFloorTexture,link:{href:"https://github.com/Srivans7/eVoting-DApp",x:-4.8,y:-4,halfExtents:{x:3.2,y:1.5}},distinctions:[{type:"awwwards",x:3.95,y:4.15},{type:"fwa",x:5.6,y:4.15}]},{name:"Spotify Web Player Clone",imageSources:[TH,AH,CH],floorTexture:this.resources.items.projectsScoutFloorTexture,link:{href:"https://github.com/Srivans7/Spotify---Web-Player-Clone",x:-4.8,y:-2,halfExtents:{x:3.2,y:1.5}},distinctions:[]},{name:"Simon Game",imageSources:[PH,RH,LH],floorTexture:this.resources.items.projectsChartogneFloorTexture,link:{href:"https://github.com/Srivans7/Simon_Game",x:-4.8,y:-3.3,halfExtents:{x:3.2,y:1.5}},distinctions:[{type:"awwwards",x:3.95,y:4.15},{type:"fwa",x:5.6,y:4.15},{type:"cssda",x:7.2,y:4.15}]},{name:"Meal Buddy",imageSources:[kH,IH,FH],floorTexture:this.resources.items.projectsZenlyFloorTexture,link:{href:"https://github.com/Srivans7/Meal-Buddy",x:-4.8,y:-4.2,halfExtents:{x:3.2,y:1.5}},distinctions:[{type:"awwwards",x:3.95,y:4.15},{type:"fwa",x:5.6,y:4.15},{type:"cssda",x:7.2,y:4.15}]},{name:"Interview-Ease",imageSources:[OH,NH,UH],floorTexture:this.resources.items.projectsPriorHoldingsFloorTexture,link:{href:"https://github.com/Srivans7/Interview-Ease",x:-4.8,y:-3,halfExtents:{x:3.2,y:1.5}},distinctions:[{type:"awwwards",x:3.95,y:4.15},{type:"fwa",x:5.6,y:4.15},{type:"cssda",x:7.2,y:4.15}]},{name:"JavaScript-Work",imageSources:[HH,VH,GH],floorTexture:this.resources.items.projectsOranoFloorTexture,link:{href:"https://github.com/Srivans7/JavaScript_work",x:-4.8,y:-3.4,halfExtents:{x:3.2,y:1.5}},distinctions:[{type:"awwwards",x:3.95,y:4.15},{type:"fwa",x:5.6,y:4.15},{type:"cssda",x:7.2,y:4.15}]},{name:"GoFood",imageSources:[DH,BH,zH],floorTexture:this.resources.items.projectsCitrixRedbullFloorTexture,link:{href:"https://github.com/Srivans7/GoFood",x:-4.8,y:-4.4,halfExtents:{x:3.2,y:1.5}},distinctions:[{type:"awwwards",x:3.95,y:4.15},{type:"fwa",x:5.6,y:4.15},{type:"cssda",x:7.2,y:4.15}]},{name:"Portfolio",imageSources:[WH,jH,XH],floorTexture:this.resources.items.projectsKepplerFloorTexture,link:{href:"https://github.com/Srivans7/My-Portfolio",x:2.75,y:-1.1,halfExtents:{x:3.2,y:1.5}},distinctions:[]}]}setZone(){const e=this.list.length*(this.interDistance/2),t=this.zones.add({position:{x:this.x+e-this.projectHalfWidth-6,y:this.y},halfExtents:{x:e,y:12},data:{cameraAngle:"projects"}});t.on("in",n=>{this.camera.angle.set(n.cameraAngle),Ct.to(this.passes.horizontalBlurPass.material.uniforms.uStrength.value,2,{x:0}),Ct.to(this.passes.verticalBlurPass.material.uniforms.uStrength.value,2,{y:0})}),t.on("out",()=>{this.camera.angle.set("default"),Ct.to(this.passes.horizontalBlurPass.material.uniforms.uStrength.value,2,{x:this.passes.horizontalBlurPass.strength}),Ct.to(this.passes.verticalBlurPass.material.uniforms.uStrength.value,2,{y:this.passes.verticalBlurPass.strength})})}add(e){const t=this.x+this.items.length*this.interDistance;let n=this.y;this.items.length>0&&(n+=(Math.random()-.5)*this.positionRandomess);const r=new yH({time:this.time,resources:this.resources,objects:this.objects,areas:this.areas,geometries:this.geometries,meshes:this.meshes,debug:this.debugFolder,x:t,y:n,...e});if(this.container.add(r.container),this.items.length>=1){const s=this.items[this.items.length-1],o=new Me(s.x+this.projectHalfWidth,s.y),c=new Me(r.x-this.projectHalfWidth,r.y).clone().sub(o);this.tiles.add({start:o,delta:c})}this.items.push(r)}}class YH{constructor(e){this.time=e.time,this.resources=e.resources,this.objects=e.objects,this.areas=e.areas,this.tiles=e.tiles,this.debug=e.debug,this.x=e.x,this.y=e.y,this.container=new ft,this.container.matrixAutoUpdate=!1,this.setStatic(),this.setTiles()}setStatic(){this.objects.add({base:this.resources.items.crossroadsStaticBase.scene,collision:this.resources.items.crossroadsStaticCollision.scene,floorShadowTexture:this.resources.items.crossroadsStaticFloorShadowTexture,offset:new B(this.x,this.y,0),mass:0})}setTiles(){this.tiles.add({start:new Me(this.x,-10),delta:new Me(0,this.y+14)}),this.tiles.add({start:new Me(this.x+12.5,this.y),delta:new Me(7.5,0)}),this.tiles.add({start:new Me(this.x-13,this.y),delta:new Me(-6,0)})}}class $H{constructor(e){this.time=e.time,this.resources=e.resources,this.objects=e.objects,this.areas=e.areas,this.tiles=e.tiles,this.debug=e.debug,this.x=e.x,this.y=e.y,this.container=new ft,this.container.matrixAutoUpdate=!1,this.setStatic(),this.setBaguettes(),this.setLinks(),this.setActivities(),this.setTiles()}setStatic(){this.objects.add({base:this.resources.items.informationStaticBase.scene,collision:this.resources.items.informationStaticCollision.scene,floorShadowTexture:this.resources.items.informationStaticFloorShadowTexture,offset:new B(this.x,this.y,0),mass:0})}setBaguettes(){this.baguettes={},this.baguettes.x=-4,this.baguettes.y=6,this.baguettes.a=this.objects.add({base:this.resources.items.informationBaguetteBase.scene,collision:this.resources.items.informationBaguetteCollision.scene,offset:new B(this.x+this.baguettes.x-.56,this.y+this.baguettes.y-.666,.2),rotation:new Et(0,0,-Math.PI*37/180),duplicated:!0,shadow:{sizeX:.6,sizeY:3.5,offsetZ:-.15,alpha:.35},mass:1.5}),this.baguettes.b=this.objects.add({base:this.resources.items.informationBaguetteBase.scene,collision:this.resources.items.informationBaguetteCollision.scene,offset:new B(this.x+this.baguettes.x-.8,this.y+this.baguettes.y-2,.5),rotation:new Et(0,-.5,Math.PI*60/180),duplicated:!0,shadow:{sizeX:.6,sizeY:3.5,offsetZ:-.15,alpha:.35},mass:1.5,sleep:!1})}setLinks(){this.links={},this.links.x=1.95,this.links.y=-1.5,this.links.halfExtents={},this.links.halfExtents.x=1,this.links.halfExtents.y=1,this.links.distanceBetween=2.4,this.links.labelWidth=this.links.halfExtents.x*2+1,this.links.labelGeometry=new xn(this.links.labelWidth,this.links.labelWidth*.25,1,1),this.links.labelOffset=-1.6,this.links.items=[],this.links.container=new ft,this.links.container.matrixAutoUpdate=!1,this.container.add(this.links.container),this.links.options=[{href:"https://x.com/Srivans7?t=VD8f33KjgAw9wSOGYyyooA&s=09/",labelTexture:this.resources.items.informationContactTwitterLabelTexture},{href:"https://github.com/Srivans7/",labelTexture:this.resources.items.informationContactGithubLabelTexture},{href:"https://www.linkedin.com/in/srivans-katriyar/",labelTexture:this.resources.items.informationContactLinkedinLabelTexture},{href:"mailto:srivanskatriyar7@gmail.com",labelTexture:this.resources.items.informationContactMailLabelTexture}];let e=0;for(const t of this.links.options){const n={};n.x=this.x+this.links.x+this.links.distanceBetween*e,n.y=this.y+this.links.y,n.href=t.href,n.area=this.areas.add({position:new Me(n.x,n.y),halfExtents:new Me(this.links.halfExtents.x,this.links.halfExtents.y)}),n.area.on("interact",()=>{window.open(t.href,"_blank")}),n.texture=t.labelTexture,n.texture.magFilter=Kt,n.texture.minFilter=jt,n.labelMesh=new je(this.links.labelGeometry,new Bt({wireframe:!1,color:16777215,alphaMap:t.labelTexture,depthTest:!0,depthWrite:!1,transparent:!0})),n.labelMesh.position.x=n.x+this.links.labelWidth*.5-this.links.halfExtents.x,n.labelMesh.position.y=n.y+this.links.labelOffset,n.labelMesh.matrixAutoUpdate=!1,n.labelMesh.updateMatrix(),this.links.container.add(n.labelMesh),this.links.items.push(n),e++}}setActivities(){this.activities={},this.activities.x=this.x+0,this.activities.y=this.y-10,this.activities.multiplier=5.5,this.activities.geometry=new xn(2*this.activities.multiplier,1*this.activities.multiplier,1,1),this.activities.texture=this.resources.items.informationActivitiesTexture,this.activities.texture.magFilter=Kt,this.activities.texture.minFilter=jt,this.activities.material=new Bt({wireframe:!1,color:16777215,alphaMap:this.activities.texture,transparent:!0}),this.activities.mesh=new je(this.activities.geometry,this.activities.material),this.activities.mesh.position.x=this.activities.x,this.activities.mesh.position.y=this.activities.y,this.activities.mesh.matrixAutoUpdate=!1,this.activities.mesh.updateMatrix(),this.container.add(this.activities.mesh)}setTiles(){this.tiles.add({start:new Me(this.x-1.2,this.y+13),delta:new Me(0,-20)})}}class QH{constructor(e){this.time=e.time,this.resources=e.resources,this.objects=e.objects,this.areas=e.areas,this.walls=e.walls,this.tiles=e.tiles,this.debug=e.debug,this.x=e.x,this.y=e.y,this.debug&&(this.debugFolder=this.debug.addFolder("playgroundSection")),this.container=new ft,this.container.matrixAutoUpdate=!1,this.resources.items.areaResetTexture.magFilter=Kt,this.resources.items.areaResetTexture.minFilter=jt,this.setStatic(),this.setBricksWalls(),this.setBowling()}setStatic(){this.objects.add({base:this.resources.items.playgroundStaticBase.scene,collision:this.resources.items.playgroundStaticCollision.scene,floorShadowTexture:this.resources.items.playgroundStaticFloorShadowTexture,offset:new B(this.x,this.y,0),mass:0})}setBricksWalls(){this.brickWalls={},this.brickWalls.x=this.x+15,this.brickWalls.y=this.y+14,this.brickWalls.items=[],this.brickWalls.brickOptions={base:this.resources.items.brickBase.scene,collision:this.resources.items.brickCollision.scene,offset:new B(0,0,.1),rotation:new Et(0,0,0),duplicated:!0,shadow:{sizeX:1.2,sizeY:1.8,offsetZ:-.15,alpha:.35},mass:.5,soundName:"brick"},this.brickWalls.items.push(this.walls.add({object:this.brickWalls.brickOptions,shape:{type:"rectangle",widthCount:5,heightCount:6,position:new B(this.brickWalls.x-6,this.brickWalls.y,0),offsetWidth:new B(0,1.05,0),offsetHeight:new B(0,0,.45),randomOffset:new B(0,0,0),randomRotation:new B(0,0,.4)}}),this.walls.add({object:this.brickWalls.brickOptions,shape:{type:"brick",widthCount:5,heightCount:6,position:new B(this.brickWalls.x-12,this.brickWalls.y,0),offsetWidth:new B(0,1.05,0),offsetHeight:new B(0,0,.45),randomOffset:new B(0,0,0),randomRotation:new B(0,0,.4)}}),this.walls.add({object:this.brickWalls.brickOptions,shape:{type:"triangle",widthCount:6,position:new B(this.brickWalls.x-18,this.brickWalls.y,0),offsetWidth:new B(0,1.05,0),offsetHeight:new B(0,0,.45),randomOffset:new B(0,0,0),randomRotation:new B(0,0,.4)}})),this.brickWalls.reset=()=>{for(const e of this.brickWalls.items)for(const t of e.items)t.collision.reset()},this.brickWalls.resetArea=this.areas.add({position:new Me(this.brickWalls.x,this.brickWalls.y),halfExtents:new Me(2,2)}),this.brickWalls.resetArea.on("interact",()=>{this.brickWalls.reset()}),this.brickWalls.areaLabelMesh=new je(new xn(2,.5),new Bt({transparent:!0,depthWrite:!1,color:16777215,alphaMap:this.resources.items.areaResetTexture})),this.brickWalls.areaLabelMesh.position.x=this.brickWalls.x,this.brickWalls.areaLabelMesh.position.y=this.brickWalls.y,this.brickWalls.areaLabelMesh.matrixAutoUpdate=!1,this.brickWalls.areaLabelMesh.updateMatrix(),this.container.add(this.brickWalls.areaLabelMesh),this.debugFolder&&this.debugFolder.add(this.brickWalls,"reset").name("brickWalls reset")}setBowling(){this.bowling={},this.bowling.x=this.x+15,this.bowling.y=this.y+4,this.bowling.pins=this.walls.add({object:{base:this.resources.items.bowlingPinBase.scene,collision:this.resources.items.bowlingPinCollision.scene,offset:new B(0,0,.1),rotation:new Et(0,0,0),duplicated:!0,shadow:{sizeX:1.4,sizeY:1.4,offsetZ:-.15,alpha:.35},mass:.1,soundName:"bowlingPin"},shape:{type:"triangle",widthCount:4,position:new B(this.bowling.x-25,this.bowling.y,0),offsetWidth:new B(0,1,0),offsetHeight:new B(.65,0,0),randomOffset:new B(0,0,0),randomRotation:new B(0,0,0)}}),this.bowling.ball=this.objects.add({base:this.resources.items.bowlingBallBase.scene,collision:this.resources.items.bowlingBallCollision.scene,offset:new B(this.bowling.x-5,this.bowling.y,0),rotation:new Et(Math.PI*.5,0,0),duplicated:!0,shadow:{sizeX:1.5,sizeY:1.5,offsetZ:-.15,alpha:.35},mass:1,soundName:"bowlingBall"}),this.bowling.reset=()=>{for(const e of this.bowling.pins.items)e.collision.reset();this.bowling.ball.collision.reset()},this.bowling.resetArea=this.areas.add({position:new Me(this.bowling.x,this.bowling.y),halfExtents:new Me(2,2)}),this.bowling.resetArea.on("interact",()=>{this.bowling.reset()}),this.bowling.areaLabelMesh=new je(new xn(2,.5),new Bt({transparent:!0,depthWrite:!1,color:16777215,alphaMap:this.resources.items.areaResetTexture})),this.bowling.areaLabelMesh.position.x=this.bowling.x,this.bowling.areaLabelMesh.position.y=this.bowling.y,this.bowling.areaLabelMesh.matrixAutoUpdate=!1,this.bowling.areaLabelMesh.updateMatrix(),this.container.add(this.bowling.areaLabelMesh),this.debugFolder&&this.debugFolder.add(this.bowling,"reset").name("bowling reset")}}var ZH="./assets/doubleTriangle.f34b3213.png",GT="./assets/triangle.7264ae6d.png",KH="./assets/cross.3759345d.png";class JH extends ec{constructor(e){super(),this.config=e.config,this.sizes=e.sizes,this.time=e.time,this.camera=e.camera,this.sounds=e.sounds,this.setActions(),this.setKeyboard()}setActions(){this.actions={},this.actions.up=!1,this.actions.right=!1,this.actions.down=!1,this.actions.left=!1,this.actions.brake=!1,this.actions.boost=!1,document.addEventListener("visibilitychange",()=>{document.hidden||(this.actions.up=!1,this.actions.right=!1,this.actions.down=!1,this.actions.left=!1,this.actions.brake=!1,this.actions.boost=!1)})}setKeyboard(){this.keyboard={},this.keyboard.events={},this.keyboard.events.keyDown=e=>{switch(e.key){case"ArrowUp":case"z":case"w":this.camera.pan.reset(),this.actions.up=!0;break;case"ArrowRight":case"d":this.actions.right=!0;break;case"ArrowDown":case"s":this.camera.pan.reset(),this.actions.down=!0;break;case"ArrowLeft":case"q":case"a":this.actions.left=!0;break;case"Control":case" ":this.actions.brake=!0;break;case"Shift":this.actions.boost=!0;break}},this.keyboard.events.keyUp=e=>{switch(e.key){case"ArrowUp":case"z":case"w":this.actions.up=!1;break;case"ArrowRight":case"d":this.actions.right=!1;break;case"ArrowDown":case"s":this.actions.down=!1;break;case"ArrowLeft":case"q":case"a":this.actions.left=!1;break;case"Control":case" ":this.actions.brake=!1;break;case"Shift":this.actions.boost=!1;break;case"r":this.trigger("action",["reset"]);break}},document.addEventListener("keydown",this.keyboard.events.keyDown),document.addEventListener("keyup",this.keyboard.events.keyUp)}setTouch(){this.touch={},this.touch.joystick={},this.touch.joystick.active=!1,this.touch.joystick.$element=document.createElement("div"),this.touch.joystick.$element.style.userSelect="none",this.touch.joystick.$element.style.position="fixed",this.touch.joystick.$element.style.bottom="10px",this.touch.joystick.$element.style.left="10px",this.touch.joystick.$element.style.width="170px",this.touch.joystick.$element.style.height="170px",this.touch.joystick.$element.style.borderRadius="50%",this.touch.joystick.$element.style.transition="opacity 0.3s 0.0s",this.touch.joystick.$element.style.willChange="opacity",this.touch.joystick.$element.style.opacity="0",document.body.appendChild(this.touch.joystick.$element),this.touch.joystick.$cursor=document.createElement("div"),this.touch.joystick.$cursor.style.position="absolute",this.touch.joystick.$cursor.style.top="calc(50% - 30px)",this.touch.joystick.$cursor.style.left="calc(50% - 30px)",this.touch.joystick.$cursor.style.width="60px",this.touch.joystick.$cursor.style.height="60px",this.touch.joystick.$cursor.style.border="2px solid #ffffff",this.touch.joystick.$cursor.style.borderRadius="50%",this.touch.joystick.$cursor.style.boxSizing="border-box",this.touch.joystick.$cursor.style.pointerEvents="none",this.touch.joystick.$cursor.style.willChange="transform",this.touch.joystick.$element.appendChild(this.touch.joystick.$cursor),this.touch.joystick.$limit=document.createElement("div"),this.touch.joystick.$limit.style.position="absolute",this.touch.joystick.$limit.style.top="calc(50% - 75px)",this.touch.joystick.$limit.style.left="calc(50% - 75px)",this.touch.joystick.$limit.style.width="150px",this.touch.joystick.$limit.style.height="150px",this.touch.joystick.$limit.style.border="2px solid #ffffff",this.touch.joystick.$limit.style.borderRadius="50%",this.touch.joystick.$limit.style.opacity="0.25",this.touch.joystick.$limit.style.pointerEvents="none",this.touch.joystick.$limit.style.boxSizing="border-box",this.touch.joystick.$element.appendChild(this.touch.joystick.$limit),this.touch.joystick.angle={},this.touch.joystick.angle.offset=Math.PI*.18,this.touch.joystick.angle.center={},this.touch.joystick.angle.center.x=0,this.touch.joystick.angle.center.y=0,this.touch.joystick.angle.current={},this.touch.joystick.angle.current.x=0,this.touch.joystick.angle.current.y=0,this.touch.joystick.angle.originalValue=0,this.touch.joystick.angle.value=-Math.PI*.5,this.touch.joystick.resize=()=>{const e=this.touch.joystick.$element.getBoundingClientRect();this.touch.joystick.angle.center.x=e.left+e.width*.5,this.touch.joystick.angle.center.y=e.top+e.height*.5},this.sizes.on("resize",this.touch.joystick.resize),this.touch.joystick.resize(),this.time.on("tick",()=>{if(this.touch.joystick.active){this.touch.joystick.angle.originalValue=-Math.atan2(this.touch.joystick.angle.current.y-this.touch.joystick.angle.center.y,this.touch.joystick.angle.current.x-this.touch.joystick.angle.center.x),this.touch.joystick.angle.value=this.touch.joystick.angle.originalValue+this.touch.joystick.angle.offset;const e=Math.hypot(this.touch.joystick.angle.current.y-this.touch.joystick.angle.center.y,this.touch.joystick.angle.current.x-this.touch.joystick.angle.center.x);let t=e;t>20&&(t=20+Math.log(e-20)*5),t>43&&(t=43);const n=Math.sin(this.touch.joystick.angle.originalValue+Math.PI*.5)*t,r=Math.cos(this.touch.joystick.angle.originalValue+Math.PI*.5)*t;this.touch.joystick.$cursor.style.transform=`translateX(${n}px) translateY(${r}px)`}}),this.touch.joystick.events={},this.touch.joystick.touchIdentifier=null,this.touch.joystick.events.touchstart=e=>{e.preventDefault();const t=e.changedTouches[0];t&&(this.touch.joystick.active=!0,this.touch.joystick.touchIdentifier=t.identifier,this.touch.joystick.angle.current.x=t.clientX,this.touch.joystick.angle.current.y=t.clientY,this.touch.joystick.$limit.style.opacity="0.5",document.addEventListener("touchend",this.touch.joystick.events.touchend),document.addEventListener("touchmove",this.touch.joystick.events.touchmove,{passive:!1}),this.trigger("joystickStart"))},this.touch.joystick.events.touchmove=e=>{e.preventDefault();const n=[...e.changedTouches].find(r=>r.identifier===this.touch.joystick.touchIdentifier);n&&(this.touch.joystick.angle.current.x=n.clientX,this.touch.joystick.angle.current.y=n.clientY,this.trigger("joystickMove"))},this.touch.joystick.events.touchend=e=>{[...e.changedTouches].find(r=>r.identifier===this.touch.joystick.touchIdentifier)&&(this.touch.joystick.active=!1,this.touch.joystick.$limit.style.opacity="0.25",this.touch.joystick.$cursor.style.transform="translateX(0px) translateY(0px)",document.removeEventListener("touchend",this.touch.joystick.events.touchend),this.trigger("joystickEnd"))},this.touch.joystick.$element.addEventListener("touchstart",this.touch.joystick.events.touchstart,{passive:!1}),this.touch.boost={},this.touch.boost.$element=document.createElement("div"),this.touch.boost.$element.style.userSelect="none",this.touch.boost.$element.style.position="fixed",this.touch.boost.$element.style.bottom="calc(70px * 3 + 15px)",this.touch.boost.$element.style.right="0px",this.touch.boost.$element.style.width="95px",this.touch.boost.$element.style.height="70px",this.touch.boost.$element.style.transition="opacity 0.3s 0.4s",this.touch.boost.$element.style.willChange="opacity",this.touch.boost.$element.style.opacity="0",document.body.appendChild(this.touch.boost.$element),this.touch.boost.$border=document.createElement("div"),this.touch.boost.$border.style.position="absolute",this.touch.boost.$border.style.top="calc(50% - 30px)",this.touch.boost.$border.style.left="calc(50% - 30px)",this.touch.boost.$border.style.width="60px",this.touch.boost.$border.style.height="60px",this.touch.boost.$border.style.border="2px solid #ffffff",this.touch.boost.$border.style.borderRadius="10px",this.touch.boost.$border.style.boxSizing="border-box",this.touch.boost.$border.style.opacity="0.25",this.touch.boost.$border.style.willChange="opacity",this.touch.boost.$element.appendChild(this.touch.boost.$border),this.touch.boost.$icon=document.createElement("div"),this.touch.boost.$icon.style.position="absolute",this.touch.boost.$icon.style.top="calc(50% - 13px)",this.touch.boost.$icon.style.left="calc(50% - 11px)",this.touch.boost.$icon.style.width="22px",this.touch.boost.$icon.style.height="26px",this.touch.boost.$icon.style.backgroundImage=`url(${ZH})`,this.touch.boost.$icon.style.backgroundSize="cover",this.touch.boost.$element.appendChild(this.touch.boost.$icon),this.touch.boost.events={},this.touch.boost.touchIdentifier=null,this.touch.boost.events.touchstart=e=>{e.preventDefault();const t=e.changedTouches[0];t&&(this.camera.pan.reset(),this.touch.boost.touchIdentifier=t.identifier,this.actions.up=!0,this.actions.boost=!0,this.touch.boost.$border.style.opacity="0.5",document.addEventListener("touchend",this.touch.boost.events.touchend))},this.touch.boost.events.touchend=e=>{[...e.changedTouches].find(r=>r.identifier===this.touch.boost.touchIdentifier)&&(this.actions.up=!1,this.actions.boost=!1,this.touch.boost.$border.style.opacity="0.25",document.removeEventListener("touchend",this.touch.boost.events.touchend))},this.touch.boost.$element.addEventListener("touchstart",this.touch.boost.events.touchstart),this.touch.forward={},this.touch.forward.$element=document.createElement("div"),this.touch.forward.$element.style.userSelect="none",this.touch.forward.$element.style.position="fixed",this.touch.forward.$element.style.bottom="calc(70px * 2 + 15px)",this.touch.forward.$element.style.right="0px",this.touch.forward.$element.style.width="95px",this.touch.forward.$element.style.height="70px",this.touch.forward.$element.style.transition="opacity 0.3s 0.3s",this.touch.forward.$element.style.willChange="opacity",this.touch.forward.$element.style.opacity="0",document.body.appendChild(this.touch.forward.$element),this.touch.forward.$border=document.createElement("div"),this.touch.forward.$border.style.position="absolute",this.touch.forward.$border.style.top="calc(50% - 30px)",this.touch.forward.$border.style.left="calc(50% - 30px)",this.touch.forward.$border.style.width="60px",this.touch.forward.$border.style.height="60px",this.touch.forward.$border.style.border="2px solid #ffffff",this.touch.forward.$border.style.borderRadius="10px",this.touch.forward.$border.style.boxSizing="border-box",this.touch.forward.$border.style.opacity="0.25",this.touch.forward.$border.style.willChange="opacity",this.touch.forward.$element.appendChild(this.touch.forward.$border),this.touch.forward.$icon=document.createElement("div"),this.touch.forward.$icon.style.position="absolute",this.touch.forward.$icon.style.top="calc(50% - 9px)",this.touch.forward.$icon.style.left="calc(50% - 11px)",this.touch.forward.$icon.style.width="22px",this.touch.forward.$icon.style.height="18px",this.touch.forward.$icon.style.backgroundImage=`url(${GT})`,this.touch.forward.$icon.style.backgroundSize="cover",this.touch.forward.$element.appendChild(this.touch.forward.$icon),this.touch.forward.events={},this.touch.forward.touchIdentifier=null,this.touch.forward.events.touchstart=e=>{e.preventDefault();const t=e.changedTouches[0];t&&(this.camera.pan.reset(),this.touch.forward.touchIdentifier=t.identifier,this.actions.up=!0,this.touch.forward.$border.style.opacity="0.5",document.addEventListener("touchend",this.touch.forward.events.touchend))},this.touch.forward.events.touchend=e=>{[...e.changedTouches].find(r=>r.identifier===this.touch.forward.touchIdentifier)&&(this.actions.up=!1,this.touch.forward.$border.style.opacity="0.25",document.removeEventListener("touchend",this.touch.forward.events.touchend))},this.touch.forward.$element.addEventListener("touchstart",this.touch.forward.events.touchstart),this.touch.brake={},this.touch.brake.$element=document.createElement("div"),this.touch.brake.$element.style.userSelect="none",this.touch.brake.$element.style.position="fixed",this.touch.brake.$element.style.bottom="calc(70px + 15px)",this.touch.brake.$element.style.right="0px",this.touch.brake.$element.style.width="95px",this.touch.brake.$element.style.height="70px",this.touch.brake.$element.style.transition="opacity 0.3s 0.2s",this.touch.brake.$element.style.willChange="opacity",this.touch.brake.$element.style.opacity="0",document.body.appendChild(this.touch.brake.$element),this.touch.brake.$border=document.createElement("div"),this.touch.brake.$border.style.position="absolute",this.touch.brake.$border.style.top="calc(50% - 30px)",this.touch.brake.$border.style.left="calc(50% - 30px)",this.touch.brake.$border.style.width="60px",this.touch.brake.$border.style.height="60px",this.touch.brake.$border.style.border="2px solid #ffffff",this.touch.brake.$border.style.borderRadius="10px",this.touch.brake.$border.style.boxSizing="border-box",this.touch.brake.$border.style.opacity="0.25",this.touch.brake.$border.style.willChange="opacity",this.touch.brake.$element.appendChild(this.touch.brake.$border),this.touch.brake.$icon=document.createElement("div"),this.touch.brake.$icon.style.position="absolute",this.touch.brake.$icon.style.top="calc(50% - 7px)",this.touch.brake.$icon.style.left="calc(50% - 7px)",this.touch.brake.$icon.style.width="15px",this.touch.brake.$icon.style.height="15px",this.touch.brake.$icon.style.backgroundImage=`url(${KH})`,this.touch.brake.$icon.style.backgroundSize="cover",this.touch.brake.$icon.style.transform="rotate(180deg)",this.touch.brake.$element.appendChild(this.touch.brake.$icon),this.touch.brake.events={},this.touch.brake.touchIdentifier=null,this.touch.brake.events.touchstart=e=>{e.preventDefault();const t=e.changedTouches[0];t&&(this.touch.brake.touchIdentifier=t.identifier,this.actions.brake=!0,this.touch.brake.$border.style.opacity="0.5",document.addEventListener("touchend",this.touch.brake.events.touchend))},this.touch.brake.events.touchend=e=>{[...e.changedTouches].find(r=>r.identifier===this.touch.brake.touchIdentifier)&&(this.actions.brake=!1,this.touch.brake.$border.style.opacity="0.25",document.removeEventListener("touchend",this.touch.brake.events.touchend))},this.touch.brake.$element.addEventListener("touchstart",this.touch.brake.events.touchstart),this.touch.backward={},this.touch.backward.$element=document.createElement("div"),this.touch.backward.$element.style.userSelect="none",this.touch.backward.$element.style.position="fixed",this.touch.backward.$element.style.bottom="15px",this.touch.backward.$element.style.right="0px",this.touch.backward.$element.style.width="95px",this.touch.backward.$element.style.height="70px",this.touch.backward.$element.style.transition="opacity 0.3s 0.1s",this.touch.backward.$element.style.willChange="opacity",this.touch.backward.$element.style.opacity="0",document.body.appendChild(this.touch.backward.$element),this.touch.backward.$border=document.createElement("div"),this.touch.backward.$border.style.position="absolute",this.touch.backward.$border.style.top="calc(50% - 30px)",this.touch.backward.$border.style.left="calc(50% - 30px)",this.touch.backward.$border.style.width="60px",this.touch.backward.$border.style.height="60px",this.touch.backward.$border.style.border="2px solid #ffffff",this.touch.backward.$border.style.borderRadius="10px",this.touch.backward.$border.style.boxSizing="border-box",this.touch.backward.$border.style.opacity="0.25",this.touch.backward.$border.style.willChange="opacity",this.touch.backward.$element.appendChild(this.touch.backward.$border),this.touch.backward.$icon=document.createElement("div"),this.touch.backward.$icon.style.position="absolute",this.touch.backward.$icon.style.top="calc(50% - 9px)",this.touch.backward.$icon.style.left="calc(50% - 11px)",this.touch.backward.$icon.style.width="22px",this.touch.backward.$icon.style.height="18px",this.touch.backward.$icon.style.backgroundImage=`url(${GT})`,this.touch.backward.$icon.style.backgroundSize="cover",this.touch.backward.$icon.style.transform="rotate(180deg)",this.touch.backward.$element.appendChild(this.touch.backward.$icon),this.touch.backward.events={},this.touch.backward.touchIdentifier=null,this.touch.backward.events.touchstart=e=>{e.preventDefault();const t=e.changedTouches[0];t&&(this.camera.pan.reset(),this.touch.backward.touchIdentifier=t.identifier,this.actions.down=!0,this.touch.backward.$border.style.opacity="0.5",document.addEventListener("touchend",this.touch.backward.events.touchend))},this.touch.backward.events.touchend=e=>{[...e.changedTouches].find(r=>r.identifier===this.touch.backward.touchIdentifier)&&(this.actions.down=!1,this.touch.backward.$border.style.opacity="0.25",document.removeEventListener("touchend",this.touch.backward.events.touchend))},this.touch.backward.$element.addEventListener("touchstart",this.touch.backward.events.touchstart),this.touch.reveal=()=>{this.touch.joystick.$element.style.opacity=1,this.touch.backward.$element.style.opacity=1,this.touch.brake.$element.style.opacity=1,this.touch.forward.$element.style.opacity=1,this.touch.boost.$element.style.opacity=1}}}var xi={};/*!
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(i){(function(){var e=function(){this.init()};e.prototype={init:function(){var l=this||t;return l._counter=1e3,l._html5AudioPool=[],l.html5PoolSize=10,l._codecs={},l._howls=[],l._muted=!1,l._volume=1,l._canPlayEvent="canplaythrough",l._navigator=typeof window!="undefined"&&window.navigator?window.navigator:null,l.masterGain=null,l.noAudio=!1,l.usingWebAudio=!0,l.autoSuspend=!0,l.ctx=null,l.autoUnlock=!0,l._setup(),l},volume:function(l){var u=this||t;if(l=parseFloat(l),u.ctx||d(),typeof l!="undefined"&&l>=0&&l<=1){if(u._volume=l,u._muted)return u;u.usingWebAudio&&u.masterGain.gain.setValueAtTime(l,t.ctx.currentTime);for(var p=0;p<u._howls.length;p++)if(!u._howls[p]._webAudio)for(var g=u._howls[p]._getSoundIds(),y=0;y<g.length;y++){var x=u._howls[p]._soundById(g[y]);x&&x._node&&(x._node.volume=x._volume*l)}return u}return u._volume},mute:function(l){var u=this||t;u.ctx||d(),u._muted=l,u.usingWebAudio&&u.masterGain.gain.setValueAtTime(l?0:u._volume,t.ctx.currentTime);for(var p=0;p<u._howls.length;p++)if(!u._howls[p]._webAudio)for(var g=u._howls[p]._getSoundIds(),y=0;y<g.length;y++){var x=u._howls[p]._soundById(g[y]);x&&x._node&&(x._node.muted=l?!0:x._muted)}return u},stop:function(){for(var l=this||t,u=0;u<l._howls.length;u++)l._howls[u].stop();return l},unload:function(){for(var l=this||t,u=l._howls.length-1;u>=0;u--)l._howls[u].unload();return l.usingWebAudio&&l.ctx&&typeof l.ctx.close!="undefined"&&(l.ctx.close(),l.ctx=null,d()),l},codecs:function(l){return(this||t)._codecs[l.replace(/^x-/,"")]},_setup:function(){var l=this||t;if(l.state=l.ctx&&l.ctx.state||"suspended",l._autoSuspend(),!l.usingWebAudio)if(typeof Audio!="undefined")try{var u=new Audio;typeof u.oncanplaythrough=="undefined"&&(l._canPlayEvent="canplay")}catch{l.noAudio=!0}else l.noAudio=!0;try{var u=new Audio;u.muted&&(l.noAudio=!0)}catch{}return l.noAudio||l._setupCodecs(),l},_setupCodecs:function(){var l=this||t,u=null;try{u=typeof Audio!="undefined"?new Audio:null}catch{return l}if(!u||typeof u.canPlayType!="function")return l;var p=u.canPlayType("audio/mpeg;").replace(/^no$/,""),g=l._navigator?l._navigator.userAgent:"",y=g.match(/OPR\/([0-6].)/g),x=y&&parseInt(y[0].split("/")[1],10)<33,v=g.indexOf("Safari")!==-1&&g.indexOf("Chrome")===-1,w=g.match(/Version\/(.*?) /),S=v&&w&&parseInt(w[1],10)<15;return l._codecs={mp3:!!(!x&&(p||u.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!p,opus:!!u.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!u.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!u.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(u.canPlayType('audio/wav; codecs="1"')||u.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!u.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!u.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(u.canPlayType("audio/x-m4a;")||u.canPlayType("audio/m4a;")||u.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(u.canPlayType("audio/x-m4b;")||u.canPlayType("audio/m4b;")||u.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(u.canPlayType("audio/x-mp4;")||u.canPlayType("audio/mp4;")||u.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!S&&u.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!S&&u.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!u.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(u.canPlayType("audio/x-flac;")||u.canPlayType("audio/flac;")).replace(/^no$/,"")},l},_unlockAudio:function(){var l=this||t;if(!(l._audioUnlocked||!l.ctx)){l._audioUnlocked=!1,l.autoUnlock=!1,!l._mobileUnloaded&&l.ctx.sampleRate!==44100&&(l._mobileUnloaded=!0,l.unload()),l._scratchBuffer=l.ctx.createBuffer(1,1,22050);var u=function(p){for(;l._html5AudioPool.length<l.html5PoolSize;)try{var g=new Audio;g._unlocked=!0,l._releaseHtml5Audio(g)}catch{l.noAudio=!0;break}for(var y=0;y<l._howls.length;y++)if(!l._howls[y]._webAudio)for(var x=l._howls[y]._getSoundIds(),v=0;v<x.length;v++){var w=l._howls[y]._soundById(x[v]);w&&w._node&&!w._node._unlocked&&(w._node._unlocked=!0,w._node.load())}l._autoResume();var S=l.ctx.createBufferSource();S.buffer=l._scratchBuffer,S.connect(l.ctx.destination),typeof S.start=="undefined"?S.noteOn(0):S.start(0),typeof l.ctx.resume=="function"&&l.ctx.resume(),S.onended=function(){S.disconnect(0),l._audioUnlocked=!0,document.removeEventListener("touchstart",u,!0),document.removeEventListener("touchend",u,!0),document.removeEventListener("click",u,!0),document.removeEventListener("keydown",u,!0);for(var b=0;b<l._howls.length;b++)l._howls[b]._emit("unlock")}};return document.addEventListener("touchstart",u,!0),document.addEventListener("touchend",u,!0),document.addEventListener("click",u,!0),document.addEventListener("keydown",u,!0),l}},_obtainHtml5Audio:function(){var l=this||t;if(l._html5AudioPool.length)return l._html5AudioPool.pop();var u=new Audio().play();return u&&typeof Promise!="undefined"&&(u instanceof Promise||typeof u.then=="function")&&u.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(l){var u=this||t;return l._unlocked&&u._html5AudioPool.push(l),u},_autoSuspend:function(){var l=this;if(!(!l.autoSuspend||!l.ctx||typeof l.ctx.suspend=="undefined"||!t.usingWebAudio)){for(var u=0;u<l._howls.length;u++)if(l._howls[u]._webAudio){for(var p=0;p<l._howls[u]._sounds.length;p++)if(!l._howls[u]._sounds[p]._paused)return l}return l._suspendTimer&&clearTimeout(l._suspendTimer),l._suspendTimer=setTimeout(function(){if(!!l.autoSuspend){l._suspendTimer=null,l.state="suspending";var g=function(){l.state="suspended",l._resumeAfterSuspend&&(delete l._resumeAfterSuspend,l._autoResume())};l.ctx.suspend().then(g,g)}},3e4),l}},_autoResume:function(){var l=this;if(!(!l.ctx||typeof l.ctx.resume=="undefined"||!t.usingWebAudio))return l.state==="running"&&l.ctx.state!=="interrupted"&&l._suspendTimer?(clearTimeout(l._suspendTimer),l._suspendTimer=null):l.state==="suspended"||l.state==="running"&&l.ctx.state==="interrupted"?(l.ctx.resume().then(function(){l.state="running";for(var u=0;u<l._howls.length;u++)l._howls[u]._emit("resume")}),l._suspendTimer&&(clearTimeout(l._suspendTimer),l._suspendTimer=null)):l.state==="suspending"&&(l._resumeAfterSuspend=!0),l}};var t=new e,n=function(l){var u=this;if(!l.src||l.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}u.init(l)};n.prototype={init:function(l){var u=this;return t.ctx||d(),u._autoplay=l.autoplay||!1,u._format=typeof l.format!="string"?l.format:[l.format],u._html5=l.html5||!1,u._muted=l.mute||!1,u._loop=l.loop||!1,u._pool=l.pool||5,u._preload=typeof l.preload=="boolean"||l.preload==="metadata"?l.preload:!0,u._rate=l.rate||1,u._sprite=l.sprite||{},u._src=typeof l.src!="string"?l.src:[l.src],u._volume=l.volume!==void 0?l.volume:1,u._xhr={method:l.xhr&&l.xhr.method?l.xhr.method:"GET",headers:l.xhr&&l.xhr.headers?l.xhr.headers:null,withCredentials:l.xhr&&l.xhr.withCredentials?l.xhr.withCredentials:!1},u._duration=0,u._state="unloaded",u._sounds=[],u._endTimers={},u._queue=[],u._playLock=!1,u._onend=l.onend?[{fn:l.onend}]:[],u._onfade=l.onfade?[{fn:l.onfade}]:[],u._onload=l.onload?[{fn:l.onload}]:[],u._onloaderror=l.onloaderror?[{fn:l.onloaderror}]:[],u._onplayerror=l.onplayerror?[{fn:l.onplayerror}]:[],u._onpause=l.onpause?[{fn:l.onpause}]:[],u._onplay=l.onplay?[{fn:l.onplay}]:[],u._onstop=l.onstop?[{fn:l.onstop}]:[],u._onmute=l.onmute?[{fn:l.onmute}]:[],u._onvolume=l.onvolume?[{fn:l.onvolume}]:[],u._onrate=l.onrate?[{fn:l.onrate}]:[],u._onseek=l.onseek?[{fn:l.onseek}]:[],u._onunlock=l.onunlock?[{fn:l.onunlock}]:[],u._onresume=[],u._webAudio=t.usingWebAudio&&!u._html5,typeof t.ctx!="undefined"&&t.ctx&&t.autoUnlock&&t._unlockAudio(),t._howls.push(u),u._autoplay&&u._queue.push({event:"play",action:function(){u.play()}}),u._preload&&u._preload!=="none"&&u.load(),u},load:function(){var l=this,u=null;if(t.noAudio){l._emit("loaderror",null,"No audio support.");return}typeof l._src=="string"&&(l._src=[l._src]);for(var p=0;p<l._src.length;p++){var g,y;if(l._format&&l._format[p])g=l._format[p];else{if(y=l._src[p],typeof y!="string"){l._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}g=/^data:audio\/([^;,]+);/i.exec(y),g||(g=/\.([^.]+)$/.exec(y.split("?",1)[0])),g&&(g=g[1].toLowerCase())}if(g||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),g&&t.codecs(g)){u=l._src[p];break}}if(!u){l._emit("loaderror",null,"No codec support for selected audio sources.");return}return l._src=u,l._state="loading",window.location.protocol==="https:"&&u.slice(0,5)==="http:"&&(l._html5=!0,l._webAudio=!1),new r(l),l._webAudio&&o(l),l},play:function(l,u){var p=this,g=null;if(typeof l=="number")g=l,l=null;else{if(typeof l=="string"&&p._state==="loaded"&&!p._sprite[l])return null;if(typeof l=="undefined"&&(l="__default",!p._playLock)){for(var y=0,x=0;x<p._sounds.length;x++)p._sounds[x]._paused&&!p._sounds[x]._ended&&(y++,g=p._sounds[x]._id);y===1?l=null:g=null}}var v=g?p._soundById(g):p._inactiveSound();if(!v)return null;if(g&&!l&&(l=v._sprite||"__default"),p._state!=="loaded"){v._sprite=l,v._ended=!1;var w=v._id;return p._queue.push({event:"play",action:function(){p.play(w)}}),w}if(g&&!v._paused)return u||p._loadQueue("play"),v._id;p._webAudio&&t._autoResume();var S=Math.max(0,v._seek>0?v._seek:p._sprite[l][0]/1e3),b=Math.max(0,(p._sprite[l][0]+p._sprite[l][1])/1e3-S),E=b*1e3/Math.abs(v._rate),R=p._sprite[l][0]/1e3,z=(p._sprite[l][0]+p._sprite[l][1])/1e3;v._sprite=l,v._ended=!1;var I=function(){v._paused=!1,v._seek=S,v._start=R,v._stop=z,v._loop=!!(v._loop||p._sprite[l][2])};if(S>=z){p._ended(v);return}var N=v._node;if(p._webAudio){var F=function(){p._playLock=!1,I(),p._refreshBuffer(v);var U=v._muted||p._muted?0:v._volume;N.gain.setValueAtTime(U,t.ctx.currentTime),v._playStart=t.ctx.currentTime,typeof N.bufferSource.start=="undefined"?v._loop?N.bufferSource.noteGrainOn(0,S,86400):N.bufferSource.noteGrainOn(0,S,b):v._loop?N.bufferSource.start(0,S,86400):N.bufferSource.start(0,S,b),E!==1/0&&(p._endTimers[v._id]=setTimeout(p._ended.bind(p,v),E)),u||setTimeout(function(){p._emit("play",v._id),p._loadQueue()},0)};t.state==="running"&&t.ctx.state!=="interrupted"?F():(p._playLock=!0,p.once("resume",F),p._clearTimer(v._id))}else{var C=function(){N.currentTime=S,N.muted=v._muted||p._muted||t._muted||N.muted,N.volume=v._volume*t.volume(),N.playbackRate=v._rate;try{var U=N.play();if(U&&typeof Promise!="undefined"&&(U instanceof Promise||typeof U.then=="function")?(p._playLock=!0,I(),U.then(function(){p._playLock=!1,N._unlocked=!0,u?p._loadQueue():p._emit("play",v._id)}).catch(function(){p._playLock=!1,p._emit("playerror",v._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),v._ended=!0,v._paused=!0})):u||(p._playLock=!1,I(),p._emit("play",v._id)),N.playbackRate=v._rate,N.paused){p._emit("playerror",v._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}l!=="__default"||v._loop?p._endTimers[v._id]=setTimeout(p._ended.bind(p,v),E):(p._endTimers[v._id]=function(){p._ended(v),N.removeEventListener("ended",p._endTimers[v._id],!1)},N.addEventListener("ended",p._endTimers[v._id],!1))}catch(te){p._emit("playerror",v._id,te)}};N.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(N.src=p._src,N.load());var O=window&&window.ejecta||!N.readyState&&t._navigator.isCocoonJS;if(N.readyState>=3||O)C();else{p._playLock=!0,p._state="loading";var X=function(){p._state="loaded",C(),N.removeEventListener(t._canPlayEvent,X,!1)};N.addEventListener(t._canPlayEvent,X,!1),p._clearTimer(v._id)}}return v._id},pause:function(l){var u=this;if(u._state!=="loaded"||u._playLock)return u._queue.push({event:"pause",action:function(){u.pause(l)}}),u;for(var p=u._getSoundIds(l),g=0;g<p.length;g++){u._clearTimer(p[g]);var y=u._soundById(p[g]);if(y&&!y._paused&&(y._seek=u.seek(p[g]),y._rateSeek=0,y._paused=!0,u._stopFade(p[g]),y._node))if(u._webAudio){if(!y._node.bufferSource)continue;typeof y._node.bufferSource.stop=="undefined"?y._node.bufferSource.noteOff(0):y._node.bufferSource.stop(0),u._cleanBuffer(y._node)}else(!isNaN(y._node.duration)||y._node.duration===1/0)&&y._node.pause();arguments[1]||u._emit("pause",y?y._id:null)}return u},stop:function(l,u){var p=this;if(p._state!=="loaded"||p._playLock)return p._queue.push({event:"stop",action:function(){p.stop(l)}}),p;for(var g=p._getSoundIds(l),y=0;y<g.length;y++){p._clearTimer(g[y]);var x=p._soundById(g[y]);x&&(x._seek=x._start||0,x._rateSeek=0,x._paused=!0,x._ended=!0,p._stopFade(g[y]),x._node&&(p._webAudio?x._node.bufferSource&&(typeof x._node.bufferSource.stop=="undefined"?x._node.bufferSource.noteOff(0):x._node.bufferSource.stop(0),p._cleanBuffer(x._node)):(!isNaN(x._node.duration)||x._node.duration===1/0)&&(x._node.currentTime=x._start||0,x._node.pause(),x._node.duration===1/0&&p._clearSound(x._node))),u||p._emit("stop",x._id))}return p},mute:function(l,u){var p=this;if(p._state!=="loaded"||p._playLock)return p._queue.push({event:"mute",action:function(){p.mute(l,u)}}),p;if(typeof u=="undefined")if(typeof l=="boolean")p._muted=l;else return p._muted;for(var g=p._getSoundIds(u),y=0;y<g.length;y++){var x=p._soundById(g[y]);x&&(x._muted=l,x._interval&&p._stopFade(x._id),p._webAudio&&x._node?x._node.gain.setValueAtTime(l?0:x._volume,t.ctx.currentTime):x._node&&(x._node.muted=t._muted?!0:l),p._emit("mute",x._id))}return p},volume:function(){var l=this,u=arguments,p,g;if(u.length===0)return l._volume;if(u.length===1||u.length===2&&typeof u[1]=="undefined"){var y=l._getSoundIds(),x=y.indexOf(u[0]);x>=0?g=parseInt(u[0],10):p=parseFloat(u[0])}else u.length>=2&&(p=parseFloat(u[0]),g=parseInt(u[1],10));var v;if(typeof p!="undefined"&&p>=0&&p<=1){if(l._state!=="loaded"||l._playLock)return l._queue.push({event:"volume",action:function(){l.volume.apply(l,u)}}),l;typeof g=="undefined"&&(l._volume=p),g=l._getSoundIds(g);for(var w=0;w<g.length;w++)v=l._soundById(g[w]),v&&(v._volume=p,u[2]||l._stopFade(g[w]),l._webAudio&&v._node&&!v._muted?v._node.gain.setValueAtTime(p,t.ctx.currentTime):v._node&&!v._muted&&(v._node.volume=p*t.volume()),l._emit("volume",v._id))}else return v=g?l._soundById(g):l._sounds[0],v?v._volume:0;return l},fade:function(l,u,p,g){var y=this;if(y._state!=="loaded"||y._playLock)return y._queue.push({event:"fade",action:function(){y.fade(l,u,p,g)}}),y;l=Math.min(Math.max(0,parseFloat(l)),1),u=Math.min(Math.max(0,parseFloat(u)),1),p=parseFloat(p),y.volume(l,g);for(var x=y._getSoundIds(g),v=0;v<x.length;v++){var w=y._soundById(x[v]);if(w){if(g||y._stopFade(x[v]),y._webAudio&&!w._muted){var S=t.ctx.currentTime,b=S+p/1e3;w._volume=l,w._node.gain.setValueAtTime(l,S),w._node.gain.linearRampToValueAtTime(u,b)}y._startFadeInterval(w,l,u,p,x[v],typeof g=="undefined")}}return y},_startFadeInterval:function(l,u,p,g,y,x){var v=this,w=u,S=p-u,b=Math.abs(S/.01),E=Math.max(4,b>0?g/b:g),R=Date.now();l._fadeTo=p,l._interval=setInterval(function(){var z=(Date.now()-R)/g;R=Date.now(),w+=S*z,w=Math.round(w*100)/100,S<0?w=Math.max(p,w):w=Math.min(p,w),v._webAudio?l._volume=w:v.volume(w,l._id,!0),x&&(v._volume=w),(p<u&&w<=p||p>u&&w>=p)&&(clearInterval(l._interval),l._interval=null,l._fadeTo=null,v.volume(p,l._id),v._emit("fade",l._id))},E)},_stopFade:function(l){var u=this,p=u._soundById(l);return p&&p._interval&&(u._webAudio&&p._node.gain.cancelScheduledValues(t.ctx.currentTime),clearInterval(p._interval),p._interval=null,u.volume(p._fadeTo,l),p._fadeTo=null,u._emit("fade",l)),u},loop:function(){var l=this,u=arguments,p,g,y;if(u.length===0)return l._loop;if(u.length===1)if(typeof u[0]=="boolean")p=u[0],l._loop=p;else return y=l._soundById(parseInt(u[0],10)),y?y._loop:!1;else u.length===2&&(p=u[0],g=parseInt(u[1],10));for(var x=l._getSoundIds(g),v=0;v<x.length;v++)y=l._soundById(x[v]),y&&(y._loop=p,l._webAudio&&y._node&&y._node.bufferSource&&(y._node.bufferSource.loop=p,p&&(y._node.bufferSource.loopStart=y._start||0,y._node.bufferSource.loopEnd=y._stop,l.playing(x[v])&&(l.pause(x[v],!0),l.play(x[v],!0)))));return l},rate:function(){var l=this,u=arguments,p,g;if(u.length===0)g=l._sounds[0]._id;else if(u.length===1){var y=l._getSoundIds(),x=y.indexOf(u[0]);x>=0?g=parseInt(u[0],10):p=parseFloat(u[0])}else u.length===2&&(p=parseFloat(u[0]),g=parseInt(u[1],10));var v;if(typeof p=="number"){if(l._state!=="loaded"||l._playLock)return l._queue.push({event:"rate",action:function(){l.rate.apply(l,u)}}),l;typeof g=="undefined"&&(l._rate=p),g=l._getSoundIds(g);for(var w=0;w<g.length;w++)if(v=l._soundById(g[w]),v){l.playing(g[w])&&(v._rateSeek=l.seek(g[w]),v._playStart=l._webAudio?t.ctx.currentTime:v._playStart),v._rate=p,l._webAudio&&v._node&&v._node.bufferSource?v._node.bufferSource.playbackRate.setValueAtTime(p,t.ctx.currentTime):v._node&&(v._node.playbackRate=p);var S=l.seek(g[w]),b=(l._sprite[v._sprite][0]+l._sprite[v._sprite][1])/1e3-S,E=b*1e3/Math.abs(v._rate);(l._endTimers[g[w]]||!v._paused)&&(l._clearTimer(g[w]),l._endTimers[g[w]]=setTimeout(l._ended.bind(l,v),E)),l._emit("rate",v._id)}}else return v=l._soundById(g),v?v._rate:l._rate;return l},seek:function(){var l=this,u=arguments,p,g;if(u.length===0)l._sounds.length&&(g=l._sounds[0]._id);else if(u.length===1){var y=l._getSoundIds(),x=y.indexOf(u[0]);x>=0?g=parseInt(u[0],10):l._sounds.length&&(g=l._sounds[0]._id,p=parseFloat(u[0]))}else u.length===2&&(p=parseFloat(u[0]),g=parseInt(u[1],10));if(typeof g=="undefined")return 0;if(typeof p=="number"&&(l._state!=="loaded"||l._playLock))return l._queue.push({event:"seek",action:function(){l.seek.apply(l,u)}}),l;var v=l._soundById(g);if(v)if(typeof p=="number"&&p>=0){var w=l.playing(g);w&&l.pause(g,!0),v._seek=p,v._ended=!1,l._clearTimer(g),!l._webAudio&&v._node&&!isNaN(v._node.duration)&&(v._node.currentTime=p);var S=function(){w&&l.play(g,!0),l._emit("seek",g)};if(w&&!l._webAudio){var b=function(){l._playLock?setTimeout(b,0):S()};setTimeout(b,0)}else S()}else if(l._webAudio){var E=l.playing(g)?t.ctx.currentTime-v._playStart:0,R=v._rateSeek?v._rateSeek-v._seek:0;return v._seek+(R+E*Math.abs(v._rate))}else return v._node.currentTime;return l},playing:function(l){var u=this;if(typeof l=="number"){var p=u._soundById(l);return p?!p._paused:!1}for(var g=0;g<u._sounds.length;g++)if(!u._sounds[g]._paused)return!0;return!1},duration:function(l){var u=this,p=u._duration,g=u._soundById(l);return g&&(p=u._sprite[g._sprite][1]/1e3),p},state:function(){return this._state},unload:function(){for(var l=this,u=l._sounds,p=0;p<u.length;p++)u[p]._paused||l.stop(u[p]._id),l._webAudio||(l._clearSound(u[p]._node),u[p]._node.removeEventListener("error",u[p]._errorFn,!1),u[p]._node.removeEventListener(t._canPlayEvent,u[p]._loadFn,!1),u[p]._node.removeEventListener("ended",u[p]._endFn,!1),t._releaseHtml5Audio(u[p]._node)),delete u[p]._node,l._clearTimer(u[p]._id);var g=t._howls.indexOf(l);g>=0&&t._howls.splice(g,1);var y=!0;for(p=0;p<t._howls.length;p++)if(t._howls[p]._src===l._src||l._src.indexOf(t._howls[p]._src)>=0){y=!1;break}return s&&y&&delete s[l._src],t.noAudio=!1,l._state="unloaded",l._sounds=[],l=null,null},on:function(l,u,p,g){var y=this,x=y["_on"+l];return typeof u=="function"&&x.push(g?{id:p,fn:u,once:g}:{id:p,fn:u}),y},off:function(l,u,p){var g=this,y=g["_on"+l],x=0;if(typeof u=="number"&&(p=u,u=null),u||p)for(x=0;x<y.length;x++){var v=p===y[x].id;if(u===y[x].fn&&v||!u&&v){y.splice(x,1);break}}else if(l)g["_on"+l]=[];else{var w=Object.keys(g);for(x=0;x<w.length;x++)w[x].indexOf("_on")===0&&Array.isArray(g[w[x]])&&(g[w[x]]=[])}return g},once:function(l,u,p){var g=this;return g.on(l,u,p,1),g},_emit:function(l,u,p){for(var g=this,y=g["_on"+l],x=y.length-1;x>=0;x--)(!y[x].id||y[x].id===u||l==="load")&&(setTimeout(function(v){v.call(this,u,p)}.bind(g,y[x].fn),0),y[x].once&&g.off(l,y[x].fn,y[x].id));return g._loadQueue(l),g},_loadQueue:function(l){var u=this;if(u._queue.length>0){var p=u._queue[0];p.event===l&&(u._queue.shift(),u._loadQueue()),l||p.action()}return u},_ended:function(l){var u=this,p=l._sprite;if(!u._webAudio&&l._node&&!l._node.paused&&!l._node.ended&&l._node.currentTime<l._stop)return setTimeout(u._ended.bind(u,l),100),u;var g=!!(l._loop||u._sprite[p][2]);if(u._emit("end",l._id),!u._webAudio&&g&&u.stop(l._id,!0).play(l._id),u._webAudio&&g){u._emit("play",l._id),l._seek=l._start||0,l._rateSeek=0,l._playStart=t.ctx.currentTime;var y=(l._stop-l._start)*1e3/Math.abs(l._rate);u._endTimers[l._id]=setTimeout(u._ended.bind(u,l),y)}return u._webAudio&&!g&&(l._paused=!0,l._ended=!0,l._seek=l._start||0,l._rateSeek=0,u._clearTimer(l._id),u._cleanBuffer(l._node),t._autoSuspend()),!u._webAudio&&!g&&u.stop(l._id,!0),u},_clearTimer:function(l){var u=this;if(u._endTimers[l]){if(typeof u._endTimers[l]!="function")clearTimeout(u._endTimers[l]);else{var p=u._soundById(l);p&&p._node&&p._node.removeEventListener("ended",u._endTimers[l],!1)}delete u._endTimers[l]}return u},_soundById:function(l){for(var u=this,p=0;p<u._sounds.length;p++)if(l===u._sounds[p]._id)return u._sounds[p];return null},_inactiveSound:function(){var l=this;l._drain();for(var u=0;u<l._sounds.length;u++)if(l._sounds[u]._ended)return l._sounds[u].reset();return new r(l)},_drain:function(){var l=this,u=l._pool,p=0,g=0;if(!(l._sounds.length<u)){for(g=0;g<l._sounds.length;g++)l._sounds[g]._ended&&p++;for(g=l._sounds.length-1;g>=0;g--){if(p<=u)return;l._sounds[g]._ended&&(l._webAudio&&l._sounds[g]._node&&l._sounds[g]._node.disconnect(0),l._sounds.splice(g,1),p--)}}},_getSoundIds:function(l){var u=this;if(typeof l=="undefined"){for(var p=[],g=0;g<u._sounds.length;g++)p.push(u._sounds[g]._id);return p}else return[l]},_refreshBuffer:function(l){var u=this;return l._node.bufferSource=t.ctx.createBufferSource(),l._node.bufferSource.buffer=s[u._src],l._panner?l._node.bufferSource.connect(l._panner):l._node.bufferSource.connect(l._node),l._node.bufferSource.loop=l._loop,l._loop&&(l._node.bufferSource.loopStart=l._start||0,l._node.bufferSource.loopEnd=l._stop||0),l._node.bufferSource.playbackRate.setValueAtTime(l._rate,t.ctx.currentTime),u},_cleanBuffer:function(l){var u=this,p=t._navigator&&t._navigator.vendor.indexOf("Apple")>=0;if(t._scratchBuffer&&l.bufferSource&&(l.bufferSource.onended=null,l.bufferSource.disconnect(0),p))try{l.bufferSource.buffer=t._scratchBuffer}catch{}return l.bufferSource=null,u},_clearSound:function(l){var u=/MSIE |Trident\//.test(t._navigator&&t._navigator.userAgent);u||(l.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var r=function(l){this._parent=l,this.init()};r.prototype={init:function(){var l=this,u=l._parent;return l._muted=u._muted,l._loop=u._loop,l._volume=u._volume,l._rate=u._rate,l._seek=0,l._paused=!0,l._ended=!0,l._sprite="__default",l._id=++t._counter,u._sounds.push(l),l.create(),l},create:function(){var l=this,u=l._parent,p=t._muted||l._muted||l._parent._muted?0:l._volume;return u._webAudio?(l._node=typeof t.ctx.createGain=="undefined"?t.ctx.createGainNode():t.ctx.createGain(),l._node.gain.setValueAtTime(p,t.ctx.currentTime),l._node.paused=!0,l._node.connect(t.masterGain)):t.noAudio||(l._node=t._obtainHtml5Audio(),l._errorFn=l._errorListener.bind(l),l._node.addEventListener("error",l._errorFn,!1),l._loadFn=l._loadListener.bind(l),l._node.addEventListener(t._canPlayEvent,l._loadFn,!1),l._endFn=l._endListener.bind(l),l._node.addEventListener("ended",l._endFn,!1),l._node.src=u._src,l._node.preload=u._preload===!0?"auto":u._preload,l._node.volume=p*t.volume(),l._node.load()),l},reset:function(){var l=this,u=l._parent;return l._muted=u._muted,l._loop=u._loop,l._volume=u._volume,l._rate=u._rate,l._seek=0,l._rateSeek=0,l._paused=!0,l._ended=!0,l._sprite="__default",l._id=++t._counter,l},_errorListener:function(){var l=this;l._parent._emit("loaderror",l._id,l._node.error?l._node.error.code:0),l._node.removeEventListener("error",l._errorFn,!1)},_loadListener:function(){var l=this,u=l._parent;u._duration=Math.ceil(l._node.duration*10)/10,Object.keys(u._sprite).length===0&&(u._sprite={__default:[0,u._duration*1e3]}),u._state!=="loaded"&&(u._state="loaded",u._emit("load"),u._loadQueue()),l._node.removeEventListener(t._canPlayEvent,l._loadFn,!1)},_endListener:function(){var l=this,u=l._parent;u._duration===1/0&&(u._duration=Math.ceil(l._node.duration*10)/10,u._sprite.__default[1]===1/0&&(u._sprite.__default[1]=u._duration*1e3),u._ended(l)),l._node.removeEventListener("ended",l._endFn,!1)}};var s={},o=function(l){var u=l._src;if(s[u]){l._duration=s[u].duration,h(l);return}if(/^data:[^;]+;base64,/.test(u)){for(var p=atob(u.split(",")[1]),g=new Uint8Array(p.length),y=0;y<p.length;++y)g[y]=p.charCodeAt(y);c(g.buffer,l)}else{var x=new XMLHttpRequest;x.open(l._xhr.method,u,!0),x.withCredentials=l._xhr.withCredentials,x.responseType="arraybuffer",l._xhr.headers&&Object.keys(l._xhr.headers).forEach(function(v){x.setRequestHeader(v,l._xhr.headers[v])}),x.onload=function(){var v=(x.status+"")[0];if(v!=="0"&&v!=="2"&&v!=="3"){l._emit("loaderror",null,"Failed loading audio file with status: "+x.status+".");return}c(x.response,l)},x.onerror=function(){l._webAudio&&(l._html5=!0,l._webAudio=!1,l._sounds=[],delete s[u],l.load())},a(x)}},a=function(l){try{l.send()}catch{l.onerror()}},c=function(l,u){var p=function(){u._emit("loaderror",null,"Decoding audio data failed.")},g=function(y){y&&u._sounds.length>0?(s[u._src]=y,h(u,y)):p()};typeof Promise!="undefined"&&t.ctx.decodeAudioData.length===1?t.ctx.decodeAudioData(l).then(g).catch(p):t.ctx.decodeAudioData(l,g,p)},h=function(l,u){u&&!l._duration&&(l._duration=u.duration),Object.keys(l._sprite).length===0&&(l._sprite={__default:[0,l._duration*1e3]}),l._state!=="loaded"&&(l._state="loaded",l._emit("load"),l._loadQueue())},d=function(){if(!!t.usingWebAudio){try{typeof AudioContext!="undefined"?t.ctx=new AudioContext:typeof webkitAudioContext!="undefined"?t.ctx=new webkitAudioContext:t.usingWebAudio=!1}catch{t.usingWebAudio=!1}t.ctx||(t.usingWebAudio=!1);var l=/iP(hone|od|ad)/.test(t._navigator&&t._navigator.platform),u=t._navigator&&t._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),p=u?parseInt(u[1],10):null;if(l&&p&&p<9){var g=/safari/.test(t._navigator&&t._navigator.userAgent.toLowerCase());t._navigator&&!g&&(t.usingWebAudio=!1)}t.usingWebAudio&&(t.masterGain=typeof t.ctx.createGain=="undefined"?t.ctx.createGainNode():t.ctx.createGain(),t.masterGain.gain.setValueAtTime(t._muted?0:t._volume,t.ctx.currentTime),t.masterGain.connect(t.ctx.destination)),t._setup()}};i.Howler=t,i.Howl=n,typeof Ch!="undefined"?(Ch.HowlerGlobal=e,Ch.Howler=t,Ch.Howl=n,Ch.Sound=r):typeof window!="undefined"&&(window.HowlerGlobal=e,window.Howler=t,window.Howl=n,window.Sound=r)})();/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(t){var n=this;if(!n.ctx||!n.ctx.listener)return n;for(var r=n._howls.length-1;r>=0;r--)n._howls[r].stereo(t);return n},HowlerGlobal.prototype.pos=function(t,n,r){var s=this;if(!s.ctx||!s.ctx.listener)return s;if(n=typeof n!="number"?s._pos[1]:n,r=typeof r!="number"?s._pos[2]:r,typeof t=="number")s._pos=[t,n,r],typeof s.ctx.listener.positionX!="undefined"?(s.ctx.listener.positionX.setTargetAtTime(s._pos[0],Howler.ctx.currentTime,.1),s.ctx.listener.positionY.setTargetAtTime(s._pos[1],Howler.ctx.currentTime,.1),s.ctx.listener.positionZ.setTargetAtTime(s._pos[2],Howler.ctx.currentTime,.1)):s.ctx.listener.setPosition(s._pos[0],s._pos[1],s._pos[2]);else return s._pos;return s},HowlerGlobal.prototype.orientation=function(t,n,r,s,o,a){var c=this;if(!c.ctx||!c.ctx.listener)return c;var h=c._orientation;if(n=typeof n!="number"?h[1]:n,r=typeof r!="number"?h[2]:r,s=typeof s!="number"?h[3]:s,o=typeof o!="number"?h[4]:o,a=typeof a!="number"?h[5]:a,typeof t=="number")c._orientation=[t,n,r,s,o,a],typeof c.ctx.listener.forwardX!="undefined"?(c.ctx.listener.forwardX.setTargetAtTime(t,Howler.ctx.currentTime,.1),c.ctx.listener.forwardY.setTargetAtTime(n,Howler.ctx.currentTime,.1),c.ctx.listener.forwardZ.setTargetAtTime(r,Howler.ctx.currentTime,.1),c.ctx.listener.upX.setTargetAtTime(s,Howler.ctx.currentTime,.1),c.ctx.listener.upY.setTargetAtTime(o,Howler.ctx.currentTime,.1),c.ctx.listener.upZ.setTargetAtTime(a,Howler.ctx.currentTime,.1)):c.ctx.listener.setOrientation(t,n,r,s,o,a);else return h;return c},Howl.prototype.init=function(t){return function(n){var r=this;return r._orientation=n.orientation||[1,0,0],r._stereo=n.stereo||null,r._pos=n.pos||null,r._pannerAttr={coneInnerAngle:typeof n.coneInnerAngle!="undefined"?n.coneInnerAngle:360,coneOuterAngle:typeof n.coneOuterAngle!="undefined"?n.coneOuterAngle:360,coneOuterGain:typeof n.coneOuterGain!="undefined"?n.coneOuterGain:0,distanceModel:typeof n.distanceModel!="undefined"?n.distanceModel:"inverse",maxDistance:typeof n.maxDistance!="undefined"?n.maxDistance:1e4,panningModel:typeof n.panningModel!="undefined"?n.panningModel:"HRTF",refDistance:typeof n.refDistance!="undefined"?n.refDistance:1,rolloffFactor:typeof n.rolloffFactor!="undefined"?n.rolloffFactor:1},r._onstereo=n.onstereo?[{fn:n.onstereo}]:[],r._onpos=n.onpos?[{fn:n.onpos}]:[],r._onorientation=n.onorientation?[{fn:n.onorientation}]:[],t.call(this,n)}}(Howl.prototype.init),Howl.prototype.stereo=function(t,n){var r=this;if(!r._webAudio)return r;if(r._state!=="loaded")return r._queue.push({event:"stereo",action:function(){r.stereo(t,n)}}),r;var s=typeof Howler.ctx.createStereoPanner=="undefined"?"spatial":"stereo";if(typeof n=="undefined")if(typeof t=="number")r._stereo=t,r._pos=[t,0,0];else return r._stereo;for(var o=r._getSoundIds(n),a=0;a<o.length;a++){var c=r._soundById(o[a]);if(c)if(typeof t=="number")c._stereo=t,c._pos=[t,0,0],c._node&&(c._pannerAttr.panningModel="equalpower",(!c._panner||!c._panner.pan)&&e(c,s),s==="spatial"?typeof c._panner.positionX!="undefined"?(c._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),c._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),c._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):c._panner.setPosition(t,0,0):c._panner.pan.setValueAtTime(t,Howler.ctx.currentTime)),r._emit("stereo",c._id);else return c._stereo}return r},Howl.prototype.pos=function(t,n,r,s){var o=this;if(!o._webAudio)return o;if(o._state!=="loaded")return o._queue.push({event:"pos",action:function(){o.pos(t,n,r,s)}}),o;if(n=typeof n!="number"?0:n,r=typeof r!="number"?-.5:r,typeof s=="undefined")if(typeof t=="number")o._pos=[t,n,r];else return o._pos;for(var a=o._getSoundIds(s),c=0;c<a.length;c++){var h=o._soundById(a[c]);if(h)if(typeof t=="number")h._pos=[t,n,r],h._node&&((!h._panner||h._panner.pan)&&e(h,"spatial"),typeof h._panner.positionX!="undefined"?(h._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),h._panner.positionY.setValueAtTime(n,Howler.ctx.currentTime),h._panner.positionZ.setValueAtTime(r,Howler.ctx.currentTime)):h._panner.setPosition(t,n,r)),o._emit("pos",h._id);else return h._pos}return o},Howl.prototype.orientation=function(t,n,r,s){var o=this;if(!o._webAudio)return o;if(o._state!=="loaded")return o._queue.push({event:"orientation",action:function(){o.orientation(t,n,r,s)}}),o;if(n=typeof n!="number"?o._orientation[1]:n,r=typeof r!="number"?o._orientation[2]:r,typeof s=="undefined")if(typeof t=="number")o._orientation=[t,n,r];else return o._orientation;for(var a=o._getSoundIds(s),c=0;c<a.length;c++){var h=o._soundById(a[c]);if(h)if(typeof t=="number")h._orientation=[t,n,r],h._node&&(h._panner||(h._pos||(h._pos=o._pos||[0,0,-.5]),e(h,"spatial")),typeof h._panner.orientationX!="undefined"?(h._panner.orientationX.setValueAtTime(t,Howler.ctx.currentTime),h._panner.orientationY.setValueAtTime(n,Howler.ctx.currentTime),h._panner.orientationZ.setValueAtTime(r,Howler.ctx.currentTime)):h._panner.setOrientation(t,n,r)),o._emit("orientation",h._id);else return h._orientation}return o},Howl.prototype.pannerAttr=function(){var t=this,n=arguments,r,s,o;if(!t._webAudio)return t;if(n.length===0)return t._pannerAttr;if(n.length===1)if(typeof n[0]=="object")r=n[0],typeof s=="undefined"&&(r.pannerAttr||(r.pannerAttr={coneInnerAngle:r.coneInnerAngle,coneOuterAngle:r.coneOuterAngle,coneOuterGain:r.coneOuterGain,distanceModel:r.distanceModel,maxDistance:r.maxDistance,refDistance:r.refDistance,rolloffFactor:r.rolloffFactor,panningModel:r.panningModel}),t._pannerAttr={coneInnerAngle:typeof r.pannerAttr.coneInnerAngle!="undefined"?r.pannerAttr.coneInnerAngle:t._coneInnerAngle,coneOuterAngle:typeof r.pannerAttr.coneOuterAngle!="undefined"?r.pannerAttr.coneOuterAngle:t._coneOuterAngle,coneOuterGain:typeof r.pannerAttr.coneOuterGain!="undefined"?r.pannerAttr.coneOuterGain:t._coneOuterGain,distanceModel:typeof r.pannerAttr.distanceModel!="undefined"?r.pannerAttr.distanceModel:t._distanceModel,maxDistance:typeof r.pannerAttr.maxDistance!="undefined"?r.pannerAttr.maxDistance:t._maxDistance,refDistance:typeof r.pannerAttr.refDistance!="undefined"?r.pannerAttr.refDistance:t._refDistance,rolloffFactor:typeof r.pannerAttr.rolloffFactor!="undefined"?r.pannerAttr.rolloffFactor:t._rolloffFactor,panningModel:typeof r.pannerAttr.panningModel!="undefined"?r.pannerAttr.panningModel:t._panningModel});else return o=t._soundById(parseInt(n[0],10)),o?o._pannerAttr:t._pannerAttr;else n.length===2&&(r=n[0],s=parseInt(n[1],10));for(var a=t._getSoundIds(s),c=0;c<a.length;c++)if(o=t._soundById(a[c]),o){var h=o._pannerAttr;h={coneInnerAngle:typeof r.coneInnerAngle!="undefined"?r.coneInnerAngle:h.coneInnerAngle,coneOuterAngle:typeof r.coneOuterAngle!="undefined"?r.coneOuterAngle:h.coneOuterAngle,coneOuterGain:typeof r.coneOuterGain!="undefined"?r.coneOuterGain:h.coneOuterGain,distanceModel:typeof r.distanceModel!="undefined"?r.distanceModel:h.distanceModel,maxDistance:typeof r.maxDistance!="undefined"?r.maxDistance:h.maxDistance,refDistance:typeof r.refDistance!="undefined"?r.refDistance:h.refDistance,rolloffFactor:typeof r.rolloffFactor!="undefined"?r.rolloffFactor:h.rolloffFactor,panningModel:typeof r.panningModel!="undefined"?r.panningModel:h.panningModel};var d=o._panner;d?(d.coneInnerAngle=h.coneInnerAngle,d.coneOuterAngle=h.coneOuterAngle,d.coneOuterGain=h.coneOuterGain,d.distanceModel=h.distanceModel,d.maxDistance=h.maxDistance,d.refDistance=h.refDistance,d.rolloffFactor=h.rolloffFactor,d.panningModel=h.panningModel):(o._pos||(o._pos=t._pos||[0,0,-.5]),e(o,"spatial"))}return t},Sound.prototype.init=function(t){return function(){var n=this,r=n._parent;n._orientation=r._orientation,n._stereo=r._stereo,n._pos=r._pos,n._pannerAttr=r._pannerAttr,t.call(this),n._stereo?r.stereo(n._stereo):n._pos&&r.pos(n._pos[0],n._pos[1],n._pos[2],n._id)}}(Sound.prototype.init),Sound.prototype.reset=function(t){return function(){var n=this,r=n._parent;return n._orientation=r._orientation,n._stereo=r._stereo,n._pos=r._pos,n._pannerAttr=r._pannerAttr,n._stereo?r.stereo(n._stereo):n._pos?r.pos(n._pos[0],n._pos[1],n._pos[2],n._id):n._panner&&(n._panner.disconnect(0),n._panner=void 0,r._refreshBuffer(n)),t.call(this)}}(Sound.prototype.reset);var e=function(t,n){n=n||"spatial",n==="spatial"?(t._panner=Howler.ctx.createPanner(),t._panner.coneInnerAngle=t._pannerAttr.coneInnerAngle,t._panner.coneOuterAngle=t._pannerAttr.coneOuterAngle,t._panner.coneOuterGain=t._pannerAttr.coneOuterGain,t._panner.distanceModel=t._pannerAttr.distanceModel,t._panner.maxDistance=t._pannerAttr.maxDistance,t._panner.refDistance=t._pannerAttr.refDistance,t._panner.rolloffFactor=t._pannerAttr.rolloffFactor,t._panner.panningModel=t._pannerAttr.panningModel,typeof t._panner.positionX!="undefined"?(t._panner.positionX.setValueAtTime(t._pos[0],Howler.ctx.currentTime),t._panner.positionY.setValueAtTime(t._pos[1],Howler.ctx.currentTime),t._panner.positionZ.setValueAtTime(t._pos[2],Howler.ctx.currentTime)):t._panner.setPosition(t._pos[0],t._pos[1],t._pos[2]),typeof t._panner.orientationX!="undefined"?(t._panner.orientationX.setValueAtTime(t._orientation[0],Howler.ctx.currentTime),t._panner.orientationY.setValueAtTime(t._orientation[1],Howler.ctx.currentTime),t._panner.orientationZ.setValueAtTime(t._orientation[2],Howler.ctx.currentTime)):t._panner.setOrientation(t._orientation[0],t._orientation[1],t._orientation[2])):(t._panner=Howler.ctx.createStereoPanner(),t._panner.pan.setValueAtTime(t._stereo,Howler.ctx.currentTime)),t._panner.connect(t._node),t._paused||t._parent.pause(t._id,!0).play(t._id,!0)}})()})(xi);var eV="./assets/reveal-1.41e840fd.mp3",tV="./assets/low_off.5d71289c.mp3",nV="./assets/brick-1.9f1ae990.mp3",iV="./assets/brick-2.dac68136.mp3",rV="./assets/brick-4.3f3d232e.mp3",sV="./assets/brick-6.ef5541bc.mp3",oV="./assets/brick-7.fd5a2c28.mp3",aV="./assets/brick-8.52a772d9.mp3",Im="./assets/pin-1.681a7302.mp3",lV="./assets/car-hit-1.679fd9a9.mp3",cV="./assets/car-hit-3.1f2a09be.mp3",uV="./assets/car-hit-4.27f68daa.mp3",hV="./assets/car-hit-5.ee76f1ae.mp3",dV="./assets/wood-hit-1.2d8164db.mp3",fV="./assets/screech-1.0fcb5cdf.mp3",pV="./assets/area-1.1f95d080.mp3",mV="./assets/car-horn-1.946f3a0c.mp3",gV="./assets/car-horn-2.af6603d1.mp3",vV="./assets/horn-1.d84dc185.mp3",yV="./assets/horn-2.7d1d2c48.mp3",xV="./assets/horn-3.e99fbb1f.mp3";class wV{constructor(e){this.time=e.time,this.debug=e.debug,this.debug&&(this.debugFolder=this.debug.addFolder("sounds")),this.items=[],this.setSettings(),this.setMasterVolume(),this.setMute(),this.setEngine()}setSettings(){this.settings=[{name:"reveal",sounds:[eV],minDelta:100,velocityMin:0,velocityMultiplier:1,volumeMin:1,volumeMax:1,rateMin:1,rateMax:1},{name:"brick",sounds:[nV,iV,rV,sV,oV,aV],minDelta:100,velocityMin:1,velocityMultiplier:.75,volumeMin:.2,volumeMax:.85,rateMin:.5,rateMax:.75},{name:"bowlingPin",sounds:[Im],minDelta:0,velocityMin:1,velocityMultiplier:.5,volumeMin:.35,volumeMax:1,rateMin:.1,rateMax:.85},{name:"bowlingBall",sounds:[Im,Im,Im],minDelta:0,velocityMin:1,velocityMultiplier:.5,volumeMin:.35,volumeMax:1,rateMin:.1,rateMax:.2},{name:"carHit",sounds:[lV,cV,uV,hV],minDelta:100,velocityMin:2,velocityMultiplier:1,volumeMin:.2,volumeMax:.6,rateMin:.35,rateMax:.55},{name:"woodHit",sounds:[dV],minDelta:30,velocityMin:1,velocityMultiplier:1,volumeMin:.5,volumeMax:1,rateMin:.75,rateMax:1.5},{name:"screech",sounds:[fV],minDelta:1e3,velocityMin:0,velocityMultiplier:1,volumeMin:.75,volumeMax:1,rateMin:.9,rateMax:1.1},{name:"uiArea",sounds:[pV],minDelta:100,velocityMin:0,velocityMultiplier:1,volumeMin:.75,volumeMax:1,rateMin:.95,rateMax:1.05},{name:"carHorn1",sounds:[mV],minDelta:0,velocityMin:0,velocityMultiplier:1,volumeMin:.95,volumeMax:1,rateMin:1,rateMax:1},{name:"carHorn2",sounds:[gV],minDelta:0,velocityMin:0,velocityMultiplier:1,volumeMin:.95,volumeMax:1,rateMin:1,rateMax:1},{name:"horn",sounds:[vV,yV,xV],minDelta:100,velocityMin:1,velocityMultiplier:.75,volumeMin:.5,volumeMax:1,rateMin:.75,rateMax:1}];for(const e of this.settings)this.add(e)}setMasterVolume(){this.masterVolume=.5,xi.Howler.volume(this.masterVolume),window.requestAnimationFrame(()=>{xi.Howler.volume(this.masterVolume)}),this.debug&&this.debugFolder.add(this,"masterVolume").step(.001).min(0).max(1).onChange(()=>{xi.Howler.volume(this.masterVolume)})}setMute(){this.muted=typeof this.debug!="undefined",xi.Howler.mute(this.muted),window.addEventListener("keydown",e=>{e.key==="m"&&(this.muted=!this.muted,xi.Howler.mute(this.muted))}),document.addEventListener("visibilitychange",()=>{document.hidden?xi.Howler.mute(!0):xi.Howler.mute(this.muted)}),this.debug&&this.debugFolder.add(this,"muted").listen().onChange(()=>{xi.Howler.mute(this.muted)})}setEngine(){this.engine={},this.engine.progress=0,this.engine.progressEasingUp=.3,this.engine.progressEasingDown=.15,this.engine.speed=0,this.engine.speedMultiplier=2.5,this.engine.acceleration=0,this.engine.accelerationMultiplier=.4,this.engine.rate={},this.engine.rate.min=.4,this.engine.rate.max=1.4,this.engine.volume={},this.engine.volume.min=.4,this.engine.volume.max=1,this.engine.volume.master=0,this.engine.sound=new xi.Howl({src:[tV],loop:!0});const e=()=>{try{typeof xi.Howler!="undefined"&&xi.Howler.ctx&&xi.Howler.ctx.state==="suspended"?xi.Howler.ctx.resume().then(()=>{this.engine.sound.play()}).catch(()=>{this.engine.sound.play()}):this.engine.sound.play()}catch{try{this.engine.sound.play()}catch{}}window.removeEventListener("pointerdown",e),window.removeEventListener("touchstart",e),window.removeEventListener("keydown",e)};if(typeof xi.Howler!="undefined"&&xi.Howler.ctx&&xi.Howler.ctx.state!=="suspended"?this.engine.sound.play():(window.addEventListener("pointerdown",e),window.addEventListener("touchstart",e),window.addEventListener("keydown",e)),this.time.on("tick",()=>{let t=Math.abs(this.engine.speed)*this.engine.speedMultiplier+Math.max(this.engine.acceleration,0)*this.engine.accelerationMultiplier;t=Math.min(Math.max(t,0),1),this.engine.progress+=(t-this.engine.progress)*this.engine[t>this.engine.progress?"progressEasingUp":"progressEasingDown"];const n=this.engine.rate.max-this.engine.rate.min;this.engine.sound.rate(this.engine.rate.min+n*this.engine.progress);const r=this.engine.volume.max-this.engine.volume.min;this.engine.sound.volume((this.engine.volume.min+r*this.engine.progress)*this.engine.volume.master)}),this.debug){const t=this.debugFolder.addFolder("engine");t.open(),t.add(this.engine,"progressEasingUp").step(.001).min(0).max(1).name("progressEasingUp"),t.add(this.engine,"progressEasingDown").step(.001).min(0).max(1).name("progressEasingDown"),t.add(this.engine.rate,"min").step(.001).min(0).max(4).name("rateMin"),t.add(this.engine.rate,"max").step(.001).min(0).max(4).name("rateMax"),t.add(this.engine,"speedMultiplier").step(.01).min(0).max(5).name("speedMultiplier"),t.add(this.engine,"accelerationMultiplier").step(.01).min(0).max(100).name("accelerationMultiplier"),t.add(this.engine,"progress").step(.01).min(0).max(1).name("progress").listen()}}add(e){const t={name:e.name,minDelta:e.minDelta,velocityMin:e.velocityMin,velocityMultiplier:e.velocityMultiplier,volumeMin:e.volumeMin,volumeMax:e.volumeMax,rateMin:e.rateMin,rateMax:e.rateMax,lastTime:0,sounds:[]};for(const n of e.sounds){const r=new xi.Howl({src:[n]});t.sounds.push(r)}this.items.push(t)}play(e,t){const n=this.items.find(o=>o.name===e),r=Date.now(),s=typeof t=="undefined"?0:t;if(n&&r>n.lastTime+n.minDelta&&(n.velocityMin===0||s>n.velocityMin)){const o=n.sounds[Math.floor(Math.random()*n.sounds.length)];let a=Math.min(Math.max((s-n.velocityMin)*n.velocityMultiplier,n.volumeMin),n.volumeMax);a=Math.pow(a,2),o.volume(a);const c=n.rateMax-n.rateMin;o.rate(n.rateMin+Math.random()*c),o.play(),n.lastTime=r}}}class _V{constructor(e){this.resources=e.resources,this.car=e.car,this.walls=e.walls,this.objects=e.objects,this.materials=e.materials,this.areas=e.areas,this.config=e.config,this.physics=e.physics,this.container=new ft,this.container.matrixAutoUpdate=!1,this.setKonamiCode(),this.setWigs()}setKonamiCode(){this.konamiCode={},this.konamiCode.x=-60,this.konamiCode.y=-100,this.konamiCode.sequence=["ArrowUp","ArrowUp","ArrowDown","ArrowDown","ArrowLeft","ArrowRight","ArrowLeft","ArrowRight"],this.config.touch||this.konamiCode.sequence.push("b","a"),this.konamiCode.keyIndex=0,this.konamiCode.latestKeys=[],this.konamiCode.count=0,this.config.touch?this.konamiCode.labelTexture=this.resources.items.konamiLabelTouchTexture:this.konamiCode.labelTexture=this.resources.items.konamiLabelTexture,this.konamiCode.labelTexture.magFilter=Kt,this.konamiCode.labelTexture.minFilter=jt,this.konamiCode.label=new je(new xn(8,8/16),new Bt({transparent:!0,depthWrite:!1,color:16777215,alphaMap:this.konamiCode.labelTexture})),this.konamiCode.label.position.x=this.konamiCode.x+5,this.konamiCode.label.position.y=this.konamiCode.y,this.konamiCode.label.matrixAutoUpdate=!1,this.konamiCode.label.updateMatrix(),this.container.add(this.konamiCode.label),this.konamiCode.lemonOption={base:this.resources.items.lemonBase.scene,collision:this.resources.items.lemonCollision.scene,offset:new B(0,0,0),rotation:new Et(Math.PI*.5,-Math.PI*.3,0),duplicated:!0,shadow:{sizeX:1.2,sizeY:1.8,offsetZ:-.15,alpha:.35},mass:.5,sleep:!0,soundName:"woodHit"},this.objects.add({...this.konamiCode.lemonOption,offset:new B(this.konamiCode.x,this.konamiCode.y,.4)}),this.konamiCode.testInput=e=>{if(this.konamiCode.latestKeys.push(e),this.konamiCode.latestKeys.length>this.konamiCode.sequence.length&&this.konamiCode.latestKeys.shift(),this.konamiCode.sequence.toString()===this.konamiCode.latestKeys.toString()){this.konamiCode.count++;for(let t=0;t<Math.pow(3,this.konamiCode.count);t++)window.setTimeout(()=>{const n=this.car.chassis.object.position.x+(Math.random()-.5)*10,r=this.car.chassis.object.position.y+(Math.random()-.5)*10;this.objects.add({...this.konamiCode.lemonOption,offset:new B(n,r,10),rotation:new Et(Math.random()*Math.PI*2,Math.random()*Math.PI*2,Math.random()*Math.PI*2),sleep:!1})},t*50)}},window.addEventListener("keydown",e=>{this.konamiCode.testInput(e.key)}),this.konamiCode.touch={},this.konamiCode.touch.x=0,this.konamiCode.touch.y=0,this.konamiCode.touch.touchstart=e=>{window.addEventListener("touchend",this.konamiCode.touch.touchend),this.konamiCode.touch.x=e.changedTouches[0].clientX,this.konamiCode.touch.y=e.changedTouches[0].clientY},this.konamiCode.touch.touchend=e=>{window.removeEventListener("touchend",this.konamiCode.touch.touchend);const t=e.changedTouches[0].clientX,n=e.changedTouches[0].clientY,r=t-this.konamiCode.touch.x,s=n-this.konamiCode.touch.y;if(Math.hypot(r,s)>30){const a=Math.atan2(s,r);let c=null;a<-Math.PI*.75?c="ArrowLeft":a<-Math.PI*.25?c="ArrowUp":a<Math.PI*.25?c="ArrowRight":a<Math.PI*.75?c="ArrowDown":c="ArrowLeft",this.konamiCode.testInput(c)}},window.addEventListener("touchstart",this.konamiCode.touch.touchstart)}setWigs(){this.wigs={},this.wigs.currentWig=null,this.wigs.container=new ft,this.wigs.container.position.x=-.1,this.wigs.container.position.y=-30,this.wigs.container.matrixAutoUpdate=!1,this.wigs.container.updateMatrix(),this.container.add(this.wigs.container),this.wigs.materials=[this.materials.shades.items.green,this.materials.shades.items.red,this.materials.shades.items.emeraldGreen,this.materials.shades.items.purple,this.materials.shades.items.yellow,this.materials.shades.items.white],this.wigs.list=[this.resources.items.wig1,this.resources.items.wig2,this.resources.items.wig3,this.resources.items.wig4],this.wigs.items=[];for(const e of this.wigs.list){const t=new ft;t.visible=!1,t.matrixAutoUpdate=!1,this.wigs.container.add(t);const n=[...e.scene.children];for(const r of n)r.material=this.wigs.materials[0],t.add(r);this.wigs.items.push(t)}this.wigs.change=()=>{this.wigs.currentWig&&(this.wigs.currentWig.visible=!1);let e=null;do e=this.wigs.items[Math.floor(Math.random()*this.wigs.items.length)];while(this.wigs.currentWig===e);this.wigs.currentWig=e,this.wigs.currentWig.visible=!0;const t=this.wigs.materials[Math.floor(Math.random()*this.wigs.materials.length)];for(const n of this.wigs.currentWig.children)n.material=t},this.wigs.area=this.areas.add({position:new Me(0,80),halfExtents:new Me(2,2)}),this.wigs.area.on("interact",this.wigs.change),this.resources.items.areaQuestionMarkTexture.magFilter=Kt,this.resources.items.areaQuestionMarkTexture.minFilter=jt,this.wigs.areaLabel=new je(new xn(1,1),new Bt({transparent:!0,depthWrite:!1,color:16777215,alphaMap:this.resources.items.areaQuestionMarkTexture})),this.wigs.areaLabel.position.x=0,this.wigs.areaLabel.position.y=80,this.wigs.areaLabel.matrixAutoUpdate=!1,this.wigs.areaLabel.updateMatrix(),this.container.add(this.wigs.areaLabel)}setEggs(){this.eggs={},this.eggs.items=[],console.log("\u{1F95A} 2021eggbvpoabe");const e=[{offset:new B(-29.8,-18.94,.5),material:this.materials.shades.items.emeraldGreen,code:"MjAyMWVnZ2Fvem5kZXo="},{offset:new B(103.91,128.56,.5),material:this.materials.shades.items.red,code:"MjAyMWVnZ3Fxc3ZwcG8="},{offset:new B(39.68,-23.67,.5),material:this.materials.shades.items.purple,code:"MjAyMWVnZ212b2Focnc="},{offset:new B(107.62,-155.75,.5),material:this.materials.shades.items.blue,code:"MjAyMWVnZ2N1ZHBhaW4="}];this.eggs.add=t=>{const n={};n.found=!1,n.code=t.code,n.object=this.objects.add({base:this.resources.items.eggBase.scene,collision:this.resources.items.eggCollision.scene,duplicated:!0,shadow:{sizeX:1.2,sizeY:1.8,offsetZ:-.15,alpha:.35},mass:.5,sleep:typeof t.sleep!="undefined"?t.sleep:!0,soundName:"woodHit",offset:t.offset,rotation:typeof t.sleep!="undefined"?t.rotation:new Et(0,0,0)}),n.object.container.children[0].material=t.material,n.collisionCallback=r=>{if(r.body===this.physics.car.chassis.body&&!n.found){n.found=!0;const s=atob(n.code);window.setTimeout(()=>{window.confirm(`
You find an egg!
Here is your code for a 30% discount on https://threejs-journey.xyz
${s}

Would you like to go on the subscription page?
                        `)&&window.open(`https://threejs-journey.xyz/subscribe/${s}`,"_blank"),window.setTimeout(()=>{n.found=!1},1e3)},600)}},n.object.collision.body.addEventListener("collide",n.collisionCallback),this.eggs.items.push(n)};for(const t of e)this.eggs.add(t)}}class SV{constructor(e){this.config=e.config,this.debug=e.debug,this.resources=e.resources,this.time=e.time,this.sizes=e.sizes,this.camera=e.camera,this.renderer=e.renderer,this.passes=e.passes,this.debug&&(this.debugFolder=this.debug.addFolder("world"),this.debugFolder.open()),this.container=new ft,this.container.matrixAutoUpdate=!1,this.setSounds(),this.setControls(),this.setFloor(),this.setAreas(),this.setStartingScreen()}start(){window.setTimeout(()=>{this.camera.pan.enable()},2e3),this.setReveal(),this.setMaterials(),this.setShadows(),this.setPhysics(),this.setZones(),this.setObjects(),this.setCar(),this.areas.car=this.car,this.setTiles(),this.setWalls(),this.setSections(),this.setEasterEggs()}setReveal(){this.reveal={},this.reveal.matcapsProgress=0,this.reveal.floorShadowsProgress=0,this.reveal.previousMatcapsProgress=null,this.reveal.previousFloorShadowsProgress=null,this.reveal.go=()=>{Ct.fromTo(this.reveal,3,{matcapsProgress:0},{matcapsProgress:1}),Ct.fromTo(this.reveal,3,{floorShadowsProgress:0},{floorShadowsProgress:1,delay:.5}),Ct.fromTo(this.shadows,3,{alpha:0},{alpha:.5,delay:.5}),this.sections.intro&&(Ct.fromTo(this.sections.intro.instructions.arrows.label.material,.3,{opacity:0},{opacity:1,delay:.5}),this.sections.intro.otherInstructions&&Ct.fromTo(this.sections.intro.otherInstructions.label.material,.3,{opacity:0},{opacity:1,delay:.75})),this.physics.car.chassis.body.sleep(),this.physics.car.chassis.body.position.set(0,0,12),window.setTimeout(()=>{this.physics.car.chassis.body.wakeUp()},300),Ct.fromTo(this.sounds.engine.volume,.5,{master:0},{master:.7,delay:.3,ease:eH.easeIn}),window.setTimeout(()=>{this.sounds.play("reveal")},400),this.controls.touch&&window.setTimeout(()=>{this.controls.touch.reveal()},400)},this.time.on("tick",()=>{if(this.reveal.matcapsProgress!==this.reveal.previousMatcapsProgress){for(const e in this.materials.shades.items){const t=this.materials.shades.items[e];t.uniforms.uRevealProgress.value=this.reveal.matcapsProgress}this.reveal.previousMatcapsProgress=this.reveal.matcapsProgress}if(this.reveal.floorShadowsProgress!==this.reveal.previousFloorShadowsProgress){for(const e of this.objects.floorShadows)e.material.uniforms.uAlpha.value=this.reveal.floorShadowsProgress;this.reveal.previousFloorShadowsProgress=this.reveal.floorShadowsProgress}}),this.debug&&(this.debugFolder.add(this.reveal,"matcapsProgress").step(1e-4).min(0).max(1).name("matcapsProgress"),this.debugFolder.add(this.reveal,"floorShadowsProgress").step(1e-4).min(0).max(1).name("floorShadowsProgress"),this.debugFolder.add(this.reveal,"go").name("reveal"))}setStartingScreen(){this.startingScreen={},this.startingScreen.area=this.areas.add({position:new Me(0,0),halfExtents:new Me(2.35,1.5),hasKey:!1,testCar:!1,active:!1}),this.startingScreen.loadingLabel={},this.startingScreen.loadingLabel.geometry=new xn(2.5,2.5/4),this.startingScreen.loadingLabel.image=new Image,this.startingScreen.loadingLabel.image.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAABABAMAAAAHc7SNAAAAMFBMVEUAAAD///9ra2ucnJzR0dH09PQmJiaNjY24uLjp6end3d1CQkLFxcVYWFiqqqp9fX3nQ5qrAAAEVUlEQVRo3u3YT08TQRQA8JEtW6CATGnDdvljaTwYE2IBI/HGRrwSetGTsZh4MPFQYiQe229gE++WePFY9Oqh1cRzieEDYIgXLxjPJu5M33vbZQszW+fgoS+B7ewO836znRl2lg1jGMP4P2Okw0yFvaKsklr3I99Tvl3iPPelGbQhKqxB4eN6N/7gVcsvbEAz1F4RLn67zzl/v6/oLvejGBQ9LsNphio4UFjmEAsVJuOK/zkDtc6w+gyTcZ3LyP6IAzjBDA+pj6LkEgAjW4kANsMAC6vmOvqAMU5RgVOTskQACicCmCcA9AXjkT5gj1MswqlxWcoTgKJ6HuAQAD5guNoAu8QpMnBul1ONMGD2PCBbRgDAKYq6AEtmXvtdj3S6GhRyW1t1DvkAgM0ggG7mu1t3xWFHFzAqv3wYCi0mY1UCGgiQPU+1oWIY8LoXcAA3qeYfr+kClvHW14PJ5OfCAgHYNAoDAORBQIrDvHjqH5c0ANTbORzBacbAQgUC2IAKAzI9gCSHlWEMLmgBPJxMvyARpIICALDm4nkAbwIA71EZx5UOgO48JnLoOhQIAN9sOgKoBoAE5r0aB8ARcNhtFzrg0VQmwCp8CAMeAADGc44S5GMBsF1aCEU2LcAcAPDCvwFytBDehCaUgJxRAKeF8BNUUQJ43iiAUlqwFKoBrTCAHjiagwEgU0YM5IYWYD4KoIgPwIXQwUbVgCXzgLpIBJNeDciWTQNskVsq1ADX/6kYBdCTjse5owbMiX+IpgGWOCPSuWpA2vN/TAMm5QTYg5IC4FdbMA0YF5Nb5s2rAaLyhzBgektGZWDArrgqi0U1QHxf38OABDwUDgTAjGfyPlTVgJT/67FBACbqyGYaaoBctQwD2vI4DecVAPkgZRhQlxPQks2rAePGAbZsRlaa1QBYEQBUHRCAmaXD0QDYxgFWdye05R9cDQCrmQYkeBA6gGXTgNEeQF4DMG4S4MLjOUZRA5A0CcjADgmjqgGwSwSg9wK1GIBS74KTgTxv/EHoiaVQsTOS5RoCJuiZyosB8EIrHpyowFiYofO0i4wCjhCQwL0hq2sCaFNM22S4JXloLk0AuLDTBzCBAAt3xykeA7CHe/mDbgdTvQ9GswSAwdbqA0giYASHjQUJnhQKhQ6z/d8rDA4hAG2Dsk042ejubHMM2nV6AMf93pCkaRjhh0WsWuz+6aasl2FwiAImReEts1/CSaFfwFouAJxC4RW+I4oCThBQE1X2WbKkBFDkqYDtJ0SHaYKq3pJJwCECjjiFPoC1w+2P0gumurgeBjT6AhIIGKOelGIAngWlFnRnMZjMIYBb7gtIIsAuYU+8GICpEhYyZVgIZ2g9rYYAX1lfAKvjnxzjnWrHALDn9K1h2k2aoI1ewGd2AWAVAVMHcKdW4wDYje739pNufJXhkJohgLu9zy4CHCKAJYUge4ddCojGyPrp9kaHmYjUi9N7+2wYwxjGZfEXMKxGE0GkkfIAAAAASUVORK5CYII=",this.startingScreen.loadingLabel.texture=new hn(this.startingScreen.loadingLabel.image),this.startingScreen.loadingLabel.texture.magFilter=Kt,this.startingScreen.loadingLabel.texture.minFilter=jt,this.startingScreen.loadingLabel.texture.needsUpdate=!0,this.startingScreen.loadingLabel.material=new Bt({transparent:!0,depthWrite:!1,color:16777215,alphaMap:this.startingScreen.loadingLabel.texture}),this.startingScreen.loadingLabel.mesh=new je(this.startingScreen.loadingLabel.geometry,this.startingScreen.loadingLabel.material),this.startingScreen.loadingLabel.mesh.matrixAutoUpdate=!1,this.container.add(this.startingScreen.loadingLabel.mesh),this.startingScreen.startLabel={},this.startingScreen.startLabel.geometry=new xn(2.5,2.5/4),this.startingScreen.startLabel.image=new Image,this.startingScreen.startLabel.image.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAABABAMAAAAHc7SNAAAAMFBMVEUAAAD///+cnJxra2vR0dHd3d0mJib09PRYWFjp6em4uLhCQkKqqqqNjY19fX3FxcV3XeRgAAADsklEQVRo3u3YsU9TQRwH8KNgLSDQg9ZCAak1IdE4PKPu1NTEsSzOMDl3I3GpcXAxBhLjXFxNjJgQJ2ON0Rnj4uAAEyv8B/L7tV++5/VN+CM69Ldwfa+534d7d793VzeIQQzi/49c4v5lPF/1vvhFm++rjIpcyErrmrSCuz+cxng1iL/If8drPJD2Lc/Iy4VhaZWlFd4tLPfuMc6e/5LvRilJA2SkVSQA8c0OsI0uNtIAU9rsB8y1rAAZjyimAUa1mQDAeGwF+MA+9lIA69qs9AMKVoDP8vhf35A+NiMAc7YJKFSrX7tcI8BW9+k/O/kz6zSunjSnncMHiQYBcmdXrh3xCVbc2WO8N/YZZI0AxxwMArKivmwAwFKSPmV0UwBbCpj5E+C+yzUbQAaJVwUSA9SFjwFgHQ0jAMrBWgzAPCtHgFFbQAlpEwKC2zWUQgJGbAH+naSdu/fTxQAthPL5/ADD6OCpQwCAsb6LsbEGcBluOAYBmG2fkMIawHVWXEsDIGUGpZCAIRsAS93DPgDbhUmUQgKe2NUB90hfhK0YwEJYHkYpJGDbqBKiB86CGLAlzd6/S8CEvh8sACiBvrSXCshKblWEgNy2vkAMAHwGfjECcJHOu5qUQgDm6vXulshZAXJNL9GJAeg+LxeKPQBj1gzgdlnuCWAhbOi7LwaU9u0A2VWPpUgAC+GR5k0iwBtnB3Bj3qMaRYB17X0IOQhYcjYA7guxxyIAGfd1HNqchPfly7aACQUshAA2W1r5G1yG415YpgB3qIIkAHBH2D075QnQ10fHDsCl+CoGSKpiN8kMAVqIN00BsitnVgKyPIBMB4ADKU92AA5BKQIgszjKBGBLagpwB5xZBGS6pbcuizQAXMA6NAK86OCQ3okAI55BQPe7VoDxXzU/iwPASgS4GAASAiYxWgYAzvAa1loA2AkAFQIU2zEELCJtDDgIAG0CFLvp7LblC2kAtF6eTEJJ2CBAr88bAXKY4WkASbzXmwt5AvTvohHA4WSUBmj2Jt+IThQChrAOLQC13vPFMAOAQwuyTAeAKVQto3OBDOdESh2YxNZPbpYBQNbEAoBfod7e1i1BiwB0voSZWgwAOWgtAGPhD18E8ASIiRIAXNPwXJBtcqMbAFAIr5weIJMAcIx1aAAIqk0lAuycompyFwBMHAsAZlj/lgw0rsy2AkhbsgK4Q+70CUBjxeFXsUb0G1HJDJC9rketZRcCWCJwHM8DgJm7b7ch+XizXm25QQxiEOcXvwGCWOhbCZC0qAAAAABJRU5ErkJggg==",this.startingScreen.startLabel.texture=new hn(this.startingScreen.startLabel.image),this.startingScreen.startLabel.texture.magFilter=Kt,this.startingScreen.startLabel.texture.minFilter=jt,this.startingScreen.startLabel.texture.needsUpdate=!0,this.startingScreen.startLabel.material=new Bt({transparent:!0,depthWrite:!1,color:16777215,alphaMap:this.startingScreen.startLabel.texture}),this.startingScreen.startLabel.material.opacity=0,this.startingScreen.startLabel.mesh=new je(this.startingScreen.startLabel.geometry,this.startingScreen.startLabel.material),this.startingScreen.startLabel.mesh.matrixAutoUpdate=!1,this.container.add(this.startingScreen.startLabel.mesh),this.resources.on("progress",e=>{this.startingScreen.area.floorBorder.material.uniforms.uAlpha.value=1,this.startingScreen.area.floorBorder.material.uniforms.uLoadProgress.value=e}),this.resources.on("ready",()=>{window.requestAnimationFrame(()=>{this.startingScreen.area.activate(),Ct.to(this.startingScreen.area.floorBorder.material.uniforms.uAlpha,.3,{value:.3}),Ct.to(this.startingScreen.loadingLabel.material,.3,{opacity:0}),Ct.to(this.startingScreen.startLabel.material,.3,{opacity:1,delay:.3})})}),this.startingScreen.area.on("interact",()=>{this.startingScreen.area.deactivate(),Ct.to(this.startingScreen.area.floorBorder.material.uniforms.uProgress,.3,{value:0,delay:.4}),Ct.to(this.startingScreen.startLabel.material,.3,{opacity:0,delay:.4}),this.start(),window.setTimeout(()=>{this.reveal.go()},600)})}setSounds(){this.sounds=new wV({debug:this.debugFolder,time:this.time})}setAxes(){this.axis=new D1,this.container.add(this.axis)}setControls(){this.controls=new JH({config:this.config,sizes:this.sizes,time:this.time,camera:this.camera,sounds:this.sounds})}setMaterials(){this.materials=new IU({resources:this.resources,debug:this.debugFolder})}setFloor(){this.floor=new zU({debug:this.debugFolder}),this.container.add(this.floor.container)}setShadows(){this.shadows=new XU({time:this.time,debug:this.debugFolder,renderer:this.renderer,camera:this.camera}),this.container.add(this.shadows.container)}setPhysics(){this.physics=new qU({config:this.config,debug:this.debug,time:this.time,sizes:this.sizes,controls:this.controls,sounds:this.sounds}),this.container.add(this.physics.models.container)}setZones(){this.zones=new $U({time:this.time,physics:this.physics,debug:this.debugFolder}),this.container.add(this.zones.container)}setAreas(){this.areas=new hH({config:this.config,resources:this.resources,debug:this.debug,renderer:this.renderer,camera:this.camera,car:this.car,sounds:this.sounds,time:this.time}),this.container.add(this.areas.container)}setTiles(){this.tiles=new dH({resources:this.resources,objects:this.objects,debug:this.debug})}setWalls(){this.walls=new fH({resources:this.resources,objects:this.objects})}setObjects(){this.objects=new ZU({time:this.time,resources:this.resources,materials:this.materials,physics:this.physics,shadows:this.shadows,sounds:this.sounds,debug:this.debugFolder}),this.container.add(this.objects.container)}setCar(){this.car=new KU({time:this.time,resources:this.resources,objects:this.objects,physics:this.physics,shadows:this.shadows,materials:this.materials,controls:this.controls,sounds:this.sounds,renderer:this.renderer,camera:this.camera,debug:this.debugFolder,config:this.config}),this.container.add(this.car.container)}setSections(){this.sections={};const e={config:this.config,time:this.time,resources:this.resources,camera:this.camera,passes:this.passes,objects:this.objects,areas:this.areas,zones:this.zones,walls:this.walls,tiles:this.tiles,debug:this.debugFolder};this.sections.intro=new pH({...e,x:0,y:0}),this.container.add(this.sections.intro.container),this.sections.crossroads=new YH({...e,x:0,y:-30}),this.container.add(this.sections.crossroads.container),this.sections.projects=new qH({...e,x:30,y:-30}),this.container.add(this.sections.projects.container),this.sections.information=new $H({...e,x:1.2,y:-55}),this.container.add(this.sections.information.container),this.sections.playground=new QH({...e,x:-38,y:-34}),this.container.add(this.sections.playground.container)}setEasterEggs(){this.easterEggs=new _V({resources:this.resources,car:this.car,walls:this.walls,objects:this.objects,materials:this.materials,areas:this.areas,config:this.config,physics:this.physics}),this.container.add(this.easterEggs.container)}}class bV extends Ei{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new AV(t)}),this.register(function(t){return new IV(t)}),this.register(function(t){return new FV(t)}),this.register(function(t){return new CV(t)}),this.register(function(t){return new PV(t)}),this.register(function(t){return new RV(t)}),this.register(function(t){return new LV(t)}),this.register(function(t){return new kV(t)}),this.register(function(t){return new EV(t)}),this.register(function(t){return new DV(t)})}load(e,t,n,r){const s=this;let o;this.resourcePath!==""?o=this.resourcePath:this.path!==""?o=this.path:o=pr.extractUrlBase(e),this.manager.itemStart(e);const a=function(h){r?r(h):console.error(h),s.manager.itemError(e),s.manager.itemEnd(e)},c=new er(this.manager);c.setPath(this.path),c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(e,function(h){try{s.parse(h,o,function(d){t(d),s.manager.itemEnd(e)},a)}catch(d){a(d)}},n,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,r){let s;const o={},a={};if(typeof e=="string")s=e;else if(pr.decodeText(new Uint8Array(e,0,4))===KP){try{o[Zt.KHR_BINARY_GLTF]=new BV(e)}catch(l){r&&r(l);return}s=o[Zt.KHR_BINARY_GLTF].content}else s=pr.decodeText(new Uint8Array(e));const c=JSON.parse(s);if(c.asset===void 0||c.asset.version[0]<2){r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const h=new $V(c,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});h.fileLoader.setRequestHeader(this.requestHeader);for(let d=0;d<this.pluginCallbacks.length;d++){const l=this.pluginCallbacks[d](h);a[l.name]=l,o[l.name]=!0}if(c.extensionsUsed)for(let d=0;d<c.extensionsUsed.length;++d){const l=c.extensionsUsed[d],u=c.extensionsRequired||[];switch(l){case Zt.KHR_MATERIALS_UNLIT:o[l]=new TV;break;case Zt.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:o[l]=new NV;break;case Zt.KHR_DRACO_MESH_COMPRESSION:o[l]=new zV(c,this.dracoLoader);break;case Zt.KHR_TEXTURE_TRANSFORM:o[l]=new OV;break;case Zt.KHR_MESH_QUANTIZATION:o[l]=new UV;break;default:u.indexOf(l)>=0&&a[l]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+l+'".')}}h.setExtensions(o),h.setPlugins(a),h.parse(n,r)}parseAsync(e,t){const n=this;return new Promise(function(r,s){n.parse(e,t,r,s)})}}function MV(){let i={};return{get:function(e){return i[e]},add:function(e,t){i[e]=t},remove:function(e){delete i[e]},removeAll:function(){i={}}}}const Zt={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"};class EV{constructor(e){this.parser=e,this.name=Zt.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,r=t.length;n<r;n++){const s=t[n];s.extensions&&s.extensions[this.name]&&s.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let r=t.cache.get(n);if(r)return r;const s=t.json,c=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let h;const d=new qe(16777215);c.color!==void 0&&d.fromArray(c.color);const l=c.range!==void 0?c.range:0;switch(c.type){case"directional":h=new xf(d),h.target.position.set(0,0,-1),h.add(h.target);break;case"point":h=new zu(d),h.distance=l;break;case"spot":h=new yf(d),h.distance=l,c.spot=c.spot||{},c.spot.innerConeAngle=c.spot.innerConeAngle!==void 0?c.spot.innerConeAngle:0,c.spot.outerConeAngle=c.spot.outerConeAngle!==void 0?c.spot.outerConeAngle:Math.PI/4,h.angle=c.spot.outerConeAngle,h.penumbra=1-c.spot.innerConeAngle/c.spot.outerConeAngle,h.target.position.set(0,0,-1),h.add(h.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+c.type)}return h.position.set(0,0,0),h.decay=2,c.intensity!==void 0&&(h.intensity=c.intensity),h.name=t.createUniqueName(c.name||"light_"+e),r=Promise.resolve(h),t.cache.add(n,r),r}createNodeAttachment(e){const t=this,n=this.parser,s=n.json.nodes[e],a=(s.extensions&&s.extensions[this.name]||{}).light;return a===void 0?null:this._loadLight(a).then(function(c){return n._getNodeRef(t.cache,a,c)})}}class TV{constructor(){this.name=Zt.KHR_MATERIALS_UNLIT}getMaterialType(){return Bt}extendParams(e,t,n){const r=[];e.color=new qe(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.fromArray(o),e.opacity=o[3]}s.baseColorTexture!==void 0&&r.push(n.assignTexture(e,"map",s.baseColorTexture,Ht))}return Promise.all(r)}}class AV{constructor(e){this.parser=e,this.name=Zt.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:No}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];if(o.clearcoatFactor!==void 0&&(t.clearcoat=o.clearcoatFactor),o.clearcoatTexture!==void 0&&s.push(n.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),o.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),o.clearcoatRoughnessTexture!==void 0&&s.push(n.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),o.clearcoatNormalTexture!==void 0&&(s.push(n.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),o.clearcoatNormalTexture.scale!==void 0)){const a=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new Me(a,a)}return Promise.all(s)}}class CV{constructor(e){this.parser=e,this.name=Zt.KHR_MATERIALS_SHEEN}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:No}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new qe(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=r.extensions[this.name];return o.sheenColorFactor!==void 0&&t.sheenColor.fromArray(o.sheenColorFactor),o.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=o.sheenRoughnessFactor),o.sheenColorTexture!==void 0&&s.push(n.assignTexture(t,"sheenColorMap",o.sheenColorTexture,Ht)),o.sheenRoughnessTexture!==void 0&&s.push(n.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class PV{constructor(e){this.parser=e,this.name=Zt.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:No}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return o.transmissionFactor!==void 0&&(t.transmission=o.transmissionFactor),o.transmissionTexture!==void 0&&s.push(n.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class RV{constructor(e){this.parser=e,this.name=Zt.KHR_MATERIALS_VOLUME}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:No}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.thickness=o.thicknessFactor!==void 0?o.thicknessFactor:0,o.thicknessTexture!==void 0&&s.push(n.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||0;const a=o.attenuationColor||[1,1,1];return t.attenuationColor=new qe(a[0],a[1],a[2]),Promise.all(s)}}class LV{constructor(e){this.parser=e,this.name=Zt.KHR_MATERIALS_IOR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:No}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return t.ior=s.ior!==void 0?s.ior:1.5,Promise.resolve()}}class kV{constructor(e){this.parser=e,this.name=Zt.KHR_MATERIALS_SPECULAR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:No}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.specularIntensity=o.specularFactor!==void 0?o.specularFactor:1,o.specularTexture!==void 0&&s.push(n.assignTexture(t,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return t.specularColor=new qe(a[0],a[1],a[2]),o.specularColorTexture!==void 0&&s.push(n.assignTexture(t,"specularColorMap",o.specularColorTexture,Ht)),Promise.all(s)}}class IV{constructor(e){this.parser=e,this.name=Zt.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,r=n.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,o)}}class FV{constructor(e){this.parser=e,this.name=Zt.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,r=n.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=r.images[o.source];let c=n.textureLoader;if(a.uri){const h=n.options.manager.getHandler(a.uri);h!==null&&(c=h)}return this.detectSupport().then(function(h){if(h)return n.loadTextureImage(e,o.source,c);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class DV{constructor(e){this.name=Zt.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const r=n.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([s,o.ready]).then(function(a){const c=r.byteOffset||0,h=r.byteLength||0,d=r.count,l=r.byteStride,u=new ArrayBuffer(d*l),p=new Uint8Array(a[0],c,h);return o.decodeGltfBuffer(new Uint8Array(u),d,l,p,r.mode,r.filter),u})}else return null}}const KP="glTF",Qh=12,WT={JSON:1313821514,BIN:5130562};class BV{constructor(e){this.name=Zt.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,Qh);if(this.header={magic:pr.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==KP)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const n=this.header.length-Qh,r=new DataView(e,Qh);let s=0;for(;s<n;){const o=r.getUint32(s,!0);s+=4;const a=r.getUint32(s,!0);if(s+=4,a===WT.JSON){const c=new Uint8Array(e,Qh+s,o);this.content=pr.decodeText(c)}else if(a===WT.BIN){const c=Qh+s;this.body=e.slice(c,c+o)}s+=o}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class zV{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Zt.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},c={},h={};for(const d in o){const l=jw[d]||d.toLowerCase();a[l]=o[d]}for(const d in e.attributes){const l=jw[d]||d.toLowerCase();if(o[d]!==void 0){const u=n.accessors[e.attributes[d]],p=Jd[u.componentType];h[l]=p,c[l]=u.normalized===!0}}return t.getDependency("bufferView",s).then(function(d){return new Promise(function(l){r.decodeDracoFile(d,function(u){for(const p in u.attributes){const g=u.attributes[p],y=c[p];y!==void 0&&(g.normalized=y)}l(u)},a,h)})})}}class OV{constructor(){this.name=Zt.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return t.texCoord!==void 0&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class Ww extends $l{constructor(e){super(),this.isGLTFSpecularGlossinessMaterial=!0;const t=["#ifdef USE_SPECULARMAP","	uniform sampler2D specularMap;","#endif"].join(`
`),n=["#ifdef USE_GLOSSINESSMAP","	uniform sampler2D glossinessMap;","#endif"].join(`
`),r=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","	vec4 texelSpecular = texture2D( specularMap, vUv );","	// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","	specularFactor *= texelSpecular.rgb;","#endif"].join(`
`),s=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","	vec4 texelGlossiness = texture2D( glossinessMap, vUv );","	// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","	glossinessFactor *= texelGlossiness.a;","#endif"].join(`
`),o=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.roughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.specularColor = specularFactor;"].join(`
`),a={specular:{value:new qe().setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=a,this.onBeforeCompile=function(c){for(const h in a)c.uniforms[h]=a[h];c.fragmentShader=c.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",t).replace("#include <metalnessmap_pars_fragment>",n).replace("#include <roughnessmap_fragment>",r).replace("#include <metalnessmap_fragment>",s).replace("#include <lights_physical_fragment>",o)},Object.defineProperties(this,{specular:{get:function(){return a.specular.value},set:function(c){a.specular.value=c}},specularMap:{get:function(){return a.specularMap.value},set:function(c){a.specularMap.value=c,c?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return a.glossiness.value},set:function(c){a.glossiness.value=c}},glossinessMap:{get:function(){return a.glossinessMap.value},set:function(c){a.glossinessMap.value=c,c?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(e)}copy(e){return super.copy(e),this.specularMap=e.specularMap,this.specular.copy(e.specular),this.glossinessMap=e.glossinessMap,this.glossiness=e.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this}}class NV{constructor(){this.name=Zt.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,this.specularGlossinessParams=["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity"]}getMaterialType(){return Ww}extendParams(e,t,n){const r=t.extensions[this.name];e.color=new qe(1,1,1),e.opacity=1;const s=[];if(Array.isArray(r.diffuseFactor)){const o=r.diffuseFactor;e.color.fromArray(o),e.opacity=o[3]}if(r.diffuseTexture!==void 0&&s.push(n.assignTexture(e,"map",r.diffuseTexture,Ht)),e.emissive=new qe(0,0,0),e.glossiness=r.glossinessFactor!==void 0?r.glossinessFactor:1,e.specular=new qe(1,1,1),Array.isArray(r.specularFactor)&&e.specular.fromArray(r.specularFactor),r.specularGlossinessTexture!==void 0){const o=r.specularGlossinessTexture;s.push(n.assignTexture(e,"glossinessMap",o)),s.push(n.assignTexture(e,"specularMap",o,Ht))}return Promise.all(s)}createMaterial(e){const t=new Ww(e);return t.fog=!0,t.color=e.color,t.map=e.map===void 0?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=e.aoMap===void 0?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=e.emissiveMap===void 0?null:e.emissiveMap,t.bumpMap=e.bumpMap===void 0?null:e.bumpMap,t.bumpScale=1,t.normalMap=e.normalMap===void 0?null:e.normalMap,t.normalMapType=Na,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=e.specularMap===void 0?null:e.specularMap,t.specular=e.specular,t.glossinessMap=e.glossinessMap===void 0?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=e.envMap===void 0?null:e.envMap,t.envMapIntensity=1,t}}class UV{constructor(){this.name=Zt.KHR_MESH_QUANTIZATION}}class Xl extends eo{constructor(e,t,n,r){super(e,t,n,r)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let o=0;o!==r;o++)t[o]=n[s+o];return t}}Xl.prototype.beforeStart_=Xl.prototype.copySampleValue_;Xl.prototype.afterEnd_=Xl.prototype.copySampleValue_;Xl.prototype.interpolate_=function(i,e,t,n){const r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=o*2,c=o*3,h=n-e,d=(t-e)/h,l=d*d,u=l*d,p=i*c,g=p-c,y=-2*u+3*l,x=u-l,v=1-y,w=x-l+d;for(let S=0;S!==o;S++){const b=s[g+S+o],E=s[g+S+a]*h,R=s[p+S+o],z=s[p+S]*h;r[S]=v*b+w*E+y*R+x*z}return r};const HV=new qt;class VV extends Xl{interpolate_(e,t,n,r){const s=super.interpolate_(e,t,n,r);return HV.fromArray(s).normalize().toArray(s),s}}const go={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Jd={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},jT={9728:Kt,9729:jt,9984:Vd,9985:lv,9986:Gd,9987:Do},XT={33071:_i,33648:wu,10497:Zs},qT={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},jw={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},sa={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},GV={CUBICSPLINE:void 0,LINEAR:zl,STEP:Su},tx={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function WV(i){return i.DefaultMaterial===void 0&&(i.DefaultMaterial=new $l({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Pa})),i.DefaultMaterial}function Zh(i,e,t){for(const n in t.extensions)i[n]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=t.extensions[n])}function pl(i,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(i.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function jV(i,e,t){let n=!1,r=!1,s=!1;for(let h=0,d=e.length;h<d;h++){const l=e[h];if(l.POSITION!==void 0&&(n=!0),l.NORMAL!==void 0&&(r=!0),l.COLOR_0!==void 0&&(s=!0),n&&r&&s)break}if(!n&&!r&&!s)return Promise.resolve(i);const o=[],a=[],c=[];for(let h=0,d=e.length;h<d;h++){const l=e[h];if(n){const u=l.POSITION!==void 0?t.getDependency("accessor",l.POSITION):i.attributes.position;o.push(u)}if(r){const u=l.NORMAL!==void 0?t.getDependency("accessor",l.NORMAL):i.attributes.normal;a.push(u)}if(s){const u=l.COLOR_0!==void 0?t.getDependency("accessor",l.COLOR_0):i.attributes.color;c.push(u)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(c)]).then(function(h){const d=h[0],l=h[1],u=h[2];return n&&(i.morphAttributes.position=d),r&&(i.morphAttributes.normal=l),s&&(i.morphAttributes.color=u),i.morphTargetsRelative=!0,i})}function XV(i,e){if(i.updateMorphTargets(),e.weights!==void 0)for(let t=0,n=e.weights.length;t<n;t++)i.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(i.morphTargetInfluences.length===t.length){i.morphTargetDictionary={};for(let n=0,r=t.length;n<r;n++)i.morphTargetDictionary[t[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function qV(i){const e=i.extensions&&i.extensions[Zt.KHR_DRACO_MESH_COMPRESSION];let t;return e?t="draco:"+e.bufferView+":"+e.indices+":"+YT(e.attributes):t=i.indices+":"+YT(i.attributes)+":"+i.mode,t}function YT(i){let e="";const t=Object.keys(i).sort();for(let n=0,r=t.length;n<r;n++)e+=t[n]+":"+i[t[n]]+";";return e}function Xw(i){switch(i){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function YV(i){return i.search(/\.jpe?g($|\?)/i)>0||i.search(/^data\:image\/jpeg/)===0?"image/jpeg":i.search(/\.webp($|\?)/i)>0||i.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}class $V{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new MV,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={},typeof createImageBitmap!="undefined"&&/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!1?this.textureLoader=new R1(this.options.manager):this.textureLoader=new Ev(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new er(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,r=this.json,s=this.extensions;this.cache.removeAll(),this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(o){const a={scene:o[0][r.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:r.asset,parser:n,userData:{}};Zh(s,a,r),pl(a,r),Promise.all(n._invokeAll(function(c){return c.afterRoot&&c.afterRoot(a)})).then(function(){e(a)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){const o=t[r].joints;for(let a=0,c=o.length;a<c;a++)e[o[a]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const o=e[r];o.mesh!==void 0&&(this._addNodeRef(this.meshCache,o.mesh),o.skin!==void 0&&(n[o.mesh].isSkinnedMesh=!0)),o.camera!==void 0&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const r=n.clone(),s=(o,a)=>{const c=this.associations.get(o);c!=null&&this.associations.set(a,c);for(const[h,d]of o.children.entries())s(d,a.children[h])};return s(n,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const r=e(t[n]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let r=0;r<t.length;r++){const s=e(t[r]);s&&n.push(s)}return n}getDependency(e,t){const n=e+":"+t;let r=this.cache.get(n);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this.loadNode(t);break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this.loadAnimation(t);break;case"camera":r=this.loadCamera(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(n,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this,r=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(r.map(function(s,o){return n.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[Zt.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(s,o){n.load(pr.resolveURL(t.uri,r.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(n){const r=t.byteLength||0,s=t.byteOffset||0;return n.slice(s,s+r)})}loadAccessor(e){const t=this,n=this.json,r=this.json.accessors[e];if(r.bufferView===void 0&&r.sparse===void 0)return Promise.resolve(null);const s=[];return r.bufferView!==void 0?s.push(this.getDependency("bufferView",r.bufferView)):s.push(null),r.sparse!==void 0&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(o){const a=o[0],c=qT[r.type],h=Jd[r.componentType],d=h.BYTES_PER_ELEMENT,l=d*c,u=r.byteOffset||0,p=r.bufferView!==void 0?n.bufferViews[r.bufferView].byteStride:void 0,g=r.normalized===!0;let y,x;if(p&&p!==l){const v=Math.floor(u/p),w="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+v+":"+r.count;let S=t.cache.get(w);S||(y=new h(a,v*p,r.count*p/d),S=new Ha(y,p/d),t.cache.add(w,S)),x=new Po(S,c,u%p/d,g)}else a===null?y=new h(r.count*c):y=new h(a,u,r.count*c),x=new zt(y,c,g);if(r.sparse!==void 0){const v=qT.SCALAR,w=Jd[r.sparse.indices.componentType],S=r.sparse.indices.byteOffset||0,b=r.sparse.values.byteOffset||0,E=new w(o[1],S,r.sparse.count*v),R=new h(o[2],b,r.sparse.count*c);a!==null&&(x=new zt(x.array.slice(),x.itemSize,x.normalized));for(let z=0,I=E.length;z<I;z++){const N=E[z];if(x.setX(N,R[z*c]),c>=2&&x.setY(N,R[z*c+1]),c>=3&&x.setZ(N,R[z*c+2]),c>=4&&x.setW(N,R[z*c+3]),c>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return x})}loadTexture(e){const t=this.json,n=this.options,s=t.textures[e].source,o=t.images[s];let a=this.textureLoader;if(o.uri){const c=n.manager.getHandler(o.uri);c!==null&&(a=c)}return this.loadTextureImage(e,s,a)}loadTextureImage(e,t,n){const r=this,s=this.json,o=s.textures[e],a=s.images[t],c=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[c])return this.textureCache[c];const h=this.loadImageSource(t,n).then(function(d){d.flipY=!1,o.name&&(d.name=o.name);const u=(s.samplers||{})[o.sampler]||{};return d.magFilter=jT[u.magFilter]||jt,d.minFilter=jT[u.minFilter]||Do,d.wrapS=XT[u.wrapS]||Zs,d.wrapT=XT[u.wrapT]||Zs,r.associations.set(d,{textures:e}),d}).catch(function(){return null});return this.textureCache[c]=h,h}loadImageSource(e,t){const n=this,r=this.json,s=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(l=>l.clone());const o=r.images[e],a=self.URL||self.webkitURL;let c=o.uri||"",h=!1;if(o.bufferView!==void 0)c=n.getDependency("bufferView",o.bufferView).then(function(l){h=!0;const u=new Blob([l],{type:o.mimeType});return c=a.createObjectURL(u),c});else if(o.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const d=Promise.resolve(c).then(function(l){return new Promise(function(u,p){let g=u;t.isImageBitmapLoader===!0&&(g=function(y){const x=new hn(y);x.needsUpdate=!0,u(x)}),t.load(pr.resolveURL(l,s.path),g,void 0,p)})}).then(function(l){return h===!0&&a.revokeObjectURL(c),l.userData.mimeType=o.mimeType||YV(o.uri),l}).catch(function(l){throw console.error("THREE.GLTFLoader: Couldn't load texture",c),l});return this.sourceCache[e]=d,d}assignTexture(e,t,n,r){const s=this;return this.getDependency("texture",n.index).then(function(o){if(n.texCoord!==void 0&&n.texCoord!=0&&!(t==="aoMap"&&n.texCoord==1)&&console.warn("THREE.GLTFLoader: Custom UV set "+n.texCoord+" for texture "+t+" not yet supported."),s.extensions[Zt.KHR_TEXTURE_TRANSFORM]){const a=n.extensions!==void 0?n.extensions[Zt.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const c=s.associations.get(o);o=s.extensions[Zt.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),s.associations.set(o,c)}}return r!==void 0&&(o.encoding=r),e[t]=o,o})}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const r=t.attributes.tangent===void 0,s=t.attributes.color!==void 0,o=t.attributes.normal===void 0;if(e.isPoints){const a="PointsMaterial:"+n.uuid;let c=this.cache.get(a);c||(c=new Va,An.prototype.copy.call(c,n),c.color.copy(n.color),c.map=n.map,c.sizeAttenuation=!1,this.cache.add(a,c)),n=c}else if(e.isLine){const a="LineBasicMaterial:"+n.uuid;let c=this.cache.get(a);c||(c=new ni,An.prototype.copy.call(c,n),c.color.copy(n.color),this.cache.add(a,c)),n=c}if(r||s||o){let a="ClonedMaterial:"+n.uuid+":";n.isGLTFSpecularGlossinessMaterial&&(a+="specular-glossiness:"),r&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let c=this.cache.get(a);c||(c=n.clone(),s&&(c.vertexColors=!0),o&&(c.flatShading=!0),r&&(c.normalScale&&(c.normalScale.y*=-1),c.clearcoatNormalScale&&(c.clearcoatNormalScale.y*=-1)),this.cache.add(a,c),this.associations.set(c,this.associations.get(n))),n=c}n.aoMap&&t.attributes.uv2===void 0&&t.attributes.uv!==void 0&&t.setAttribute("uv2",t.attributes.uv),e.material=n}getMaterialType(){return $l}loadMaterial(e){const t=this,n=this.json,r=this.extensions,s=n.materials[e];let o;const a={},c=s.extensions||{},h=[];if(c[Zt.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){const l=r[Zt.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];o=l.getMaterialType(),h.push(l.extendParams(a,s,t))}else if(c[Zt.KHR_MATERIALS_UNLIT]){const l=r[Zt.KHR_MATERIALS_UNLIT];o=l.getMaterialType(),h.push(l.extendParams(a,s,t))}else{const l=s.pbrMetallicRoughness||{};if(a.color=new qe(1,1,1),a.opacity=1,Array.isArray(l.baseColorFactor)){const u=l.baseColorFactor;a.color.fromArray(u),a.opacity=u[3]}l.baseColorTexture!==void 0&&h.push(t.assignTexture(a,"map",l.baseColorTexture,Ht)),a.metalness=l.metallicFactor!==void 0?l.metallicFactor:1,a.roughness=l.roughnessFactor!==void 0?l.roughnessFactor:1,l.metallicRoughnessTexture!==void 0&&(h.push(t.assignTexture(a,"metalnessMap",l.metallicRoughnessTexture)),h.push(t.assignTexture(a,"roughnessMap",l.metallicRoughnessTexture))),o=this._invokeOne(function(u){return u.getMaterialType&&u.getMaterialType(e)}),h.push(Promise.all(this._invokeAll(function(u){return u.extendMaterialParams&&u.extendMaterialParams(e,a)})))}s.doubleSided===!0&&(a.side=Es);const d=s.alphaMode||tx.OPAQUE;if(d===tx.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,d===tx.MASK&&(a.alphaTest=s.alphaCutoff!==void 0?s.alphaCutoff:.5)),s.normalTexture!==void 0&&o!==Bt&&(h.push(t.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new Me(1,1),s.normalTexture.scale!==void 0)){const l=s.normalTexture.scale;a.normalScale.set(l,l)}return s.occlusionTexture!==void 0&&o!==Bt&&(h.push(t.assignTexture(a,"aoMap",s.occlusionTexture)),s.occlusionTexture.strength!==void 0&&(a.aoMapIntensity=s.occlusionTexture.strength)),s.emissiveFactor!==void 0&&o!==Bt&&(a.emissive=new qe().fromArray(s.emissiveFactor)),s.emissiveTexture!==void 0&&o!==Bt&&h.push(t.assignTexture(a,"emissiveMap",s.emissiveTexture,Ht)),Promise.all(h).then(function(){let l;return o===Ww?l=r[Zt.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(a):l=new o(a),s.name&&(l.name=s.name),pl(l,s),t.associations.set(l,{materials:e}),s.extensions&&Zh(r,l,s),l})}createUniqueName(e){const t=Wt.sanitizeNodeName(e||"");let n=t;for(let r=1;this.nodeNamesUsed[n];++r)n=t+"_"+r;return this.nodeNamesUsed[n]=!0,n}loadGeometries(e){const t=this,n=this.extensions,r=this.primitiveCache;function s(a){return n[Zt.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(c){return $T(c,a,t)})}const o=[];for(let a=0,c=e.length;a<c;a++){const h=e[a],d=qV(h),l=r[d];if(l)o.push(l.promise);else{let u;h.extensions&&h.extensions[Zt.KHR_DRACO_MESH_COMPRESSION]?u=s(h):u=$T(new vt,h,t),r[d]={primitive:h,promise:u},o.push(u)}}return Promise.all(o)}loadMesh(e){const t=this,n=this.json,r=this.extensions,s=n.meshes[e],o=s.primitives,a=[];for(let c=0,h=o.length;c<h;c++){const d=o[c].material===void 0?WV(this.cache):this.getDependency("material",o[c].material);a.push(d)}return a.push(t.loadGeometries(o)),Promise.all(a).then(function(c){const h=c.slice(0,c.length-1),d=c[c.length-1],l=[];for(let p=0,g=d.length;p<g;p++){const y=d[p],x=o[p];let v;const w=h[p];if(x.mode===go.TRIANGLES||x.mode===go.TRIANGLE_STRIP||x.mode===go.TRIANGLE_FAN||x.mode===void 0)v=s.isSkinnedMesh===!0?new Qu(y,w):new je(y,w),v.isSkinnedMesh===!0&&!v.geometry.attributes.skinWeight.normalized&&v.normalizeSkinWeights(),x.mode===go.TRIANGLE_STRIP?v.geometry=QT(v.geometry,m3):x.mode===go.TRIANGLE_FAN&&(v.geometry=QT(v.geometry,n1));else if(x.mode===go.LINES)v=new Ji(y,w);else if(x.mode===go.LINE_STRIP)v=new di(y,w);else if(x.mode===go.LINE_LOOP)v=new yv(y,w);else if(x.mode===go.POINTS)v=new Ku(y,w);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+x.mode);Object.keys(v.geometry.morphAttributes).length>0&&XV(v,s),v.name=t.createUniqueName(s.name||"mesh_"+e),pl(v,s),x.extensions&&Zh(r,v,x),t.assignFinalMaterial(v),l.push(v)}for(let p=0,g=l.length;p<g;p++)t.associations.set(l[p],{meshes:e,primitives:p});if(l.length===1)return l[0];const u=new Jr;t.associations.set(u,{meshes:e});for(let p=0,g=l.length;p<g;p++)u.add(l[p]);return u})}loadCamera(e){let t;const n=this.json.cameras[e],r=n[n.type];if(!r){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return n.type==="perspective"?t=new Mn(Pr.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):n.type==="orthographic"&&(t=new Fr(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),pl(t,n),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],n={joints:t.joints};return t.inverseBindMatrices===void 0?Promise.resolve(n):this.getDependency("accessor",t.inverseBindMatrices).then(function(r){return n.inverseBindMatrices=r,n})}loadAnimation(e){const n=this.json.animations[e],r=[],s=[],o=[],a=[],c=[];for(let h=0,d=n.channels.length;h<d;h++){const l=n.channels[h],u=n.samplers[l.sampler],p=l.target,g=p.node!==void 0?p.node:p.id,y=n.parameters!==void 0?n.parameters[u.input]:u.input,x=n.parameters!==void 0?n.parameters[u.output]:u.output;r.push(this.getDependency("node",g)),s.push(this.getDependency("accessor",y)),o.push(this.getDependency("accessor",x)),a.push(u),c.push(p)}return Promise.all([Promise.all(r),Promise.all(s),Promise.all(o),Promise.all(a),Promise.all(c)]).then(function(h){const d=h[0],l=h[1],u=h[2],p=h[3],g=h[4],y=[];for(let v=0,w=d.length;v<w;v++){const S=d[v],b=l[v],E=u[v],R=p[v],z=g[v];if(S===void 0)continue;S.updateMatrix(),S.matrixAutoUpdate=!0;let I;switch(sa[z.path]){case sa.weights:I=Vl;break;case sa.rotation:I=Lo;break;case sa.position:case sa.scale:default:I=Gl;break}const N=S.name?S.name:S.uuid,F=R.interpolation!==void 0?GV[R.interpolation]:zl,C=[];sa[z.path]===sa.weights?S.traverse(function(X){X.morphTargetInfluences&&C.push(X.name?X.name:X.uuid)}):C.push(N);let O=E.array;if(E.normalized){const X=Xw(O.constructor),U=new Float32Array(O.length);for(let te=0,ne=O.length;te<ne;te++)U[te]=O[te]*X;O=U}for(let X=0,U=C.length;X<U;X++){const te=new I(C[X]+"."+sa[z.path],b.array,O,F);R.interpolation==="CUBICSPLINE"&&(te.createInterpolant=function(j){const k=this instanceof Lo?VV:Xl;return new k(this.times,this.values,this.getValueSize()/3,j)},te.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),y.push(te)}}const x=n.name?n.name:"animation_"+e;return new Wl(x,void 0,y)})}createNodeMesh(e){const t=this.json,n=this,r=t.nodes[e];return r.mesh===void 0?null:n.getDependency("mesh",r.mesh).then(function(s){const o=n._getNodeRef(n.meshCache,r.mesh,s);return r.weights!==void 0&&o.traverse(function(a){if(!!a.isMesh)for(let c=0,h=r.weights.length;c<h;c++)a.morphTargetInfluences[c]=r.weights[c]}),o})}loadNode(e){const t=this.json,n=this.extensions,r=this,s=t.nodes[e],o=s.name?r.createUniqueName(s.name):"";return function(){const a=[],c=r._invokeOne(function(h){return h.createNodeMesh&&h.createNodeMesh(e)});return c&&a.push(c),s.camera!==void 0&&a.push(r.getDependency("camera",s.camera).then(function(h){return r._getNodeRef(r.cameraCache,s.camera,h)})),r._invokeAll(function(h){return h.createNodeAttachment&&h.createNodeAttachment(e)}).forEach(function(h){a.push(h)}),Promise.all(a)}().then(function(a){let c;if(s.isBone===!0?c=new Ol:a.length>1?c=new Jr:a.length===1?c=a[0]:c=new ft,c!==a[0])for(let h=0,d=a.length;h<d;h++)c.add(a[h]);if(s.name&&(c.userData.name=s.name,c.name=o),pl(c,s),s.extensions&&Zh(n,c,s),s.matrix!==void 0){const h=new st;h.fromArray(s.matrix),c.applyMatrix4(h)}else s.translation!==void 0&&c.position.fromArray(s.translation),s.rotation!==void 0&&c.quaternion.fromArray(s.rotation),s.scale!==void 0&&c.scale.fromArray(s.scale);return r.associations.has(c)||r.associations.set(c,{}),r.associations.get(c).nodes=e,c})}loadScene(e){const t=this.json,n=this.extensions,r=this.json.scenes[e],s=this,o=new Jr;r.name&&(o.name=s.createUniqueName(r.name)),pl(o,r),r.extensions&&Zh(n,o,r);const a=r.nodes||[],c=[];for(let h=0,d=a.length;h<d;h++)c.push(JP(a[h],o,t,s));return Promise.all(c).then(function(){const h=d=>{const l=new Map;for(const[u,p]of s.associations)(u instanceof An||u instanceof hn)&&l.set(u,p);return d.traverse(u=>{const p=s.associations.get(u);p!=null&&l.set(u,p)}),l};return s.associations=h(o),o})}}function JP(i,e,t,n){const r=t.nodes[i];return n.getDependency("node",i).then(function(s){if(r.skin===void 0)return s;let o;return n.getDependency("skin",r.skin).then(function(a){o=a;const c=[];for(let h=0,d=o.joints.length;h<d;h++)c.push(n.getDependency("node",o.joints[h]));return Promise.all(c)}).then(function(a){return s.traverse(function(c){if(!c.isMesh)return;const h=[],d=[];for(let l=0,u=a.length;l<u;l++){const p=a[l];if(p){h.push(p);const g=new st;o.inverseBindMatrices!==void 0&&g.fromArray(o.inverseBindMatrices.array,l*16),d.push(g)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',o.joints[l])}c.bind(new Zu(h,d),c.matrixWorld)}),s})}).then(function(s){e.add(s);const o=[];if(r.children){const a=r.children;for(let c=0,h=a.length;c<h;c++){const d=a[c];o.push(JP(d,s,t,n))}}return Promise.all(o)})}function QV(i,e,t){const n=e.attributes,r=new vr;if(n.POSITION!==void 0){const a=t.json.accessors[n.POSITION],c=a.min,h=a.max;if(c!==void 0&&h!==void 0){if(r.set(new B(c[0],c[1],c[2]),new B(h[0],h[1],h[2])),a.normalized){const d=Xw(Jd[a.componentType]);r.min.multiplyScalar(d),r.max.multiplyScalar(d)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const s=e.targets;if(s!==void 0){const a=new B,c=new B;for(let h=0,d=s.length;h<d;h++){const l=s[h];if(l.POSITION!==void 0){const u=t.json.accessors[l.POSITION],p=u.min,g=u.max;if(p!==void 0&&g!==void 0){if(c.setX(Math.max(Math.abs(p[0]),Math.abs(g[0]))),c.setY(Math.max(Math.abs(p[1]),Math.abs(g[1]))),c.setZ(Math.max(Math.abs(p[2]),Math.abs(g[2]))),u.normalized){const y=Xw(Jd[u.componentType]);c.multiplyScalar(y)}a.max(c)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(a)}i.boundingBox=r;const o=new zo;r.getCenter(o.center),o.radius=r.min.distanceTo(r.max)/2,i.boundingSphere=o}function $T(i,e,t){const n=e.attributes,r=[];function s(o,a){return t.getDependency("accessor",o).then(function(c){i.setAttribute(a,c)})}for(const o in n){const a=jw[o]||o.toLowerCase();a in i.attributes||r.push(s(n[o],a))}if(e.indices!==void 0&&!i.index){const o=t.getDependency("accessor",e.indices).then(function(a){i.setIndex(a)});r.push(o)}return pl(i,e),QV(i,e,t),Promise.all(r).then(function(){return e.targets!==void 0?jV(i,e.targets,t):i})}function QT(i,e){let t=i.getIndex();if(t===null){const o=[],a=i.getAttribute("position");if(a!==void 0){for(let c=0;c<a.count;c++)o.push(c);i.setIndex(o),t=i.getIndex()}else return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),i}const n=t.count-2,r=[];if(e===n1)for(let o=1;o<=n;o++)r.push(t.getX(0)),r.push(t.getX(o)),r.push(t.getX(o+1));else for(let o=0;o<n;o++)o%2===0?(r.push(t.getX(o)),r.push(t.getX(o+1)),r.push(t.getX(o+2))):(r.push(t.getX(o+2)),r.push(t.getX(o+1)),r.push(t.getX(o)));r.length/3!==n&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=i.clone();return s.setIndex(r),s}/*!
fflate - fast JavaScript compression/decompression
<https://101arrowz.github.io/fflate>
Licensed under MIT. https://github.com/101arrowz/fflate/blob/master/LICENSE
version 0.6.9
*/var ZT={},qw=function(i){return URL.createObjectURL(new Blob([i],{type:"text/javascript"}))},eR=function(i){return new Worker(i)};try{URL.revokeObjectURL(qw(""))}catch{qw=function(e){return"data:application/javascript;charset=UTF-8,"+encodeURI(e)},eR=function(e){return new Worker(e,{type:"module"})}}var ZV=function(i,e,t,n,r){var s=eR(ZT[e]||(ZT[e]=qw(i)));return s.onerror=function(o){return r(o.error,null)},s.onmessage=function(o){return r(null,o.data)},s.postMessage(t,n),s},Yt=Uint8Array,Si=Uint16Array,ko=Uint32Array,th=new Yt([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),nh=new Yt([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ef=new Yt([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),tR=function(i,e){for(var t=new Si(31),n=0;n<31;++n)t[n]=e+=1<<i[n-1];for(var r=new ko(t[30]),n=1;n<30;++n)for(var s=t[n];s<t[n+1];++s)r[s]=s-t[n]<<5|n;return[t,r]},nR=tR(th,2),V1=nR[0],Og=nR[1];V1[28]=258,Og[258]=28;var iR=tR(nh,0),rR=iR[0],Yw=iR[1],tf=new Si(32768);for(var En=0;En<32768;++En){var oa=(En&43690)>>>1|(En&21845)<<1;oa=(oa&52428)>>>2|(oa&13107)<<2,oa=(oa&61680)>>>4|(oa&3855)<<4,tf[En]=((oa&65280)>>>8|(oa&255)<<8)>>>1}var ts=function(i,e,t){for(var n=i.length,r=0,s=new Si(e);r<n;++r)++s[i[r]-1];var o=new Si(e);for(r=0;r<e;++r)o[r]=o[r-1]+s[r-1]<<1;var a;if(t){a=new Si(1<<e);var c=15-e;for(r=0;r<n;++r)if(i[r])for(var h=r<<4|i[r],d=e-i[r],l=o[i[r]-1]++<<d,u=l|(1<<d)-1;l<=u;++l)a[tf[l]>>>c]=h}else for(a=new Si(n),r=0;r<n;++r)i[r]&&(a[r]=tf[o[i[r]-1]++]>>>15-i[r]);return a},Io=new Yt(288);for(var En=0;En<144;++En)Io[En]=8;for(var En=144;En<256;++En)Io[En]=9;for(var En=256;En<280;++En)Io[En]=7;for(var En=280;En<288;++En)Io[En]=8;var Nu=new Yt(32);for(var En=0;En<32;++En)Nu[En]=5;var sR=ts(Io,9,0),oR=ts(Io,9,1),aR=ts(Nu,5,0),lR=ts(Nu,5,1),ng=function(i){for(var e=i[0],t=1;t<i.length;++t)i[t]>e&&(e=i[t]);return e},$r=function(i,e,t){var n=e/8|0;return(i[n]|i[n+1]<<8)>>(e&7)&t},ig=function(i,e){var t=e/8|0;return(i[t]|i[t+1]<<8|i[t+2]<<16)>>(e&7)},bf=function(i){return(i/8|0)+(i&7&&1)},ns=function(i,e,t){(e==null||e<0)&&(e=0),(t==null||t>i.length)&&(t=i.length);var n=new(i instanceof Si?Si:i instanceof ko?ko:Yt)(t-e);return n.set(i.subarray(e,t)),n},Mf=function(i,e,t){var n=i.length;if(!n||t&&!t.l&&n<5)return e||new Yt(0);var r=!e||t,s=!t||t.i;t||(t={}),e||(e=new Yt(n*3));var o=function(Z){var Ee=e.length;if(Z>Ee){var Se=new Yt(Math.max(Ee*2,Z));Se.set(e),e=Se}},a=t.f||0,c=t.p||0,h=t.b||0,d=t.l,l=t.d,u=t.m,p=t.n,g=n*8;do{if(!d){t.f=a=$r(i,c,1);var y=$r(i,c+1,3);if(c+=3,y)if(y==1)d=oR,l=lR,u=9,p=5;else if(y==2){var S=$r(i,c,31)+257,b=$r(i,c+10,15)+4,E=S+$r(i,c+5,31)+1;c+=14;for(var R=new Yt(E),z=new Yt(19),I=0;I<b;++I)z[ef[I]]=$r(i,c+I*3,7);c+=b*3;for(var N=ng(z),F=(1<<N)-1,C=ts(z,N,1),I=0;I<E;){var O=C[$r(i,c,F)];c+=O&15;var x=O>>>4;if(x<16)R[I++]=x;else{var X=0,U=0;for(x==16?(U=3+$r(i,c,3),c+=2,X=R[I-1]):x==17?(U=3+$r(i,c,7),c+=3):x==18&&(U=11+$r(i,c,127),c+=7);U--;)R[I++]=X}}var te=R.subarray(0,S),ne=R.subarray(S);u=ng(te),p=ng(ne),d=ts(te,u,1),l=ts(ne,p,1)}else throw"invalid block type";else{var x=bf(c)+4,v=i[x-4]|i[x-3]<<8,w=x+v;if(w>n){if(s)throw"unexpected EOF";break}r&&o(h+v),e.set(i.subarray(x,w),h),t.b=h+=v,t.p=c=w*8;continue}if(c>g){if(s)throw"unexpected EOF";break}}r&&o(h+131072);for(var j=(1<<u)-1,k=(1<<p)-1,W=c;;W=c){var X=d[ig(i,c)&j],Y=X>>>4;if(c+=X&15,c>g){if(s)throw"unexpected EOF";break}if(!X)throw"invalid length/literal";if(Y<256)e[h++]=Y;else if(Y==256){W=c,d=null;break}else{var H=Y-254;if(Y>264){var I=Y-257,J=th[I];H=$r(i,c,(1<<J)-1)+V1[I],c+=J}var K=l[ig(i,c)&k],ee=K>>>4;if(!K)throw"invalid distance";c+=K&15;var ne=rR[ee];if(ee>3){var J=nh[ee];ne+=ig(i,c)&(1<<J)-1,c+=J}if(c>g){if(s)throw"unexpected EOF";break}r&&o(h+131072);for(var $=h+H;h<$;h+=4)e[h]=e[h-ne],e[h+1]=e[h+1-ne],e[h+2]=e[h+2-ne],e[h+3]=e[h+3-ne];h=$}}t.l=d,t.p=W,t.b=h,d&&(a=1,t.m=u,t.d=l,t.n=p)}while(!a);return h==e.length?e:ns(e,0,h)},Gs=function(i,e,t){t<<=e&7;var n=e/8|0;i[n]|=t,i[n+1]|=t>>>8},Nc=function(i,e,t){t<<=e&7;var n=e/8|0;i[n]|=t,i[n+1]|=t>>>8,i[n+2]|=t>>>16},rg=function(i,e){for(var t=[],n=0;n<i.length;++n)i[n]&&t.push({s:n,f:i[n]});var r=t.length,s=t.slice();if(!r)return[So,0];if(r==1){var o=new Yt(t[0].s+1);return o[t[0].s]=1,[o,1]}t.sort(function(E,R){return E.f-R.f}),t.push({s:-1,f:25001});var a=t[0],c=t[1],h=0,d=1,l=2;for(t[0]={s:-1,f:a.f+c.f,l:a,r:c};d!=r-1;)a=t[t[h].f<t[l].f?h++:l++],c=t[h!=d&&t[h].f<t[l].f?h++:l++],t[d++]={s:-1,f:a.f+c.f,l:a,r:c};for(var u=s[0].s,n=1;n<r;++n)s[n].s>u&&(u=s[n].s);var p=new Si(u+1),g=Ng(t[d-1],p,0);if(g>e){var n=0,y=0,x=g-e,v=1<<x;for(s.sort(function(R,z){return p[z.s]-p[R.s]||R.f-z.f});n<r;++n){var w=s[n].s;if(p[w]>e)y+=v-(1<<g-p[w]),p[w]=e;else break}for(y>>>=x;y>0;){var S=s[n].s;p[S]<e?y-=1<<e-p[S]++-1:++n}for(;n>=0&&y;--n){var b=s[n].s;p[b]==e&&(--p[b],++y)}g=e}return[new Yt(p),g]},Ng=function(i,e,t){return i.s==-1?Math.max(Ng(i.l,e,t+1),Ng(i.r,e,t+1)):e[i.s]=t},$w=function(i){for(var e=i.length;e&&!i[--e];);for(var t=new Si(++e),n=0,r=i[0],s=1,o=function(c){t[n++]=c},a=1;a<=e;++a)if(i[a]==r&&a!=e)++s;else{if(!r&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(r),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(r);s=1,r=i[a]}return[t.subarray(0,n),e]},Uc=function(i,e){for(var t=0,n=0;n<e.length;++n)t+=i[n]*e[n];return t},Sd=function(i,e,t){var n=t.length,r=bf(e+2);i[r]=n&255,i[r+1]=n>>>8,i[r+2]=i[r]^255,i[r+3]=i[r+1]^255;for(var s=0;s<n;++s)i[r+s+4]=t[s];return(r+4+n)*8},Qw=function(i,e,t,n,r,s,o,a,c,h,d){Gs(e,d++,t),++r[256];for(var l=rg(r,15),u=l[0],p=l[1],g=rg(s,15),y=g[0],x=g[1],v=$w(u),w=v[0],S=v[1],b=$w(y),E=b[0],R=b[1],z=new Si(19),I=0;I<w.length;++I)z[w[I]&31]++;for(var I=0;I<E.length;++I)z[E[I]&31]++;for(var N=rg(z,7),F=N[0],C=N[1],O=19;O>4&&!F[ef[O-1]];--O);var X=h+5<<3,U=Uc(r,Io)+Uc(s,Nu)+o,te=Uc(r,u)+Uc(s,y)+o+14+3*O+Uc(z,F)+(2*z[16]+3*z[17]+7*z[18]);if(X<=U&&X<=te)return Sd(e,d,i.subarray(c,c+h));var ne,j,k,W;if(Gs(e,d,1+(te<U)),d+=2,te<U){ne=ts(u,p,0),j=u,k=ts(y,x,0),W=y;var Y=ts(F,C,0);Gs(e,d,S-257),Gs(e,d+5,R-1),Gs(e,d+10,O-4),d+=14;for(var I=0;I<O;++I)Gs(e,d+3*I,F[ef[I]]);d+=3*O;for(var H=[w,E],J=0;J<2;++J)for(var K=H[J],I=0;I<K.length;++I){var ee=K[I]&31;Gs(e,d,Y[ee]),d+=F[ee],ee>15&&(Gs(e,d,K[I]>>>5&127),d+=K[I]>>>12)}}else ne=sR,j=Io,k=aR,W=Nu;for(var I=0;I<a;++I)if(n[I]>255){var ee=n[I]>>>18&31;Nc(e,d,ne[ee+257]),d+=j[ee+257],ee>7&&(Gs(e,d,n[I]>>>23&31),d+=th[ee]);var $=n[I]&31;Nc(e,d,k[$]),d+=W[$],$>3&&(Nc(e,d,n[I]>>>5&8191),d+=nh[$])}else Nc(e,d,ne[n[I]]),d+=j[n[I]];return Nc(e,d,ne[256]),d+j[256]},cR=new ko([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),So=new Yt(0),uR=function(i,e,t,n,r,s){var o=i.length,a=new Yt(n+o+5*(1+Math.ceil(o/7e3))+r),c=a.subarray(n,a.length-r),h=0;if(!e||o<8)for(var d=0;d<=o;d+=65535){var l=d+65535;l<o?h=Sd(c,h,i.subarray(d,l)):(c[d]=s,h=Sd(c,h,i.subarray(d,o)))}else{for(var u=cR[e-1],p=u>>>13,g=u&8191,y=(1<<t)-1,x=new Si(32768),v=new Si(y+1),w=Math.ceil(t/3),S=2*w,b=function(we){return(i[we]^i[we+1]<<w^i[we+2]<<S)&y},E=new ko(25e3),R=new Si(288),z=new Si(32),I=0,N=0,d=0,F=0,C=0,O=0;d<o;++d){var X=b(d),U=d&32767,te=v[X];if(x[U]=te,v[X]=U,C<=d){var ne=o-d;if((I>7e3||F>24576)&&ne>423){h=Qw(i,c,0,E,R,z,N,F,O,d-O,h),F=I=N=0,O=d;for(var j=0;j<286;++j)R[j]=0;for(var j=0;j<30;++j)z[j]=0}var k=2,W=0,Y=g,H=U-te&32767;if(ne>2&&X==b(d-H))for(var J=Math.min(p,ne)-1,K=Math.min(32767,d),ee=Math.min(258,ne);H<=K&&--Y&&U!=te;){if(i[d+k]==i[d+k-H]){for(var $=0;$<ee&&i[d+$]==i[d+$-H];++$);if($>k){if(k=$,W=H,$>J)break;for(var Z=Math.min(H,$-2),Ee=0,j=0;j<Z;++j){var Se=d-H+j+32768&32767,de=x[Se],he=Se-de+32768&32767;he>Ee&&(Ee=he,te=Se)}}}U=te,te=x[U],H+=U-te+32768&32767}if(W){E[F++]=268435456|Og[k]<<18|Yw[W];var Ce=Og[k]&31,me=Yw[W]&31;N+=th[Ce]+nh[me],++R[257+Ce],++z[me],C=d+k,++I}else E[F++]=i[d],++R[i[d]]}}h=Qw(i,c,s,E,R,z,N,F,O,d-O,h),!s&&h&7&&(h=Sd(c,h+1,So))}return ns(a,0,n+bf(h)+r)},hR=function(){for(var i=new ko(256),e=0;e<256;++e){for(var t=e,n=9;--n;)t=(t&1&&3988292384)^t>>>1;i[e]=t}return i}(),ih=function(){var i=-1;return{p:function(e){for(var t=i,n=0;n<e.length;++n)t=hR[t&255^e[n]]^t>>>8;i=t},d:function(){return~i}}},G1=function(){var i=1,e=0;return{p:function(t){for(var n=i,r=e,s=t.length,o=0;o!=s;){for(var a=Math.min(o+2655,s);o<a;++o)r+=n+=t[o];n=(n&65535)+15*(n>>16),r=(r&65535)+15*(r>>16)}i=n,e=r},d:function(){return i%=65521,e%=65521,(i&255)<<24|i>>>8<<16|(e&255)<<8|e>>>8}}},tc=function(i,e,t,n,r){return uR(i,e.level==null?6:e.level,e.mem==null?Math.ceil(Math.max(8,Math.min(13,Math.log(i.length)))*1.5):12+e.mem,t,n,!r)},Ef=function(i,e){var t={};for(var n in i)t[n]=i[n];for(var n in e)t[n]=e[n];return t},KT=function(i,e,t){for(var n=i(),r=i.toString(),s=r.slice(r.indexOf("[")+1,r.lastIndexOf("]")).replace(/ /g,"").split(","),o=0;o<n.length;++o){var a=n[o],c=s[o];if(typeof a=="function"){e+=";"+c+"=";var h=a.toString();if(a.prototype)if(h.indexOf("[native code]")!=-1){var d=h.indexOf(" ",8)+1;e+=h.slice(d,h.indexOf("(",d))}else{e+=h;for(var l in a.prototype)e+=";"+c+".prototype."+l+"="+a.prototype[l].toString()}else e+=h}else t[c]=a}return[e,t]},Fm=[],KV=function(i){var e=[];for(var t in i)(i[t]instanceof Yt||i[t]instanceof Si||i[t]instanceof ko)&&e.push((i[t]=new i[t].constructor(i[t])).buffer);return e},dR=function(i,e,t,n){var r;if(!Fm[t]){for(var s="",o={},a=i.length-1,c=0;c<a;++c)r=KT(i[c],s,o),s=r[0],o=r[1];Fm[t]=KT(i[a],s,o)}var h=Ef({},Fm[t][1]);return ZV(Fm[t][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+e.toString()+"}",t,h,KV(h),n)},rh=function(){return[Yt,Si,ko,th,nh,ef,V1,rR,oR,lR,tf,ts,ng,$r,ig,bf,ns,Mf,lh,ja,W1]},sh=function(){return[Yt,Si,ko,th,nh,ef,Og,Yw,sR,Io,aR,Nu,tf,cR,So,ts,Gs,Nc,rg,Ng,$w,Uc,Sd,Qw,bf,ns,uR,tc,Tf,ja]},fR=function(){return[j1,q1,cn,ih,hR]},pR=function(){return[X1,vR]},mR=function(){return[Y1,cn,G1]},gR=function(){return[yR]},ja=function(i){return postMessage(i,[i.buffer])},W1=function(i){return i&&i.size&&new Yt(i.size)},oh=function(i,e,t,n,r,s){var o=dR(t,n,r,function(a,c){o.terminate(),s(a,c)});return o.postMessage([i,e],e.consume?[i.buffer]:[]),function(){o.terminate()}},ss=function(i){return i.ondata=function(e,t){return postMessage([e,t],[e.buffer])},function(e){return i.push(e.data[0],e.data[1])}},ah=function(i,e,t,n,r){var s,o=dR(i,n,r,function(a,c){a?(o.terminate(),e.ondata.call(e,a)):(c[1]&&o.terminate(),e.ondata.call(e,a,c[0],c[1]))});o.postMessage(t),e.push=function(a,c){if(s)throw"stream finished";if(!e.ondata)throw"no stream handler";o.postMessage([a,s=c],[a.buffer])},e.terminate=function(){o.terminate()}},Qi=function(i,e){return i[e]|i[e+1]<<8},ei=function(i,e){return(i[e]|i[e+1]<<8|i[e+2]<<16|i[e+3]<<24)>>>0},nx=function(i,e){return ei(i,e)+ei(i,e+4)*4294967296},cn=function(i,e,t){for(;t;++e)i[e]=t,t>>>=8},j1=function(i,e){var t=e.filename;if(i[0]=31,i[1]=139,i[2]=8,i[8]=e.level<2?4:e.level==9?2:0,i[9]=3,e.mtime!=0&&cn(i,4,Math.floor(new Date(e.mtime||Date.now())/1e3)),t){i[3]=8;for(var n=0;n<=t.length;++n)i[n+10]=t.charCodeAt(n)}},X1=function(i){if(i[0]!=31||i[1]!=139||i[2]!=8)throw"invalid gzip data";var e=i[3],t=10;e&4&&(t+=i[10]|(i[11]<<8)+2);for(var n=(e>>3&1)+(e>>4&1);n>0;n-=!i[t++]);return t+(e&2)},vR=function(i){var e=i.length;return(i[e-4]|i[e-3]<<8|i[e-2]<<16|i[e-1]<<24)>>>0},q1=function(i){return 10+(i.filename&&i.filename.length+1||0)},Y1=function(i,e){var t=e.level,n=t==0?0:t<6?1:t==9?3:2;i[0]=120,i[1]=n<<6|(n?32-2*n:1)},yR=function(i){if((i[0]&15)!=8||i[0]>>>4>7||(i[0]<<8|i[1])%31)throw"invalid zlib data";if(i[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function $1(i,e){return!e&&typeof i=="function"&&(e=i,i={}),this.ondata=e,i}var to=function(){function i(e,t){!t&&typeof e=="function"&&(t=e,e={}),this.ondata=t,this.o=e||{}}return i.prototype.p=function(e,t){this.ondata(tc(e,this.o,0,0,!t),t)},i.prototype.push=function(e,t){if(this.d)throw"stream finished";if(!this.ondata)throw"no stream handler";this.d=t,this.p(e,t||!1)},i}(),xR=function(){function i(e,t){ah([sh,function(){return[ss,to]}],this,$1.call(this,e,t),function(n){var r=new to(n.data);onmessage=ss(r)},6)}return i}();function wR(i,e,t){if(t||(t=e,e={}),typeof t!="function")throw"no callback";return oh(i,e,[sh],function(n){return ja(Tf(n.data[0],n.data[1]))},0,t)}function Tf(i,e){return tc(i,e||{},0,0)}var mr=function(){function i(e){this.s={},this.p=new Yt(0),this.ondata=e}return i.prototype.e=function(e){if(this.d)throw"stream finished";if(!this.ondata)throw"no stream handler";var t=this.p.length,n=new Yt(t+e.length);n.set(this.p),n.set(e,t),this.p=n},i.prototype.c=function(e){this.d=this.s.i=e||!1;var t=this.s.b,n=Mf(this.p,this.o,this.s);this.ondata(ns(n,t,this.s.b),this.d),this.o=ns(n,this.s.b-32768),this.s.b=this.o.length,this.p=ns(this.p,this.s.p/8|0),this.s.p&=7},i.prototype.push=function(e,t){this.e(e),this.c(t)},i}(),Q1=function(){function i(e){this.ondata=e,ah([rh,function(){return[ss,mr]}],this,0,function(){var t=new mr;onmessage=ss(t)},7)}return i}();function Z1(i,e,t){if(t||(t=e,e={}),typeof t!="function")throw"no callback";return oh(i,e,[rh],function(n){return ja(lh(n.data[0],W1(n.data[1])))},1,t)}function lh(i,e){return Mf(i,e)}var Ug=function(){function i(e,t){this.c=ih(),this.l=0,this.v=1,to.call(this,e,t)}return i.prototype.push=function(e,t){to.prototype.push.call(this,e,t)},i.prototype.p=function(e,t){this.c.p(e),this.l+=e.length;var n=tc(e,this.o,this.v&&q1(this.o),t&&8,!t);this.v&&(j1(n,this.o),this.v=0),t&&(cn(n,n.length-8,this.c.d()),cn(n,n.length-4,this.l)),this.ondata(n,t)},i}(),JT=function(){function i(e,t){ah([sh,fR,function(){return[ss,to,Ug]}],this,$1.call(this,e,t),function(n){var r=new Ug(n.data);onmessage=ss(r)},8)}return i}();function eA(i,e,t){if(t||(t=e,e={}),typeof t!="function")throw"no callback";return oh(i,e,[sh,fR,function(){return[Hg]}],function(n){return ja(Hg(n.data[0],n.data[1]))},2,t)}function Hg(i,e){e||(e={});var t=ih(),n=i.length;t.p(i);var r=tc(i,e,q1(e),8),s=r.length;return j1(r,e),cn(r,s-8,t.d()),cn(r,s-4,n),r}var Vg=function(){function i(e){this.v=1,mr.call(this,e)}return i.prototype.push=function(e,t){if(mr.prototype.e.call(this,e),this.v){var n=this.p.length>3?X1(this.p):4;if(n>=this.p.length&&!t)return;this.p=this.p.subarray(n),this.v=0}if(t){if(this.p.length<8)throw"invalid gzip stream";this.p=this.p.subarray(0,-8)}mr.prototype.c.call(this,t)},i}(),_R=function(){function i(e){this.ondata=e,ah([rh,pR,function(){return[ss,mr,Vg]}],this,0,function(){var t=new Vg;onmessage=ss(t)},9)}return i}();function SR(i,e,t){if(t||(t=e,e={}),typeof t!="function")throw"no callback";return oh(i,e,[rh,pR,function(){return[Gg]}],function(n){return ja(Gg(n.data[0]))},3,t)}function Gg(i,e){return Mf(i.subarray(X1(i),-8),e||new Yt(vR(i)))}var Zw=function(){function i(e,t){this.c=G1(),this.v=1,to.call(this,e,t)}return i.prototype.push=function(e,t){to.prototype.push.call(this,e,t)},i.prototype.p=function(e,t){this.c.p(e);var n=tc(e,this.o,this.v&&2,t&&4,!t);this.v&&(Y1(n,this.o),this.v=0),t&&cn(n,n.length-4,this.c.d()),this.ondata(n,t)},i}(),JV=function(){function i(e,t){ah([sh,mR,function(){return[ss,to,Zw]}],this,$1.call(this,e,t),function(n){var r=new Zw(n.data);onmessage=ss(r)},10)}return i}();function e6(i,e,t){if(t||(t=e,e={}),typeof t!="function")throw"no callback";return oh(i,e,[sh,mR,function(){return[Kw]}],function(n){return ja(Kw(n.data[0],n.data[1]))},4,t)}function Kw(i,e){e||(e={});var t=G1();t.p(i);var n=tc(i,e,2,4);return Y1(n,e),cn(n,n.length-4,t.d()),n}var Wg=function(){function i(e){this.v=1,mr.call(this,e)}return i.prototype.push=function(e,t){if(mr.prototype.e.call(this,e),this.v){if(this.p.length<2&&!t)return;this.p=this.p.subarray(2),this.v=0}if(t){if(this.p.length<4)throw"invalid zlib stream";this.p=this.p.subarray(0,-4)}mr.prototype.c.call(this,t)},i}(),bR=function(){function i(e){this.ondata=e,ah([rh,gR,function(){return[ss,mr,Wg]}],this,0,function(){var t=new Wg;onmessage=ss(t)},11)}return i}();function MR(i,e,t){if(t||(t=e,e={}),typeof t!="function")throw"no callback";return oh(i,e,[rh,gR,function(){return[nf]}],function(n){return ja(nf(n.data[0],W1(n.data[1])))},5,t)}function nf(i,e){return Mf((yR(i),i.subarray(2,-4)),e)}var ER=function(){function i(e){this.G=Vg,this.I=mr,this.Z=Wg,this.ondata=e}return i.prototype.push=function(e,t){if(!this.ondata)throw"no stream handler";if(this.s)this.s.push(e,t);else{if(this.p&&this.p.length){var n=new Yt(this.p.length+e.length);n.set(this.p),n.set(e,this.p.length)}else this.p=e;if(this.p.length>2){var r=this,s=function(){r.ondata.apply(r,arguments)};this.s=this.p[0]==31&&this.p[1]==139&&this.p[2]==8?new this.G(s):(this.p[0]&15)!=8||this.p[0]>>4>7||(this.p[0]<<8|this.p[1])%31?new this.I(s):new this.Z(s),this.s.push(this.p,t),this.p=null}}},i}(),t6=function(){function i(e){this.G=_R,this.I=Q1,this.Z=bR,this.ondata=e}return i.prototype.push=function(e,t){ER.prototype.push.call(this,e,t)},i}();function n6(i,e,t){if(t||(t=e,e={}),typeof t!="function")throw"no callback";return i[0]==31&&i[1]==139&&i[2]==8?SR(i,e,t):(i[0]&15)!=8||i[0]>>4>7||(i[0]<<8|i[1])%31?Z1(i,e,t):MR(i,e,t)}function i6(i,e){return i[0]==31&&i[1]==139&&i[2]==8?Gg(i,e):(i[0]&15)!=8||i[0]>>4>7||(i[0]<<8|i[1])%31?lh(i,e):nf(i,e)}var K1=function(i,e,t,n){for(var r in i){var s=i[r],o=e+r;s instanceof Yt?t[o]=[s,n]:Array.isArray(s)?t[o]=[s[0],Ef(n,s[1])]:K1(s,o+"/",t,n)}},tA=typeof TextEncoder!="undefined"&&new TextEncoder,Jw=typeof TextDecoder!="undefined"&&new TextDecoder,TR=0;try{Jw.decode(So,{stream:!0}),TR=1}catch{}var AR=function(i){for(var e="",t=0;;){var n=i[t++],r=(n>127)+(n>223)+(n>239);if(t+r>i.length)return[e,ns(i,t-1)];r?r==3?(n=((n&15)<<18|(i[t++]&63)<<12|(i[t++]&63)<<6|i[t++]&63)-65536,e+=String.fromCharCode(55296|n>>10,56320|n&1023)):r&1?e+=String.fromCharCode((n&31)<<6|i[t++]&63):e+=String.fromCharCode((n&15)<<12|(i[t++]&63)<<6|i[t++]&63):e+=String.fromCharCode(n)}},r6=function(){function i(e){this.ondata=e,TR?this.t=new TextDecoder:this.p=So}return i.prototype.push=function(e,t){if(!this.ondata)throw"no callback";if(t=!!t,this.t){if(this.ondata(this.t.decode(e,{stream:!0}),t),t){if(this.t.decode().length)throw"invalid utf-8 data";this.t=null}return}if(!this.p)throw"stream finished";var n=new Yt(this.p.length+e.length);n.set(this.p),n.set(e,this.p.length);var r=AR(n),s=r[0],o=r[1];if(t){if(o.length)throw"invalid utf-8 data";this.p=null}else this.p=o;this.ondata(s,t)},i}(),s6=function(){function i(e){this.ondata=e}return i.prototype.push=function(e,t){if(!this.ondata)throw"no callback";if(this.d)throw"stream finished";this.ondata(Da(e),this.d=t||!1)},i}();function Da(i,e){if(e){for(var t=new Yt(i.length),n=0;n<i.length;++n)t[n]=i.charCodeAt(n);return t}if(tA)return tA.encode(i);for(var r=i.length,s=new Yt(i.length+(i.length>>1)),o=0,a=function(d){s[o++]=d},n=0;n<r;++n){if(o+5>s.length){var c=new Yt(o+8+(r-n<<1));c.set(s),s=c}var h=i.charCodeAt(n);h<128||e?a(h):h<2048?(a(192|h>>6),a(128|h&63)):h>55295&&h<57344?(h=65536+(h&1023<<10)|i.charCodeAt(++n)&1023,a(240|h>>18),a(128|h>>12&63),a(128|h>>6&63),a(128|h&63)):(a(224|h>>12),a(128|h>>6&63),a(128|h&63))}return ns(s,0,o)}function J1(i,e){if(e){for(var t="",n=0;n<i.length;n+=16384)t+=String.fromCharCode.apply(null,i.subarray(n,n+16384));return t}else{if(Jw)return Jw.decode(i);var r=AR(i),s=r[0],o=r[1];if(o.length)throw"invalid utf-8 data";return s}}var CR=function(i){return i==1?3:i<6?2:i==9?1:0},PR=function(i,e){return e+30+Qi(i,e+26)+Qi(i,e+28)},RR=function(i,e,t){var n=Qi(i,e+28),r=J1(i.subarray(e+46,e+46+n),!(Qi(i,e+8)&2048)),s=e+46+n,o=ei(i,e+20),a=t&&o==4294967295?LR(i,s):[o,ei(i,e+24),ei(i,e+42)],c=a[0],h=a[1],d=a[2];return[Qi(i,e+10),c,h,r,s+Qi(i,e+30)+Qi(i,e+32),d]},LR=function(i,e){for(;Qi(i,e)!=1;e+=4+Qi(i,e+2));return[nx(i,e+12),nx(i,e+4),nx(i,e+20)]},Ta=function(i){var e=0;if(i)for(var t in i){var n=i[t].length;if(n>65535)throw"extra field too long";e+=n+4}return e},Uu=function(i,e,t,n,r,s,o,a){var c=n.length,h=t.extra,d=a&&a.length,l=Ta(h);cn(i,e,o!=null?33639248:67324752),e+=4,o!=null&&(i[e++]=20,i[e++]=t.os),i[e]=20,e+=2,i[e++]=t.flag<<1|(s==null&&8),i[e++]=r&&8,i[e++]=t.compression&255,i[e++]=t.compression>>8;var u=new Date(t.mtime==null?Date.now():t.mtime),p=u.getFullYear()-1980;if(p<0||p>119)throw"date not in range 1980-2099";if(cn(i,e,p<<25|u.getMonth()+1<<21|u.getDate()<<16|u.getHours()<<11|u.getMinutes()<<5|u.getSeconds()>>>1),e+=4,s!=null&&(cn(i,e,t.crc),cn(i,e+4,s),cn(i,e+8,t.size)),cn(i,e+12,c),cn(i,e+14,l),e+=16,o!=null&&(cn(i,e,d),cn(i,e+6,t.attrs),cn(i,e+10,o),e+=14),i.set(n,e),e+=c,l)for(var g in h){var y=h[g],x=y.length;cn(i,e,+g),cn(i,e+2,x),i.set(y,e+4),e+=4+x}return d&&(i.set(a,e),e+=d),e},eS=function(i,e,t,n,r){cn(i,e,101010256),cn(i,e+8,t),cn(i,e+10,t),cn(i,e+12,n),cn(i,e+16,r)},rf=function(){function i(e){this.filename=e,this.c=ih(),this.size=0,this.compression=0}return i.prototype.process=function(e,t){this.ondata(null,e,t)},i.prototype.push=function(e,t){if(!this.ondata)throw"no callback - add to ZIP archive before pushing";this.c.p(e),this.size+=e.length,t&&(this.crc=this.c.d()),this.process(e,t||!1)},i}(),o6=function(){function i(e,t){var n=this;t||(t={}),rf.call(this,e),this.d=new to(t,function(r,s){n.ondata(null,r,s)}),this.compression=8,this.flag=CR(t.level)}return i.prototype.process=function(e,t){try{this.d.push(e,t)}catch(n){this.ondata(n,null,t)}},i.prototype.push=function(e,t){rf.prototype.push.call(this,e,t)},i}(),a6=function(){function i(e,t){var n=this;t||(t={}),rf.call(this,e),this.d=new xR(t,function(r,s,o){n.ondata(r,s,o)}),this.compression=8,this.flag=CR(t.level),this.terminate=this.d.terminate}return i.prototype.process=function(e,t){this.d.push(e,t)},i.prototype.push=function(e,t){rf.prototype.push.call(this,e,t)},i}(),l6=function(){function i(e){this.ondata=e,this.u=[],this.d=1}return i.prototype.add=function(e){var t=this;if(this.d&2)throw"stream finished";var n=Da(e.filename),r=n.length,s=e.comment,o=s&&Da(s),a=r!=e.filename.length||o&&s.length!=o.length,c=r+Ta(e.extra)+30;if(r>65535)throw"filename too long";var h=new Yt(c);Uu(h,0,e,n,a);var d=[h],l=function(){for(var x=0,v=d;x<v.length;x++){var w=v[x];t.ondata(null,w,!1)}d=[]},u=this.d;this.d=0;var p=this.u.length,g=Ef(e,{f:n,u:a,o,t:function(){e.terminate&&e.terminate()},r:function(){if(l(),u){var x=t.u[p+1];x?x.r():t.d=1}u=1}}),y=0;e.ondata=function(x,v,w){if(x)t.ondata(x,v,w),t.terminate();else if(y+=v.length,d.push(v),w){var S=new Yt(16);cn(S,0,134695760),cn(S,4,e.crc),cn(S,8,y),cn(S,12,e.size),d.push(S),g.c=y,g.b=c+y+16,g.crc=e.crc,g.size=e.size,u&&g.r(),u=1}else u&&l()},this.u.push(g)},i.prototype.end=function(){var e=this;if(this.d&2)throw this.d&1?"stream finishing":"stream finished";this.d?this.e():this.u.push({r:function(){!(e.d&1)||(e.u.splice(-1,1),e.e())},t:function(){}}),this.d=3},i.prototype.e=function(){for(var e=0,t=0,n=0,r=0,s=this.u;r<s.length;r++){var o=s[r];n+=46+o.f.length+Ta(o.extra)+(o.o?o.o.length:0)}for(var a=new Yt(n+22),c=0,h=this.u;c<h.length;c++){var o=h[c];Uu(a,e,o,o.f,o.u,o.c,t,o.o),e+=46+o.f.length+Ta(o.extra)+(o.o?o.o.length:0),t+=o.b}eS(a,e,this.u.length,n,t),this.ondata(null,a,!0),this.d=2},i.prototype.terminate=function(){for(var e=0,t=this.u;e<t.length;e++){var n=t[e];n.t()}this.d=2},i}();function c6(i,e,t){if(t||(t=e,e={}),typeof t!="function")throw"no callback";var n={};K1(i,"",n,e);var r=Object.keys(n),s=r.length,o=0,a=0,c=s,h=new Array(s),d=[],l=function(){for(var y=0;y<d.length;++y)d[y]()},u=function(){var y=new Yt(a+22),x=o,v=a-o;a=0;for(var w=0;w<c;++w){var S=h[w];try{var b=S.c.length;Uu(y,a,S,S.f,S.u,b);var E=30+S.f.length+Ta(S.extra),R=a+E;y.set(S.c,R),Uu(y,o,S,S.f,S.u,b,a,S.m),o+=16+E+(S.m?S.m.length:0),a=R+b}catch(z){return t(z,null)}}eS(y,o,h.length,v,x),t(null,y)};s||u();for(var p=function(y){var x=r[y],v=n[x],w=v[0],S=v[1],b=ih(),E=w.length;b.p(w);var R=Da(x),z=R.length,I=S.comment,N=I&&Da(I),F=N&&N.length,C=Ta(S.extra),O=S.level==0?0:8,X=function(U,te){if(U)l(),t(U,null);else{var ne=te.length;h[y]=Ef(S,{size:E,crc:b.d(),c:te,f:R,m:N,u:z!=x.length||N&&I.length!=F,compression:O}),o+=30+z+C+ne,a+=76+2*(z+C)+(F||0)+ne,--s||u()}};if(z>65535&&X("filename too long",null),!O)X(null,w);else if(E<16e4)try{X(null,Tf(w,S))}catch(U){X(U,null)}else d.push(wR(w,S,X))},g=0;g<c;++g)p(g);return l}function u6(i,e){e||(e={});var t={},n=[];K1(i,"",t,e);var r=0,s=0;for(var o in t){var a=t[o],c=a[0],h=a[1],d=h.level==0?0:8,l=Da(o),u=l.length,p=h.comment,g=p&&Da(p),y=g&&g.length,x=Ta(h.extra);if(u>65535)throw"filename too long";var v=d?Tf(c,h):c,w=v.length,S=ih();S.p(c),n.push(Ef(h,{size:c.length,crc:S.d(),c:v,f:l,m:g,u:u!=o.length||g&&p.length!=y,o:r,compression:d})),r+=30+u+x+w,s+=76+2*(u+x)+(y||0)+w}for(var b=new Yt(s+22),E=r,R=s-r,z=0;z<n.length;++z){var l=n[z];Uu(b,l.o,l,l.f,l.u,l.c.length);var I=30+l.f.length+Ta(l.extra);b.set(l.c,l.o+I),Uu(b,r,l,l.f,l.u,l.c.length,l.o,l.m),r+=16+I+(l.m?l.m.length:0)}return eS(b,r,n.length,R,E),b}var kR=function(){function i(){}return i.prototype.push=function(e,t){this.ondata(null,e,t)},i.compression=0,i}(),h6=function(){function i(){var e=this;this.i=new mr(function(t,n){e.ondata(null,t,n)})}return i.prototype.push=function(e,t){try{this.i.push(e,t)}catch(n){this.ondata(n,e,t)}},i.compression=8,i}(),d6=function(){function i(e,t){var n=this;t<32e4?this.i=new mr(function(r,s){n.ondata(null,r,s)}):(this.i=new Q1(function(r,s,o){n.ondata(r,s,o)}),this.terminate=this.i.terminate)}return i.prototype.push=function(e,t){this.i.terminate&&(e=ns(e,0)),this.i.push(e,t)},i.compression=8,i}(),f6=function(){function i(e){this.onfile=e,this.k=[],this.o={0:kR},this.p=So}return i.prototype.push=function(e,t){var n=this;if(!this.onfile)throw"no callback";if(!this.p)throw"stream finished";if(this.c>0){var r=Math.min(this.c,e.length),s=e.subarray(0,r);if(this.c-=r,this.d?this.d.push(s,!this.c):this.k[0].push(s),e=e.subarray(r),e.length)return this.push(e,t)}else{var o=0,a=0,c=void 0,h=void 0;this.p.length?e.length?(h=new Yt(this.p.length+e.length),h.set(this.p),h.set(e,this.p.length)):h=this.p:h=e;for(var d=h.length,l=this.c,u=l&&this.d,p=function(){var v,w=ei(h,a);if(w==67324752){o=1,c=a,g.d=null,g.c=0;var S=Qi(h,a+6),b=Qi(h,a+8),E=S&2048,R=S&8,z=Qi(h,a+26),I=Qi(h,a+28);if(d>a+30+z+I){var N=[];g.k.unshift(N),o=2;var F=ei(h,a+18),C=ei(h,a+22),O=J1(h.subarray(a+30,a+=30+z),!E);F==4294967295?(v=R?[-2]:LR(h,a),F=v[0],C=v[1]):R&&(F=-1),a+=I,g.c=F;var X,U={name:O,compression:b,start:function(){if(!U.ondata)throw"no callback";if(!F)U.ondata(null,So,!0);else{var te=n.o[b];if(!te)throw"unknown compression type "+b;X=F<0?new te(O):new te(O,F,C),X.ondata=function(W,Y,H){U.ondata(W,Y,H)};for(var ne=0,j=N;ne<j.length;ne++){var k=j[ne];X.push(k,!1)}n.k[0]==N&&n.c?n.d=X:X.push(So,!0)}},terminate:function(){X&&X.terminate&&X.terminate()}};F>=0&&(U.size=F,U.originalSize=C),g.onfile(U)}return"break"}else if(l){if(w==134695760)return c=a+=12+(l==-2&&8),o=3,g.c=0,"break";if(w==33639248)return c=a-=4,o=3,g.c=0,"break"}},g=this;a<d-4;++a){var y=p();if(y==="break")break}if(this.p=So,l<0){var x=o?h.subarray(0,c-12-(l==-2&&8)-(ei(h,c-16)==134695760&&4)):h.subarray(0,a);u?u.push(x,!!o):this.k[+(o==2)].push(x)}if(o&2)return this.push(h.subarray(a),t);this.p=h.subarray(a)}if(t){if(this.c)throw"invalid zip file";this.p=null}},i.prototype.register=function(e){this.o[e.compression]=e},i}();function p6(i,e){if(typeof e!="function")throw"no callback";for(var t=[],n=function(){for(var u=0;u<t.length;++u)t[u]()},r={},s=i.length-22;ei(i,s)!=101010256;--s)if(!s||i.length-s>65558){e("invalid zip file",null);return}var o=Qi(i,s+8);o||e(null,{});var a=o,c=ei(i,s+16),h=c==4294967295;if(h){if(s=ei(i,s-12),ei(i,s)!=101075792){e("invalid zip file",null);return}a=o=ei(i,s+32),c=ei(i,s+48)}for(var d=function(u){var p=RR(i,c,h),g=p[0],y=p[1],x=p[2],v=p[3],w=p[4],S=p[5],b=PR(i,S);c=w;var E=function(z,I){z?(n(),e(z,null)):(r[v]=I,--o||e(null,r))};if(!g)E(null,ns(i,b,b+y));else if(g==8){var R=i.subarray(b,b+y);if(y<32e4)try{E(null,lh(R,new Yt(x)))}catch(z){E(z,null)}else t.push(Z1(R,{size:x},E))}else E("unknown compression type "+g,null)},l=0;l<a;++l)d();return n}function m6(i){for(var e={},t=i.length-22;ei(i,t)!=101010256;--t)if(!t||i.length-t>65558)throw"invalid zip file";var n=Qi(i,t+8);if(!n)return{};var r=ei(i,t+16),s=r==4294967295;if(s){if(t=ei(i,t-12),ei(i,t)!=101075792)throw"invalid zip file";n=ei(i,t+32),r=ei(i,t+48)}for(var o=0;o<n;++o){var a=RR(i,r,s),c=a[0],h=a[1],d=a[2],l=a[3],u=a[4],p=a[5],g=PR(i,p);if(r=u,!c)e[l]=ns(i,g,g+h);else if(c==8)e[l]=lh(i.subarray(g,g+h),new Yt(d));else throw"unknown compression type "+c}return e}var g6=Object.freeze(Object.defineProperty({__proto__:null,Deflate:to,AsyncDeflate:xR,deflate:wR,deflateSync:Tf,Inflate:mr,AsyncInflate:Q1,inflate:Z1,inflateSync:lh,Gzip:Ug,AsyncGzip:JT,gzip:eA,gzipSync:Hg,Gunzip:Vg,AsyncGunzip:_R,gunzip:SR,gunzipSync:Gg,Zlib:Zw,AsyncZlib:JV,zlib:e6,zlibSync:Kw,Unzlib:Wg,AsyncUnzlib:bR,unzlib:MR,unzlibSync:nf,compress:eA,AsyncCompress:JT,compressSync:Hg,Compress:Ug,Decompress:ER,AsyncDecompress:t6,decompress:n6,decompressSync:i6,DecodeUTF8:r6,EncodeUTF8:s6,strToU8:Da,strFromU8:J1,ZipPassThrough:rf,ZipDeflate:o6,AsyncZipDeflate:a6,Zip:l6,zip:c6,zipSync:u6,UnzipPassThrough:kR,UnzipInflate:h6,AsyncUnzipInflate:d6,Unzip:f6,unzip:p6,unzipSync:m6},Symbol.toStringTag,{value:"Module"}));function IR(i,e,t){const n=t.length-i-1;if(e>=t[n])return n-1;if(e<=t[i])return i;let r=i,s=n,o=Math.floor((r+s)/2);for(;e<t[o]||e>=t[o+1];)e<t[o]?s=o:r=o,o=Math.floor((r+s)/2);return o}function v6(i,e,t,n){const r=[],s=[],o=[];r[0]=1;for(let a=1;a<=t;++a){s[a]=e-n[i+1-a],o[a]=n[i+a]-e;let c=0;for(let h=0;h<a;++h){const d=o[h+1],l=s[a-h],u=r[h]/(d+l);r[h]=c+d*u,c=l*u}r[a]=c}return r}function y6(i,e,t,n){const r=IR(i,n,e),s=v6(r,n,i,e),o=new Jt(0,0,0,0);for(let a=0;a<=i;++a){const c=t[r-i+a],h=s[a],d=c.w*h;o.x+=c.x*d,o.y+=c.y*d,o.z+=c.z*d,o.w+=c.w*h}return o}function x6(i,e,t,n,r){const s=[];for(let l=0;l<=t;++l)s[l]=0;const o=[];for(let l=0;l<=n;++l)o[l]=s.slice(0);const a=[];for(let l=0;l<=t;++l)a[l]=s.slice(0);a[0][0]=1;const c=s.slice(0),h=s.slice(0);for(let l=1;l<=t;++l){c[l]=e-r[i+1-l],h[l]=r[i+l]-e;let u=0;for(let p=0;p<l;++p){const g=h[p+1],y=c[l-p];a[l][p]=g+y;const x=a[p][l-1]/a[l][p];a[p][l]=u+g*x,u=y*x}a[l][l]=u}for(let l=0;l<=t;++l)o[0][l]=a[l][t];for(let l=0;l<=t;++l){let u=0,p=1;const g=[];for(let y=0;y<=t;++y)g[y]=s.slice(0);g[0][0]=1;for(let y=1;y<=n;++y){let x=0;const v=l-y,w=t-y;l>=y&&(g[p][0]=g[u][0]/a[w+1][v],x=g[p][0]*a[v][w]);const S=v>=-1?1:-v,b=l-1<=w?y-1:t-l;for(let R=S;R<=b;++R)g[p][R]=(g[u][R]-g[u][R-1])/a[w+1][v+R],x+=g[p][R]*a[v+R][w];l<=w&&(g[p][y]=-g[u][y-1]/a[w+1][l],x+=g[p][y]*a[l][w]),o[y][l]=x;const E=u;u=p,p=E}}let d=t;for(let l=1;l<=n;++l){for(let u=0;u<=t;++u)o[l][u]*=d;d*=t-l}return o}function w6(i,e,t,n,r){const s=r<i?r:i,o=[],a=IR(i,n,e),c=x6(a,n,i,s,e),h=[];for(let d=0;d<t.length;++d){const l=t[d].clone(),u=l.w;l.x*=u,l.y*=u,l.z*=u,h[d]=l}for(let d=0;d<=s;++d){const l=h[a-i].clone().multiplyScalar(c[d][0]);for(let u=1;u<=i;++u)l.add(h[a-i+u].clone().multiplyScalar(c[d][u]));o[d]=l}for(let d=s+1;d<=r+1;++d)o[d]=new Jt(0,0,0);return o}function _6(i,e){let t=1;for(let r=2;r<=i;++r)t*=r;let n=1;for(let r=2;r<=e;++r)n*=r;for(let r=2;r<=i-e;++r)n*=r;return t/n}function S6(i){const e=i.length,t=[],n=[];for(let s=0;s<e;++s){const o=i[s];t[s]=new B(o.x,o.y,o.z),n[s]=o.w}const r=[];for(let s=0;s<e;++s){const o=t[s].clone();for(let a=1;a<=s;++a)o.sub(r[s-a].clone().multiplyScalar(_6(s,a)*n[a]));r[s]=o.divideScalar(n[0])}return r}function b6(i,e,t,n,r){const s=w6(i,e,t,n,r);return S6(s)}class nA extends gr{constructor(e,t,n,r,s){super(),this.degree=e,this.knots=t,this.controlPoints=[],this.startKnot=r||0,this.endKnot=s||this.knots.length-1;for(let o=0;o<n.length;++o){const a=n[o];this.controlPoints[o]=new Jt(a.x,a.y,a.z,a.w)}}getPoint(e,t=new B){const n=t,r=this.knots[this.startKnot]+e*(this.knots[this.endKnot]-this.knots[this.startKnot]),s=y6(this.degree,this.knots,this.controlPoints,r);return s.w!==1&&s.divideScalar(s.w),n.set(s.x,s.y,s.z)}getTangent(e,t=new B){const n=t,r=this.knots[0]+e*(this.knots[this.knots.length-1]-this.knots[0]),s=b6(this.degree,this.knots,this.controlPoints,r,1);return n.copy(s[1]).normalize(),n}}let Xt,Qn,or;class M6 extends Ei{constructor(e){super(e)}load(e,t,n,r){const s=this,o=s.path===""?pr.extractUrlBase(e):s.path,a=new er(this.manager);a.setPath(s.path),a.setResponseType("arraybuffer"),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,function(c){try{t(s.parse(c,o))}catch(h){r?r(h):console.error(h),s.manager.itemError(e)}},n,r)}parse(e,t){if(R6(e))Xt=new P6().parse(e);else{const r=zR(e);if(!L6(r))throw new Error("THREE.FBXLoader: Unknown format.");if(rA(r)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+rA(r));Xt=new C6().parse(r)}const n=new Ev(this.manager).setPath(this.resourcePath||t).setCrossOrigin(this.crossOrigin);return new E6(n,this.manager).parse(Xt)}}class E6{constructor(e,t){this.textureLoader=e,this.manager=t}parse(){Qn=this.parseConnections();const e=this.parseImages(),t=this.parseTextures(e),n=this.parseMaterials(t),r=this.parseDeformers(),s=new T6().parse(r);return this.parseScene(r,s,n),or}parseConnections(){const e=new Map;return"Connections"in Xt&&Xt.Connections.connections.forEach(function(n){const r=n[0],s=n[1],o=n[2];e.has(r)||e.set(r,{parents:[],children:[]});const a={ID:s,relationship:o};e.get(r).parents.push(a),e.has(s)||e.set(s,{parents:[],children:[]});const c={ID:r,relationship:o};e.get(s).children.push(c)}),e}parseImages(){const e={},t={};if("Video"in Xt.Objects){const n=Xt.Objects.Video;for(const r in n){const s=n[r],o=parseInt(r);if(e[o]=s.RelativeFilename||s.Filename,"Content"in s){const a=s.Content instanceof ArrayBuffer&&s.Content.byteLength>0,c=typeof s.Content=="string"&&s.Content!=="";if(a||c){const h=this.parseImage(n[r]);t[s.RelativeFilename||s.Filename]=h}}}}for(const n in e){const r=e[n];t[r]!==void 0?e[n]=t[r]:e[n]=e[n].split("\\").pop()}return e}parseImage(e){const t=e.Content,n=e.RelativeFilename||e.Filename,r=n.slice(n.lastIndexOf(".")+1).toLowerCase();let s;switch(r){case"bmp":s="image/bmp";break;case"jpg":case"jpeg":s="image/jpeg";break;case"png":s="image/png";break;case"tif":s="image/tiff";break;case"tga":this.manager.getHandler(".tga")===null&&console.warn("FBXLoader: TGA loader not found, skipping ",n),s="image/tga";break;default:console.warn('FBXLoader: Image type "'+r+'" is not supported.');return}if(typeof t=="string")return"data:"+s+";base64,"+t;{const o=new Uint8Array(t);return window.URL.createObjectURL(new Blob([o],{type:s}))}}parseTextures(e){const t=new Map;if("Texture"in Xt.Objects){const n=Xt.Objects.Texture;for(const r in n){const s=this.parseTexture(n[r],e);t.set(parseInt(r),s)}}return t}parseTexture(e,t){const n=this.loadTexture(e,t);n.ID=e.id,n.name=e.attrName;const r=e.WrapModeU,s=e.WrapModeV,o=r!==void 0?r.value:0,a=s!==void 0?s.value:0;if(n.wrapS=o===0?Zs:_i,n.wrapT=a===0?Zs:_i,"Scaling"in e){const c=e.Scaling.value;n.repeat.x=c[0],n.repeat.y=c[1]}return n}loadTexture(e,t){let n;const r=this.textureLoader.path,s=Qn.get(e.id).children;s!==void 0&&s.length>0&&t[s[0].ID]!==void 0&&(n=t[s[0].ID],(n.indexOf("blob:")===0||n.indexOf("data:")===0)&&this.textureLoader.setPath(void 0));let o;const a=e.FileName.slice(-3).toLowerCase();if(a==="tga"){const c=this.manager.getHandler(".tga");c===null?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",e.RelativeFilename),o=new hn):(c.setPath(this.textureLoader.path),o=c.load(n))}else a==="psd"?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",e.RelativeFilename),o=new hn):o=this.textureLoader.load(n);return this.textureLoader.setPath(r),o}parseMaterials(e){const t=new Map;if("Material"in Xt.Objects){const n=Xt.Objects.Material;for(const r in n){const s=this.parseMaterial(n[r],e);s!==null&&t.set(parseInt(r),s)}}return t}parseMaterial(e,t){const n=e.id,r=e.attrName;let s=e.ShadingModel;if(typeof s=="object"&&(s=s.value),!Qn.has(n))return null;const o=this.parseParameters(e,t,n);let a;switch(s.toLowerCase()){case"phong":a=new uu;break;case"lambert":a=new Mv;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',s),a=new uu;break}return a.setValues(o),a.name=r,a}parseParameters(e,t,n){const r={};e.BumpFactor&&(r.bumpScale=e.BumpFactor.value),e.Diffuse?r.color=new qe().fromArray(e.Diffuse.value):e.DiffuseColor&&(e.DiffuseColor.type==="Color"||e.DiffuseColor.type==="ColorRGB")&&(r.color=new qe().fromArray(e.DiffuseColor.value)),e.DisplacementFactor&&(r.displacementScale=e.DisplacementFactor.value),e.Emissive?r.emissive=new qe().fromArray(e.Emissive.value):e.EmissiveColor&&(e.EmissiveColor.type==="Color"||e.EmissiveColor.type==="ColorRGB")&&(r.emissive=new qe().fromArray(e.EmissiveColor.value)),e.EmissiveFactor&&(r.emissiveIntensity=parseFloat(e.EmissiveFactor.value)),e.Opacity&&(r.opacity=parseFloat(e.Opacity.value)),r.opacity<1&&(r.transparent=!0),e.ReflectionFactor&&(r.reflectivity=e.ReflectionFactor.value),e.Shininess&&(r.shininess=e.Shininess.value),e.Specular?r.specular=new qe().fromArray(e.Specular.value):e.SpecularColor&&e.SpecularColor.type==="Color"&&(r.specular=new qe().fromArray(e.SpecularColor.value));const s=this;return Qn.get(n).children.forEach(function(o){const a=o.relationship;switch(a){case"Bump":r.bumpMap=s.getTexture(t,o.ID);break;case"Maya|TEX_ao_map":r.aoMap=s.getTexture(t,o.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":r.map=s.getTexture(t,o.ID),r.map!==void 0&&(r.map.encoding=Ht);break;case"DisplacementColor":r.displacementMap=s.getTexture(t,o.ID);break;case"EmissiveColor":r.emissiveMap=s.getTexture(t,o.ID),r.emissiveMap!==void 0&&(r.emissiveMap.encoding=Ht);break;case"NormalMap":case"Maya|TEX_normal_map":r.normalMap=s.getTexture(t,o.ID);break;case"ReflectionColor":r.envMap=s.getTexture(t,o.ID),r.envMap!==void 0&&(r.envMap.mapping=xu,r.envMap.encoding=Ht);break;case"SpecularColor":r.specularMap=s.getTexture(t,o.ID),r.specularMap!==void 0&&(r.specularMap.encoding=Ht);break;case"TransparentColor":case"TransparencyFactor":r.alphaMap=s.getTexture(t,o.ID),r.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",a);break}}),r}getTexture(e,t){return"LayeredTexture"in Xt.Objects&&t in Xt.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),t=Qn.get(t).children[0].ID),e.get(t)}parseDeformers(){const e={},t={};if("Deformer"in Xt.Objects){const n=Xt.Objects.Deformer;for(const r in n){const s=n[r],o=Qn.get(parseInt(r));if(s.attrType==="Skin"){const a=this.parseSkeleton(o,n);a.ID=r,o.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),a.geometryID=o.parents[0].ID,e[r]=a}else if(s.attrType==="BlendShape"){const a={id:r};a.rawTargets=this.parseMorphTargets(o,n),a.id=r,o.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),t[r]=a}}}return{skeletons:e,morphTargets:t}}parseSkeleton(e,t){const n=[];return e.children.forEach(function(r){const s=t[r.ID];if(s.attrType!=="Cluster")return;const o={ID:r.ID,indices:[],weights:[],transformLink:new st().fromArray(s.TransformLink.a)};"Indexes"in s&&(o.indices=s.Indexes.a,o.weights=s.Weights.a),n.push(o)}),{rawBones:n,bones:[]}}parseMorphTargets(e,t){const n=[];for(let r=0;r<e.children.length;r++){const s=e.children[r],o=t[s.ID],a={name:o.attrName,initialWeight:o.DeformPercent,id:o.id,fullWeights:o.FullWeights.a};if(o.attrType!=="BlendShapeChannel")return;a.geoID=Qn.get(parseInt(s.ID)).children.filter(function(c){return c.relationship===void 0})[0].ID,n.push(a)}return n}parseScene(e,t,n){or=new Jr;const r=this.parseModels(e.skeletons,t,n),s=Xt.Objects.Model,o=this;r.forEach(function(c){const h=s[c.ID];o.setLookAtProperties(c,h),Qn.get(c.ID).parents.forEach(function(l){const u=r.get(l.ID);u!==void 0&&u.add(c)}),c.parent===null&&or.add(c)}),this.bindSkeleton(e.skeletons,t,r),this.createAmbientLight(),or.traverse(function(c){if(c.userData.transformData){c.parent&&(c.userData.transformData.parentMatrix=c.parent.matrix,c.userData.transformData.parentMatrixWorld=c.parent.matrixWorld);const h=DR(c.userData.transformData);c.applyMatrix4(h),c.updateWorldMatrix()}});const a=new A6().parse();or.children.length===1&&or.children[0].isGroup&&(or.children[0].animations=a,or=or.children[0]),or.animations=a}parseModels(e,t,n){const r=new Map,s=Xt.Objects.Model;for(const o in s){const a=parseInt(o),c=s[o],h=Qn.get(a);let d=this.buildSkeleton(h,e,a,c.attrName);if(!d){switch(c.attrType){case"Camera":d=this.createCamera(h);break;case"Light":d=this.createLight(h);break;case"Mesh":d=this.createMesh(h,t,n);break;case"NurbsCurve":d=this.createCurve(h,t);break;case"LimbNode":case"Root":d=new Ol;break;case"Null":default:d=new Jr;break}d.name=c.attrName?Wt.sanitizeNodeName(c.attrName):"",d.ID=a}this.getTransformData(d,c),r.set(a,d)}return r}buildSkeleton(e,t,n,r){let s=null;return e.parents.forEach(function(o){for(const a in t){const c=t[a];c.rawBones.forEach(function(h,d){if(h.ID===o.ID){const l=s;s=new Ol,s.matrixWorld.copy(h.transformLink),s.name=r?Wt.sanitizeNodeName(r):"",s.ID=n,c.bones[d]=s,l!==null&&s.add(l)}})}}),s}createCamera(e){let t,n;if(e.children.forEach(function(r){const s=Xt.Objects.NodeAttribute[r.ID];s!==void 0&&(n=s)}),n===void 0)t=new ft;else{let r=0;n.CameraProjectionType!==void 0&&n.CameraProjectionType.value===1&&(r=1);let s=1;n.NearPlane!==void 0&&(s=n.NearPlane.value/1e3);let o=1e3;n.FarPlane!==void 0&&(o=n.FarPlane.value/1e3);let a=window.innerWidth,c=window.innerHeight;n.AspectWidth!==void 0&&n.AspectHeight!==void 0&&(a=n.AspectWidth.value,c=n.AspectHeight.value);const h=a/c;let d=45;n.FieldOfView!==void 0&&(d=n.FieldOfView.value);const l=n.FocalLength?n.FocalLength.value:null;switch(r){case 0:t=new Mn(d,h,s,o),l!==null&&t.setFocalLength(l);break;case 1:t=new Fr(-a/2,a/2,c/2,-c/2,s,o);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+r+"."),t=new ft;break}}return t}createLight(e){let t,n;if(e.children.forEach(function(r){const s=Xt.Objects.NodeAttribute[r.ID];s!==void 0&&(n=s)}),n===void 0)t=new ft;else{let r;n.LightType===void 0?r=0:r=n.LightType.value;let s=16777215;n.Color!==void 0&&(s=new qe().fromArray(n.Color.value));let o=n.Intensity===void 0?1:n.Intensity.value/100;n.CastLightOnObject!==void 0&&n.CastLightOnObject.value===0&&(o=0);let a=0;n.FarAttenuationEnd!==void 0&&(n.EnableFarAttenuation!==void 0&&n.EnableFarAttenuation.value===0?a=0:a=n.FarAttenuationEnd.value);const c=1;switch(r){case 0:t=new zu(s,o,a,c);break;case 1:t=new xf(s,o);break;case 2:let h=Math.PI/3;n.InnerAngle!==void 0&&(h=Pr.degToRad(n.InnerAngle.value));let d=0;n.OuterAngle!==void 0&&(d=Pr.degToRad(n.OuterAngle.value),d=Math.max(d,1)),t=new yf(s,o,a,h,d,c);break;default:console.warn("THREE.FBXLoader: Unknown light type "+n.LightType.value+", defaulting to a PointLight."),t=new zu(s,o);break}n.CastShadows!==void 0&&n.CastShadows.value===1&&(t.castShadow=!0)}return t}createMesh(e,t,n){let r,s=null,o=null;const a=[];return e.children.forEach(function(c){t.has(c.ID)&&(s=t.get(c.ID)),n.has(c.ID)&&a.push(n.get(c.ID))}),a.length>1?o=a:a.length>0?o=a[0]:(o=new uu({color:13421772}),a.push(o)),"color"in s.attributes&&a.forEach(function(c){c.vertexColors=!0}),s.FBX_Deformer?(r=new Qu(s,o),r.normalizeSkinWeights()):r=new je(s,o),r}createCurve(e,t){const n=e.children.reduce(function(s,o){return t.has(o.ID)&&(s=t.get(o.ID)),s},null),r=new ni({color:3342591,linewidth:1});return new di(n,r)}getTransformData(e,t){const n={};"InheritType"in t&&(n.inheritType=parseInt(t.InheritType.value)),"RotationOrder"in t?n.eulerOrder=BR(t.RotationOrder.value):n.eulerOrder="ZYX","Lcl_Translation"in t&&(n.translation=t.Lcl_Translation.value),"PreRotation"in t&&(n.preRotation=t.PreRotation.value),"Lcl_Rotation"in t&&(n.rotation=t.Lcl_Rotation.value),"PostRotation"in t&&(n.postRotation=t.PostRotation.value),"Lcl_Scaling"in t&&(n.scale=t.Lcl_Scaling.value),"ScalingOffset"in t&&(n.scalingOffset=t.ScalingOffset.value),"ScalingPivot"in t&&(n.scalingPivot=t.ScalingPivot.value),"RotationOffset"in t&&(n.rotationOffset=t.RotationOffset.value),"RotationPivot"in t&&(n.rotationPivot=t.RotationPivot.value),e.userData.transformData=n}setLookAtProperties(e,t){"LookAtProperty"in t&&Qn.get(e.ID).children.forEach(function(r){if(r.relationship==="LookAtProperty"){const s=Xt.Objects.Model[r.ID];if("Lcl_Translation"in s){const o=s.Lcl_Translation.value;e.target!==void 0?(e.target.position.fromArray(o),or.add(e.target)):e.lookAt(new B().fromArray(o))}}})}bindSkeleton(e,t,n){const r=this.parsePoseNodes();for(const s in e){const o=e[s];Qn.get(parseInt(o.ID)).parents.forEach(function(c){if(t.has(c.ID)){const h=c.ID;Qn.get(h).parents.forEach(function(l){n.has(l.ID)&&n.get(l.ID).bind(new Zu(o.bones),r[l.ID])})}})}}parsePoseNodes(){const e={};if("Pose"in Xt.Objects){const t=Xt.Objects.Pose;for(const n in t)if(t[n].attrType==="BindPose"&&t[n].NbPoseNodes>0){const r=t[n].PoseNode;Array.isArray(r)?r.forEach(function(s){e[s.Node]=new st().fromArray(s.Matrix.a)}):e[r.Node]=new st().fromArray(r.Matrix.a)}}return e}createAmbientLight(){if("GlobalSettings"in Xt&&"AmbientColor"in Xt.GlobalSettings){const e=Xt.GlobalSettings.AmbientColor.value,t=e[0],n=e[1],r=e[2];if(t!==0||n!==0||r!==0){const s=new qe(t,n,r);or.add(new Tv(s,1))}}}}class T6{parse(e){const t=new Map;if("Geometry"in Xt.Objects){const n=Xt.Objects.Geometry;for(const r in n){const s=Qn.get(parseInt(r)),o=this.parseGeometry(s,n[r],e);t.set(parseInt(r),o)}}return t}parseGeometry(e,t,n){switch(t.attrType){case"Mesh":return this.parseMeshGeometry(e,t,n);case"NurbsCurve":return this.parseNurbsGeometry(t)}}parseMeshGeometry(e,t,n){const r=n.skeletons,s=[],o=e.parents.map(function(l){return Xt.Objects.Model[l.ID]});if(o.length===0)return;const a=e.children.reduce(function(l,u){return r[u.ID]!==void 0&&(l=r[u.ID]),l},null);e.children.forEach(function(l){n.morphTargets[l.ID]!==void 0&&s.push(n.morphTargets[l.ID])});const c=o[0],h={};"RotationOrder"in c&&(h.eulerOrder=BR(c.RotationOrder.value)),"InheritType"in c&&(h.inheritType=parseInt(c.InheritType.value)),"GeometricTranslation"in c&&(h.translation=c.GeometricTranslation.value),"GeometricRotation"in c&&(h.rotation=c.GeometricRotation.value),"GeometricScaling"in c&&(h.scale=c.GeometricScaling.value);const d=DR(h);return this.genGeometry(t,a,s,d)}genGeometry(e,t,n,r){const s=new vt;e.attrName&&(s.name=e.attrName);const o=this.parseGeoNode(e,t),a=this.genBuffers(o),c=new lt(a.vertex,3);if(c.applyMatrix4(r),s.setAttribute("position",c),a.colors.length>0&&s.setAttribute("color",new lt(a.colors,3)),t&&(s.setAttribute("skinIndex",new df(a.weightsIndices,4)),s.setAttribute("skinWeight",new lt(a.vertexWeights,4)),s.FBX_Deformer=t),a.normal.length>0){const h=new ai().getNormalMatrix(r),d=new lt(a.normal,3);d.applyNormalMatrix(h),s.setAttribute("normal",d)}if(a.uvs.forEach(function(h,d){let l="uv"+(d+1).toString();d===0&&(l="uv"),s.setAttribute(l,new lt(a.uvs[d],2))}),o.material&&o.material.mappingType!=="AllSame"){let h=a.materialIndex[0],d=0;if(a.materialIndex.forEach(function(l,u){l!==h&&(s.addGroup(d,u-d,h),h=l,d=u)}),s.groups.length>0){const l=s.groups[s.groups.length-1],u=l.start+l.count;u!==a.materialIndex.length&&s.addGroup(u,a.materialIndex.length-u,h)}s.groups.length===0&&s.addGroup(0,a.materialIndex.length,a.materialIndex[0])}return this.addMorphTargets(s,e,n,r),s}parseGeoNode(e,t){const n={};if(n.vertexPositions=e.Vertices!==void 0?e.Vertices.a:[],n.vertexIndices=e.PolygonVertexIndex!==void 0?e.PolygonVertexIndex.a:[],e.LayerElementColor&&(n.color=this.parseVertexColors(e.LayerElementColor[0])),e.LayerElementMaterial&&(n.material=this.parseMaterialIndices(e.LayerElementMaterial[0])),e.LayerElementNormal&&(n.normal=this.parseNormals(e.LayerElementNormal[0])),e.LayerElementUV){n.uv=[];let r=0;for(;e.LayerElementUV[r];)e.LayerElementUV[r].UV&&n.uv.push(this.parseUVs(e.LayerElementUV[r])),r++}return n.weightTable={},t!==null&&(n.skeleton=t,t.rawBones.forEach(function(r,s){r.indices.forEach(function(o,a){n.weightTable[o]===void 0&&(n.weightTable[o]=[]),n.weightTable[o].push({id:s,weight:r.weights[a]})})})),n}genBuffers(e){const t={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};let n=0,r=0,s=!1,o=[],a=[],c=[],h=[],d=[],l=[];const u=this;return e.vertexIndices.forEach(function(p,g){let y,x=!1;p<0&&(p=p^-1,x=!0);let v=[],w=[];if(o.push(p*3,p*3+1,p*3+2),e.color){const S=Dm(g,n,p,e.color);c.push(S[0],S[1],S[2])}if(e.skeleton){if(e.weightTable[p]!==void 0&&e.weightTable[p].forEach(function(S){w.push(S.weight),v.push(S.id)}),w.length>4){s||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),s=!0);const S=[0,0,0,0],b=[0,0,0,0];w.forEach(function(E,R){let z=E,I=v[R];b.forEach(function(N,F,C){if(z>N){C[F]=z,z=N;const O=S[F];S[F]=I,I=O}})}),v=S,w=b}for(;w.length<4;)w.push(0),v.push(0);for(let S=0;S<4;++S)d.push(w[S]),l.push(v[S])}if(e.normal){const S=Dm(g,n,p,e.normal);a.push(S[0],S[1],S[2])}e.material&&e.material.mappingType!=="AllSame"&&(y=Dm(g,n,p,e.material)[0]),e.uv&&e.uv.forEach(function(S,b){const E=Dm(g,n,p,S);h[b]===void 0&&(h[b]=[]),h[b].push(E[0]),h[b].push(E[1])}),r++,x&&(u.genFace(t,e,o,y,a,c,h,d,l,r),n++,r=0,o=[],a=[],c=[],h=[],d=[],l=[])}),t}genFace(e,t,n,r,s,o,a,c,h,d){for(let l=2;l<d;l++)e.vertex.push(t.vertexPositions[n[0]]),e.vertex.push(t.vertexPositions[n[1]]),e.vertex.push(t.vertexPositions[n[2]]),e.vertex.push(t.vertexPositions[n[(l-1)*3]]),e.vertex.push(t.vertexPositions[n[(l-1)*3+1]]),e.vertex.push(t.vertexPositions[n[(l-1)*3+2]]),e.vertex.push(t.vertexPositions[n[l*3]]),e.vertex.push(t.vertexPositions[n[l*3+1]]),e.vertex.push(t.vertexPositions[n[l*3+2]]),t.skeleton&&(e.vertexWeights.push(c[0]),e.vertexWeights.push(c[1]),e.vertexWeights.push(c[2]),e.vertexWeights.push(c[3]),e.vertexWeights.push(c[(l-1)*4]),e.vertexWeights.push(c[(l-1)*4+1]),e.vertexWeights.push(c[(l-1)*4+2]),e.vertexWeights.push(c[(l-1)*4+3]),e.vertexWeights.push(c[l*4]),e.vertexWeights.push(c[l*4+1]),e.vertexWeights.push(c[l*4+2]),e.vertexWeights.push(c[l*4+3]),e.weightsIndices.push(h[0]),e.weightsIndices.push(h[1]),e.weightsIndices.push(h[2]),e.weightsIndices.push(h[3]),e.weightsIndices.push(h[(l-1)*4]),e.weightsIndices.push(h[(l-1)*4+1]),e.weightsIndices.push(h[(l-1)*4+2]),e.weightsIndices.push(h[(l-1)*4+3]),e.weightsIndices.push(h[l*4]),e.weightsIndices.push(h[l*4+1]),e.weightsIndices.push(h[l*4+2]),e.weightsIndices.push(h[l*4+3])),t.color&&(e.colors.push(o[0]),e.colors.push(o[1]),e.colors.push(o[2]),e.colors.push(o[(l-1)*3]),e.colors.push(o[(l-1)*3+1]),e.colors.push(o[(l-1)*3+2]),e.colors.push(o[l*3]),e.colors.push(o[l*3+1]),e.colors.push(o[l*3+2])),t.material&&t.material.mappingType!=="AllSame"&&(e.materialIndex.push(r),e.materialIndex.push(r),e.materialIndex.push(r)),t.normal&&(e.normal.push(s[0]),e.normal.push(s[1]),e.normal.push(s[2]),e.normal.push(s[(l-1)*3]),e.normal.push(s[(l-1)*3+1]),e.normal.push(s[(l-1)*3+2]),e.normal.push(s[l*3]),e.normal.push(s[l*3+1]),e.normal.push(s[l*3+2])),t.uv&&t.uv.forEach(function(u,p){e.uvs[p]===void 0&&(e.uvs[p]=[]),e.uvs[p].push(a[p][0]),e.uvs[p].push(a[p][1]),e.uvs[p].push(a[p][(l-1)*2]),e.uvs[p].push(a[p][(l-1)*2+1]),e.uvs[p].push(a[p][l*2]),e.uvs[p].push(a[p][l*2+1])})}addMorphTargets(e,t,n,r){if(n.length===0)return;e.morphTargetsRelative=!0,e.morphAttributes.position=[];const s=this;n.forEach(function(o){o.rawTargets.forEach(function(a){const c=Xt.Objects.Geometry[a.geoID];c!==void 0&&s.genMorphGeometry(e,t,c,r,a.name)})})}genMorphGeometry(e,t,n,r,s){const o=t.PolygonVertexIndex!==void 0?t.PolygonVertexIndex.a:[],a=n.Vertices!==void 0?n.Vertices.a:[],c=n.Indexes!==void 0?n.Indexes.a:[],h=e.attributes.position.count*3,d=new Float32Array(h);for(let g=0;g<c.length;g++){const y=c[g]*3;d[y]=a[g*3],d[y+1]=a[g*3+1],d[y+2]=a[g*3+2]}const l={vertexIndices:o,vertexPositions:d},u=this.genBuffers(l),p=new lt(u.vertex,3);p.name=s||n.attrName,p.applyMatrix4(r),e.morphAttributes.position.push(p)}parseNormals(e){const t=e.MappingInformationType,n=e.ReferenceInformationType,r=e.Normals.a;let s=[];return n==="IndexToDirect"&&("NormalIndex"in e?s=e.NormalIndex.a:"NormalsIndex"in e&&(s=e.NormalsIndex.a)),{dataSize:3,buffer:r,indices:s,mappingType:t,referenceType:n}}parseUVs(e){const t=e.MappingInformationType,n=e.ReferenceInformationType,r=e.UV.a;let s=[];return n==="IndexToDirect"&&(s=e.UVIndex.a),{dataSize:2,buffer:r,indices:s,mappingType:t,referenceType:n}}parseVertexColors(e){const t=e.MappingInformationType,n=e.ReferenceInformationType,r=e.Colors.a;let s=[];return n==="IndexToDirect"&&(s=e.ColorIndex.a),{dataSize:4,buffer:r,indices:s,mappingType:t,referenceType:n}}parseMaterialIndices(e){const t=e.MappingInformationType,n=e.ReferenceInformationType;if(t==="NoMappingInformation")return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:n};const r=e.Materials.a,s=[];for(let o=0;o<r.length;++o)s.push(o);return{dataSize:1,buffer:r,indices:s,mappingType:t,referenceType:n}}parseNurbsGeometry(e){if(nA===void 0)return console.error("THREE.FBXLoader: The loader relies on NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new vt;const t=parseInt(e.Order);if(isNaN(t))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new vt;const n=t-1,r=e.KnotVector.a,s=[],o=e.Points.a;for(let l=0,u=o.length;l<u;l+=4)s.push(new Jt().fromArray(o,l));let a,c;if(e.Form==="Closed")s.push(s[0]);else if(e.Form==="Periodic"){a=n,c=r.length-1-a;for(let l=0;l<n;++l)s.push(s[l])}const d=new nA(n,r,s,a,c).getPoints(s.length*12);return new vt().setFromPoints(d)}}class A6{parse(){const e=[],t=this.parseClips();if(t!==void 0)for(const n in t){const r=t[n],s=this.addClip(r);e.push(s)}return e}parseClips(){if(Xt.Objects.AnimationCurve===void 0)return;const e=this.parseAnimationCurveNodes();this.parseAnimationCurves(e);const t=this.parseAnimationLayers(e);return this.parseAnimStacks(t)}parseAnimationCurveNodes(){const e=Xt.Objects.AnimationCurveNode,t=new Map;for(const n in e){const r=e[n];if(r.attrName.match(/S|R|T|DeformPercent/)!==null){const s={id:r.id,attr:r.attrName,curves:{}};t.set(s.id,s)}}return t}parseAnimationCurves(e){const t=Xt.Objects.AnimationCurve;for(const n in t){const r={id:t[n].id,times:t[n].KeyTime.a.map(k6),values:t[n].KeyValueFloat.a},s=Qn.get(r.id);if(s!==void 0){const o=s.parents[0].ID,a=s.parents[0].relationship;a.match(/X/)?e.get(o).curves.x=r:a.match(/Y/)?e.get(o).curves.y=r:a.match(/Z/)?e.get(o).curves.z=r:a.match(/d|DeformPercent/)&&e.has(o)&&(e.get(o).curves.morph=r)}}}parseAnimationLayers(e){const t=Xt.Objects.AnimationLayer,n=new Map;for(const r in t){const s=[],o=Qn.get(parseInt(r));o!==void 0&&(o.children.forEach(function(c,h){if(e.has(c.ID)){const d=e.get(c.ID);if(d.curves.x!==void 0||d.curves.y!==void 0||d.curves.z!==void 0){if(s[h]===void 0){const l=Qn.get(c.ID).parents.filter(function(u){return u.relationship!==void 0})[0].ID;if(l!==void 0){const u=Xt.Objects.Model[l.toString()];if(u===void 0){console.warn("THREE.FBXLoader: Encountered a unused curve.",c);return}const p={modelName:u.attrName?Wt.sanitizeNodeName(u.attrName):"",ID:u.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};or.traverse(function(g){g.ID===u.id&&(p.transform=g.matrix,g.userData.transformData&&(p.eulerOrder=g.userData.transformData.eulerOrder))}),p.transform||(p.transform=new st),"PreRotation"in u&&(p.preRotation=u.PreRotation.value),"PostRotation"in u&&(p.postRotation=u.PostRotation.value),s[h]=p}}s[h]&&(s[h][d.attr]=d)}else if(d.curves.morph!==void 0){if(s[h]===void 0){const l=Qn.get(c.ID).parents.filter(function(v){return v.relationship!==void 0})[0].ID,u=Qn.get(l).parents[0].ID,p=Qn.get(u).parents[0].ID,g=Qn.get(p).parents[0].ID,y=Xt.Objects.Model[g],x={modelName:y.attrName?Wt.sanitizeNodeName(y.attrName):"",morphName:Xt.Objects.Deformer[l].attrName};s[h]=x}s[h][d.attr]=d}}}),n.set(parseInt(r),s))}return n}parseAnimStacks(e){const t=Xt.Objects.AnimationStack,n={};for(const r in t){const s=Qn.get(parseInt(r)).children;s.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");const o=e.get(s[0].ID);n[r]={name:t[r].attrName,layer:o}}return n}addClip(e){let t=[];const n=this;return e.layer.forEach(function(r){t=t.concat(n.generateTracks(r))}),new Wl(e.name,-1,t)}generateTracks(e){const t=[];let n=new B,r=new qt,s=new B;if(e.transform&&e.transform.decompose(n,r,s),n=n.toArray(),r=new Et().setFromQuaternion(r,e.eulerOrder).toArray(),s=s.toArray(),e.T!==void 0&&Object.keys(e.T.curves).length>0){const o=this.generateVectorTrack(e.modelName,e.T.curves,n,"position");o!==void 0&&t.push(o)}if(e.R!==void 0&&Object.keys(e.R.curves).length>0){const o=this.generateRotationTrack(e.modelName,e.R.curves,r,e.preRotation,e.postRotation,e.eulerOrder);o!==void 0&&t.push(o)}if(e.S!==void 0&&Object.keys(e.S.curves).length>0){const o=this.generateVectorTrack(e.modelName,e.S.curves,s,"scale");o!==void 0&&t.push(o)}if(e.DeformPercent!==void 0){const o=this.generateMorphTrack(e);o!==void 0&&t.push(o)}return t}generateVectorTrack(e,t,n,r){const s=this.getTimesForAllAxes(t),o=this.getKeyframeTrackValues(s,t,n);return new Gl(e+"."+r,s,o)}generateRotationTrack(e,t,n,r,s,o){t.x!==void 0&&(this.interpolateRotations(t.x),t.x.values=t.x.values.map(Pr.degToRad)),t.y!==void 0&&(this.interpolateRotations(t.y),t.y.values=t.y.values.map(Pr.degToRad)),t.z!==void 0&&(this.interpolateRotations(t.z),t.z.values=t.z.values.map(Pr.degToRad));const a=this.getTimesForAllAxes(t),c=this.getKeyframeTrackValues(a,t,n);r!==void 0&&(r=r.map(Pr.degToRad),r.push(o),r=new Et().fromArray(r),r=new qt().setFromEuler(r)),s!==void 0&&(s=s.map(Pr.degToRad),s.push(o),s=new Et().fromArray(s),s=new qt().setFromEuler(s).invert());const h=new qt,d=new Et,l=[];for(let u=0;u<c.length;u+=3)d.set(c[u],c[u+1],c[u+2],o),h.setFromEuler(d),r!==void 0&&h.premultiply(r),s!==void 0&&h.multiply(s),h.toArray(l,u/3*4);return new Lo(e+".quaternion",a,l)}generateMorphTrack(e){const t=e.DeformPercent.curves.morph,n=t.values.map(function(s){return s/100}),r=or.getObjectByName(e.modelName).morphTargetDictionary[e.morphName];return new Vl(e.modelName+".morphTargetInfluences["+r+"]",t.times,n)}getTimesForAllAxes(e){let t=[];if(e.x!==void 0&&(t=t.concat(e.x.times)),e.y!==void 0&&(t=t.concat(e.y.times)),e.z!==void 0&&(t=t.concat(e.z.times)),t=t.sort(function(n,r){return n-r}),t.length>1){let n=1,r=t[0];for(let s=1;s<t.length;s++){const o=t[s];o!==r&&(t[n]=o,r=o,n++)}t=t.slice(0,n)}return t}getKeyframeTrackValues(e,t,n){const r=n,s=[];let o=-1,a=-1,c=-1;return e.forEach(function(h){if(t.x&&(o=t.x.times.indexOf(h)),t.y&&(a=t.y.times.indexOf(h)),t.z&&(c=t.z.times.indexOf(h)),o!==-1){const d=t.x.values[o];s.push(d),r[0]=d}else s.push(r[0]);if(a!==-1){const d=t.y.values[a];s.push(d),r[1]=d}else s.push(r[1]);if(c!==-1){const d=t.z.values[c];s.push(d),r[2]=d}else s.push(r[2])}),s}interpolateRotations(e){for(let t=1;t<e.values.length;t++){const n=e.values[t-1],r=e.values[t]-n,s=Math.abs(r);if(s>=180){const o=s/180,a=r/o;let c=n+a;const h=e.times[t-1],l=(e.times[t]-h)/o;let u=h+l;const p=[],g=[];for(;u<e.times[t];)p.push(u),u+=l,g.push(c),c+=a;e.times=sA(e.times,t,p),e.values=sA(e.values,t,g)}}}}class C6{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(e){this.nodeStack.push(e),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(e,t){this.currentProp=e,this.currentPropName=t}parse(e){this.currentIndent=0,this.allNodes=new FR,this.nodeStack=[],this.currentProp=[],this.currentPropName="";const t=this,n=e.split(/[\r\n]+/);return n.forEach(function(r,s){const o=r.match(/^[\s\t]*;/),a=r.match(/^[\s\t]*$/);if(o||a)return;const c=r.match("^\\t{"+t.currentIndent+"}(\\w+):(.*){",""),h=r.match("^\\t{"+t.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),d=r.match("^\\t{"+(t.currentIndent-1)+"}}");c?t.parseNodeBegin(r,c):h?t.parseNodeProperty(r,h,n[++s]):d?t.popStack():r.match(/^[^\s\t}]/)&&t.parseNodePropertyContinued(r)}),this.allNodes}parseNodeBegin(e,t){const n=t[1].trim().replace(/^"/,"").replace(/"$/,""),r=t[2].split(",").map(function(c){return c.trim().replace(/^"/,"").replace(/"$/,"")}),s={name:n},o=this.parseNodeAttr(r),a=this.getCurrentNode();this.currentIndent===0?this.allNodes.add(n,s):n in a?(n==="PoseNode"?a.PoseNode.push(s):a[n].id!==void 0&&(a[n]={},a[n][a[n].id]=a[n]),o.id!==""&&(a[n][o.id]=s)):typeof o.id=="number"?(a[n]={},a[n][o.id]=s):n!=="Properties70"&&(n==="PoseNode"?a[n]=[s]:a[n]=s),typeof o.id=="number"&&(s.id=o.id),o.name!==""&&(s.attrName=o.name),o.type!==""&&(s.attrType=o.type),this.pushStack(s)}parseNodeAttr(e){let t=e[0];e[0]!==""&&(t=parseInt(e[0]),isNaN(t)&&(t=e[0]));let n="",r="";return e.length>1&&(n=e[1].replace(/^(\w+)::/,""),r=e[2]),{id:t,name:n,type:r}}parseNodeProperty(e,t,n){let r=t[1].replace(/^"/,"").replace(/"$/,"").trim(),s=t[2].replace(/^"/,"").replace(/"$/,"").trim();r==="Content"&&s===","&&(s=n.replace(/"/g,"").replace(/,$/,"").trim());const o=this.getCurrentNode();if(o.name==="Properties70"){this.parseNodeSpecialProperty(e,r,s);return}if(r==="C"){const c=s.split(",").slice(1),h=parseInt(c[0]),d=parseInt(c[1]);let l=s.split(",").slice(3);l=l.map(function(u){return u.trim().replace(/^"/,"")}),r="connections",s=[h,d],F6(s,l),o[r]===void 0&&(o[r]=[])}r==="Node"&&(o.id=s),r in o&&Array.isArray(o[r])?o[r].push(s):r!=="a"?o[r]=s:o.a=s,this.setCurrentProp(o,r),r==="a"&&s.slice(-1)!==","&&(o.a=rx(s))}parseNodePropertyContinued(e){const t=this.getCurrentNode();t.a+=e,e.slice(-1)!==","&&(t.a=rx(t.a))}parseNodeSpecialProperty(e,t,n){const r=n.split('",').map(function(d){return d.trim().replace(/^\"/,"").replace(/\s/,"_")}),s=r[0],o=r[1],a=r[2],c=r[3];let h=r[4];switch(o){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":h=parseFloat(h);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":h=rx(h);break}this.getPrevNode()[s]={type:o,type2:a,flag:c,value:h},this.setCurrentProp(this.getPrevNode(),s)}}class P6{parse(e){const t=new iA(e);t.skip(23);const n=t.getUint32();if(n<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+n);const r=new FR;for(;!this.endOfContent(t);){const s=this.parseNode(t,n);s!==null&&r.add(s.name,s)}return r}endOfContent(e){return e.size()%16===0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()}parseNode(e,t){const n={},r=t>=7500?e.getUint64():e.getUint32(),s=t>=7500?e.getUint64():e.getUint32();t>=7500?e.getUint64():e.getUint32();const o=e.getUint8(),a=e.getString(o);if(r===0)return null;const c=[];for(let u=0;u<s;u++)c.push(this.parseProperty(e));const h=c.length>0?c[0]:"",d=c.length>1?c[1]:"",l=c.length>2?c[2]:"";for(n.singleProperty=s===1&&e.getOffset()===r;r>e.getOffset();){const u=this.parseNode(e,t);u!==null&&this.parseSubNode(a,n,u)}return n.propertyList=c,typeof h=="number"&&(n.id=h),d!==""&&(n.attrName=d),l!==""&&(n.attrType=l),a!==""&&(n.name=a),n}parseSubNode(e,t,n){if(n.singleProperty===!0){const r=n.propertyList[0];Array.isArray(r)?(t[n.name]=n,n.a=r):t[n.name]=r}else if(e==="Connections"&&n.name==="C"){const r=[];n.propertyList.forEach(function(s,o){o!==0&&r.push(s)}),t.connections===void 0&&(t.connections=[]),t.connections.push(r)}else if(n.name==="Properties70")Object.keys(n).forEach(function(s){t[s]=n[s]});else if(e==="Properties70"&&n.name==="P"){let r=n.propertyList[0],s=n.propertyList[1];const o=n.propertyList[2],a=n.propertyList[3];let c;r.indexOf("Lcl ")===0&&(r=r.replace("Lcl ","Lcl_")),s.indexOf("Lcl ")===0&&(s=s.replace("Lcl ","Lcl_")),s==="Color"||s==="ColorRGB"||s==="Vector"||s==="Vector3D"||s.indexOf("Lcl_")===0?c=[n.propertyList[4],n.propertyList[5],n.propertyList[6]]:c=n.propertyList[4],t[r]={type:s,type2:o,flag:a,value:c}}else t[n.name]===void 0?typeof n.id=="number"?(t[n.name]={},t[n.name][n.id]=n):t[n.name]=n:n.name==="PoseNode"?(Array.isArray(t[n.name])||(t[n.name]=[t[n.name]]),t[n.name].push(n)):t[n.name][n.id]===void 0&&(t[n.name][n.id]=n)}parseProperty(e){const t=e.getString(1);let n;switch(t){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":return n=e.getUint32(),e.getArrayBuffer(n);case"S":return n=e.getUint32(),e.getString(n);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":const r=e.getUint32(),s=e.getUint32(),o=e.getUint32();if(s===0)switch(t){case"b":case"c":return e.getBooleanArray(r);case"d":return e.getFloat64Array(r);case"f":return e.getFloat32Array(r);case"i":return e.getInt32Array(r);case"l":return e.getInt64Array(r)}typeof g6=="undefined"&&console.error("THREE.FBXLoader: External library fflate.min.js required.");const a=nf(new Uint8Array(e.getArrayBuffer(o))),c=new iA(a.buffer);switch(t){case"b":case"c":return c.getBooleanArray(r);case"d":return c.getFloat64Array(r);case"f":return c.getFloat32Array(r);case"i":return c.getInt32Array(r);case"l":return c.getInt64Array(r)}default:throw new Error("THREE.FBXLoader: Unknown property type "+t)}}}class iA{constructor(e,t){this.dv=new DataView(e),this.offset=0,this.littleEndian=t!==void 0?t:!0}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(e){this.offset+=e}getBoolean(){return(this.getUint8()&1)===1}getBooleanArray(e){const t=[];for(let n=0;n<e;n++)t.push(this.getBoolean());return t}getUint8(){const e=this.dv.getUint8(this.offset);return this.offset+=1,e}getInt16(){const e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}getInt32(){const e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}getInt32Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getInt32());return t}getUint32(){const e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}getInt64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),t&2147483648?(t=~t&4294967295,e=~e&4294967295,e===4294967295&&(t=t+1&4294967295),e=e+1&4294967295,-(t*4294967296+e)):t*4294967296+e}getInt64Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getInt64());return t}getUint64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),t*4294967296+e}getFloat32(){const e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}getFloat32Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getFloat32());return t}getFloat64(){const e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}getFloat64Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getFloat64());return t}getArrayBuffer(e){const t=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}getString(e){let t=[];for(let r=0;r<e;r++)t[r]=this.getUint8();const n=t.indexOf(0);return n>=0&&(t=t.slice(0,n)),pr.decodeText(new Uint8Array(t))}}class FR{add(e,t){this[e]=t}}function R6(i){const e="Kaydara FBX Binary  \0";return i.byteLength>=e.length&&e===zR(i,0,e.length)}function L6(i){const e=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];let t=0;function n(r){const s=i[r-1];return i=i.slice(t+r),t++,s}for(let r=0;r<e.length;++r)if(n(1)===e[r])return!1;return!0}function rA(i){const e=/FBXVersion: (\d+)/,t=i.match(e);if(t)return parseInt(t[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function k6(i){return i/46186158e3}const I6=[];function Dm(i,e,t,n){let r;switch(n.mappingType){case"ByPolygonVertex":r=i;break;case"ByPolygon":r=e;break;case"ByVertice":r=t;break;case"AllSame":r=n.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+n.mappingType)}n.referenceType==="IndexToDirect"&&(r=n.indices[r]);const s=r*n.dataSize,o=s+n.dataSize;return D6(I6,n.buffer,s,o)}const ix=new Et,Fc=new B;function DR(i){const e=new st,t=new st,n=new st,r=new st,s=new st,o=new st,a=new st,c=new st,h=new st,d=new st,l=new st,u=new st,p=i.inheritType?i.inheritType:0;if(i.translation&&e.setPosition(Fc.fromArray(i.translation)),i.preRotation){const F=i.preRotation.map(Pr.degToRad);F.push(i.eulerOrder),t.makeRotationFromEuler(ix.fromArray(F))}if(i.rotation){const F=i.rotation.map(Pr.degToRad);F.push(i.eulerOrder),n.makeRotationFromEuler(ix.fromArray(F))}if(i.postRotation){const F=i.postRotation.map(Pr.degToRad);F.push(i.eulerOrder),r.makeRotationFromEuler(ix.fromArray(F)),r.invert()}i.scale&&s.scale(Fc.fromArray(i.scale)),i.scalingOffset&&a.setPosition(Fc.fromArray(i.scalingOffset)),i.scalingPivot&&o.setPosition(Fc.fromArray(i.scalingPivot)),i.rotationOffset&&c.setPosition(Fc.fromArray(i.rotationOffset)),i.rotationPivot&&h.setPosition(Fc.fromArray(i.rotationPivot)),i.parentMatrixWorld&&(l.copy(i.parentMatrix),d.copy(i.parentMatrixWorld));const g=t.clone().multiply(n).multiply(r),y=new st;y.extractRotation(d);const x=new st;x.copyPosition(d);const v=x.clone().invert().multiply(d),w=y.clone().invert().multiply(v),S=s,b=new st;if(p===0)b.copy(y).multiply(g).multiply(w).multiply(S);else if(p===1)b.copy(y).multiply(w).multiply(g).multiply(S);else{const C=new st().scale(new B().setFromMatrixScale(l)).clone().invert(),O=w.clone().multiply(C);b.copy(y).multiply(g).multiply(O).multiply(S)}const E=h.clone().invert(),R=o.clone().invert();let z=e.clone().multiply(c).multiply(h).multiply(t).multiply(n).multiply(r).multiply(E).multiply(a).multiply(o).multiply(s).multiply(R);const I=new st().copyPosition(z),N=d.clone().multiply(I);return u.copyPosition(N),z=u.clone().multiply(b),z.premultiply(d.invert()),z}function BR(i){i=i||0;const e=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return i===6?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),e[0]):e[i]}function rx(i){return i.split(",").map(function(t){return parseFloat(t)})}function zR(i,e,t){return e===void 0&&(e=0),t===void 0&&(t=i.byteLength),pr.decodeText(new Uint8Array(i,e,t))}function F6(i,e){for(let t=0,n=i.length,r=e.length;t<r;t++,n++)i[n]=e[t]}function D6(i,e,t,n){for(let r=t,s=0;r<n;r++,s++)i[s]=e[r];return i}function sA(i,e,t){return i.slice(0,e).concat(t).concat(i.slice(e))}const sx=new WeakMap;class oA extends Ei{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,n,r){const s=new er(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,o=>{const a={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(o,a).then(t).catch(r)},n,r)}decodeDracoFile(e,t,n,r){const s={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!n};this.decodeGeometry(e,s).then(t)}decodeGeometry(e,t){for(const c in t.attributeTypes){const h=t.attributeTypes[c];h.BYTES_PER_ELEMENT!==void 0&&(t.attributeTypes[c]=h.name)}const n=JSON.stringify(t);if(sx.has(e)){const c=sx.get(e);if(c.key===n)return c.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let r;const s=this.workerNextTaskID++,o=e.byteLength,a=this._getWorker(s,o).then(c=>(r=c,new Promise((h,d)=>{r._callbacks[s]={resolve:h,reject:d},r.postMessage({type:"decode",id:s,taskConfig:t,buffer:e},[e])}))).then(c=>this._createGeometry(c.geometry));return a.catch(()=>!0).then(()=>{r&&s&&this._releaseTask(r,s)}),sx.set(e,{key:n,promise:a}),a}_createGeometry(e){const t=new vt;e.index&&t.setIndex(new zt(e.index.array,1));for(let n=0;n<e.attributes.length;n++){const r=e.attributes[n],s=r.name,o=r.array,a=r.itemSize;t.setAttribute(s,new zt(o,a))}return t}_loadLibrary(e,t){const n=new er(this.manager);return n.setPath(this.decoderPath),n.setResponseType(t),n.setWithCredentials(this.withCredentials),new Promise((r,s)=>{n.load(e,r,void 0,s)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(n=>{const r=n[0];e||(this.decoderConfig.wasmBinary=n[1]);const s=B6.toString(),o=["/* draco decoder */",r,"","/* worker */",s.substring(s.indexOf("{")+1,s.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([o]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const r=new Worker(this.workerSourceURL);r._callbacks={},r._taskCosts={},r._taskLoad=0,r.postMessage({type:"init",decoderConfig:this.decoderConfig}),r.onmessage=function(s){const o=s.data;switch(o.type){case"decode":r._callbacks[o.id].resolve(o);break;case"error":r._callbacks[o.id].reject(o);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+o.type+'"')}},this.workerPool.push(r)}else this.workerPool.sort(function(r,s){return r._taskLoad>s._taskLoad?-1:1});const n=this.workerPool[this.workerPool.length-1];return n._taskCosts[e]=t,n._taskLoad+=t,n})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function B6(){let i,e;onmessage=function(o){const a=o.data;switch(a.type){case"init":i=a.decoderConfig,e=new Promise(function(d){i.onModuleLoaded=function(l){d({draco:l})},DracoDecoderModule(i)});break;case"decode":const c=a.buffer,h=a.taskConfig;e.then(d=>{const l=d.draco,u=new l.Decoder,p=new l.DecoderBuffer;p.Init(new Int8Array(c),c.byteLength);try{const g=t(l,u,p,h),y=g.attributes.map(x=>x.array.buffer);g.index&&y.push(g.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:g},y)}catch(g){console.error(g),self.postMessage({type:"error",id:a.id,error:g.message})}finally{l.destroy(p),l.destroy(u)}});break}};function t(o,a,c,h){const d=h.attributeIDs,l=h.attributeTypes;let u,p;const g=a.GetEncodedGeometryType(c);if(g===o.TRIANGULAR_MESH)u=new o.Mesh,p=a.DecodeBufferToMesh(c,u);else if(g===o.POINT_CLOUD)u=new o.PointCloud,p=a.DecodeBufferToPointCloud(c,u);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!p.ok()||u.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+p.error_msg());const y={index:null,attributes:[]};for(const x in d){const v=self[l[x]];let w,S;if(h.useUniqueIDs)S=d[x],w=a.GetAttributeByUniqueId(u,S);else{if(S=a.GetAttributeId(u,o[d[x]]),S===-1)continue;w=a.GetAttribute(u,S)}y.attributes.push(r(o,a,u,x,v,w))}return g===o.TRIANGULAR_MESH&&(y.index=n(o,a,u)),o.destroy(u),y}function n(o,a,c){const d=c.num_faces()*3,l=d*4,u=o._malloc(l);a.GetTrianglesUInt32Array(c,l,u);const p=new Uint32Array(o.HEAPF32.buffer,u,d).slice();return o._free(u),{array:p,itemSize:1}}function r(o,a,c,h,d,l){const u=l.num_components(),g=c.num_points()*u,y=g*d.BYTES_PER_ELEMENT,x=s(o,d),v=o._malloc(y);a.GetAttributeDataArrayForAllPoints(c,l,x,y,v);const w=new d(o.HEAPF32.buffer,v,g).slice();return o._free(v),{name:h,array:w,itemSize:u}}function s(o,a){switch(a){case Float32Array:return o.DT_FLOAT32;case Int8Array:return o.DT_INT8;case Int16Array:return o.DT_INT16;case Int32Array:return o.DT_INT32;case Uint8Array:return o.DT_UINT8;case Uint16Array:return o.DT_UINT16;case Uint32Array:return o.DT_UINT32}}}class z6 extends ec{constructor(){super(),this.setLoaders(),this.toLoad=0,this.loaded=0,this.items={}}setLoaders(){this.loaders=[],this.loaders.push({extensions:["jpg","png"],action:r=>{const s=new Image;s.addEventListener("load",()=>{this.fileLoadEnd(r,s)}),s.addEventListener("error",()=>{this.fileLoadEnd(r,s)}),s.src=r.source}});const e=new oA;e.setDecoderPath("draco/"),e.setDecoderConfig({type:"js"}),this.loaders.push({extensions:["drc"],action:r=>{e.load(r.source,s=>{this.fileLoadEnd(r,s),oA.releaseDecoderModule()})}});const t=new bV;t.setDRACOLoader(e),this.loaders.push({extensions:["glb","gltf"],action:r=>{t.load(r.source,s=>{this.fileLoadEnd(r,s)})}});const n=new M6;this.loaders.push({extensions:["fbx"],action:r=>{n.load(r.source,s=>{this.fileLoadEnd(r,s)})}})}load(e=[]){for(const t of e)if(this.toLoad++,typeof t.source=="string"){let n=null;if(t.source.indexOf("data:")===0){const r=Math.max(t.source.indexOf(";"),t.source.indexOf(",")),s=t.source.substring(5,r>-1?r:void 0);if(s&&s.indexOf("/")!==-1){const[o,a]=s.split("/");o==="image"?n=a==="jpeg"?"jpg":a:s==="model/gltf-binary"?n="glb":s==="model/gltf+json"&&(n="gltf")}}else{const r=t.source.match(/\.([a-z]+)$/i);r&&typeof r[1]!="undefined"&&(n=r[1].toLowerCase())}if(n){const r=this.loaders.find(s=>s.extensions.find(o=>o===n));r?r.action(t):console.warn(`Cannot find loader for resource source: ${t.source} (mapped extension: ${n})`)}else console.warn(`Cannot find extension for resource source: ${t.source}`)}else try{console.warn(`Invalid or missing source for resource: ${JSON.stringify(t)}`)}catch{console.warn("Invalid or missing source for resource (unserializable object)",t)}}fileLoadEnd(e,t){this.loaded++,this.items[e.name]=t,this.trigger("fileEnd",[e,t]),this.loaded===this.toLoad&&this.trigger("end")}}var O6="./assets/beige.8121e9c0.png",N6="./assets/black.e8d7b515.png",U6="./assets/orange.fb34f224.png",H6="./assets/red.ff643615.png",V6="./assets/white.e347e7e5.png",G6="./assets/green.4c4c3f67.png",W6="./assets/brown.2c37f8b8.png",j6="./assets/gray.817aef5b.png",X6="./assets/emeraldGreen.25072a88.png",q6="./assets/purple.f4781d8c.png",Y6="./assets/blue.1b6b2fc5.png",$6="./assets/yellow.20eeafd6.png",Q6="./assets/metal.e28b3ed1.png",Z6="./assets/base.ecaff711.glb",K6="./assets/collision.c993f6c6.glb",J6="./assets/floorShadow.8955520b.png",eG="./assets/labels.dde7eda4.glb",tG="./assets/arrows.64f1fe95.png",nG="./assets/controls.d13d237b.png",iG="./assets/other.fdb5a96d.png",rG="./assets/base.7a894c6a.glb",sG="./assets/collision.239bd890.glb",oG="./assets/base.5312df74.glb",aG="./assets/base.5312df74.glb",lG="./assets/collision.041980d3.glb",cG="./assets/collision.041980d3.glb",uG="./assets/base.3f797b66.glb",hG="./assets/base.3f797b66.glb",dG="./assets/base.ac8afcde.glb",fG="./assets/base.ac8afcde.glb",pG="./assets/collision.7863d079.glb",mG="./assets/collision.7863d079.glb",gG="./assets/base.38b27a97.glb",vG="./assets/base.38b27a97.glb",yG="./assets/collision.34d1e39b.glb",xG="./assets/collision.34d1e39b.glb",wG="./assets/collision.c0fad730.glb",_G="./assets/collision.c0fad730.glb",SG="./assets/base.48f4ccd9.glb",bG="./assets/base.48f4ccd9.glb",MG="./assets/base.4a6c4942.glb",EG="./assets/base.4a6c4942.glb",TG="./assets/floorShadow.d50f2913.png",AG="./assets/base.7d54e0b2.glb",CG="./assets/collision.90d13905.glb",PG="./assets/chassis.b021cf81.glb",RG="./assets/wheel.7f9dc25b.glb",LG="./assets/backLightsBrake.72c8bf5a.glb",kG="./assets/backLightsReverse.1ccab371.glb",IG="./assets/antena.bd96c4d3.glb",FG="./assets/chassis.490a4957.glb",DG="./assets/wheel.78e995a2.glb",BG="./assets/backLightsBrake.6adb222e.glb",zG="./assets/backLightsReverse.4daf4530.glb",OG="./assets/antena.c59c22cc.glb",NG="./assets/structure.6f2df84c.glb",UG="./assets/collision.e1ddb325.glb",HG="./assets/floorShadow.410d4fd5.png",VG="./assets/plane.de80bf8e.glb",GG="./assets/base.a58d09f1.glb",WG="./assets/collision.1ee15a0d.glb",jG="./assets/base.ac8cf42a.glb",XG="./assets/collision.052936c0.glb",qG="./assets/base.c4db4f51.glb",YG="./assets/collision.280c97e3.glb",$G="./assets/floorTexture.ef3c4fa7.png",QG="./assets/floorTexture.2b32d915.png",ZG="./assets/floorTexture.946adccd.png",KG="./assets/floorTexture.b7e92932.png",JG="./assets/floorTexture.a4c1c6a4.png",eW="./assets/floorTexture.74ed9c0f.png",tW="./assets/floorTexture.f84b24a9.png",nW="./assets/floorTexture.d5430a5b.png",iW="./assets/floorTexture.4e5477e3.png",rW="./assets/base.b9531c73.glb",sW="./assets/collision.918df174.glb",oW="./assets/floorShadow.99df3cd0.png",aW="./assets/base.ec4d1ae6.glb",lW="./assets/collision.ee2ee759.glb",cW="./assets/contactTwitterLabel.2624e98a.png",uW="./assets/contactGithubLabel.05cb95f3.png",hW="./assets/contactLinkedinLabel.0273cb5f.png",dW="./assets/contactMailLabel.1eb0ae16.png",fW="./assets/activities.8afc75fd.png",pW="./assets/floorShadow.bef033c2.png",mW="./assets/base.356e2290.glb",gW="./assets/collision.e49bc444.glb",vW="./assets/base.76dc992c.glb",yW="./assets/collision.d6770d90.glb",xW="./assets/base.4a22728b.glb",wW="./assets/collision.63bddd19.glb",_W="./assets/base.8b4e38f9.glb",SW="./assets/collision.2636a780.glb",bW="./assets/base.fe517e4b.glb",MW="./assets/collision.1f6855ad.glb",EW="./assets/base.3504980e.glb",TW="./assets/collision.a7f3be0e.glb",AW="./assets/base.696213eb.glb",CW="./assets/collision.a72dc9d0.glb",PW="./assets/keyEnter.6653c47c.png",RW="./assets/enter.f1a5f8de.png",LW="./assets/open.c41bfc0a.png",kW="./assets/reset.2e5dd4c2.png",IW="./assets/questionMark.99add929.png",FW="./assets/base.61eea99d.glb",DW="./assets/collision.a80debf6.glb",BW="./assets/base.a77ac271.glb",zW="./assets/collision.e856b6b4.glb",OW="./assets/base.7cbee42c.glb",NW="./assets/collision.083f849f.glb",UW="./assets/base.2e10d746.glb",HW="./assets/collision.a5fcae28.glb",VW="./assets/base.0a1704df.glb",GW="./assets/collision.de60f629.glb",WW="./assets/label.71f4f239.png",jW="./assets/label-touch.5dbb6974.png",XW="./assets/wig1.68912d72.glb",qW="./assets/wig2.50ac1584.glb",YW="./assets/wig3.fee96721.glb",$W="./assets/wig4.91f94913.glb";class QW extends ec{constructor(){super(),this.loader=new z6,this.items={},this.loader.load([{name:"matcapBeige",source:O6,type:"texture"},{name:"matcapBlack",source:N6,type:"texture"},{name:"matcapOrange",source:U6,type:"texture"},{name:"matcapRed",source:H6,type:"texture"},{name:"matcapWhite",source:V6,type:"texture"},{name:"matcapGreen",source:G6,type:"texture"},{name:"matcapBrown",source:W6,type:"texture"},{name:"matcapGray",source:j6,type:"texture"},{name:"matcapEmeraldGreen",source:X6,type:"texture"},{name:"matcapPurple",source:q6,type:"texture"},{name:"matcapBlue",source:Y6,type:"texture"},{name:"matcapYellow",source:$6,type:"texture"},{name:"matcapMetal",source:Q6,type:"texture"},{name:"introStaticBase",source:Z6},{name:"introStaticCollision",source:K6},{name:"introStaticFloorShadow",source:J6,type:"texture"},{name:"introInstructionsLabels",source:eG},{name:"introInstructionsArrows",source:tG,type:"texture"},{name:"introInstructionsControls",source:nG,type:"texture"},{name:"introInstructionsOther",source:iG,type:"texture"},{name:"introArrowKeyBase",source:rG},{name:"introArrowKeyCollision",source:sG},{name:"introBBase",source:oG},{name:"introBCollision",source:aG},{name:"introRBase",source:lG},{name:"introRCollision",source:cG},{name:"introUBase",source:uG},{name:"introUCollision",source:hG},{name:"introNBase",source:dG},{name:"introNCollision",source:fG},{name:"introOBase",source:pG},{name:"introOCollision",source:mG},{name:"introSBase",source:gG},{name:"introSCollision",source:vG},{name:"introIBase",source:yG},{name:"introICollision",source:xG},{name:"introMBase",source:wG},{name:"introMCollision",source:_G},{name:"introCreativeBase",source:SG},{name:"introCreativeCollision",source:bG},{name:"introDevBase",source:MG},{name:"introDevCollision",source:EG},{name:"crossroadsStaticBase",source:AG},{name:"crossroadsStaticCollision",source:CG},{name:"crossroadsStaticFloorShadow",source:TG,type:"texture"},{name:"carDefaultChassis",source:PG},{name:"carDefaultWheel",source:RG},{name:"carDefaultBackLightsBrake",source:LG},{name:"carDefaultBackLightsReverse",source:kG},{name:"carDefaultAntena",source:IG},{name:"carCyberTruckChassis",source:FG},{name:"carCyberTruckWheel",source:DG},{name:"carCyberTruckBackLightsBrake",source:BG},{name:"carCyberTruckBackLightsReverse",source:zG},{name:"carCyberTruckAntena",source:OG},{name:"projectsBoardStructure",source:NG},{name:"projectsBoardCollision",source:UG},{name:"projectsBoardStructureFloorShadow",source:HG,type:"texture"},{name:"projectsBoardPlane",source:VG},{name:"projectsDistinctionsAwwwardsBase",source:GG},{name:"projectsDistinctionsAwwwardsCollision",source:WG},{name:"projectsDistinctionsFWABase",source:jG},{name:"projectsDistinctionsFWACollision",source:XG},{name:"projectsDistinctionsCSSDABase",source:qG},{name:"projectsDistinctionsCSSDACollision",source:YG},{name:"projectsThreejsJourneyFloor",source:$G,type:"texture"},{name:"projectsMadboxFloor",source:QG,type:"texture"},{name:"projectsScoutFloor",source:ZG,type:"texture"},{name:"projectsChartogneFloor",source:KG,type:"texture"},{name:"projectsZenlyFloor",source:JG,type:"texture"},{name:"projectsCitrixRedbullFloor",source:eW,type:"texture"},{name:"projectsPriorHoldingsFloor",source:tW,type:"texture"},{name:"projectsOranoFloor",source:nW,type:"texture"},{name:"projectsKepplerFloor",source:iW,type:"texture"},{name:"informationStaticBase",source:rW},{name:"informationStaticCollision",source:sW},{name:"informationStaticFloorShadow",source:oW,type:"texture"},{name:"informationBaguetteBase",source:aW},{name:"informationBaguetteCollision",source:lW},{name:"informationContactTwitterLabel",source:cW,type:"texture"},{name:"informationContactGithubLabel",source:uW,type:"texture"},{name:"informationContactLinkedinLabel",source:hW,type:"texture"},{name:"informationContactMailLabel",source:dW,type:"texture"},{name:"informationActivities",source:fW,type:"texture"},{name:"playgroundStaticBase",source:mW},{name:"playgroundStaticCollision",source:gW},{name:"playgroundStaticFloorShadow",source:pW,type:"texture"},{name:"brickBase",source:vW},{name:"brickCollision",source:yW},{name:"hornBase",source:xW},{name:"hornCollision",source:wW},{name:"webbyTrophyBase",source:_W},{name:"webbyTrophyCollision",source:SW},{name:"lemonBase",source:bW},{name:"lemonCollision",source:MW},{name:"bowlingBallBase",source:EW},{name:"bowlingBallCollision",source:TW},{name:"bowlingPinBase",source:AW},{name:"bowlingPinCollision",source:CW},{name:"areaKeyEnter",source:PW,type:"texture"},{name:"areaEnter",source:RW,type:"texture"},{name:"areaOpen",source:LW,type:"texture"},{name:"areaReset",source:kW,type:"texture"},{name:"areaQuestionMark",source:IW,type:"texture"},{name:"tilesABase",source:FW},{name:"tilesACollision",source:DW},{name:"tilesBBase",source:BW},{name:"tilesBCollision",source:zW},{name:"tilesCBase",source:OW},{name:"tilesCCollision",source:NW},{name:"tilesDBase",source:UW},{name:"tilesDCollision",source:HW},{name:"tilesEBase",source:VW},{name:"tilesECollision",source:GW},{name:"konamiLabel",source:WW,type:"texture"},{name:"konamiLabelTouch",source:jW,type:"texture"},{name:"wig1",source:XW},{name:"wig2",source:qW},{name:"wig3",source:YW},{name:"wig4",source:$W}]),this.loader.on("fileEnd",(e,t)=>{if(this.items[e.name]=t,e.type==="texture"){const n=new hn(t);n.needsUpdate=!0,this.items[`${e.name}Texture`]=n}this.trigger("progress",[this.loader.loaded/this.loader.toLoad])}),this.loader.on("end",()=>{this.trigger("ready")})}}const aA={type:"change"},ox={type:"start"},lA={type:"end"};class ZW extends Bo{constructor(e,t){super(),t===void 0&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),t===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new B,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:Ar.ROTATE,MIDDLE:Ar.DOLLY,RIGHT:Ar.PAN},this.touches={ONE:Cr.ROTATE,TWO:Cr.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return a.phi},this.getAzimuthalAngle=function(){return a.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(G){G.addEventListener("keydown",V),this._domElementKeyEvents=G},this.saveState=function(){n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=function(){n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(aA),n.update(),s=r.NONE},this.update=function(){const G=new B,Ae=new qt().setFromUnitVectors(e.up,new B(0,1,0)),Fe=Ae.clone().invert(),Ve=new B,oe=new qt,Ne=2*Math.PI;return function(){const ae=n.object.position;G.copy(ae).sub(n.target),G.applyQuaternion(Ae),a.setFromVector3(G),n.autoRotate&&s===r.NONE&&N(z()),n.enableDamping?(a.theta+=c.theta*n.dampingFactor,a.phi+=c.phi*n.dampingFactor):(a.theta+=c.theta,a.phi+=c.phi);let Te=n.minAzimuthAngle,Ge=n.maxAzimuthAngle;return isFinite(Te)&&isFinite(Ge)&&(Te<-Math.PI?Te+=Ne:Te>Math.PI&&(Te-=Ne),Ge<-Math.PI?Ge+=Ne:Ge>Math.PI&&(Ge-=Ne),Te<=Ge?a.theta=Math.max(Te,Math.min(Ge,a.theta)):a.theta=a.theta>(Te+Ge)/2?Math.max(Te,a.theta):Math.min(Ge,a.theta)),a.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,a.phi)),a.makeSafe(),a.radius*=h,a.radius=Math.max(n.minDistance,Math.min(n.maxDistance,a.radius)),n.enableDamping===!0?n.target.addScaledVector(d,n.dampingFactor):n.target.add(d),G.setFromSpherical(a),G.applyQuaternion(Fe),ae.copy(n.target).add(G),n.object.lookAt(n.target),n.enableDamping===!0?(c.theta*=1-n.dampingFactor,c.phi*=1-n.dampingFactor,d.multiplyScalar(1-n.dampingFactor)):(c.set(0,0,0),d.set(0,0,0)),h=1,l||Ve.distanceToSquared(n.object.position)>o||8*(1-oe.dot(n.object.quaternion))>o?(n.dispatchEvent(aA),Ve.copy(n.object.position),oe.copy(n.object.quaternion),l=!1,!0):!1}}(),this.dispose=function(){n.domElement.removeEventListener("contextmenu",q),n.domElement.removeEventListener("pointerdown",we),n.domElement.removeEventListener("pointercancel",it),n.domElement.removeEventListener("wheel",L),n.domElement.removeEventListener("pointermove",ye),n.domElement.removeEventListener("pointerup",_e),n._domElementKeyEvents!==null&&n._domElementKeyEvents.removeEventListener("keydown",V)};const n=this,r={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let s=r.NONE;const o=1e-6,a=new Zd,c=new Zd;let h=1;const d=new B;let l=!1;const u=new Me,p=new Me,g=new Me,y=new Me,x=new Me,v=new Me,w=new Me,S=new Me,b=new Me,E=[],R={};function z(){return 2*Math.PI/60/60*n.autoRotateSpeed}function I(){return Math.pow(.95,n.zoomSpeed)}function N(G){c.theta-=G}function F(G){c.phi-=G}const C=function(){const G=new B;return function(Fe,Ve){G.setFromMatrixColumn(Ve,0),G.multiplyScalar(-Fe),d.add(G)}}(),O=function(){const G=new B;return function(Fe,Ve){n.screenSpacePanning===!0?G.setFromMatrixColumn(Ve,1):(G.setFromMatrixColumn(Ve,0),G.crossVectors(n.object.up,G)),G.multiplyScalar(Fe),d.add(G)}}(),X=function(){const G=new B;return function(Fe,Ve){const oe=n.domElement;if(n.object.isPerspectiveCamera){const Ne=n.object.position;G.copy(Ne).sub(n.target);let Je=G.length();Je*=Math.tan(n.object.fov/2*Math.PI/180),C(2*Fe*Je/oe.clientHeight,n.object.matrix),O(2*Ve*Je/oe.clientHeight,n.object.matrix)}else n.object.isOrthographicCamera?(C(Fe*(n.object.right-n.object.left)/n.object.zoom/oe.clientWidth,n.object.matrix),O(Ve*(n.object.top-n.object.bottom)/n.object.zoom/oe.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}}();function U(G){n.object.isPerspectiveCamera?h/=G:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom*G)),n.object.updateProjectionMatrix(),l=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function te(G){n.object.isPerspectiveCamera?h*=G:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/G)),n.object.updateProjectionMatrix(),l=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function ne(G){u.set(G.clientX,G.clientY)}function j(G){w.set(G.clientX,G.clientY)}function k(G){y.set(G.clientX,G.clientY)}function W(G){p.set(G.clientX,G.clientY),g.subVectors(p,u).multiplyScalar(n.rotateSpeed);const Ae=n.domElement;N(2*Math.PI*g.x/Ae.clientHeight),F(2*Math.PI*g.y/Ae.clientHeight),u.copy(p),n.update()}function Y(G){S.set(G.clientX,G.clientY),b.subVectors(S,w),b.y>0?U(I()):b.y<0&&te(I()),w.copy(S),n.update()}function H(G){x.set(G.clientX,G.clientY),v.subVectors(x,y).multiplyScalar(n.panSpeed),X(v.x,v.y),y.copy(x),n.update()}function J(G){G.deltaY<0?te(I()):G.deltaY>0&&U(I()),n.update()}function K(G){let Ae=!1;switch(G.code){case n.keys.UP:X(0,n.keyPanSpeed),Ae=!0;break;case n.keys.BOTTOM:X(0,-n.keyPanSpeed),Ae=!0;break;case n.keys.LEFT:X(n.keyPanSpeed,0),Ae=!0;break;case n.keys.RIGHT:X(-n.keyPanSpeed,0),Ae=!0;break}Ae&&(G.preventDefault(),n.update())}function ee(){if(E.length===1)u.set(E[0].pageX,E[0].pageY);else{const G=.5*(E[0].pageX+E[1].pageX),Ae=.5*(E[0].pageY+E[1].pageY);u.set(G,Ae)}}function $(){if(E.length===1)y.set(E[0].pageX,E[0].pageY);else{const G=.5*(E[0].pageX+E[1].pageX),Ae=.5*(E[0].pageY+E[1].pageY);y.set(G,Ae)}}function Z(){const G=E[0].pageX-E[1].pageX,Ae=E[0].pageY-E[1].pageY,Fe=Math.sqrt(G*G+Ae*Ae);w.set(0,Fe)}function Ee(){n.enableZoom&&Z(),n.enablePan&&$()}function Se(){n.enableZoom&&Z(),n.enableRotate&&ee()}function de(G){if(E.length==1)p.set(G.pageX,G.pageY);else{const Fe=be(G),Ve=.5*(G.pageX+Fe.x),oe=.5*(G.pageY+Fe.y);p.set(Ve,oe)}g.subVectors(p,u).multiplyScalar(n.rotateSpeed);const Ae=n.domElement;N(2*Math.PI*g.x/Ae.clientHeight),F(2*Math.PI*g.y/Ae.clientHeight),u.copy(p)}function he(G){if(E.length===1)x.set(G.pageX,G.pageY);else{const Ae=be(G),Fe=.5*(G.pageX+Ae.x),Ve=.5*(G.pageY+Ae.y);x.set(Fe,Ve)}v.subVectors(x,y).multiplyScalar(n.panSpeed),X(v.x,v.y),y.copy(x)}function Ce(G){const Ae=be(G),Fe=G.pageX-Ae.x,Ve=G.pageY-Ae.y,oe=Math.sqrt(Fe*Fe+Ve*Ve);S.set(0,oe),b.set(0,Math.pow(S.y/w.y,n.zoomSpeed)),U(b.y),w.copy(S)}function me(G){n.enableZoom&&Ce(G),n.enablePan&&he(G)}function fe(G){n.enableZoom&&Ce(G),n.enableRotate&&de(G)}function we(G){n.enabled!==!1&&(E.length===0&&(n.domElement.setPointerCapture(G.pointerId),n.domElement.addEventListener("pointermove",ye),n.domElement.addEventListener("pointerup",_e)),re(G),G.pointerType==="touch"?P(G):$e(G))}function ye(G){n.enabled!==!1&&(G.pointerType==="touch"?T(G):et(G))}function _e(G){pe(G),E.length===0&&(n.domElement.releasePointerCapture(G.pointerId),n.domElement.removeEventListener("pointermove",ye),n.domElement.removeEventListener("pointerup",_e)),n.dispatchEvent(lA),s=r.NONE}function it(G){pe(G)}function $e(G){let Ae;switch(G.button){case 0:Ae=n.mouseButtons.LEFT;break;case 1:Ae=n.mouseButtons.MIDDLE;break;case 2:Ae=n.mouseButtons.RIGHT;break;default:Ae=-1}switch(Ae){case Ar.DOLLY:if(n.enableZoom===!1)return;j(G),s=r.DOLLY;break;case Ar.ROTATE:if(G.ctrlKey||G.metaKey||G.shiftKey){if(n.enablePan===!1)return;k(G),s=r.PAN}else{if(n.enableRotate===!1)return;ne(G),s=r.ROTATE}break;case Ar.PAN:if(G.ctrlKey||G.metaKey||G.shiftKey){if(n.enableRotate===!1)return;ne(G),s=r.ROTATE}else{if(n.enablePan===!1)return;k(G),s=r.PAN}break;default:s=r.NONE}s!==r.NONE&&n.dispatchEvent(ox)}function et(G){if(n.enabled!==!1)switch(s){case r.ROTATE:if(n.enableRotate===!1)return;W(G);break;case r.DOLLY:if(n.enableZoom===!1)return;Y(G);break;case r.PAN:if(n.enablePan===!1)return;H(G);break}}function L(G){n.enabled===!1||n.enableZoom===!1||s!==r.NONE||(G.preventDefault(),n.dispatchEvent(ox),J(G),n.dispatchEvent(lA))}function V(G){n.enabled===!1||n.enablePan===!1||K(G)}function P(G){switch(ge(G),E.length){case 1:switch(n.touches.ONE){case Cr.ROTATE:if(n.enableRotate===!1)return;ee(),s=r.TOUCH_ROTATE;break;case Cr.PAN:if(n.enablePan===!1)return;$(),s=r.TOUCH_PAN;break;default:s=r.NONE}break;case 2:switch(n.touches.TWO){case Cr.DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;Ee(),s=r.TOUCH_DOLLY_PAN;break;case Cr.DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;Se(),s=r.TOUCH_DOLLY_ROTATE;break;default:s=r.NONE}break;default:s=r.NONE}s!==r.NONE&&n.dispatchEvent(ox)}function T(G){switch(ge(G),s){case r.TOUCH_ROTATE:if(n.enableRotate===!1)return;de(G),n.update();break;case r.TOUCH_PAN:if(n.enablePan===!1)return;he(G),n.update();break;case r.TOUCH_DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;me(G),n.update();break;case r.TOUCH_DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;fe(G),n.update();break;default:s=r.NONE}}function q(G){n.enabled!==!1&&G.preventDefault()}function re(G){E.push(G)}function pe(G){delete R[G.pointerId];for(let Ae=0;Ae<E.length;Ae++)if(E[Ae].pointerId==G.pointerId){E.splice(Ae,1);return}}function ge(G){let Ae=R[G.pointerId];Ae===void 0&&(Ae=new Me,R[G.pointerId]=Ae),Ae.set(G.pageX,G.pageY)}function be(G){const Ae=G.pointerId===E[0].pointerId?E[1]:E[0];return R[Ae.pointerId]}n.domElement.addEventListener("contextmenu",q),n.domElement.addEventListener("pointerdown",we),n.domElement.addEventListener("pointercancel",it),n.domElement.addEventListener("wheel",L,{passive:!1}),this.update()}}class KW{constructor(e){this.time=e.time,this.sizes=e.sizes,this.renderer=e.renderer,this.debug=e.debug,this.config=e.config,this.container=new ft,this.container.matrixAutoUpdate=!1,this.target=new B(0,0,0),this.targetEased=new B(0,0,0),this.easing=.15,this.debug&&(this.debugFolder=this.debug.addFolder("camera")),this.setAngle(),this.setInstance(),this.setZoom(),this.setPan(),this.setOrbitControls()}setAngle(){this.angle={},this.angle.items={default:new B(1.135,-1.45,1.15),projects:new B(.38,-1.4,1.63)},this.angle.value=new B,this.angle.value.copy(this.angle.items.default),this.angle.set=e=>{const t=this.angle.items[e];typeof t!="undefined"&&Ct.to(this.angle.value,2,{...t,ease:JU.easeInOut})},this.debug&&(this.debugFolder.add(this,"easing").step(1e-4).min(0).max(1).name("easing"),this.debugFolder.add(this.angle.value,"x").step(.001).min(-2).max(2).name("invertDirectionX").listen(),this.debugFolder.add(this.angle.value,"y").step(.001).min(-2).max(2).name("invertDirectionY").listen(),this.debugFolder.add(this.angle.value,"z").step(.001).min(-2).max(2).name("invertDirectionZ").listen())}setInstance(){this.instance=new Mn(40,this.sizes.viewport.width/this.sizes.viewport.height,1,80),this.instance.up.set(0,0,1),this.instance.position.copy(this.angle.value),this.instance.lookAt(new B),this.container.add(this.instance),this.sizes.on("resize",()=>{this.instance.aspect=this.sizes.viewport.width/this.sizes.viewport.height,this.instance.updateProjectionMatrix()}),this.time.on("tick",()=>{this.orbitControls.enabled||(this.targetEased.x+=(this.target.x-this.targetEased.x)*this.easing,this.targetEased.y+=(this.target.y-this.targetEased.y)*this.easing,this.targetEased.z+=(this.target.z-this.targetEased.z)*this.easing,this.instance.position.copy(this.targetEased).add(this.angle.value.clone().normalize().multiplyScalar(this.zoom.distance)),this.instance.lookAt(this.targetEased),this.instance.position.x+=this.pan.value.x,this.instance.position.y+=this.pan.value.y)})}setZoom(){this.zoom={},this.zoom.easing=.1,this.zoom.minDistance=14,this.zoom.amplitude=15,this.zoom.value=this.config.cyberTruck?.3:.5,this.zoom.targetValue=this.zoom.value,this.zoom.distance=this.zoom.minDistance+this.zoom.amplitude*this.zoom.value,document.addEventListener("mousewheel",e=>{this.zoom.targetValue+=e.deltaY*.001,this.zoom.targetValue=Math.min(Math.max(this.zoom.targetValue,0),1)},{passive:!0}),this.zoom.touch={},this.zoom.touch.startDistance=0,this.zoom.touch.startValue=0,this.renderer.domElement.addEventListener("touchstart",e=>{e.touches.length===2&&(this.zoom.touch.startDistance=Math.hypot(e.touches[0].clientX-e.touches[1].clientX,e.touches[0].clientX-e.touches[1].clientX),this.zoom.touch.startValue=this.zoom.targetValue)}),this.renderer.domElement.addEventListener("touchmove",e=>{if(e.touches.length===2){e.preventDefault();const n=Math.hypot(e.touches[0].clientX-e.touches[1].clientX,e.touches[0].clientX-e.touches[1].clientX)/this.zoom.touch.startDistance;this.zoom.targetValue=this.zoom.touch.startValue-(n-1),this.zoom.targetValue=Math.min(Math.max(this.zoom.targetValue,0),1)}}),this.time.on("tick",()=>{this.zoom.value+=(this.zoom.targetValue-this.zoom.value)*this.zoom.easing,this.zoom.distance=this.zoom.minDistance+this.zoom.amplitude*this.zoom.value})}setPan(){this.pan={},this.pan.enabled=!1,this.pan.active=!1,this.pan.easing=.1,this.pan.start={},this.pan.start.x=0,this.pan.start.y=0,this.pan.value={},this.pan.value.x=0,this.pan.value.y=0,this.pan.targetValue={},this.pan.targetValue.x=this.pan.value.x,this.pan.targetValue.y=this.pan.value.y,this.pan.raycaster=new _f,this.pan.mouse=new Me,this.pan.needsUpdate=!1,this.pan.hitMesh=new je(new xn(500,500,1,1),new Bt({color:16711680,wireframe:!0,visible:!1})),this.container.add(this.pan.hitMesh),this.pan.reset=()=>{this.pan.targetValue.x=0,this.pan.targetValue.y=0},this.pan.enable=()=>{this.pan.enabled=!0,this.renderer.domElement.classList.add("has-cursor-grab")},this.pan.disable=()=>{this.pan.enabled=!1,this.renderer.domElement.classList.remove("has-cursor-grab")},this.pan.down=(e,t)=>{if(!this.pan.enabled)return;this.renderer.domElement.classList.add("has-cursor-grabbing"),this.pan.active=!0,this.pan.mouse.x=e/this.sizes.viewport.width*2-1,this.pan.mouse.y=-(t/this.sizes.viewport.height)*2+1,this.pan.raycaster.setFromCamera(this.pan.mouse,this.instance);const n=this.pan.raycaster.intersectObjects([this.pan.hitMesh]);n.length&&(this.pan.start.x=n[0].point.x,this.pan.start.y=n[0].point.y)},this.pan.move=(e,t)=>{!this.pan.enabled||!this.pan.active||(this.pan.mouse.x=e/this.sizes.viewport.width*2-1,this.pan.mouse.y=-(t/this.sizes.viewport.height)*2+1,this.pan.needsUpdate=!0)},this.pan.up=()=>{this.pan.active=!1,this.renderer.domElement.classList.remove("has-cursor-grabbing")},window.addEventListener("mousedown",e=>{this.pan.down(e.clientX,e.clientY)}),window.addEventListener("mousemove",e=>{this.pan.move(e.clientX,e.clientY)}),window.addEventListener("mouseup",()=>{this.pan.up()}),this.renderer.domElement.addEventListener("touchstart",e=>{e.touches.length===1&&this.pan.down(e.touches[0].clientX,e.touches[0].clientY)}),this.renderer.domElement.addEventListener("touchmove",e=>{e.touches.length===1&&this.pan.move(e.touches[0].clientX,e.touches[0].clientY)}),this.renderer.domElement.addEventListener("touchend",()=>{this.pan.up()}),this.time.on("tick",()=>{if(this.pan.active&&this.pan.needsUpdate){this.pan.raycaster.setFromCamera(this.pan.mouse,this.instance);const e=this.pan.raycaster.intersectObjects([this.pan.hitMesh]);e.length&&(this.pan.targetValue.x=-(e[0].point.x-this.pan.start.x),this.pan.targetValue.y=-(e[0].point.y-this.pan.start.y)),this.pan.needsUpdate=!1}this.pan.value.x+=(this.pan.targetValue.x-this.pan.value.x)*this.pan.easing,this.pan.value.y+=(this.pan.targetValue.y-this.pan.value.y)*this.pan.easing})}setOrbitControls(){this.orbitControls=new ZW(this.instance,this.renderer.domElement),this.orbitControls.enabled=!1,this.orbitControls.enableKeys=!1,this.orbitControls.zoomSpeed=.5,this.debug&&this.debugFolder.add(this.orbitControls,"enabled").name("orbitControlsEnabled")}}class JW{constructor(e){if(this.config=e.config,this.time=e.time,this.world=e.world,this.$container=document.querySelector(".js-threejs-journey"),!this.$container){console.warn("ThreejsJourney: .js-threejs-journey not found. Aborting setup."),this.$messages=[],this.$yes=null,this.$no=null,this.step=0,this.maxStep=0,this.shown=!1;return}this.$messages=[...this.$container.querySelectorAll(".js-message")],this.$yes=this.$container.querySelector(".js-yes"),this.$no=this.$container.querySelector(".js-no"),this.step=0,this.maxStep=Math.max(0,this.$messages.length-1),this.seenCount=parseInt(window.localStorage.getItem("threejsJourneySeenCount")||"0",10),this.shown=!1,this.traveledDistance=0,this.minTraveledDistance=(this.config.debug?5:75)*(this.seenCount+1),this.prevent=!!window.localStorage.getItem("threejsJourneyPrevent"),this.config.debug&&this.start(),!this.prevent&&(this.setYesNo(),this.setLog(),this.time.on("tick",()=>{this.world.physics&&(this.traveledDistance+=this.world.physics.car.forwardSpeed,!this.config.touch&&!this.shown&&this.traveledDistance>this.minTraveledDistance&&this.start())}))}setYesNo(){this.$yes.addEventListener("click",()=>{Ct.delayedCall(2,()=>{this.hide()}),window.localStorage.setItem("threejsJourneyPrevent",1)}),this.$no.addEventListener("click",()=>{this.next(),Ct.delayedCall(5,()=>{this.hide()})}),this.$yes.addEventListener("mouseenter",()=>{this.$container.classList.remove("is-hover-none"),this.$container.classList.remove("is-hover-no"),this.$container.classList.add("is-hover-yes")}),this.$no.addEventListener("mouseenter",()=>{this.$container.classList.remove("is-hover-none"),this.$container.classList.add("is-hover-no"),this.$container.classList.remove("is-hover-yes")}),this.$yes.addEventListener("mouseleave",()=>{this.$container.classList.add("is-hover-none"),this.$container.classList.remove("is-hover-no"),this.$container.classList.remove("is-hover-yes")}),this.$no.addEventListener("mouseleave",()=>{this.$container.classList.add("is-hover-none"),this.$container.classList.remove("is-hover-no"),this.$container.classList.remove("is-hover-yes")})}setLog(){}hide(){for(const e of this.$messages)e.classList.remove("is-visible");Ct.delayedCall(.5,()=>{this.$container.classList.remove("is-active")})}start(){this.$container.classList.add("is-active"),window.requestAnimationFrame(()=>{this.next(),Ct.delayedCall(4,()=>{this.next()}),Ct.delayedCall(7,()=>{this.next()})}),this.shown=!0,window.localStorage.setItem("threejsJourneySeenCount",this.seenCount+1)}updateMessages(){let e=0;for(const n of this.$messages)e<this.step&&n.classList.add("is-visible"),e++;this.$messages.reverse();let t=0;e=this.maxStep;for(const n of this.$messages){const r=n.offsetHeight;e<this.step?(n.style.transform=`translateY(${-t}px)`,t+=r+20):n.style.transform=`translateY(${r}px)`,e--}this.$messages.reverse()}next(){this.step>this.maxStep||(this.step++,this.updateMessages())}}const cA={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			gl_FragColor = texture2D( tDiffuse, vUv );
			gl_FragColor.a *= opacity;


		}`};class Pv{constructor(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}const e8=new Fr(-1,1,1,-1,0,1),tS=new vt;tS.setAttribute("position",new lt([-1,3,0,-1,-1,0,3,-1,0],3));tS.setAttribute("uv",new lt([0,2,0,0,2,0],2));class t8{constructor(e){this._mesh=new je(tS,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,e8)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}class bd extends Pv{constructor(e,t){super(),this.textureID=t!==void 0?t:"tDiffuse",e instanceof jn?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=r1.clone(e.uniforms),this.material=new jn({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new t8(this.material)}render(e,t,n){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}}class uA extends Pv{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,n){const r=e.getContext(),s=e.state;s.buffers.color.setMask(!1),s.buffers.depth.setMask(!1),s.buffers.color.setLocked(!0),s.buffers.depth.setLocked(!0);let o,a;this.inverse?(o=0,a=1):(o=1,a=0),s.buffers.stencil.setTest(!0),s.buffers.stencil.setOp(r.REPLACE,r.REPLACE,r.REPLACE),s.buffers.stencil.setFunc(r.ALWAYS,o,4294967295),s.buffers.stencil.setClear(a),s.buffers.stencil.setLocked(!0),e.setRenderTarget(n),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),s.buffers.color.setLocked(!1),s.buffers.depth.setLocked(!1),s.buffers.stencil.setLocked(!1),s.buffers.stencil.setFunc(r.EQUAL,1,4294967295),s.buffers.stencil.setOp(r.KEEP,r.KEEP,r.KEEP),s.buffers.stencil.setLocked(!0)}}class n8 extends Pv{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class i8{constructor(e,t){if(this.renderer=e,t===void 0){const n=e.getSize(new Me);this._pixelRatio=e.getPixelRatio(),this._width=n.width,this._height=n.height,t=new Gi(this._width*this._pixelRatio,this._height*this._pixelRatio),t.texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],cA===void 0&&console.error("THREE.EffectComposer relies on CopyShader"),bd===void 0&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new bd(cA),this.clock=new Av}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const t=this.passes.indexOf(e);t!==-1&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){e===void 0&&(e=this.clock.getDelta());const t=this.renderer.getRenderTarget();let n=!1;for(let r=0,s=this.passes.length;r<s;r++){const o=this.passes[r];if(o.enabled!==!1){if(o.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(r),o.render(this.renderer,this.writeBuffer,this.readBuffer,e,n),o.needsSwap){if(n){const a=this.renderer.getContext(),c=this.renderer.state.buffers.stencil;c.setFunc(a.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),c.setFunc(a.EQUAL,1,4294967295)}this.swapBuffers()}uA!==void 0&&(o instanceof uA?n=!0:o instanceof n8&&(n=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(e===void 0){const t=this.renderer.getSize(new Me);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,e=this.renderTarget1.clone(),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;const n=this._width*this._pixelRatio,r=this._height*this._pixelRatio;this.renderTarget1.setSize(n,r),this.renderTarget2.setSize(n,r);for(let s=0;s<this.passes.length;s++)this.passes[s].setSize(n,r)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}}new Fr(-1,1,1,-1,0,1);const OR=new vt;OR.setAttribute("position",new lt([-1,3,0,-1,-1,0,3,-1,0],3));OR.setAttribute("uv",new lt([0,2,0,0,2,0],2));class r8 extends Pv{constructor(e,t,n,r,s){super(),this.scene=e,this.camera=t,this.overrideMaterial=n,this.clearColor=r,this.clearAlpha=s!==void 0?s:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new qe}render(e,t,n){const r=e.autoClear;e.autoClear=!1;let s,o;this.overrideMaterial!==void 0&&(o=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(e.getClearColor(this._oldClearColor),s=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:n),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(this._oldClearColor,s),this.overrideMaterial!==void 0&&(this.scene.overrideMaterial=o),e.autoClear=r}}var s8=`#define GLSLIFY 1
#define M_PI 3.1415926535897932384626433832795

uniform sampler2D tDiffuse;
uniform vec2 uResolution;
uniform vec2 uStrength;

varying vec2 vUv;

vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main()
{
    vec4 diffuseColor = texture2D(tDiffuse, vUv);
    vec4 blurColor = blur9(tDiffuse, vUv, uResolution, uStrength);
    float blurStrength = 1.0 - sin(vUv.y * M_PI);
    gl_FragColor = mix(diffuseColor, blurColor, blurStrength);
}
`,o8=`#define GLSLIFY 1
varying vec2 vUv;

void main()
{
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,hA={uniforms:{tDiffuse:{type:"t",value:null},uResolution:{type:"v2",value:null},uStrength:{type:"v2",value:null}},vertexShader:o8,fragmentShader:s8},a8=`#define GLSLIFY 1
uniform sampler2D tDiffuse;
uniform vec2 uPosition;
uniform float uRadius;
uniform vec3 uColor;
uniform float uAlpha;

varying vec2 vUv;

void main()
{
    vec4 diffuseColor = texture2D(tDiffuse, vUv);

    float glowStrength = distance(vUv, uPosition) / uRadius;
    glowStrength = 1.0 - glowStrength;
    glowStrength *= uAlpha;
    glowStrength = clamp(glowStrength, 0.0, 1.0);
    vec3 color = mix(diffuseColor.rgb, uColor, glowStrength);

    gl_FragColor = vec4(color, 1.0);
}
`,l8=`#define GLSLIFY 1
varying vec2 vUv;

void main()
{
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,c8={uniforms:{tDiffuse:{type:"t",value:null},uPosition:{type:"v2",value:null},uRadius:{type:"f",value:null},uColor:{type:"v3",value:null},uAlpha:{type:"f",value:null}},vertexShader:l8,fragmentShader:a8};class u8{constructor(e){this.$canvas=e.$canvas,this.time=new AU,this.sizes=new TU,this.resources=new QW,this.setConfig(),this.setDebug(),this.setRenderer(),this.setCamera(),this.setPasses(),this.setWorld(),this.setTitle(),this.setThreejsJourney()}setConfig(){this.config={},this.config.debug=window.location.hash==="#debug",this.config.cyberTruck=window.location.hash==="#cybertruck",this.config.touch=!1,window.addEventListener("touchstart",()=>{this.config.touch=!0,this.world.controls.setTouch(),this.passes.horizontalBlurPass.strength=1,this.passes.horizontalBlurPass.material.uniforms.uStrength.value=new Me(this.passes.horizontalBlurPass.strength,0),this.passes.verticalBlurPass.strength=1,this.passes.verticalBlurPass.material.uniforms.uStrength.value=new Me(0,this.passes.verticalBlurPass.strength)},{once:!0})}setDebug(){this.config.debug&&(this.debug=new EU({width:420}))}setRenderer(){this.scene=new $u,this.renderer=new ln({canvas:this.$canvas,alpha:!0}),this.renderer.setClearColor(0,1),this.renderer.setPixelRatio(2),this.renderer.setSize(this.sizes.viewport.width,this.sizes.viewport.height),this.renderer.physicallyCorrectLights=!0,this.renderer.physicallyCorrectLights=!0,this.renderer.outputEncoding=Ht,this.renderer.autoClear=!1,this.sizes.on("resize",()=>{this.renderer.setSize(this.sizes.viewport.width,this.sizes.viewport.height)})}setCamera(){this.camera=new KW({time:this.time,sizes:this.sizes,renderer:this.renderer,debug:this.debug,config:this.config}),this.scene.add(this.camera.container),this.time.on("tick",()=>{this.world&&this.world.car&&(this.camera.target.x=this.world.car.chassis.object.position.x,this.camera.target.y=this.world.car.chassis.object.position.y)})}setPasses(){if(this.passes={},this.debug&&(this.passes.debugFolder=this.debug.addFolder("postprocess")),this.passes.composer=new i8(this.renderer),this.passes.renderPass=new r8(this.scene,this.camera.instance),this.passes.horizontalBlurPass=new bd(hA),this.passes.horizontalBlurPass.strength=this.config.touch?0:1,this.passes.horizontalBlurPass.material.uniforms.uResolution.value=new Me(this.sizes.viewport.width,this.sizes.viewport.height),this.passes.horizontalBlurPass.material.uniforms.uStrength.value=new Me(this.passes.horizontalBlurPass.strength,0),this.passes.verticalBlurPass=new bd(hA),this.passes.verticalBlurPass.strength=this.config.touch?0:1,this.passes.verticalBlurPass.material.uniforms.uResolution.value=new Me(this.sizes.viewport.width,this.sizes.viewport.height),this.passes.verticalBlurPass.material.uniforms.uStrength.value=new Me(0,this.passes.verticalBlurPass.strength),this.debug){const e=this.passes.debugFolder.addFolder("blur");e.open(),e.add(this.passes.horizontalBlurPass.material.uniforms.uStrength.value,"x").step(.001).min(0).max(10),e.add(this.passes.verticalBlurPass.material.uniforms.uStrength.value,"y").step(.001).min(0).max(10)}if(this.passes.glowsPass=new bd(c8),this.passes.glowsPass.color="#ffcfe0",this.passes.glowsPass.material.uniforms.uPosition.value=new Me(0,.25),this.passes.glowsPass.material.uniforms.uRadius.value=.7,this.passes.glowsPass.material.uniforms.uColor.value=new qe(this.passes.glowsPass.color),this.passes.glowsPass.material.uniforms.uAlpha.value=.55,this.debug){const e=this.passes.debugFolder.addFolder("glows");e.open(),e.add(this.passes.glowsPass.material.uniforms.uPosition.value,"x").step(.001).min(-1).max(2).name("positionX"),e.add(this.passes.glowsPass.material.uniforms.uPosition.value,"y").step(.001).min(-1).max(2).name("positionY"),e.add(this.passes.glowsPass.material.uniforms.uRadius,"value").step(.001).min(0).max(2).name("radius"),e.addColor(this.passes.glowsPass,"color").name("color").onChange(()=>{this.passes.glowsPass.material.uniforms.uColor.value=new qe(this.passes.glowsPass.color)}),e.add(this.passes.glowsPass.material.uniforms.uAlpha,"value").step(.001).min(0).max(1).name("alpha")}this.passes.composer.addPass(this.passes.renderPass),this.passes.composer.addPass(this.passes.horizontalBlurPass),this.passes.composer.addPass(this.passes.verticalBlurPass),this.passes.composer.addPass(this.passes.glowsPass),this.time.on("tick",()=>{this.passes.horizontalBlurPass.enabled=this.passes.horizontalBlurPass.material.uniforms.uStrength.value.x>0,this.passes.verticalBlurPass.enabled=this.passes.verticalBlurPass.material.uniforms.uStrength.value.y>0,this.passes.composer.render()}),this.sizes.on("resize",()=>{this.renderer.setSize(this.sizes.viewport.width,this.sizes.viewport.height),this.passes.composer.setSize(this.sizes.viewport.width,this.sizes.viewport.height),this.passes.horizontalBlurPass.material.uniforms.uResolution.value.x=this.sizes.viewport.width,this.passes.horizontalBlurPass.material.uniforms.uResolution.value.y=this.sizes.viewport.height,this.passes.verticalBlurPass.material.uniforms.uResolution.value.x=this.sizes.viewport.width,this.passes.verticalBlurPass.material.uniforms.uResolution.value.y=this.sizes.viewport.height})}setWorld(){this.world=new SV({config:this.config,debug:this.debug,resources:this.resources,time:this.time,sizes:this.sizes,camera:this.camera,renderer:this.renderer,passes:this.passes}),this.scene.add(this.world.container)}setTitle(){this.title={},this.title.frequency=300,this.title.width=20,this.title.position=0,this.title.$element=document.querySelector("title"),this.title.absolutePosition=Math.round(this.title.width*.25),this.time.on("tick",()=>{this.world.physics&&(this.title.absolutePosition+=this.world.physics.car.forwardSpeed,this.title.absolutePosition<0&&(this.title.absolutePosition=0))}),window.setInterval(()=>{this.title.position=Math.round(this.title.absolutePosition%this.title.width),document.title=`${"_".repeat(this.title.width-this.title.position)}\u{1F697}${"_".repeat(this.title.position)}`},this.title.frequency)}setThreejsJourney(){document.querySelector(".js-threejs-journey")?this.threejsJourney=new JW({config:this.config,time:this.time,world:this.world}):this.threejsJourney=null}destructor(){this.time.off("tick"),this.sizes.off("resize"),this.camera.orbitControls.dispose(),this.renderer.dispose(),this.debug.destroy()}}window.application=new u8({$canvas:document.querySelector(".js-canvas"),useComposer:!0});var nS={exports:{}},Rv={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var h8=St.exports,d8=Symbol.for("react.element"),f8=Symbol.for("react.fragment"),p8=Object.prototype.hasOwnProperty,m8=h8.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,g8={key:!0,ref:!0,__self:!0,__source:!0};function NR(i,e,t){var n,r={},s=null,o=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)p8.call(e,n)&&!g8.hasOwnProperty(n)&&(r[n]=e[n]);if(i&&i.defaultProps)for(n in e=i.defaultProps,e)r[n]===void 0&&(r[n]=e[n]);return{$$typeof:d8,type:i,key:s,ref:o,props:r,_owner:m8.current}}Rv.Fragment=f8;Rv.jsx=NR;Rv.jsxs=NR;nS.exports=Rv;const pa=nS.exports.jsx,v8=nS.exports.jsxs;function y8(){return v8(Y4,{children:[pa("ambientLight",{}),pa("pointLight",{position:[5,5,5],intensity:1}),pa("pointLight",{position:[-3,-3,2]}),pa(iU,{})]})}function x8(){return pa("div",{className:"App h-screen",children:pa(y8,{})})}const w8=document.getElementById("root"),_8=SC(w8);_8.render(pa(XL.StrictMode,{children:pa(x8,{})}))});export default S8();
